/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * Ù…Ù†ØµØ© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ - Compliance Platform
 * Ù…Ù†ØµØ© Ø§Ù„Ø¨ØµÙŠØ±ÙŠâ„¢ - Golden Thread Architecture
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * @version 5.19.1
 * @date 2025-02-03
 * @changelog
 *   - v5.8.0: Modal Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ - 7 ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø´Ø§Ù…Ù„Ø©
 *   - v5.8.0: Tab 1: Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ø§Ù„Ø¹Ù†ÙˆØ§Ù†ØŒ Ø§Ù„ÙˆØµÙØŒ Ø§Ù„Ø¬Ù‡Ø©ØŒ Ø§Ù„Ø¥Ø·Ø§Ø±)
 *   - v5.8.0: Tab 2: Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ù†Ø·Ø§Ù‚ (Ø§Ù„ØªØµÙ†ÙŠÙØŒ Ø§Ù„Ù†ÙˆØ¹ØŒ Ø§Ù„Ù†Ø·Ø§Ù‚ØŒ Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚)
 *   - v5.8.0: Tab 3: Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± (Ø§Ù„Ø£Ù‡Ù…ÙŠØ©ØŒ Ø§Ù„ØªØ£Ø«ÙŠØ±ØŒ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±)
 *   - v5.8.0: Tab 4: Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø¯ÙˆØ±ÙŠØ© (Ø§Ù„Ø³Ø±ÙŠØ§Ù†ØŒ Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ØŒ Ø§Ù„Ø¯ÙˆØ±ÙŠØ©ØŒ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª)
 *   - v5.8.0: Tab 5: Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª (Ø§Ù„Ù…Ø§Ù„ÙƒØŒ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ØŒ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ØŒ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª)
 *   - v5.8.0: Tab 6: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ø£Ø¯Ù„Ø© (Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©)
 *   - v5.8.0: Tab 7: Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ (Ø§Ù„ØªØªØ¨Ø¹ØŒ Ø³Ø¬Ù„ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª)
 *   - v5.7.0: Module 4.9 Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© - Regulatory Communications
 *   - v5.7.0: Case Management (Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù/ØªØµØ¹ÙŠØ¯ Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§)
 *   - v5.7.0: Communication Thread (Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù/Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„)
 *   - v5.7.0: Golden Thread Linking (Ø±Ø¨Ø·/ØªØ¹Ø¯ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ Ø±Ø¨Ø· Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª)
 *   - v5.7.0: Response Pack Builder (Ø¥Ù†Ø´Ø§Ø¡/Ø¥Ø¶Ø§ÙØ© Ø£Ø¯Ù„Ø©/Ø§Ø¹ØªÙ…Ø§Ø¯/ØªÙ‚Ø¯ÙŠÙ…/Ø­Ø°Ù)
 *   - v5.7.0: Command Center Dashboard Ù…Ø¹ 10 KPIs
 *   - v5.7.0: Calendar View (Ù…ØªØ£Ø®Ø±/Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹/Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±/Ù…ÙƒØªÙ…Ù„)
 *   - v5.7.0: Audit Trail Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
 *   - v5.6.0: Module 4.8 Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©
 *   - v5.5.0: Module 4.7 Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
 *   - v5.0.0: Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Module 4.2 ÙƒÙ€ Enterprise Policy Operating System
 * 
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„ØªØµÙ…ÙŠÙ…ÙŠØ©:
 * - ÙØµÙ„ Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø¹Ù† Ø§Ù„ØªØ´ØºÙŠÙ„ (Definition vs Operation)
 * - Golden Thread: Ø±Ø¨Ø· Ø§Ù„Ù…ØªØ·Ù„Ø¨ â†’ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… â†’ Ø§Ù„Ø¶Ø§Ø¨Ø· â†’ Ø§Ù„Ø¯Ù„ÙŠÙ„
 * - Many-to-Many: Ø§Ù„ØªØ²Ø§Ù… ÙˆØ§Ø­Ø¯ ÙŠØºØ·ÙŠ Ø¹Ø¯Ø© Ù…ØªØ·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¹ÙƒØ³
 * - Workflow: Draft â†’ UnderReview â†’ Approved â†’ Active â†’ Retired
 * - SoD: ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (Owner â‰  Reviewer â‰  Approver)
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

import React, { useState, useMemo, useEffect } from 'react';
import {
  Shield, FileText, Link2, ClipboardCheck, AlertTriangle,
  BarChart3, MessageSquare, TrendingUp, Building2,
  Search, Bell, User, Plus, Filter, Download, Eye, Edit,
  CheckCircle2, XCircle, Clock, Calendar, ArrowUpRight,
  Settings, LogOut, Menu, Home, FolderOpen, RefreshCw,
  FileCheck, Upload, File, ChevronDown, ChevronRight, ChevronUp,
  AlertCircle, BookOpen, Save, Send, Archive, History,
  Copy, CheckSquare, LayoutGrid, List, GitBranch, MoreVertical,
  Trash2, ExternalLink, PieChart, Layers, X, ChevronLeft,
  Users, Target, Zap, Activity, Check, Info, Scale, Briefcase,
  Building, Globe, Hash, Tag, UserCheck, UserX, RotateCcw,
  FileWarning, FilePlus, FileSearch, Table, LayoutList, Network, MapPin,
  Play, Inbox, LayoutDashboard, Mail, Link, MinusCircle, FolderPlus,
  ClipboardList, Lock, FileQuestion, HelpCircle, ArrowDownCircle, ArrowUpCircle,
  Package, Paperclip, PhoneCall, Minimize2, Maximize2, Square, ListChecks
} from 'lucide-react';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ© (Reference Data)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// 1) Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© (Regulatory Authorities)
const AUTHORITIES = [
  { id: 1, code: 'SAMA', nameAr: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', nameEn: 'Saudi Central Bank', sector: 'Banking', country: 'SA', status: 'Active' },
  { id: 2, code: 'CMA', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', nameEn: 'Capital Market Authority', sector: 'Capital', country: 'SA', status: 'Active' },
  { id: 3, code: 'NCA', nameAr: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'National Cybersecurity Authority', sector: 'Cybersecurity', country: 'SA', status: 'Active' },
  { id: 4, code: 'SDAIA', nameAr: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', nameEn: 'Saudi Data & AI Authority', sector: 'Data', country: 'SA', status: 'Active' },
  { id: 5, code: 'ZATCA', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ', nameEn: 'Zakat, Tax and Customs Authority', sector: 'Tax', country: 'SA', status: 'Active' },
  { id: 6, code: 'CCHI', nameAr: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØµØ­ÙŠ', nameEn: 'Council of Cooperative Health Insurance', sector: 'Health', country: 'SA', status: 'Active' },
  { id: 7, code: 'HRSD', nameAr: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© ÙˆØ§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©', nameEn: 'Ministry of Human Resources', sector: 'Labor', country: 'SA', status: 'Active' },
  { id: 8, code: 'CITC', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', nameEn: 'Communications & IT Commission', sector: 'Telecom', country: 'SA', status: 'Active' },
];

// 2) Ø§Ù„Ø£Ø·Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© (Regulatory Frameworks)
const FRAMEWORKS = [
  { id: 1, authorityId: 1, code: 'SAMA-AML', title: 'Ù‚ÙˆØ§Ø¹Ø¯ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', titleEn: 'Anti-Money Laundering Rules', version: '2.0', issueDate: '2023-01-15', effectiveDate: '2023-03-01', status: 'Active' },
  { id: 2, authorityId: 1, code: 'SAMA-CF', title: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©', titleEn: 'Compliance Framework', version: '1.5', issueDate: '2022-06-01', effectiveDate: '2022-09-01', status: 'Active' },
  { id: 3, authorityId: 1, code: 'SAMA-BCM', title: 'Ø¥Ø·Ø§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', titleEn: 'Business Continuity Management', version: '1.0', issueDate: '2023-05-01', effectiveDate: '2023-08-01', status: 'Active' },
  { id: 4, authorityId: 1, code: 'SAMA-CSF', title: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', titleEn: 'Cybersecurity Framework', version: '1.0', issueDate: '2022-01-01', effectiveDate: '2022-04-01', status: 'Active' },
  { id: 5, authorityId: 2, code: 'CMA-CGR', title: 'Ù„Ø§Ø¦Ø­Ø© Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª', titleEn: 'Corporate Governance Regulations', version: '3.0', issueDate: '2023-02-01', effectiveDate: '2023-05-01', status: 'Active' },
  { id: 6, authorityId: 2, code: 'CMA-AML', title: 'Ù‚ÙˆØ§Ø¹Ø¯ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ - Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', titleEn: 'AML Rules - Capital Market', version: '1.2', issueDate: '2022-08-01', effectiveDate: '2022-11-01', status: 'Active' },
  { id: 7, authorityId: 3, code: 'NCA-ECC', title: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', titleEn: 'Essential Cybersecurity Controls', version: '2.0', issueDate: '2023-01-01', effectiveDate: '2023-04-01', status: 'Active' },
  { id: 8, authorityId: 3, code: 'NCA-CCC', title: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©', titleEn: 'Critical Systems Cybersecurity Controls', version: '1.0', issueDate: '2022-06-01', effectiveDate: '2022-09-01', status: 'Active' },
  { id: 9, authorityId: 4, code: 'SDAIA-PDPL', title: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', titleEn: 'Personal Data Protection Law', version: '1.0', issueDate: '2023-09-01', effectiveDate: '2023-09-14', status: 'Active' },
  { id: 10, authorityId: 5, code: 'ZATCA-VAT', title: 'Ù„Ø§Ø¦Ø­Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©', titleEn: 'VAT Regulations', version: '2.1', issueDate: '2023-01-01', effectiveDate: '2023-01-01', status: 'Active' },
  { id: 11, authorityId: 5, code: 'ZATCA-EI', title: 'Ù„Ø§Ø¦Ø­Ø© Ø§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', titleEn: 'E-Invoicing Regulations', version: '1.0', issueDate: '2021-12-04', effectiveDate: '2021-12-04', status: 'Active' },
  { id: 12, authorityId: 6, code: 'CCHI-HI', title: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØµØ­ÙŠ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠ', titleEn: 'Cooperative Health Insurance Law', version: '1.0', issueDate: '2020-01-01', effectiveDate: '2020-01-01', status: 'Active' },
  { id: 13, authorityId: 7, code: 'HRSD-WPS', title: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±', titleEn: 'Wage Protection System', version: '2.0', issueDate: '2022-01-01', effectiveDate: '2022-01-01', status: 'Active' },
  { id: 14, authorityId: 7, code: 'HRSD-NTQ', title: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù†Ø·Ø§Ù‚Ø§Øª', titleEn: 'Nitaqat Program', version: '3.0', issueDate: '2023-01-01', effectiveDate: '2023-01-01', status: 'Active' },
];

// 3) Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© (Regulatory Requirements)
const REQUIREMENTS = [
  // SAMA-AML Requirements
  { id: 1, frameworkId: 1, refCode: 'SAMA-AML-1.1', text: 'ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ¶Ø¹ ÙˆØªÙ†ÙÙŠØ° Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡', category: 'Compliance', criticality: 'High', status: 'Active' },
  { id: 2, frameworkId: 1, refCode: 'SAMA-AML-1.2', text: 'ÙŠØ¬Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ø¨Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„', category: 'Compliance', criticality: 'High', status: 'Active' },
  { id: 3, frameworkId: 1, refCode: 'SAMA-AML-2.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø© Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­Ø±ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©', category: 'Compliance', criticality: 'High', status: 'Active' },
  { id: 4, frameworkId: 1, refCode: 'SAMA-AML-3.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù…Ø¯Ø© Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 10 Ø³Ù†ÙˆØ§Øª', category: 'Compliance', criticality: 'Medium', status: 'Active' },
  { id: 5, frameworkId: 1, refCode: 'SAMA-AML-4.1', text: 'ÙŠØ¬Ø¨ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹', category: 'HR', criticality: 'Medium', status: 'Active' },

  // SAMA-CF Requirements
  { id: 6, frameworkId: 2, refCode: 'SAMA-CF-1.1', text: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù…ØªØ«Ø§Ù„ Ù…Ø¤Ù‡Ù„ ÙˆÙ…Ø³ØªÙ‚Ù„', category: 'Governance', criticality: 'High', status: 'Active' },
  { id: 7, frameworkId: 2, refCode: 'SAMA-CF-2.1', text: 'ÙŠØ¬Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø³Ù†ÙˆÙŠ ÙˆØ±ÙØ¹Ù‡ Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', category: 'Governance', criticality: 'High', status: 'Active' },
  { id: 8, frameworkId: 2, refCode: 'SAMA-CF-3.1', text: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹', category: 'Risk', criticality: 'High', status: 'Active' },

  // NCA-ECC Requirements
  { id: 9, frameworkId: 7, refCode: 'NCA-ECC-1.1', text: 'ÙŠØ¬Ø¨ ÙˆØ¶Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ÙˆØ³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙˆØ§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§', category: 'Cybersecurity', criticality: 'High', status: 'Active' },
  { id: 10, frameworkId: 7, refCode: 'NCA-ECC-2.1', text: 'ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ ÙˆØªØµÙ†ÙŠÙ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø³Ø©', category: 'IT', criticality: 'High', status: 'Active' },
  { id: 11, frameworkId: 7, refCode: 'NCA-ECC-3.1', text: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„', category: 'IT', criticality: 'High', status: 'Active' },
  { id: 12, frameworkId: 7, refCode: 'NCA-ECC-4.1', text: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø³Ù†ÙˆÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', category: 'IT', criticality: 'High', status: 'Active' },

  // SDAIA-PDPL Requirements
  { id: 13, frameworkId: 9, refCode: 'PDPL-1.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØµØ±ÙŠØ­Ø© Ù…Ù† ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ø§Ù„Ø´Ø®ØµÙŠØ©', category: 'Data', criticality: 'High', status: 'Active' },
  { id: 14, frameworkId: 9, refCode: 'PDPL-2.1', text: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', category: 'Governance', criticality: 'High', status: 'Active' },
  { id: 15, frameworkId: 9, refCode: 'PDPL-3.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©', category: 'Compliance', criticality: 'High', status: 'Active' },

  // ZATCA Requirements
  { id: 16, frameworkId: 10, refCode: 'VAT-1.1', text: 'ÙŠØ¬Ø¨ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©', category: 'Tax', criticality: 'High', status: 'Active' },
  { id: 17, frameworkId: 11, refCode: 'EI-1.1', text: 'ÙŠØ¬Ø¨ Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©', category: 'Tax', criticality: 'High', status: 'Active' },

  // CMA Requirements
  { id: 18, frameworkId: 5, refCode: 'CGR-1.1', text: 'ÙŠØ¬Ø¨ ØªØ´ÙƒÙŠÙ„ Ù„Ø¬Ù†Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠÙŠÙ†', category: 'Governance', criticality: 'High', status: 'Active' },
  { id: 19, frameworkId: 5, refCode: 'CGR-2.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥ÙØµØ§Ø­ Ø¹Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠØ© ÙÙˆØ± Ø­Ø¯ÙˆØ«Ù‡Ø§', category: 'Governance', criticality: 'High', status: 'Active' },

  // HRSD Requirements
  { id: 20, frameworkId: 13, refCode: 'WPS-1.1', text: 'ÙŠØ¬Ø¨ ØµØ±Ù Ø£Ø¬ÙˆØ± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±', category: 'HR', criticality: 'High', status: 'Active' },
  { id: 21, frameworkId: 14, refCode: 'NTQ-1.1', text: 'ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù†Ø·Ø§Ù‚Ø§Øª', category: 'HR', criticality: 'High', status: 'Active' },
];

// 4) Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª (Categories)
const CATEGORIES = [
  { code: 'Governance', nameAr: 'Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', nameEn: 'Governance' },
  { code: 'Risk', nameAr: 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±', nameEn: 'Risk' },
  { code: 'Compliance', nameAr: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', nameEn: 'Compliance' },
  { code: 'IT', nameAr: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', nameEn: 'Information Technology' },
  { code: 'Cybersecurity', nameAr: 'Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'Cybersecurity' },
  { code: 'Data', nameAr: 'Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Protection' },
  { code: 'HR', nameAr: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', nameEn: 'Human Resources' },
  { code: 'Finance', nameAr: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©', nameEn: 'Finance' },
  { code: 'Tax', nameAr: 'Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨', nameEn: 'Tax' },
  { code: 'Operations', nameAr: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', nameEn: 'Operations' },
];

// 5) Ø§Ù„Ø¯ÙˆØ±ÙŠØ© (Frequencies)
const FREQUENCIES = [
  { code: 'Adhoc', nameAr: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©', nameEn: 'Ad-hoc' },
  { code: 'Daily', nameAr: 'ÙŠÙˆÙ…ÙŠ', nameEn: 'Daily' },
  { code: 'Weekly', nameAr: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ', nameEn: 'Weekly' },
  { code: 'Monthly', nameAr: 'Ø´Ù‡Ø±ÙŠ', nameEn: 'Monthly' },
  { code: 'Quarterly', nameAr: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', nameEn: 'Quarterly' },
  { code: 'SemiAnnual', nameAr: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ', nameEn: 'Semi-Annual' },
  { code: 'Annual', nameAr: 'Ø³Ù†ÙˆÙŠ', nameEn: 'Annual' },
  { code: 'EventDriven', nameAr: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¯Ø«', nameEn: 'Event-driven' },
];

// 6) Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù†Ø·Ø§Ù‚ (Scope Levels)
const SCOPE_LEVELS = [
  { code: 'Enterprise', nameAr: 'Ø§Ù„Ù…Ø¤Ø³Ø³Ø©', nameEn: 'Enterprise' },
  { code: 'BU', nameAr: 'ÙˆØ­Ø¯Ø© Ø£Ø¹Ù…Ø§Ù„', nameEn: 'Business Unit' },
  { code: 'Department', nameAr: 'Ø¥Ø¯Ø§Ø±Ø©', nameEn: 'Department' },
  { code: 'Process', nameAr: 'Ø¹Ù…Ù„ÙŠØ©', nameEn: 'Process' },
  { code: 'System', nameAr: 'Ù†Ø¸Ø§Ù…', nameEn: 'System' },
  { code: 'Location', nameAr: 'Ù…ÙˆÙ‚Ø¹', nameEn: 'Location' },
];

// 7) Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© (Evidence Types)
const EVIDENCE_TYPES = [
  { code: 'Policy', nameAr: 'Ø³ÙŠØ§Ø³Ø©', nameEn: 'Policy' },
  { code: 'Procedure', nameAr: 'Ø¥Ø¬Ø±Ø§Ø¡', nameEn: 'Procedure' },
  { code: 'Report', nameAr: 'ØªÙ‚Ø±ÙŠØ±', nameEn: 'Report' },
  { code: 'Log', nameAr: 'Ø³Ø¬Ù„', nameEn: 'Log' },
  { code: 'Approval', nameAr: 'Ù…ÙˆØ§ÙÙ‚Ø©', nameEn: 'Approval' },
  { code: 'Config', nameAr: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', nameEn: 'Configuration' },
  { code: 'Screenshot', nameAr: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', nameEn: 'Screenshot' },
  { code: 'Certificate', nameAr: 'Ø´Ù‡Ø§Ø¯Ø©', nameEn: 'Certificate' },
  { code: 'Minutes', nameAr: 'Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹', nameEn: 'Meeting Minutes' },
  { code: 'Contract', nameAr: 'Ø¹Ù‚Ø¯', nameEn: 'Contract' },
  { code: 'Other', nameAr: 'Ø£Ø®Ø±Ù‰', nameEn: 'Other' },
];

// 8) Ø£Ø«Ø± Ø§Ù„Ù…Ø®Ø§Ø·Ø± (Regulatory Impacts)
const REGULATORY_IMPACTS = [
  { code: 'Penalty', nameAr: 'ØºØ±Ø§Ù…Ø© Ù…Ø§Ù„ÙŠØ©', nameEn: 'Financial Penalty' },
  { code: 'License', nameAr: 'ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø®ØµØ©', nameEn: 'License Impact' },
  { code: 'Reporting', nameAr: 'Ø¥Ù„Ø²Ø§Ù… Ø¨ØªÙ‚Ø§Ø±ÙŠØ± Ø¥Ø¶Ø§ÙÙŠØ©', nameEn: 'Reporting Requirement' },
  { code: 'Reputation', nameAr: 'Ø¶Ø±Ø± Ø³Ù…Ø¹Ø©', nameEn: 'Reputation Damage' },
  { code: 'Operational', nameAr: 'ØªØ£Ø«ÙŠØ± ØªØ´ØºÙŠÙ„ÙŠ', nameEn: 'Operational Impact' },
  { code: 'Legal', nameAr: 'Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©', nameEn: 'Legal Liability' },
];

// 9) Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Users) - Ù„Ù„Ø¹Ø±Ø¶
const USERS = [
  { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'ComplianceOfficer', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
  { id: 2, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'ComplianceReviewer', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
  { id: 3, name: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ', role: 'ComplianceApprover', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
  { id: 4, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'ComplianceOfficer', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
  { id: 5, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ', role: 'ObligationOwner', department: 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±' },
  { id: 6, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', role: 'ObligationOwner', department: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' },
  { id: 7, name: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', role: 'ComplianceAdmin', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
  { id: 8, name: 'Ø±ÙŠÙ… Ø§Ù„Ø³Ø¨ÙŠØ¹ÙŠ', role: 'InternalAudit', department: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©' },
];

// 10) Ø­Ø§Ù„Ø§Øª Workflow
const WORKFLOW_STATES = {
  Draft: { code: 'Draft', nameAr: 'Ù…Ø³ÙˆØ¯Ø©', color: 'gray', icon: FileText },
  UnderReview: { code: 'UnderReview', nameAr: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', color: 'amber', icon: Clock },
  Returned: { code: 'Returned', nameAr: 'Ù…ÙØ¹Ø§Ø¯', color: 'orange', icon: RotateCcw },
  Approved: { code: 'Approved', nameAr: 'Ù…Ø¹ØªÙ…Ø¯', color: 'blue', icon: CheckCircle2 },
  Active: { code: 'Active', nameAr: 'Ù†Ø´Ø·', color: 'emerald', icon: CheckCircle2 },
  OnHold: { code: 'OnHold', nameAr: 'Ù…Ø¹Ù„Ù‘Ù‚', color: 'purple', icon: Clock },
  Retired: { code: 'Retired', nameAr: 'Ù…Ù„ØºÙŠ', color: 'red', icon: Archive },
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.2: Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± (Policies & Standards)
// Enterprise Policy Operating System - Better than Archer
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// 11) Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª (Policy Types)
const POLICY_TYPES = [
  { code: 'Policy', nameAr: 'Ø³ÙŠØ§Ø³Ø©', nameEn: 'Policy', level: 1, icon: 'ğŸ“œ' },
  { code: 'Standard', nameAr: 'Ù…Ø¹ÙŠØ§Ø±', nameEn: 'Standard', level: 2, icon: 'ğŸ“‹' },
  { code: 'Procedure', nameAr: 'Ø¥Ø¬Ø±Ø§Ø¡', nameEn: 'Procedure', level: 3, icon: 'ğŸ“' },
  { code: 'Guideline', nameAr: 'Ø¯Ù„ÙŠÙ„ Ø¥Ø±Ø´Ø§Ø¯ÙŠ', nameEn: 'Guideline', level: 4, icon: 'ğŸ“–' },
  { code: 'Form', nameAr: 'Ù†Ù…ÙˆØ°Ø¬', nameEn: 'Form', level: 5, icon: 'ğŸ“„' },
];

// 12) Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¥Ù„Ø²Ø§Ù… (Mandatory Levels)
const MANDATORY_LEVELS = [
  { code: 'Mandatory', nameAr: 'Ø¥Ù„Ø²Ø§Ù…ÙŠ', nameEn: 'Mandatory', color: 'red' },
  { code: 'ShouldComply', nameAr: 'ÙŠÙ†Ø¨ØºÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', nameEn: 'Should Comply', color: 'amber' },
  { code: 'BestPractice', nameAr: 'Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª', nameEn: 'Best Practice', color: 'blue' },
  { code: 'Optional', nameAr: 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ', nameEn: 'Optional', color: 'slate' },
];

// 13) Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± (Attestation Status)
const ATTESTATION_STATUS = [
  { code: 'Pending', nameAr: 'Ù…Ø¹Ù„Ù‚', nameEn: 'Pending', color: 'slate' },
  { code: 'Acknowledged', nameAr: 'ØªÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±', nameEn: 'Acknowledged', color: 'emerald' },
  { code: 'Overdue', nameAr: 'Ù…ØªØ£Ø®Ø±', nameEn: 'Overdue', color: 'red' },
  { code: 'Exempted', nameAr: 'Ù…Ø¹ÙÙ‰', nameEn: 'Exempted', color: 'purple' },
];

// 14) Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© (Advanced Policies)
const POLICIES = [
  {
    id: 1,
    code: 'POL-001',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ',
    titleEn: 'Regulatory Compliance Policy',
    type: 'Policy',
    category: 'Compliance',
    ownerId: 7,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '2.0',
    effectiveDate: '2024-01-01',
    nextReviewDate: '2025-01-01',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [1, 2],
    linkedObligations: [1, 2, 3, 6, 7],
    linkedControls: [1, 2, 3],
    linkedRisks: [1, 2],
    standardRequirements: [1, 2, 3, 4],
    attestationCampaigns: [1],
    summary: 'ØªØ­Ø¯Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¥Ø·Ø§Ø± Ø¹Ù…Ù„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ù„Ù„Ù…Ø¤Ø³Ø³Ø© ÙˆØªØ¶Ø¹ Ø§Ù„Ø£Ø³Ø³ ÙˆØ§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ÙŠØ© Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©',
    objectives: ['Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©', 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ù…Ù† Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©', 'ØªØ¹Ø²ÙŠØ² Ø«Ù‚Ø§ÙØ© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„'],
    createdAt: '2023-01-15',
    createdBy: 7,
    lastModifiedAt: '2024-01-01',
    lastModifiedBy: 7,
  },
  {
    id: 2,
    code: 'POL-002',
    title: 'Ø³ÙŠØ§Ø³Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
    titleEn: 'Anti-Money Laundering Policy',
    type: 'Policy',
    category: 'Compliance',
    ownerId: 1,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '3.1',
    effectiveDate: '2024-03-01',
    nextReviewDate: '2025-03-01',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [1],
    linkedObligations: [1, 2, 3, 4, 5],
    linkedControls: [1, 2, 3],
    linkedRisks: [1],
    standardRequirements: [5, 6, 7, 8, 9],
    attestationCampaigns: [2],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨ ØªØ¶Ø¹ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© ÙˆØ§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø¹Ù†ÙŠÙŠÙ†',
    objectives: ['Ù…Ù†Ø¹ ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', 'Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©', 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª SAMA'],
    createdAt: '2022-06-01',
    createdBy: 1,
    lastModifiedAt: '2024-03-01',
    lastModifiedBy: 1,
  },
  {
    id: 3,
    code: 'POL-003',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
    titleEn: 'Cybersecurity Policy',
    type: 'Policy',
    category: 'Cybersecurity',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.5',
    effectiveDate: '2024-02-15',
    nextReviewDate: '2025-02-15',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [4, 7],
    linkedObligations: [9, 10, 11, 12],
    linkedControls: [4, 5],
    linkedRisks: [3, 4],
    standardRequirements: [10, 11, 12, 13],
    attestationCampaigns: [3],
    summary: 'ØªØ­Ø¯Ø¯ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙˆØ¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù„Ø­Ù…Ø§ÙŠØ© Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©',
    objectives: ['Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ø¶ÙˆØ§Ø¨Ø· NCA'],
    createdAt: '2023-06-01',
    createdBy: 6,
    lastModifiedAt: '2024-02-15',
    lastModifiedBy: 6,
  },
  {
    id: 4,
    code: 'POL-004',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
    titleEn: 'Personal Data Protection Policy',
    type: 'Policy',
    category: 'Data',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2023-09-14',
    nextReviewDate: '2024-09-14',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [9],
    linkedObligations: [13, 14, 15],
    linkedControls: [6, 7],
    linkedRisks: [5],
    standardRequirements: [14, 15, 16],
    attestationCampaigns: [4],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© PDPL',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©',
    objectives: ['Ø­Ù…Ø§ÙŠØ© Ø®ØµÙˆØµÙŠØ© Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù€ PDPL'],
    createdAt: '2023-09-01',
    createdBy: 6,
    lastModifiedAt: '2023-09-14',
    lastModifiedBy: 6,
  },
  {
    id: 5,
    code: 'STD-001',
    title: 'Ù…Ø¹ÙŠØ§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„',
    titleEn: 'Identity & Access Management Standard',
    type: 'Standard',
    category: 'IT',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '2.0',
    effectiveDate: '2024-01-01',
    nextReviewDate: '2025-01-01',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [7],
    linkedObligations: [11],
    linkedControls: [4],
    linkedRisks: [4],
    standardRequirements: [17, 18, 19],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø¥Ø¯Ø§Ø±Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø£Ù†Ø¸Ù…Ø©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø¸Ù…Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
    objectives: ['Ø¶Ù…Ø§Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡ ÙÙ‚Ø·'],
    createdAt: '2023-01-01',
    createdBy: 6,
    lastModifiedAt: '2024-01-01',
    lastModifiedBy: 6,
  },
  {
    id: 6,
    code: 'PRC-001',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
    titleEn: 'Suspicious Transaction Reporting Procedure',
    type: 'Procedure',
    category: 'Compliance',
    ownerId: 1,
    reviewerId: 2,
    approverId: 3,
    currentVersion: '2.3',
    effectiveDate: '2024-01-15',
    nextReviewDate: '2025-01-15',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [1],
    linkedObligations: [3],
    linkedControls: [2],
    linkedRisks: [1],
    standardRequirements: [20, 21],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
    scope: 'Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª',
    objectives: ['Ø¶Ù…Ø§Ù† Ø§Ù„Ø¥Ø¨Ù„Ø§Øº ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯'],
    createdAt: '2022-01-01',
    createdBy: 1,
    lastModifiedAt: '2024-01-15',
    lastModifiedBy: 1,
  },
  {
    id: 7,
    code: 'POL-005',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ©',
    titleEn: 'Corporate Governance Policy',
    type: 'Policy',
    category: 'Governance',
    ownerId: 7,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.2',
    effectiveDate: '2024-05-01',
    nextReviewDate: '2025-05-01',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [5],
    linkedObligations: [18, 19],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [22, 23],
    attestationCampaigns: [5],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª ÙˆÙÙ‚ Ù…ØªØ·Ù„Ø¨Ø§Øª Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
    scope: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©',
    objectives: ['ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ø­Ù…Ø§ÙŠØ© Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†'],
    createdAt: '2023-05-01',
    createdBy: 7,
    lastModifiedAt: '2024-05-01',
    lastModifiedBy: 7,
  },
  {
    id: 8,
    code: 'POL-006',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©',
    titleEn: 'Human Resources Management Policy',
    type: 'Policy',
    category: 'HR',
    ownerId: 5,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '2.1',
    effectiveDate: '2024-01-01',
    nextReviewDate: '2025-01-01',
    status: 'Active',
    impactLevel: 'Medium',
    linkedFrameworks: [13, 14],
    linkedObligations: [20, 21],
    linkedControls: [8],
    linkedRisks: [6],
    standardRequirements: [24, 25],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© ÙˆØ§Ù„ØªÙˆØ·ÙŠÙ†',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†',
    objectives: ['Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„', 'ØªØ­Ù‚ÙŠÙ‚ Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ†'],
    createdAt: '2022-01-01',
    createdBy: 5,
    lastModifiedAt: '2024-01-01',
    lastModifiedBy: 5,
  },
  {
    id: 9,
    code: 'POL-007',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
    titleEn: 'Business Continuity Management Policy',
    type: 'Policy',
    category: 'Operations',
    ownerId: 7,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-06-01',
    nextReviewDate: '2025-06-01',
    status: 'UnderReview',
    impactLevel: 'Critical',
    linkedFrameworks: [3],
    linkedObligations: [],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø±Ø¬Ø©',
    objectives: ['Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', 'ØªÙ‚Ù„ÙŠÙ„ ÙˆÙ‚Øª Ø§Ù„ØªØ¹Ø·Ù„'],
    createdAt: '2024-05-01',
    createdBy: 7,
    lastModifiedAt: '2024-05-15',
    lastModifiedBy: 7,
  },
  {
    id: 10,
    code: 'POL-008',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±',
    titleEn: 'Risk Management Policy',
    type: 'Policy',
    category: 'Risk',
    ownerId: 5,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.5',
    effectiveDate: '2024-01-01',
    nextReviewDate: '2025-01-01',
    status: 'Draft',
    impactLevel: 'High',
    linkedFrameworks: [2],
    linkedObligations: [8],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª',
    objectives: ['ØªØ­Ø¯ÙŠØ¯ ÙˆØªÙ‚ÙŠÙŠÙ… ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±'],
    createdAt: '2024-01-01',
    createdBy: 5,
    lastModifiedAt: '2024-01-10',
    lastModifiedBy: 5,
  },
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© (Additional Standards) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {
    id: 11,
    code: 'STD-002',
    title: 'Ù…Ø¹ÙŠØ§Ø± ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    titleEn: 'Data Classification Standard',
    type: 'Standard',
    category: 'Data',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-03-01',
    nextReviewDate: '2025-03-01',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [7, 9],
    linkedObligations: [13, 14],
    linkedControls: [6, 7],
    linkedRisks: [5],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹ÙŠØ§Ø± ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø³Ø±ÙŠØ©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ©',
    objectives: ['ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©', 'Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù€ PDPL'],
    createdAt: '2024-02-01',
    createdBy: 6,
    lastModifiedAt: '2024-03-01',
    lastModifiedBy: 6,
  },
  {
    id: 12,
    code: 'STD-003',
    title: 'Ù…Ø¹ÙŠØ§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
    titleEn: 'Vulnerability Management Standard',
    type: 'Standard',
    category: 'Cybersecurity',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '2.1',
    effectiveDate: '2024-04-01',
    nextReviewDate: '2025-04-01',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [4, 7],
    linkedObligations: [9, 10],
    linkedControls: [4, 5],
    linkedRisks: [3, 4],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹ÙŠØ§Ø± Ø§ÙƒØªØ´Ø§Ù ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© ÙÙŠ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª',
    objectives: ['Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø«ØºØ±Ø§Øª', 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯'],
    createdAt: '2024-01-15',
    createdBy: 6,
    lastModifiedAt: '2024-04-01',
    lastModifiedBy: 6,
  },
  {
    id: 13,
    code: 'STD-004',
    title: 'Ù…Ø¹ÙŠØ§Ø± Ø§Ù„ØªØ´ÙÙŠØ± ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­',
    titleEn: 'Encryption & Key Management Standard',
    type: 'Standard',
    category: 'Cybersecurity',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.5',
    effectiveDate: '2024-02-01',
    nextReviewDate: '2025-02-01',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [4, 7],
    linkedObligations: [11, 12],
    linkedControls: [4, 5],
    linkedRisks: [3],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªØ´ÙÙŠØ± ÙˆØ¥Ø¯Ø§Ø±Ø© Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ´ÙÙŠØ± Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©',
    objectives: ['ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†'],
    createdAt: '2024-01-01',
    createdBy: 6,
    lastModifiedAt: '2024-02-01',
    lastModifiedBy: 6,
  },
  {
    id: 14,
    code: 'STD-005',
    title: 'Ù…Ø¹ÙŠØ§Ø± Ø£Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ§Øª',
    titleEn: 'Network Security Standard',
    type: 'Standard',
    category: 'Cybersecurity',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-05-01',
    nextReviewDate: '2025-05-01',
    status: 'UnderReview',
    impactLevel: 'Critical',
    linkedFrameworks: [4, 7],
    linkedObligations: [9, 10],
    linkedControls: [4],
    linkedRisks: [3, 4],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø´Ø¨ÙƒØ§Øª ÙˆØ§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©',
    scope: 'Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ù„Ù„Ø´Ø¨ÙƒØ§Øª',
    objectives: ['Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø´Ø¨ÙƒØ§Øª', 'Ù…Ù†Ø¹ Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª', 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'],
    createdAt: '2024-04-01',
    createdBy: 6,
    lastModifiedAt: '2024-04-15',
    lastModifiedBy: 6,
  },
  {
    id: 15,
    code: 'STD-006',
    title: 'Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©',
    titleEn: 'Backup & Recovery Standard',
    type: 'Standard',
    category: 'Operations',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-06-01',
    nextReviewDate: '2025-06-01',
    status: 'Draft',
    impactLevel: 'High',
    linkedFrameworks: [3, 7],
    linkedObligations: [],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø±Ø¬Ø©',
    objectives: ['Ø¶Ù…Ø§Ù† ØªÙˆÙØ± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¯ÙˆØ±ÙŠØ§Ù‹'],
    createdAt: '2024-05-15',
    createdBy: 6,
    lastModifiedAt: '2024-05-20',
    lastModifiedBy: 6,
  },
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© (Additional Procedures) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {
    id: 16,
    code: 'PRC-002',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ù…ÙŠÙ„',
    titleEn: 'Customer Identity Verification Procedure',
    type: 'Procedure',
    category: 'Compliance',
    ownerId: 1,
    reviewerId: 2,
    approverId: 3,
    currentVersion: '3.0',
    effectiveDate: '2024-02-01',
    nextReviewDate: '2025-02-01',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [1],
    linkedObligations: [1, 2],
    linkedControls: [1, 2],
    linkedRisks: [1],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (KYC) ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯ ÙˆØ§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†',
    objectives: ['Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©', 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„', 'ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡'],
    createdAt: '2022-06-01',
    createdBy: 1,
    lastModifiedAt: '2024-02-01',
    lastModifiedBy: 1,
  },
  {
    id: 17,
    code: 'PRC-003',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
    titleEn: 'Security Incident Management Procedure',
    type: 'Procedure',
    category: 'Cybersecurity',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '2.0',
    effectiveDate: '2024-03-01',
    nextReviewDate: '2025-03-01',
    status: 'Active',
    impactLevel: 'Critical',
    linkedFrameworks: [4, 7],
    linkedObligations: [9, 10],
    linkedControls: [4, 5],
    linkedRisks: [3, 4],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ© ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
    objectives: ['Ø§Ù„ÙƒØ´Ù Ø§Ù„Ø³Ø±ÙŠØ¹', 'Ø§Ù„Ø§Ø­ØªÙˆØ§Ø¡', 'Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ ÙˆØ§Ù„ØªØ¹Ù„Ù…'],
    createdAt: '2023-06-01',
    createdBy: 6,
    lastModifiedAt: '2024-03-01',
    lastModifiedBy: 6,
  },
  {
    id: 18,
    code: 'PRC-004',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª',
    titleEn: 'Change Management Procedure',
    type: 'Procedure',
    category: 'IT',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.5',
    effectiveDate: '2024-01-15',
    nextReviewDate: '2025-01-15',
    status: 'Active',
    impactLevel: 'High',
    linkedFrameworks: [7],
    linkedObligations: [11],
    linkedControls: [4],
    linkedRisks: [4],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬',
    objectives: ['Ø¶Ù…Ø§Ù† Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø¢Ù…Ù†', 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„'],
    createdAt: '2023-01-01',
    createdBy: 6,
    lastModifiedAt: '2024-01-15',
    lastModifiedBy: 6,
  },
  {
    id: 19,
    code: 'PRC-005',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø·Ù„Ø¨ Ø­Ù‚ÙˆÙ‚ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    titleEn: 'Data Subject Rights Request Procedure',
    type: 'Procedure',
    category: 'Data',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-04-01',
    nextReviewDate: '2025-04-01',
    status: 'UnderReview',
    impactLevel: 'High',
    linkedFrameworks: [9],
    linkedObligations: [13, 14, 15],
    linkedControls: [6, 7],
    linkedRisks: [5],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø·Ù„Ø¨Ø§Øª Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø·Ù„Ø¨Ø§Øª Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    objectives: ['Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø®Ù„Ø§Ù„ 30 ÙŠÙˆÙ…', 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù€ PDPL'],
    createdAt: '2024-03-01',
    createdBy: 6,
    lastModifiedAt: '2024-03-15',
    lastModifiedBy: 6,
  },
  {
    id: 20,
    code: 'PRC-006',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø±Ø§Ø¬Ø¹Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„',
    titleEn: 'Access Rights Review Procedure',
    type: 'Procedure',
    category: 'IT',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-05-01',
    nextReviewDate: '2025-05-01',
    status: 'Draft',
    impactLevel: 'High',
    linkedFrameworks: [7],
    linkedObligations: [11],
    linkedControls: [4],
    linkedRisks: [4],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†',
    objectives: ['Ù…Ø±Ø§Ø¬Ø¹Ø© Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠØ©', 'Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©'],
    createdAt: '2024-04-15',
    createdBy: 6,
    lastModifiedAt: '2024-04-20',
    lastModifiedBy: 6,
  },
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø³Ø¬Ù„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù‚ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ (Additional Draft/UnderReview) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {
    id: 21,
    code: 'POL-009',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù† Ø¨ÙØ¹Ø¯',
    titleEn: 'Remote Work Policy',
    type: 'Policy',
    category: 'HR',
    ownerId: 5,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-07-01',
    nextReviewDate: '2025-07-01',
    status: 'Draft',
    impactLevel: 'Medium',
    linkedFrameworks: [7],
    linkedObligations: [],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù† Ø¨ÙØ¹Ø¯ ÙˆØ¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ø¹Ù† Ø¨ÙØ¹Ø¯',
    objectives: ['ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù† Ø¨ÙØ¹Ø¯', 'Ø¶Ù…Ø§Ù† Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª'],
    createdAt: '2024-06-01',
    createdBy: 5,
    lastModifiedAt: '2024-06-10',
    lastModifiedBy: 5,
  },
  {
    id: 22,
    code: 'POL-010',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„',
    titleEn: 'Acceptable Use Policy',
    type: 'Policy',
    category: 'IT',
    ownerId: 6,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-06-01',
    nextReviewDate: '2025-06-01',
    status: 'UnderReview',
    impactLevel: 'Medium',
    linkedFrameworks: [7],
    linkedObligations: [],
    linkedControls: [4],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„ Ù„Ù…ÙˆØ§Ø±Ø¯ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
    scope: 'Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªØ®Ø¯Ù…ÙŠ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø¤Ø³Ø³Ø©',
    objectives: ['ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„', 'Ø­Ù…Ø§ÙŠØ© Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©'],
    createdAt: '2024-05-01',
    createdBy: 6,
    lastModifiedAt: '2024-05-15',
    lastModifiedBy: 6,
  },
  {
    id: 23,
    code: 'POL-011',
    title: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©',
    titleEn: 'Third Party Management Policy',
    type: 'Policy',
    category: 'Compliance',
    ownerId: 1,
    reviewerId: 3,
    approverId: 3,
    currentVersion: '1.0',
    effectiveDate: '2024-07-01',
    nextReviewDate: '2025-07-01',
    status: 'Draft',
    impactLevel: 'High',
    linkedFrameworks: [1, 7],
    linkedObligations: [],
    linkedControls: [],
    linkedRisks: [],
    standardRequirements: [],
    attestationCampaigns: [],
    summary: 'Ø³ÙŠØ§Ø³Ø© Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø© ÙˆØ§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†',
    scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ù…Ø¹ Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©',
    objectives: ['ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†', 'Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ÙŠ'],
    createdAt: '2024-06-15',
    createdBy: 1,
    lastModifiedAt: '2024-06-20',
    lastModifiedBy: 1,
  },
];

// 15) Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª (Policy Versions)
const POLICY_VERSIONS = [
  { id: 1, policyId: 1, version: '1.0', status: 'Superseded', effectiveDate: '2023-01-01', retiredDate: '2024-01-01', changeReason: 'Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆÙ„', changedBy: 7 },
  { id: 2, policyId: 1, version: '2.0', status: 'Active', effectiveDate: '2024-01-01', retiredDate: null, changeReason: 'ØªØ­Ø¯ÙŠØ« Ù…ØªØ·Ù„Ø¨Ø§Øª SAMA Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©', changedBy: 7 },
  { id: 3, policyId: 2, version: '1.0', status: 'Superseded', effectiveDate: '2022-06-01', retiredDate: '2023-06-01', changeReason: 'Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆÙ„', changedBy: 1 },
  { id: 4, policyId: 2, version: '2.0', status: 'Superseded', effectiveDate: '2023-06-01', retiredDate: '2024-01-01', changeReason: 'ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø©', changedBy: 1 },
  { id: 5, policyId: 2, version: '3.0', status: 'Superseded', effectiveDate: '2024-01-01', retiredDate: '2024-03-01', changeReason: 'Ø¥Ø¶Ø§ÙØ© Ù…ØªØ·Ù„Ø¨Ø§Øª PEP', changedBy: 1 },
  { id: 6, policyId: 2, version: '3.1', status: 'Active', effectiveDate: '2024-03-01', retiredDate: null, changeReason: 'ØªØµØ­ÙŠØ­Ø§Øª Ø·ÙÙŠÙØ©', changedBy: 1 },
  { id: 7, policyId: 3, version: '1.0', status: 'Superseded', effectiveDate: '2023-06-01', retiredDate: '2024-02-15', changeReason: 'Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£ÙˆÙ„', changedBy: 6 },
  { id: 8, policyId: 3, version: '1.5', status: 'Active', effectiveDate: '2024-02-15', retiredDate: null, changeReason: 'ØªØ­Ø¯ÙŠØ« Ø¶ÙˆØ§Ø¨Ø· NCA ECC 2.0', changedBy: 6 },
];

// 16) Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± (Standard Requirements)
const STANDARD_REQUIREMENTS = [
  // POL-001 Requirements
  { id: 1, policyId: 1, refCode: 'POL001-REQ-01', statement: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù…ØªØ«Ø§Ù„ Ù…Ø¹ØªÙ…Ø¯ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [6], linkedControls: [] },
  { id: 2, policyId: 1, refCode: 'POL001-REQ-02', statement: 'ÙŠØ¬Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø·Ø© Ø§Ù…ØªØ«Ø§Ù„ Ø³Ù†ÙˆÙŠØ© Ù…Ø¹ØªÙ…Ø¯Ø© Ù…Ù† Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [7], linkedControls: [] },
  { id: 3, policyId: 1, refCode: 'POL001-REQ-03', statement: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [8], linkedControls: [] },
  { id: 4, policyId: 1, refCode: 'POL001-REQ-04', statement: 'ÙŠÙ†Ø¨ØºÙŠ ØªÙˆÙÙŠØ± Ø¨Ø±Ø§Ù…Ø¬ ØªÙˆØ¹ÙŠØ© Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†', mandatoryLevel: 'ShouldComply', evidenceRequired: true, testingFrequency: 'Quarterly', linkedObligations: [], linkedControls: [] },

  // POL-002 Requirements
  { id: 5, policyId: 2, refCode: 'POL002-REQ-01', statement: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ CDD', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Daily', linkedObligations: [1, 2], linkedControls: [1] },
  { id: 6, policyId: 2, refCode: 'POL002-REQ-02', statement: 'ÙŠØ¬Ø¨ ÙØ­Øµ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¶Ø¯ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'RealTime', linkedObligations: [1], linkedControls: [1] },
  { id: 7, policyId: 2, refCode: 'POL002-REQ-03', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'EventDriven', linkedObligations: [3], linkedControls: [2] },
  { id: 8, policyId: 2, refCode: 'POL002-REQ-04', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù…Ø¯Ø© 10 Ø³Ù†ÙˆØ§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [4], linkedControls: [] },
  { id: 9, policyId: 2, refCode: 'POL002-REQ-05', statement: 'ÙŠØ¬Ø¨ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [5], linkedControls: [3] },

  // POL-003 Requirements
  { id: 10, policyId: 3, refCode: 'POL003-REQ-01', statement: 'ÙŠØ¬Ø¨ ÙˆØ¶Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ù…Ø¹ØªÙ…Ø¯Ø©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [9], linkedControls: [] },
  { id: 11, policyId: 3, refCode: 'POL003-REQ-02', statement: 'ÙŠØ¬Ø¨ ØªØµÙ†ÙŠÙ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [10], linkedControls: [] },
  { id: 12, policyId: 3, refCode: 'POL003-REQ-03', statement: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Monthly', linkedObligations: [11], linkedControls: [4] },
  { id: 13, policyId: 3, refCode: 'POL003-REQ-04', statement: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø³Ù†ÙˆÙŠØ§Ù‹', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [12], linkedControls: [5] },

  // POL-004 Requirements
  { id: 14, policyId: 4, refCode: 'POL004-REQ-01', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØµØ±ÙŠØ­Ø© Ù‚Ø¨Ù„ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'RealTime', linkedObligations: [13], linkedControls: [6] },
  { id: 15, policyId: 4, refCode: 'POL004-REQ-02', statement: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª DPO', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [14], linkedControls: [] },
  { id: 16, policyId: 4, refCode: 'POL004-REQ-03', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'EventDriven', linkedObligations: [15], linkedControls: [7] },

  // STD-001 Requirements
  { id: 17, policyId: 5, refCode: 'STD001-REQ-01', statement: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Monthly', linkedObligations: [11], linkedControls: [4] },
  { id: 18, policyId: 5, refCode: 'STD001-REQ-02', statement: 'ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¯ÙˆØ±ÙŠØ§Ù‹', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Quarterly', linkedObligations: [11], linkedControls: [4] },
  { id: 19, policyId: 5, refCode: 'STD001-REQ-03', statement: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ø¹ÙˆØ§Ù…Ù„ MFA', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [11], linkedControls: [4] },

  // PRC-001 Requirements
  { id: 20, policyId: 6, refCode: 'PRC001-REQ-01', statement: 'ÙŠØ¬Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø© Ø®Ù„Ø§Ù„ 4 Ø³Ø§Ø¹Ø§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'EventDriven', linkedObligations: [3], linkedControls: [2] },
  { id: 21, policyId: 6, refCode: 'PRC001-REQ-02', statement: 'ÙŠØ¬Ø¨ ØªÙˆØ«ÙŠÙ‚ Ù‚Ø±Ø§Ø± Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø£Ùˆ Ø¹Ø¯Ù…Ù‡ Ù…Ø¹ Ø§Ù„Ù…Ø¨Ø±Ø±Ø§Øª', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'EventDriven', linkedObligations: [3], linkedControls: [2] },

  // POL-005 Requirements
  { id: 22, policyId: 7, refCode: 'POL005-REQ-01', statement: 'ÙŠØ¬Ø¨ ØªØ´ÙƒÙŠÙ„ Ù„Ø¬Ø§Ù† Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù†Ø¸Ø§Ù…Ø§Ù‹', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Annual', linkedObligations: [18], linkedControls: [] },
  { id: 23, policyId: 7, refCode: 'POL005-REQ-02', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠØ©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'EventDriven', linkedObligations: [19], linkedControls: [] },

  // POL-006 Requirements
  { id: 24, policyId: 8, refCode: 'POL006-REQ-01', statement: 'ÙŠØ¬Ø¨ ØµØ±Ù Ø§Ù„Ø£Ø¬ÙˆØ± Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Monthly', linkedObligations: [20], linkedControls: [8] },
  { id: 25, policyId: 8, refCode: 'POL006-REQ-02', statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©', mandatoryLevel: 'Mandatory', evidenceRequired: true, testingFrequency: 'Monthly', linkedObligations: [21], linkedControls: [] },
];

// 17) Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± (Attestation Campaigns)
const ATTESTATION_CAMPAIGNS = [
  {
    id: 1,
    policyId: 1,
    title: 'Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø³Ù†ÙˆÙŠØ© - Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ 2024',
    dueDate: '2024-02-28',
    reminderDays: [14, 7, 3, 1],
    escalationDays: 3,
    targetAudience: { type: 'All', departments: [], roles: [] },
    status: 'Active',
    totalRecipients: 150,
    acknowledged: 142,
    pending: 5,
    overdue: 3,
    exempted: 0,
    createdAt: '2024-01-15',
    createdBy: 7,
  },
  {
    id: 2,
    policyId: 2,
    title: 'Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± - Ø³ÙŠØ§Ø³Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ 2024',
    dueDate: '2024-04-15',
    reminderDays: [14, 7, 3, 1],
    escalationDays: 2,
    targetAudience: { type: 'Departments', departments: ['Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', 'Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡'], roles: [] },
    status: 'Completed',
    totalRecipients: 80,
    acknowledged: 80,
    pending: 0,
    overdue: 0,
    exempted: 0,
    createdAt: '2024-03-01',
    createdBy: 1,
  },
  {
    id: 3,
    policyId: 3,
    title: 'Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± - Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ 2024',
    dueDate: '2024-03-31',
    reminderDays: [14, 7, 3, 1],
    escalationDays: 3,
    targetAudience: { type: 'All', departments: [], roles: [] },
    status: 'Active',
    totalRecipients: 150,
    acknowledged: 115,
    pending: 20,
    overdue: 15,
    exempted: 0,
    createdAt: '2024-02-15',
    createdBy: 6,
  },
  {
    id: 4,
    policyId: 4,
    title: 'Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± - Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 2024',
    dueDate: '2024-10-31',
    reminderDays: [30, 14, 7, 3],
    escalationDays: 5,
    targetAudience: { type: 'All', departments: [], roles: [] },
    status: 'Active',
    totalRecipients: 150,
    acknowledged: 144,
    pending: 4,
    overdue: 2,
    exempted: 0,
    createdAt: '2023-09-20',
    createdBy: 6,
  },
  {
    id: 5,
    policyId: 7,
    title: 'Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± - Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø­ÙˆÙƒÙ…Ø© 2024',
    dueDate: '2024-06-30',
    reminderDays: [14, 7, 3],
    escalationDays: 3,
    targetAudience: { type: 'Roles', departments: [], roles: ['Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠÙˆÙ†', 'Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª'] },
    status: 'Active',
    totalRecipients: 25,
    acknowledged: 22,
    pending: 2,
    overdue: 1,
    exempted: 0,
    createdAt: '2024-05-01',
    createdBy: 7,
  },
];

// 18) Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„ÙØ±Ø¯ÙŠØ© (Attestation Records)
const ATTESTATION_RECORDS = [
  { id: 1, campaignId: 1, userId: 1, status: 'Acknowledged', acknowledgedAt: '2024-01-20', ipAddress: '192.168.1.100' },
  { id: 2, campaignId: 1, userId: 2, status: 'Acknowledged', acknowledgedAt: '2024-01-21', ipAddress: '192.168.1.101' },
  { id: 3, campaignId: 1, userId: 3, status: 'Overdue', acknowledgedAt: null, ipAddress: null },
  { id: 4, campaignId: 3, userId: 1, status: 'Acknowledged', acknowledgedAt: '2024-03-01', ipAddress: '192.168.1.100' },
  { id: 5, campaignId: 3, userId: 6, status: 'Pending', acknowledgedAt: null, ipAddress: null },
];

// 13) Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© (Controls)
const CONTROLS = [
  {
    id: 1,
    code: 'CTRL-001',
    title: 'Ù†Ø¸Ø§Ù… ÙØ­Øµ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¢Ù„ÙŠ',
    titleEn: 'Automated Customer Screening System',
    type: 'Preventive',
    category: 'IT',
    ownerId: 6,
    frequency: 'RealTime',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-11-15',
    linkedObligations: [1, 2],
    linkedRisks: [1, 2],
  },
  {
    id: 2,
    code: 'CTRL-002',
    title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª',
    titleEn: 'Daily Transaction Review',
    type: 'Detective',
    category: 'Compliance',
    ownerId: 1,
    frequency: 'Daily',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-12-01',
    linkedObligations: [3],
    linkedRisks: [1],
  },
  {
    id: 3,
    code: 'CTRL-003',
    title: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
    titleEn: 'Annual AML Training Program',
    type: 'Preventive',
    category: 'HR',
    ownerId: 1,
    frequency: 'Annual',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-09-01',
    linkedObligations: [5],
    linkedRisks: [1],
  },
  {
    id: 4,
    code: 'CTRL-004',
    title: 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„',
    titleEn: 'Identity & Access Management System',
    type: 'Preventive',
    category: 'IT',
    ownerId: 6,
    frequency: 'RealTime',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-10-15',
    linkedObligations: [11],
    linkedRisks: [3, 4],
  },
  {
    id: 5,
    code: 'CTRL-005',
    title: 'Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø¯ÙˆØ±ÙŠØ©',
    titleEn: 'Periodic Penetration Testing',
    type: 'Detective',
    category: 'Cybersecurity',
    ownerId: 6,
    frequency: 'Annual',
    status: 'Active',
    effectiveness: 'Partially Effective',
    lastTestDate: '2024-08-01',
    linkedObligations: [12],
    linkedRisks: [3],
  },
  {
    id: 6,
    code: 'CTRL-006',
    title: 'Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    titleEn: 'Data Consent Management System',
    type: 'Preventive',
    category: 'IT',
    ownerId: 6,
    frequency: 'RealTime',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-11-01',
    linkedObligations: [13],
    linkedRisks: [5],
  },
  {
    id: 7,
    code: 'CTRL-007',
    title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    titleEn: 'Data Breach Response Procedure',
    type: 'Corrective',
    category: 'Compliance',
    ownerId: 6,
    frequency: 'EventDriven',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-10-01',
    linkedObligations: [15],
    linkedRisks: [5],
  },
  {
    id: 8,
    code: 'CTRL-008',
    title: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ± WPS',
    titleEn: 'Wage Protection System',
    type: 'Preventive',
    category: 'HR',
    ownerId: 5,
    frequency: 'Monthly',
    status: 'Active',
    effectiveness: 'Effective',
    lastTestDate: '2024-12-01',
    linkedObligations: [20],
    linkedRisks: [6],
  },
];

// 14) Ø§Ù„Ù…Ø®Ø§Ø·Ø± (Risks)
const RISKS = [
  {
    id: 1,
    code: 'RSK-001',
    title: 'Ù…Ø®Ø§Ø·Ø± ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨',
    titleEn: 'Money Laundering & Terrorism Financing Risk',
    category: 'Compliance',
    inherentRating: 'High',
    residualRating: 'Medium',
    ownerId: 1,
    status: 'Active',
    linkedObligations: [1, 2, 3, 4, 5],
    linkedControls: [1, 2, 3],
    impact: 'High',
    likelihood: 'Medium',
  },
  {
    id: 2,
    code: 'RSK-002',
    title: 'Ù…Ø®Ø§Ø·Ø± Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø©',
    titleEn: 'CDD Non-Compliance Risk',
    category: 'Compliance',
    inherentRating: 'High',
    residualRating: 'Low',
    ownerId: 1,
    status: 'Active',
    linkedObligations: [1, 2],
    linkedControls: [1],
    impact: 'High',
    likelihood: 'Low',
  },
  {
    id: 3,
    code: 'RSK-003',
    title: 'Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
    titleEn: 'Cybersecurity Risk',
    category: 'Cybersecurity',
    inherentRating: 'Critical',
    residualRating: 'Medium',
    ownerId: 6,
    status: 'Active',
    linkedObligations: [9, 10, 11, 12],
    linkedControls: [4, 5],
    impact: 'Critical',
    likelihood: 'Medium',
  },
  {
    id: 4,
    code: 'RSK-004',
    title: 'Ù…Ø®Ø§Ø·Ø± Ø§Ù„ÙˆØµÙˆÙ„ ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡',
    titleEn: 'Unauthorized Access Risk',
    category: 'IT',
    inherentRating: 'High',
    residualRating: 'Low',
    ownerId: 6,
    status: 'Active',
    linkedObligations: [11],
    linkedControls: [4],
    impact: 'High',
    likelihood: 'Low',
  },
  {
    id: 5,
    code: 'RSK-005',
    title: 'Ù…Ø®Ø§Ø·Ø± Ø§Ù†ØªÙ‡Ø§Ùƒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
    titleEn: 'Personal Data Breach Risk',
    category: 'Data',
    inherentRating: 'High',
    residualRating: 'Medium',
    ownerId: 6,
    status: 'Active',
    linkedObligations: [13, 14, 15],
    linkedControls: [6, 7],
    impact: 'High',
    likelihood: 'Medium',
  },
  {
    id: 6,
    code: 'RSK-006',
    title: 'Ù…Ø®Ø§Ø·Ø± Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±',
    titleEn: 'WPS Non-Compliance Risk',
    category: 'HR',
    inherentRating: 'Medium',
    residualRating: 'Low',
    ownerId: 5,
    status: 'Active',
    linkedObligations: [20],
    linkedControls: [8],
    impact: 'Medium',
    likelihood: 'Low',
  },
];

// 15) Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· (Control Types)
const CONTROL_TYPES = [
  { code: 'Preventive', nameAr: 'ÙˆÙ‚Ø§Ø¦ÙŠ', nameEn: 'Preventive', color: 'emerald' },
  { code: 'Detective', nameAr: 'ÙƒØ§Ø´Ù', nameEn: 'Detective', color: 'blue' },
  { code: 'Corrective', nameAr: 'ØªØµØ­ÙŠØ­ÙŠ', nameEn: 'Corrective', color: 'amber' },
];

// 16) Ù…ØµÙÙˆÙØ© Ø§Ù„Ø±Ø¨Ø· (Mapping Records) - Golden Thread
const MAPPINGS = [
  // Obligation 1 â†’ Controls & Risks
  { id: 1, obligationId: 1, controlId: 1, riskId: 1, policyId: 2, coverageLevel: 'Full', status: 'Active' },
  { id: 2, obligationId: 2, controlId: 1, riskId: 2, policyId: 2, coverageLevel: 'Full', status: 'Active' },
  { id: 3, obligationId: 3, controlId: 2, riskId: 1, policyId: 2, coverageLevel: 'Full', status: 'Active' },
  { id: 4, obligationId: 5, controlId: 3, riskId: 1, policyId: 2, coverageLevel: 'Full', status: 'Active' },
  // Cybersecurity mappings
  { id: 5, obligationId: 11, controlId: 4, riskId: 4, policyId: 3, coverageLevel: 'Full', status: 'Active' },
  { id: 6, obligationId: 12, controlId: 5, riskId: 3, policyId: 3, coverageLevel: 'Partial', status: 'Active', justification: 'ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø²ÙŠØ§Ø¯Ø© ØªÙƒØ±Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª' },
  // Data Protection mappings
  { id: 7, obligationId: 13, controlId: 6, riskId: 5, policyId: 4, coverageLevel: 'Full', status: 'Active' },
  { id: 8, obligationId: 15, controlId: 7, riskId: 5, policyId: 4, coverageLevel: 'Full', status: 'Active' },
  // HR mappings
  { id: 9, obligationId: 20, controlId: 8, riskId: 6, policyId: 8, coverageLevel: 'Full', status: 'Active' },
];

const INITIAL_OBLIGATIONS = [
  {
    id: 1,
    code: 'OBL-001',
    authorityId: 1,
    frameworkId: 1,
    requirementIds: [1, 2],
    title: 'ØªÙ†ÙÙŠØ° Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ (CDD)',
    statement: 'ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¤Ø³Ø³Ø© ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø¯ ÙˆØ§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†ØŒ Ø¨Ù…Ø§ ÙŠØ´Ù…Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆÙÙ‡Ù… Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ù†Ø´Ø§Ø· ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±.',
    category: 'Compliance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'ComplianceDirector',
    frequency: 'EventDriven',
    dueRule: null,
    triggerDescription: 'Ø¹Ù†Ø¯ ÙØªØ­ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù…ÙŠÙ„',
    evidenceRequired: true,
    evidenceTypes: ['Procedure', 'Log', 'Approval'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ÙˆØ¬ÙˆØ¯ Ù†Ù…ÙˆØ°Ø¬ KYC Ù…ÙƒØªÙ…Ù„ ÙˆÙ…ÙˆÙ‚Ø¹ØŒ Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©ØŒ Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ø§Ù„ÙŠÙŠ Ø§Ù„Ù…Ø®Ø§Ø·Ø±',
    retentionValue: 10,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'License', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  {
    id: 2,
    code: 'OBL-002',
    authorityId: 1,
    frameworkId: 1,
    requirementIds: [3],
    title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
    statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù† Ø£ÙŠ Ø¹Ù…Ù„ÙŠØ© Ù…Ø´Ø¨ÙˆÙ‡Ø© Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­Ø±ÙŠØ§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø© Ù…Ù† Ø§ÙƒØªØ´Ø§ÙÙ‡Ø§ØŒ Ù…Ø¹ ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„ Ù„Ù„Ù…Ø¨Ø±Ø±Ø§Øª ÙˆØ§Ù„Ø£Ø¯Ù„Ø©.',
    category: 'Compliance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CEO',
    frequency: 'EventDriven',
    dueRule: null,
    triggerDescription: 'Ø¹Ù†Ø¯ Ø§ÙƒØªØ´Ø§Ù Ø¹Ù…Ù„ÙŠØ© Ù…Ø´Ø¨ÙˆÙ‡Ø©',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Log', 'Approval'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ù†Ù…ÙˆØ°Ø¬ STR Ù…ÙƒØªÙ…Ù„ØŒ Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­Ø±ÙŠØ§ØªØŒ Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ',
    retentionValue: 10,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'License', 'Legal'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  {
    id: 3,
    code: 'OBL-003',
    authorityId: 1,
    frameworkId: 2,
    requirementIds: [6],
    title: 'ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù…ØªØ«Ø§Ù„ Ù…Ø³ØªÙ‚Ù„',
    statement: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù…ØªØ«Ø§Ù„ Ù…Ø¤Ù‡Ù„ ÙˆÙ…Ø³ØªÙ‚Ù„ ÙŠØ±ÙØ¹ ØªÙ‚Ø§Ø±ÙŠØ±Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ùˆ Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ Ù…Ø¹ Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ‚Ù„Ø§Ù„ÙŠØ© Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª.',
    category: 'Governance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 7,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'Board',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù†ÙˆÙŠØ© ÙÙŠ Q1',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Approval', 'Contract', 'Certificate'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ù‚Ø±Ø§Ø± ØªØ¹ÙŠÙŠÙ† Ù…Ø¹ØªÙ…Ø¯ØŒ Ø¹Ù‚Ø¯ Ø¹Ù…Ù„ØŒ Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ù‡Ù†ÙŠØ©ØŒ Ù‡ÙŠÙƒÙ„ ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙŠÙˆØ¶Ø­ Ø®Ø· Ø§Ù„Ø±ÙØ¹',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Reporting'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Partial',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  {
    id: 4,
    code: 'OBL-004',
    authorityId: 1,
    frameworkId: 2,
    requirementIds: [7],
    title: 'Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø³Ù†ÙˆÙŠ',
    statement: 'ÙŠØ¬Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„ Ø¹Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ±ÙØ¹Ù‡ Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø®Ù„Ø§Ù„ Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† ÙƒÙ„ Ø³Ù†Ø© Ù…Ø§Ù„ÙŠØ©ØŒ ÙŠØªØ¶Ù…Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙˆØ®Ø·Ø· Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©.',
    category: 'Governance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 1,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'ComplianceDirector',
    frequency: 'Annual',
    dueRule: 'Ø¢Ø®Ø± ÙŠÙˆÙ… Ø¹Ù…Ù„ Ù…Ù† Ù…Ø§Ø±Ø³',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Minutes', 'Approval'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù…ØªØ«Ø§Ù„ Ù…ÙƒØªÙ…Ù„ØŒ Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©ØŒ ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯',
    retentionValue: 7,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Reporting', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  {
    id: 5,
    code: 'OBL-005',
    authorityId: 3,
    frameworkId: 7,
    requirementIds: [9],
    title: 'Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
    statement: 'ÙŠØ¬Ø¨ ÙˆØ¶Ø¹ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙˆØ§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§ØŒ ØªØªØ¶Ù…Ù† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.',
    category: 'Cybersecurity',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 6,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CISO',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù†ÙˆÙŠØ© ÙÙŠ Q4',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Policy', 'Approval', 'Minutes'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù…Ø¹ØªÙ…Ø¯Ø©ØŒ Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§ØŒ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ°',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2023-12-20',
    updatedBy: 2,
    updatedAt: '2024-01-15',
  },
  {
    id: 6,
    code: 'OBL-006',
    authorityId: 3,
    frameworkId: 7,
    requirementIds: [12],
    title: 'ØªÙ†ÙÙŠØ° Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø¯ÙˆØ±ÙŠØ©',
    statement: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ø®ØªØ±Ø§Ù‚ Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø³Ù†ÙˆÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ØŒ Ù…Ù† Ù‚Ø¨Ù„ Ø¬Ù‡Ø© Ù…Ø³ØªÙ‚Ù„Ø© ÙˆÙ…Ø¹ØªÙ…Ø¯Ø©.',
    category: 'Cybersecurity',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'System',
    scopeValues: ['Core Banking', 'Internet Banking', 'Mobile App'],
    ownerId: 6,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CISO',
    frequency: 'Annual',
    dueRule: 'Ø®Ù„Ø§Ù„ Q2 Ù…Ù† ÙƒÙ„ Ø³Ù†Ø©',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Certificate', 'Log'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ØªÙ‚Ø±ÙŠØ± Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ØŒ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ù†ÙØ°Ø©ØŒ Ø®Ø·Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Partial',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2023-12-20',
    updatedBy: 2,
    updatedAt: '2024-01-15',
  },
  {
    id: 7,
    code: 'OBL-007',
    authorityId: 4,
    frameworkId: 9,
    requirementIds: [13],
    title: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØµØ±ÙŠØ­Ø© ÙˆÙ…Ø­Ø¯Ø¯Ø© Ù…Ù† Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ù‚Ø¨Ù„ Ø¬Ù…Ø¹ Ø£Ùˆ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙ‡Ù…ØŒ Ù…Ø¹ ØªÙˆØ¶ÙŠØ­ Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©.',
    category: 'Data',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 6,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'DPO',
    frequency: 'EventDriven',
    dueRule: null,
    triggerDescription: 'Ø¹Ù†Ø¯ Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©',
    evidenceRequired: true,
    evidenceTypes: ['Approval', 'Log', 'Screenshot'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ù…ÙˆÙ‚Ø¹ØŒ Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Legal', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'NotMapped',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2023-12-25',
    updatedBy: 2,
    updatedAt: '2024-01-20',
  },
  {
    id: 8,
    code: 'OBL-008',
    authorityId: 4,
    frameworkId: 9,
    requirementIds: [15],
    title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø£ÙŠ Ø§Ù†ØªÙ‡Ø§Ùƒ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®ØªØµØ© Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø© Ù…Ù† Ø§ÙƒØªØ´Ø§ÙÙ‡ØŒ Ù…Ø¹ Ø¥Ø®Ø·Ø§Ø± Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ£Ø«Ø±ÙŠÙ†.',
    category: 'Data',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 6,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'DPO',
    frequency: 'EventDriven',
    dueRule: null,
    triggerDescription: 'Ø¹Ù†Ø¯ Ø§ÙƒØªØ´Ø§Ù Ø§Ù†ØªÙ‡Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Log', 'Approval'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù†ØªÙ‡Ø§ÙƒØŒ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ù„Ù„Ø¬Ù‡Ø©ØŒ Ø³Ø¬Ù„ Ø¥Ø®Ø·Ø§Ø± Ø§Ù„Ù…ØªØ£Ø«Ø±ÙŠÙ†',
    retentionValue: 7,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Legal', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'NotMapped',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2023-12-25',
    updatedBy: 2,
    updatedAt: '2024-01-20',
  },
  {
    id: 9,
    code: 'OBL-009',
    authorityId: 5,
    frameworkId: 10,
    requirementIds: [16],
    title: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ø§Ù„Ø¯ÙˆØ±ÙŠ',
    statement: 'ÙŠØ¬Ø¨ ØªÙ‚Ø¯ÙŠÙ… Ø¥Ù‚Ø±Ø§Ø± Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© (Ø´Ù‡Ø±ÙŠ/Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ) Ø­Ø³Ø¨ ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†Ø´Ø£Ø©.',
    category: 'Tax',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CFO',
    frequency: 'Monthly',
    dueRule: 'Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Screenshot', 'Approval'],
    evidenceValidityDays: 30,
    acceptanceCriteria: 'Ø¥Ù‚Ø±Ø§Ø± Ù…Ù‚Ø¯Ù… Ø¹Ø¨Ø± Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©ØŒ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯ØŒ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©',
    retentionValue: 7,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Legal'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-10',
    updatedBy: 2,
    updatedAt: '2024-01-05',
  },
  {
    id: 10,
    code: 'OBL-010',
    authorityId: 5,
    frameworkId: 11,
    requirementIds: [17],
    title: 'Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
    statement: 'ÙŠØ¬Ø¨ Ø¥ØµØ¯Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø¨ØµÙŠØºØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ù…ÙˆØ§ØµÙØ§Øª Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ (ÙØ§ØªÙˆØ±Ø©).',
    category: 'Tax',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CFO',
    frequency: 'EventDriven',
    dueRule: null,
    triggerDescription: 'Ø¹Ù†Ø¯ Ø¥ØµØ¯Ø§Ø± Ø£ÙŠ ÙØ§ØªÙˆØ±Ø©',
    evidenceRequired: true,
    evidenceTypes: ['Config', 'Log', 'Certificate'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ ÙØ§ØªÙˆØ±Ø©ØŒ Ø¹ÙŠÙ†Ø© ÙÙˆØ§ØªÙŠØ± ØµØ§Ø¯Ø±Ø©ØŒ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©',
    retentionValue: 7,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-10',
    updatedBy: 2,
    updatedAt: '2024-01-05',
  },
  {
    id: 11,
    code: 'OBL-011',
    authorityId: 7,
    frameworkId: 13,
    requirementIds: [20],
    title: 'ØµØ±Ù Ø§Ù„Ø£Ø¬ÙˆØ± Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… WPS',
    statement: 'ÙŠØ¬Ø¨ ØµØ±Ù Ø¬Ù…ÙŠØ¹ Ø£Ø¬ÙˆØ± Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠÙŠÙ† ÙˆØ§Ù„Ù…Ù‚ÙŠÙ…ÙŠÙ† Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯.',
    category: 'HR',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'HRDirector',
    frequency: 'Monthly',
    dueRule: 'Ø®Ù„Ø§Ù„ Ø£ÙˆÙ„ 5 Ø£ÙŠØ§Ù… Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Log', 'Screenshot'],
    evidenceValidityDays: 30,
    acceptanceCriteria: 'Ù…Ù„Ù WPS Ø§Ù„Ù…Ø±ÙÙˆØ¹ØŒ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ø¨Ù†ÙƒØŒ ÙƒØ´Ù Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-10',
    updatedBy: 2,
    updatedAt: '2024-01-05',
  },
  {
    id: 12,
    code: 'OBL-012',
    authorityId: 7,
    frameworkId: 14,
    requirementIds: [21],
    title: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ† (Ù†Ø·Ø§Ù‚Ø§Øª)',
    statement: 'ÙŠØ¬Ø¨ ØªØ­Ù‚ÙŠÙ‚ ÙˆØ§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù…Ù†Ø´Ø£Ø© ÙˆØ§Ù„Ù‚Ø·Ø§Ø¹ Ù„Ù„Ø¨Ù‚Ø§Ø¡ ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø£Ø®Ø¶Ø± Ø£Ùˆ Ø£Ø¹Ù„Ù‰.',
    category: 'HR',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'HRDirector',
    frequency: 'Quarterly',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‡Ø§ÙŠØ© ÙƒÙ„ Ø±Ø¨Ø¹',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Screenshot'],
    evidenceValidityDays: 90,
    acceptanceCriteria: 'Ø´Ù‡Ø§Ø¯Ø© Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ù† Ù‚ÙˆÙ‰ØŒ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙˆØ·ÙŠÙ† Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØŒ Ø®Ø·Ø© Ø§Ù„ØªÙˆØ·ÙŠÙ†',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational', 'License'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Partial',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-10',
    updatedBy: 2,
    updatedAt: '2024-01-05',
  },
  {
    id: 13,
    code: 'OBL-013',
    authorityId: 2,
    frameworkId: 5,
    requirementIds: [18],
    title: 'ØªØ´ÙƒÙŠÙ„ Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
    statement: 'ÙŠØ¬Ø¨ ØªØ´ÙƒÙŠÙ„ Ù„Ø¬Ù†Ø© Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ø£Ø¹Ø¶Ø§Ø¡ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØºÙŠØ± Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠÙŠÙ†ØŒ Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ù…Ù‡Ø§Ù…Ù‡Ø§ ÙˆØµÙ„Ø§Ø­ÙŠØ§ØªÙ‡Ø§.',
    category: 'Governance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 7,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'Board',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„ Ø³Ù†ÙˆÙŠØ§Ù‹',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Approval', 'Minutes', 'Policy'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ù‚Ø±Ø§Ø± ØªØ´ÙƒÙŠÙ„ Ø§Ù„Ù„Ø¬Ù†Ø©ØŒ Ù…ÙŠØ«Ø§Ù‚ Ø§Ù„Ù„Ø¬Ù†Ø©ØŒ Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª',
    retentionValue: 10,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'License', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-05',
    updatedBy: 2,
    updatedAt: '2024-01-02',
  },
  {
    id: 14,
    code: 'OBL-014',
    authorityId: 1,
    frameworkId: 1,
    requirementIds: [5],
    title: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
    statement: 'ÙŠØ¬Ø¨ ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ÙŠ Ø³Ù†ÙˆÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø¹Ù†ÙŠÙŠÙ† Ø¹Ù„Ù‰ Ù…ØªØ·Ù„Ø¨Ø§Øª Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨.',
    category: 'HR',
    criticality: 'Medium',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'ComplianceDirector',
    frequency: 'Annual',
    dueRule: 'Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø©',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Certificate', 'Log'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ Ø´Ù‡Ø§Ø¯Ø§Øª Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ¯Ø±ÙŠØ¨ØŒ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØºØ·ÙŠØ©',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Reporting'],
    inherentRisk: 'Medium',
    controlLinkRequired: false,
    mappingStatus: 'NotMapped',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  {
    id: 15,
    code: 'OBL-015',
    authorityId: 1,
    frameworkId: 1,
    requirementIds: [4],
    title: 'Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø©',
    statement: 'ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ù…Ø¯Ø© Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 10 Ø³Ù†ÙˆØ§Øª Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©.',
    category: 'Compliance',
    criticality: 'Medium',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'ComplianceDirector',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù†ÙˆÙŠØ© Ù„Ù„Ø£Ø±Ø´ÙŠÙ',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Policy', 'Config', 'Report'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ø±Ø´ÙØ©ØŒ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø±Ø´ÙØ©ØŒ ØªÙ‚Ø±ÙŠØ± Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª',
    retentionValue: 10,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Legal'],
    inherentRisk: 'Medium',
    controlLinkRequired: false,
    mappingStatus: 'Partial',
    status: 'Active',
    effectiveFrom: '2024-01-01',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2023-12-15',
    updatedBy: 2,
    updatedAt: '2024-01-10',
  },
  // Draft obligations
  {
    id: 16,
    code: 'OBL-016',
    authorityId: 3,
    frameworkId: 7,
    requirementIds: [10],
    title: 'ØªØµÙ†ÙŠÙ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©',
    statement: 'ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ ÙˆØªØµÙ†ÙŠÙ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø­Ø³Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø£Ù‡Ù…ÙŠØ©.',
    category: 'IT',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 6,
    reviewerId: 2,
    approverId: null,
    escalationPath: '',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù†ÙˆÙŠØ©',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Config'],
    evidenceValidityDays: 365,
    acceptanceCriteria: '',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'NotMapped',
    status: 'Draft',
    effectiveFrom: null,
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2024-01-20',
    updatedBy: 4,
    updatedAt: '2024-01-20',
  },
  {
    id: 17,
    code: 'OBL-017',
    authorityId: 3,
    frameworkId: 7,
    requirementIds: [11],
    title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„',
    statement: 'ÙŠØ¬Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©.',
    category: 'IT',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'System',
    scopeValues: ['Core Systems'],
    ownerId: 6,
    reviewerId: null,
    approverId: null,
    escalationPath: '',
    frequency: 'Quarterly',
    dueRule: '',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Config', 'Log', 'Report'],
    evidenceValidityDays: 90,
    acceptanceCriteria: '',
    retentionValue: 3,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Operational'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'NotMapped',
    status: 'Draft',
    effectiveFrom: null,
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2024-01-22',
    updatedBy: 4,
    updatedAt: '2024-01-22',
  },
  // Under Review
  {
    id: 18,
    code: 'OBL-018',
    authorityId: 4,
    frameworkId: 9,
    requirementIds: [14],
    title: 'ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
    statement: 'ÙŠØ¬Ø¨ ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© (DPO) Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆÙ…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª ÙˆØ§Ø¶Ø­Ø©.',
    category: 'Governance',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 7,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CEO',
    frequency: 'Annual',
    dueRule: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ù†ÙˆÙŠØ©',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Approval', 'Contract'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ¹ÙŠÙŠÙ†ØŒ Ø§Ù„ÙˆØµÙ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØŒ Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ØªØ£Ù‡ÙŠÙ„',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Reporting'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'NotMapped',
    status: 'UnderReview',
    effectiveFrom: null,
    effectiveTo: null,
    createdBy: 4,
    createdAt: '2024-01-18',
    updatedBy: 4,
    updatedAt: '2024-01-25',
  },
  // Retired
  {
    id: 19,
    code: 'OBL-019',
    authorityId: 1,
    frameworkId: 2,
    requirementIds: [8],
    title: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ (Ù…Ù„ØºÙŠ)',
    statement: 'ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ø§Ù„ØªØ²Ø§Ù… Ø¬Ø¯ÙŠØ¯ Ø£Ø´Ù…Ù„.',
    category: 'Risk',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'ComplianceDirector',
    frequency: 'Annual',
    dueRule: 'Ø³Ù†ÙˆÙŠ',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report'],
    evidenceValidityDays: 365,
    acceptanceCriteria: '',
    retentionValue: 5,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Full',
    status: 'Retired',
    effectiveFrom: '2023-01-01',
    effectiveTo: '2024-01-15',
    retireReason: 'ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ø§Ù„ØªØ²Ø§Ù… OBL-020 Ø§Ù„Ø£Ø´Ù…Ù„',
    replacementId: 20,
    createdBy: 1,
    createdAt: '2022-12-01',
    updatedBy: 3,
    updatedAt: '2024-01-15',
  },
  {
    id: 20,
    code: 'OBL-020',
    authorityId: 1,
    frameworkId: 2,
    requirementIds: [8],
    title: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„',
    statement: 'ÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø´Ø§Ù…Ù„ Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹ ÙŠØºØ·ÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ÙŠØ©.',
    category: 'Risk',
    criticality: 'High',
    applicability: 'Applicable',
    applicabilityJustification: '',
    scopeLevel: 'Enterprise',
    scopeValues: ['All'],
    ownerId: 5,
    reviewerId: 2,
    approverId: 3,
    escalationPath: 'CRO',
    frequency: 'Annual',
    dueRule: 'Ø®Ù„Ø§Ù„ Q1',
    triggerDescription: '',
    evidenceRequired: true,
    evidenceTypes: ['Report', 'Minutes', 'Approval'],
    evidenceValidityDays: 365,
    acceptanceCriteria: 'ØªÙ‚Ø±ÙŠØ± ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ Ù…Ø­Ø¶Ø± Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©',
    retentionValue: 7,
    retentionUnit: 'Years',
    regulatoryImpacts: ['Penalty', 'Reporting', 'Reputation'],
    inherentRisk: 'High',
    controlLinkRequired: true,
    mappingStatus: 'Partial',
    status: 'Active',
    effectiveFrom: '2024-01-15',
    effectiveTo: null,
    createdBy: 1,
    createdAt: '2024-01-10',
    updatedBy: 3,
    updatedAt: '2024-01-15',
  },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Base Components)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©
const StatusBadge = ({ status }) => {
  const config = {
    Draft: { bg: 'bg-slate-100', text: 'text-slate-600', label: 'Ù…Ø³ÙˆØ¯Ø©' },
    UnderReview: { bg: 'bg-amber-100', text: 'text-amber-700', label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' },
    Returned: { bg: 'bg-orange-100', text: 'text-orange-700', label: 'Ù…ÙØ¹Ø§Ø¯' },
    Approved: { bg: 'bg-blue-100', text: 'text-blue-700', label: 'Ù…Ø¹ØªÙ…Ø¯' },
    Active: { bg: 'bg-emerald-100', text: 'text-emerald-700', label: 'Ù†Ø´Ø·' },
    OnHold: { bg: 'bg-purple-100', text: 'text-purple-700', label: 'Ù…Ø¹Ù„Ù‘Ù‚' },
    Retired: { bg: 'bg-red-100', text: 'text-red-700', label: 'Ù…Ù„ØºÙŠ' },
  };
  const c = config[status] || config.Draft;
  return <span className={`px-2.5 py-1 rounded-full text-xs font-semibold ${c.bg} ${c.text}`}>{c.label}</span>;
};

// Ø´Ø§Ø±Ø© Ø§Ù„Ø£Ù‡Ù…ÙŠØ©
const CriticalityBadge = ({ level }) => {
  const config = {
    High: { bg: 'bg-red-500', label: 'Ø¹Ø§Ù„ÙŠØ©' },
    Medium: { bg: 'bg-amber-500', label: 'Ù…ØªÙˆØ³Ø·Ø©' },
    Low: { bg: 'bg-slate-400', label: 'Ù…Ù†Ø®ÙØ¶Ø©' },
  };
  const c = config[level] || config.Medium;
  return <span className={`px-2 py-0.5 rounded text-xs font-bold text-white ${c.bg}`}>{c.label}</span>;
};

// Ø´Ø§Ø±Ø© Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
const ApplicabilityBadge = ({ value }) => {
  const config = {
    Applicable: { bg: 'bg-emerald-100', text: 'text-emerald-700', label: 'ÙŠÙ†Ø·Ø¨Ù‚' },
    NotApplicable: { bg: 'bg-slate-100', text: 'text-slate-600', label: 'Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚' },
    Partially: { bg: 'bg-amber-100', text: 'text-amber-700', label: 'Ø¬Ø²Ø¦ÙŠ' },
  };
  const c = config[value] || config.Applicable;
  return <span className={`px-2 py-0.5 rounded text-xs font-medium ${c.bg} ${c.text}`}>{c.label}</span>;
};

// Ø´Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø¨Ø·
const MappingBadge = ({ status }) => {
  const config = {
    Full: { bg: 'bg-emerald-100', text: 'text-emerald-700', icon: CheckCircle2, label: 'Ù…ÙƒØªÙ…Ù„' },
    Partial: { bg: 'bg-amber-100', text: 'text-amber-700', icon: Clock, label: 'Ø¬Ø²Ø¦ÙŠ' },
    NotMapped: { bg: 'bg-red-100', text: 'text-red-700', icon: XCircle, label: 'ØºÙŠØ± Ù…Ø±ØªØ¨Ø·' },
  };
  const c = config[status] || config.NotMapped;
  const Icon = c.icon;
  return (
    <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${c.bg} ${c.text}`}>
      <Icon className="w-3 h-3" />
      {c.label}
    </span>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø´Ø§Ø´Ø© 4.1 Ø³Ø¬Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OBLIGATIONS REGISTRY - Ø³Ø¬Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© (CRUD ÙƒØ§Ù…Ù„)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ObligationsRegistry = () => {
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Ø§Ù„Ø­Ø§Ù„Ø§Øª â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const [obligations, setObligations] = useState(INITIAL_OBLIGATIONS);
  const [viewMode, setViewMode] = useState('table');
  const [searchQuery, setSearchQuery] = useState('');
  const [filters, setFilters] = useState({
    authority: '', framework: '', category: '', criticality: '',
    status: '', applicability: '', owner: '', frequency: '', mappingStatus: '',
  });
  const [selectedObligation, setSelectedObligation] = useState(null);
  const [showModal, setShowModal] = useState(false);
  const [modalMode, setModalMode] = useState('view'); // view | create | edit
  const [modalTab, setModalTab] = useState('basic'); // basic | classification | priority | dates | responsibilities | links | audit
  const [modalSize, setModalSize] = useState({ width: 1150, height: 750 }); // Resizable modal - LARGER DEFAULT
  const [isResizing, setIsResizing] = useState(false);
  const [formData, setFormData] = useState(null);
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [deleteTarget, setDeleteTarget] = useState(null);
  const [selectedItems, setSelectedItems] = useState([]);
  const [showBulkModal, setShowBulkModal] = useState(false);
  const [notification, setNotification] = useState(null);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Helper Functions â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);
  const getFramework = (id) => FRAMEWORKS.find(f => f.id === id);
  const getUser = (id) => USERS.find(u => u.id === id);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Modal Resize Handler â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const handleMouseDown = (e, direction) => {
    e.preventDefault();
    setIsResizing(true);
    const startX = e.clientX;
    const startY = e.clientY;
    const startWidth = modalSize.width;
    const startHeight = modalSize.height;

    const handleMouseMove = (moveEvent) => {
      let newWidth = startWidth;
      let newHeight = startHeight;

      if (direction.includes('e')) newWidth = Math.max(600, Math.min(1400, startWidth + (moveEvent.clientX - startX)));
      if (direction.includes('w')) newWidth = Math.max(600, Math.min(1400, startWidth - (moveEvent.clientX - startX)));
      if (direction.includes('s')) newHeight = Math.max(400, Math.min(900, startHeight + (moveEvent.clientY - startY)));
      if (direction.includes('n')) newHeight = Math.max(400, Math.min(900, startHeight - (moveEvent.clientY - startY)));

      setModalSize({ width: newWidth, height: newHeight });
    };

    const handleMouseUp = () => {
      setIsResizing(false);
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
    };

    document.addEventListener('mousemove', handleMouseMove);
    document.addEventListener('mouseup', handleMouseUp);
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Empty Form â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const createEmptyForm = () => ({
    id: null, code: `OBL-${String(obligations.length + 1).padStart(3, '0')}`,
    authorityId: '', frameworkId: '', title: '', statement: '',
    category: '', criticality: 'High', applicability: 'Applicable',
    applicabilityJustification: '', scopeLevel: 'Enterprise',
    ownerId: '', reviewerId: '', approverId: '', frequency: '',
    dueDate: '', evidenceRequired: true, evidenceTypes: [],
    evidenceValidityDays: 365, acceptanceCriteria: '',
    mappingStatus: 'NotMapped', status: 'Draft',
    createdAt: new Date().toISOString().split('T')[0],
    updatedAt: new Date().toISOString().split('T')[0],
  });

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Filtering â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const filteredObligations = useMemo(() => {
    return obligations.filter(obl => {
      if (searchQuery) {
        const q = searchQuery.toLowerCase();
        if (!obl.code?.toLowerCase().includes(q) && !obl.title?.toLowerCase().includes(q)) return false;
      }
      if (filters.authority && obl.authorityId !== parseInt(filters.authority)) return false;
      if (filters.status && obl.status !== filters.status) return false;
      if (filters.criticality && obl.criticality !== filters.criticality) return false;
      return true;
    });
  }, [obligations, searchQuery, filters]);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Stats â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const stats = useMemo(() => ({
    total: obligations.length,
    active: obligations.filter(o => o.status === 'Active').length,
    draft: obligations.filter(o => o.status === 'Draft').length,
    underReview: obligations.filter(o => o.status === 'UnderReview').length,
    mapped: obligations.filter(o => o.mappingStatus === 'FullyMapped').length,
    notMapped: obligations.filter(o => o.mappingStatus === 'NotMapped').length,
    high: obligations.filter(o => o.criticality === 'High' || o.criticality === 'Critical').length,
  }), [obligations]);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Notification â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CRUD Handlers â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const handleCreate = () => {
    setFormData(createEmptyForm());
    setModalMode('create');
    setModalTab('basic');
    setShowModal(true);
  };

  const handleView = (obl) => {
    setSelectedObligation(obl);
    setFormData({ ...obl });
    setModalMode('view');
    setModalTab('basic');
    setShowModal(true);
  };

  const handleEdit = (obl, e) => {
    if (e) e.stopPropagation();
    setSelectedObligation(obl);
    setFormData({ ...obl });
    setModalMode('edit');
    setModalTab('basic');
    setShowModal(true);
  };

  const handleSave = () => {
    if (!formData.title || formData.title.length < 3) {
      showNotification('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨ (3 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)', 'error');
      return;
    }

    const now = new Date().toISOString().split('T')[0];
    if (modalMode === 'create') {
      const newObl = { ...formData, id: Math.max(...obligations.map(o => o.id), 0) + 1, createdAt: now, updatedAt: now };
      setObligations([...obligations, newObl]);
      showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
    } else {
      setObligations(obligations.map(o => o.id === formData.id ? { ...formData, updatedAt: now } : o));
      showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
    }
    setShowModal(false);
    setFormData(null);
  };

  const handleDelete = (obl, e) => {
    if (e) e.stopPropagation();
    setDeleteTarget(obl);
    setShowDeleteConfirm(true);
  };

  const confirmDelete = () => {
    setObligations(obligations.filter(o => o.id !== deleteTarget.id));
    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
    setShowDeleteConfirm(false);
    setDeleteTarget(null);
  };

  const handleDuplicate = (obl, e) => {
    if (e) e.stopPropagation();
    const newObl = {
      ...obl,
      id: Math.max(...obligations.map(o => o.id), 0) + 1,
      code: `OBL-${String(obligations.length + 1).padStart(3, '0')}`,
      title: `Ù†Ø³Ø®Ø© Ù…Ù†: ${obl.title}`,
      status: 'Draft',
      createdAt: new Date().toISOString().split('T')[0],
    };
    setObligations([...obligations, newObl]);
    showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Bulk Actions â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const toggleSelect = (id) => setSelectedItems(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);
  const toggleSelectAll = () => setSelectedItems(selectedItems.length === filteredObligations.length ? [] : filteredObligations.map(o => o.id));

  const handleBulkStatusChange = (status) => {
    setObligations(obligations.map(o => selectedItems.includes(o.id) ? { ...o, status, updatedAt: new Date().toISOString().split('T')[0] } : o));
    showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« ${selectedItems.length} Ø§Ù„ØªØ²Ø§Ù…`);
    setSelectedItems([]);
    setShowBulkModal(false);
  };

  const handleBulkDelete = () => {
    setObligations(obligations.filter(o => !selectedItems.includes(o.id)));
    showNotification(`ØªÙ… Ø­Ø°Ù ${selectedItems.length} Ø§Ù„ØªØ²Ø§Ù…`);
    setSelectedItems([]);
    setShowBulkModal(false);
  };

  const clearFilters = () => {
    setFilters({ authority: '', framework: '', category: '', criticality: '', status: '', applicability: '', owner: '', frequency: '', mappingStatus: '' });
    setSearchQuery('');
  };


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UI â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* Notification */}
      {notification && (
        <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold ${notification.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}`}>
          {notification.message}
        </div>
      )}

      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-slate-900">Ø³Ø¬Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</h1>
          <p className="text-slate-500">Regulatory Obligations Registry - Ø¥Ø¯Ø§Ø±Ø© ÙƒØ§Ù…Ù„Ø©</p>
        </div>
        <div className="flex items-center gap-3">
          {selectedItems.length > 0 && (
            <button onClick={() => setShowBulkModal(true)} className="flex items-center gap-2 px-4 py-2.5 bg-indigo-100 text-indigo-700 rounded-xl font-bold">
              <CheckSquare className="w-5 h-5" />Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ({selectedItems.length})
            </button>
          )}
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
          </button>
          <button onClick={handleCreate} className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg">
            <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ²Ø§Ù…
          </button>
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-7 gap-3">
        <div className="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-4 text-white">
          <p className="text-indigo-100 text-xs">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
          <p className="text-3xl font-bold mt-1">{stats.total}</p>
        </div>
        {[
          { label: 'Ù†Ø´Ø·', value: stats.active, color: 'emerald' },
          { label: 'Ù…Ø³ÙˆØ¯Ø©', value: stats.draft, color: 'slate' },
          { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', value: stats.underReview, color: 'amber' },
          { label: 'Ù…Ø±Ø¨ÙˆØ·', value: stats.mapped, color: 'blue' },
          { label: 'ØºÙŠØ± Ù…Ø±Ø¨ÙˆØ·', value: stats.notMapped, color: 'red' },
          { label: 'Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø£Ù‡Ù…ÙŠØ©', value: stats.high, color: 'orange' },
        ].map((s, i) => (
          <div key={i} className={`bg-white rounded-2xl p-4 border-2 border-${s.color}-200`}>
            <p className="text-xs text-slate-500">{s.label}</p>
            <p className={`text-2xl font-bold text-${s.color}-600`}>{s.value}</p>
          </div>
        ))}
      </div>

      {/* Filters */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 p-4">
        <div className="flex flex-wrap items-center gap-3">
          <div className="flex-1 min-w-[250px] relative">
            <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
            <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
              className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500" />
          </div>
          <select value={filters.authority} onChange={(e) => setFilters({ ...filters, authority: e.target.value })} className="px-4 py-3 border-2 border-slate-200 rounded-xl">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
            {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code}</option>)}
          </select>
          <select value={filters.status} onChange={(e) => setFilters({ ...filters, status: e.target.value })} className="px-4 py-3 border-2 border-slate-200 rounded-xl">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
            <option value="Draft">Ù…Ø³ÙˆØ¯Ø©</option>
            <option value="Active">Ù†Ø´Ø·</option>
            <option value="UnderReview">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
          </select>
          <select value={filters.criticality} onChange={(e) => setFilters({ ...filters, criticality: e.target.value })} className="px-4 py-3 border-2 border-slate-200 rounded-xl">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‡Ù…ÙŠØ§Øª</option>
            <option value="Critical">Ø­Ø±Ø¬</option>
            <option value="High">Ø¹Ø§Ù„ÙŠ</option>
            <option value="Medium">Ù…ØªÙˆØ³Ø·</option>
          </select>
          <div className="flex border-2 border-slate-200 rounded-xl overflow-hidden">
            <button onClick={() => setViewMode('table')} className={`p-3 ${viewMode === 'table' ? 'bg-indigo-500 text-white' : 'text-slate-500'}`}><Table className="w-5 h-5" /></button>
            <button onClick={() => setViewMode('cards')} className={`p-3 ${viewMode === 'cards' ? 'bg-indigo-500 text-white' : 'text-slate-500'}`}><LayoutGrid className="w-5 h-5" /></button>
          </div>
          {(searchQuery || Object.values(filters).some(v => v)) && (
            <button onClick={clearFilters} className="px-4 py-3 text-red-600 hover:bg-red-50 rounded-xl"><X className="w-4 h-4" /></button>
          )}
        </div>
      </div>

      {/* Table View */}
      {viewMode === 'table' && (
        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
          <table className="w-full">
            <thead>
              <tr className="bg-slate-50 border-b-2 border-slate-200">
                <th className="px-3 py-3 w-10"><input type="checkbox" checked={selectedItems.length === filteredObligations.length && filteredObligations.length > 0} onChange={toggleSelectAll} className="w-4 h-4" /></th>
                <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</th>
                <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ù…Ø§Ù„Ùƒ</th>
                <th className="text-center px-4 py-3 font-bold text-slate-700 w-44">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody>
              {filteredObligations.map(obl => {
                const auth = getAuthority(obl.authorityId);
                const owner = getUser(obl.ownerId);
                return (
                  <tr key={obl.id} className="border-b border-slate-100 hover:bg-slate-50 cursor-pointer" onClick={() => handleView(obl)}>
                    <td className="px-3 py-4" onClick={e => e.stopPropagation()}><input type="checkbox" checked={selectedItems.includes(obl.id)} onChange={() => toggleSelect(obl.id)} className="w-4 h-4" /></td>
                    <td className="px-4 py-4"><span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded">{obl.code}</span></td>
                    <td className="px-4 py-4"><p className="font-medium text-slate-800 line-clamp-1">{obl.title}</p></td>
                    <td className="px-3 py-4 text-center"><span className={`px-2 py-1 rounded-lg text-xs font-bold ${auth?.code === 'SAMA' ? 'bg-emerald-100 text-emerald-700' : auth?.code === 'NCA' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'}`}>{auth?.code || '-'}</span></td>
                    <td className="px-3 py-4 text-center"><span className={`px-2 py-1 rounded-lg text-xs font-bold ${obl.criticality === 'Critical' ? 'bg-red-100 text-red-700' : obl.criticality === 'High' ? 'bg-orange-100 text-orange-700' : 'bg-amber-100 text-amber-700'}`}>{obl.criticality === 'Critical' ? 'Ø­Ø±Ø¬' : obl.criticality === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·'}</span></td>
                    <td className="px-3 py-4 text-center"><span className={`px-2 py-1 rounded-lg text-xs font-bold ${obl.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : obl.status === 'Draft' ? 'bg-slate-100 text-slate-600' : 'bg-amber-100 text-amber-700'}`}>{obl.status === 'Active' ? 'Ù†Ø´Ø·' : obl.status === 'Draft' ? 'Ù…Ø³ÙˆØ¯Ø©' : 'Ù…Ø±Ø§Ø¬Ø¹Ø©'}</span></td>
                    <td className="px-3 py-4 text-center"><span className="text-sm text-slate-600">{owner?.name?.split(' ')[0] || '-'}</span></td>
                    <td className="px-4 py-4" onClick={e => e.stopPropagation()}>
                      <div className="flex items-center justify-center gap-1">
                        <button onClick={() => handleView(obl)} className="p-2 hover:bg-blue-50 rounded-lg"><Eye className="w-4 h-4 text-blue-500" /></button>
                        <button onClick={(e) => handleEdit(obl, e)} className="p-2 hover:bg-amber-50 rounded-lg"><Edit className="w-4 h-4 text-amber-500" /></button>
                        <button onClick={(e) => handleDuplicate(obl, e)} className="p-2 hover:bg-purple-50 rounded-lg"><Copy className="w-4 h-4 text-purple-500" /></button>
                        <button onClick={(e) => handleDelete(obl, e)} className="p-2 hover:bg-red-50 rounded-lg"><Trash2 className="w-4 h-4 text-red-500" /></button>
                      </div>
                    </td>
                  </tr>
                );
              })}
            </tbody>
          </table>
          {filteredObligations.length === 0 && <div className="text-center py-16 text-slate-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>}
        </div>
      )}

      {/* Cards View */}
      {viewMode === 'cards' && (
        <div className="grid grid-cols-3 gap-4">
          {filteredObligations.map(obl => {
            const auth = getAuthority(obl.authorityId);
            return (
              <div key={obl.id} className="bg-white rounded-xl border-2 border-slate-200 p-4 hover:shadow-lg cursor-pointer" onClick={() => handleView(obl)}>
                <div className="flex items-start justify-between mb-3">
                  <span className={`px-2 py-1 rounded-lg text-xs font-bold ${auth?.code === 'SAMA' ? 'bg-emerald-100 text-emerald-700' : 'bg-blue-100 text-blue-700'}`}>{auth?.code}</span>
                  <span className={`px-2 py-1 rounded-lg text-xs font-bold ${obl.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'}`}>{obl.status === 'Active' ? 'Ù†Ø´Ø·' : 'Ù…Ø³ÙˆØ¯Ø©'}</span>
                </div>
                <span className="font-mono text-xs text-indigo-600">{obl.code}</span>
                <h4 className="font-bold text-slate-800 mt-2 line-clamp-2">{obl.title}</h4>
                <div className="flex items-center justify-between mt-4 pt-3 border-t border-slate-100">
                  <span className="text-xs text-slate-500">{getUser(obl.ownerId)?.name?.split(' ')[0]}</span>
                  <div className="flex gap-1" onClick={e => e.stopPropagation()}>
                    <button onClick={(e) => handleEdit(obl, e)} className="p-1.5 hover:bg-amber-50 rounded"><Edit className="w-3.5 h-3.5 text-amber-500" /></button>
                    <button onClick={(e) => handleDelete(obl, e)} className="p-1.5 hover:bg-red-50 rounded"><Trash2 className="w-3.5 h-3.5 text-red-500" /></button>
                  </div>
                </div>
              </div>
            );
          })}
        </div>
      )}


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          WORLD-CLASS OBLIGATION MODAL - 7 TABS ENTERPRISE GRADE
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div
            className="bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col relative"
            style={{
              width: `${modalSize.width}px`,
              height: `${modalSize.height}px`,
              minWidth: '900px',
              maxWidth: '1500px',
              minHeight: '600px',
              maxHeight: '95vh'
            }}>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RESIZE HANDLES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {/* Right */}
            <div onMouseDown={(e) => handleMouseDown(e, 'e')}
              className="absolute top-0 right-0 w-2 h-full cursor-ew-resize hover:bg-indigo-500/20 transition-colors z-10" />
            {/* Left */}
            <div onMouseDown={(e) => handleMouseDown(e, 'w')}
              className="absolute top-0 left-0 w-2 h-full cursor-ew-resize hover:bg-indigo-500/20 transition-colors z-10" />
            {/* Bottom */}
            <div onMouseDown={(e) => handleMouseDown(e, 's')}
              className="absolute bottom-0 left-0 w-full h-2 cursor-ns-resize hover:bg-indigo-500/20 transition-colors z-10" />
            {/* Bottom Right Corner */}
            <div onMouseDown={(e) => handleMouseDown(e, 'se')}
              className="absolute bottom-0 right-0 w-5 h-5 cursor-nwse-resize z-20 flex items-center justify-center">
              <div className="w-3 h-3 border-r-2 border-b-2 border-slate-400 hover:border-indigo-500 transition-colors" />
            </div>
            {/* Bottom Left Corner */}
            <div onMouseDown={(e) => handleMouseDown(e, 'sw')}
              className="absolute bottom-0 left-0 w-5 h-5 cursor-nesw-resize z-20" />

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className={`px-6 py-4 text-white ${modalMode === 'create' ? 'bg-gradient-to-l from-indigo-600 via-purple-600 to-violet-700' :
                modalMode === 'edit' ? 'bg-gradient-to-l from-amber-500 via-orange-500 to-red-500' :
                  'bg-gradient-to-l from-blue-600 via-indigo-600 to-purple-700'
              }`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center shadow-lg backdrop-blur-sm">
                    {modalMode === 'create' ? <Plus className="w-6 h-6" /> : modalMode === 'edit' ? <Edit className="w-6 h-6" /> : <ClipboardCheck className="w-6 h-6" />}
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">
                      {modalMode === 'create' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ²Ø§Ù… ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø¬Ø¯ÙŠØ¯' : modalMode === 'edit' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ' : 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ'}
                    </h2>
                    <div className="flex items-center gap-2 mt-0.5">
                      <span className="px-2 py-0.5 bg-white/20 rounded-lg text-xs font-bold">{formData.code}</span>
                      {formData.status && (
                        <span className={`px-2 py-0.5 rounded-lg text-xs font-bold ${formData.status === 'Active' ? 'bg-emerald-400/30' :
                            formData.status === 'Draft' ? 'bg-slate-400/30' :
                              'bg-amber-400/30'
                          }`}>
                          {formData.status === 'Active' ? 'Ù†Ø´Ø·' : formData.status === 'Draft' ? 'Ù…Ø³ÙˆØ¯Ø©' : formData.status}
                        </span>
                      )}
                    </div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  {modalMode === 'view' && (
                    <button onClick={() => setModalMode('edit')} className="flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-xl text-sm font-bold transition-all">
                      <Edit className="w-4 h-4" />ØªØ¹Ø¯ÙŠÙ„
                    </button>
                  )}
                  {/* Size Controls */}
                  <div className="flex items-center gap-1 bg-white/10 rounded-lg p-1">
                    <button onClick={() => setModalSize({ width: 900, height: 600 })} title="Ù…ØªÙˆØ³Ø·"
                      className={`w-7 h-7 flex items-center justify-center rounded-lg transition-all ${modalSize.width <= 950 ? 'bg-white/30' : 'hover:bg-white/20'}`}>
                      <Minimize2 className="w-3.5 h-3.5" />
                    </button>
                    <button onClick={() => setModalSize({ width: 1150, height: 750 })} title="ÙƒØ¨ÙŠØ±"
                      className={`w-7 h-7 flex items-center justify-center rounded-lg transition-all ${modalSize.width > 950 && modalSize.width < 1300 ? 'bg-white/30' : 'hover:bg-white/20'}`}>
                      <Square className="w-3.5 h-3.5" />
                    </button>
                    <button onClick={() => setModalSize({ width: 1400, height: 850 })} title="Ø£Ù‚ØµÙ‰"
                      className={`w-7 h-7 flex items-center justify-center rounded-lg transition-all ${modalSize.width >= 1300 ? 'bg-white/30' : 'hover:bg-white/20'}`}>
                      <Maximize2 className="w-3.5 h-3.5" />
                    </button>
                  </div>
                  <button onClick={() => { setShowModal(false); setModalTab('basic'); setModalSize({ width: 1150, height: 750 }); }} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <X className="w-5 h-5" />
                  </button>
                </div>
              </div>
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS NAVIGATION - 10 TABS WITH LABELS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className="bg-gradient-to-r from-slate-100 to-slate-50 border-b-2 border-slate-200">
              <div className="flex overflow-x-auto">
                {[
                  { id: 'basic', label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', num: '1', color: 'indigo' },
                  { id: 'reference', label: 'Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', num: '2', color: 'purple' },
                  { id: 'program', label: 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙˆØ§Ù„ØªØµÙ†ÙŠÙ', num: '3', color: 'emerald' },
                  { id: 'applicability', label: 'Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', num: '4', color: 'amber' },
                  { id: 'evidence', label: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø©', num: '5', color: 'teal' },
                  { id: 'schedule', label: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…', num: '6', color: 'blue' },
                  { id: 'testing', label: 'Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', num: '7', color: 'cyan' },
                  { id: 'enforcement', label: 'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø°', num: '8', color: 'red' },
                  { id: 'impact', label: 'Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', num: '9', color: 'orange' },
                  { id: 'audit', label: 'Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚', num: '10', color: 'violet' },
                ].map((tab, idx) => {
                  const isActive = modalTab === tab.id;
                  const tabsList = ['basic', 'reference', 'program', 'applicability', 'evidence', 'schedule', 'testing', 'enforcement', 'impact', 'audit'];
                  const currentIdx = tabsList.indexOf(modalTab);
                  const isPassed = tabsList.indexOf(tab.id) < currentIdx;
                  return (
                    <button key={tab.id} onClick={() => setModalTab(tab.id)}
                      className={`flex items-center gap-2 px-4 py-3.5 font-bold whitespace-nowrap border-b-3 transition-all ${isActive
                          ? `text-${tab.color}-700 border-${tab.color}-500 bg-white shadow-sm`
                          : isPassed
                            ? `text-${tab.color}-600 border-transparent bg-${tab.color}-50/50`
                            : 'text-slate-500 border-transparent hover:text-slate-700 hover:bg-white/70'
                        }`}>
                      <span className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-black ${isActive ? `bg-${tab.color}-500 text-white` :
                          isPassed ? `bg-${tab.color}-400 text-white` :
                            'bg-slate-300 text-slate-600'
                        }`}>{tab.num}</span>
                      <span className="text-sm">{tab.label}</span>
                      {isPassed && <CheckCircle2 className="w-4 h-4 text-emerald-500" />}
                    </button>
                  );
                })}
              </div>
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className="flex-1 overflow-y-auto p-6">

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 1: Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - ENHANCED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'basic' && (
                <div className="space-y-5">
                  {/* Info Box */}
                  <div className="bg-indigo-50 border border-indigo-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-indigo-700">
                      <FileText className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                    </div>
                    <p className="text-indigo-600 text-sm mt-1">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„ØªÙŠ ØªØ¹Ø±Ù‘Ù Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                        ÙƒÙˆØ¯ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… <span className="text-red-500">*</span>
                      </label>
                      <input type="text" value={formData.code || ''} onChange={(e) => setFormData({ ...formData, code: e.target.value })} disabled={modalMode === 'view'}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-indigo-400 focus:outline-none font-mono"
                        placeholder="SHM-OBL-001, PDPL-ART-18" />
                    </div>
                    <div className="col-span-2">
                      <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                        Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… <span className="text-red-500">*</span>
                      </label>
                      <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })} disabled={modalMode === 'view'}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-indigo-400 focus:outline-none"
                        placeholder="Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ø¶Ø­ ÙˆÙ…Ø­Ø¯Ø¯ Ù„Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ" />
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ØµÙŠØ§ØºØ© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© / Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                    <textarea rows={3} value={formData.statement || ''} onChange={(e) => setFormData({ ...formData, statement: e.target.value })} disabled={modalMode === 'view'}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 resize-none focus:border-indigo-400 focus:outline-none font-mono text-sm"
                      placeholder="Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ù„Ù„Ø§Ù„ØªØ²Ø§Ù… ÙƒÙ…Ø§ ÙˆØ±Ø¯ ÙÙŠ Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø£Ùˆ Ø§Ù„Ù†Ø¸Ø§Ù…..." />
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</label>
                    <textarea rows={2} value={formData.notes || ''} onChange={(e) => setFormData({ ...formData, notes: e.target.value })} disabled={modalMode === 'view'}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 resize-none focus:border-indigo-400 focus:outline-none"
                      placeholder="Ø´Ø±Ø­ ØªÙØµÙŠÙ„ÙŠ Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆÙƒÙŠÙÙŠØ© ØªØ·Ø¨ÙŠÙ‚Ù‡..." />
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</label>
                      <select value={formData.criticality || 'Medium'} onChange={(e) => setFormData({ ...formData, criticality: e.target.value })} disabled={modalMode === 'view'}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-indigo-400">
                        <option value="Critical">ğŸ”´ Ø­Ø±Ø¬ (Critical)</option>
                        <option value="High">ğŸŸ  Ø¹Ø§Ù„ÙŠ (High)</option>
                        <option value="Medium">ğŸŸ¡ Ù…ØªÙˆØ³Ø· (Medium)</option>
                        <option value="Low">ğŸŸ¢ Ù…Ù†Ø®ÙØ¶ (Low)</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© (Control Type)</label>
                      <select value={formData.controlType || 'Preventive'} onChange={(e) => setFormData({ ...formData, controlType: e.target.value })} disabled={modalMode === 'view'}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-indigo-400">
                        <option value="Preventive">ğŸ›¡ï¸ ÙˆÙ‚Ø§Ø¦ÙŠ (Preventive)</option>
                        <option value="Detective">ğŸ” ÙƒØ´ÙÙŠ (Detective)</option>
                        <option value="Corrective">ğŸ”§ ØªØµØ­ÙŠØ­ÙŠ (Corrective)</option>
                        <option value="Directive">ğŸ“‹ ØªÙˆØ¬ÙŠÙ‡ÙŠ (Directive)</option>
                        <option value="Compensating">âš–ï¸ ØªØ¹ÙˆÙŠØ¶ÙŠ (Compensating)</option>
                      </select>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 2: Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'reference' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-purple-600 via-violet-600 to-indigo-600 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <BookOpen className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙˆØ§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ</h3>
                          <p className="text-purple-200 text-sm">Regulatory & Legal Reference</p>
                        </div>
                      </div>
                      {formData.authorityId && (
                        <div className="text-left bg-white/10 rounded-xl px-4 py-2 backdrop-blur">
                          <p className="text-purple-200 text-xs">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</p>
                          <p className="font-bold">{AUTHORITIES.find(a => a.id === formData.authorityId)?.code || '-'}</p>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Authority Selection - Cards */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200 flex items-center justify-between">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <Building2 className="w-5 h-5 text-purple-500" />
                        Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© <span className="text-red-500">*</span>
                      </h4>
                      <span className="text-sm text-slate-500">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</span>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-4 gap-3">
                        {[
                          { id: 1, code: 'MOI', name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©', icon: 'ğŸ›ï¸', color: 'blue', sector: 'Ø£Ù…Ù†ÙŠ' },
                          { id: 2, code: 'SAMA', name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ', icon: 'ğŸ¦', color: 'green', sector: 'Ù…Ø§Ù„ÙŠ' },
                          { id: 3, code: 'NCA', name: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', icon: 'ğŸ›¡ï¸', color: 'red', sector: 'Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ' },
                          { id: 4, code: 'SDAIA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', icon: 'ğŸ¤–', color: 'indigo', sector: 'Ø¨ÙŠØ§Ù†Ø§Øª' },
                          { id: 5, code: 'ZATCA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø©', icon: 'ğŸ’°', color: 'amber', sector: 'Ø¶Ø±ÙŠØ¨ÙŠ' },
                          { id: 6, code: 'CMA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', icon: 'ğŸ“ˆ', color: 'purple', sector: 'Ù…Ø§Ù„ÙŠ' },
                          { id: 7, code: 'MHRSD', name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', icon: 'ğŸ‘¥', color: 'cyan', sector: 'Ø¹Ù…Ø§Ù„ÙŠ' },
                          { id: 8, code: 'CBAHI', name: 'Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ØµØ­ÙŠ', icon: 'ğŸ¥', color: 'pink', sector: 'ØµØ­ÙŠ' },
                        ].map(auth => {
                          const isSelected = formData.authorityId === auth.id;
                          return (
                            <button key={auth.id} type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, authorityId: auth.id, authorityCode: auth.code, frameworkId: '' })}
                              className={`p-4 rounded-xl border-2 text-center transition-all transform hover:scale-[1.02] ${isSelected
                                  ? `bg-${auth.color}-50 border-${auth.color}-400 shadow-lg`
                                  : 'bg-white border-slate-200 hover:border-slate-300'
                                }`}>
                              <span className="text-3xl block mb-2">{auth.icon}</span>
                              <p className={`font-bold text-sm ${isSelected ? `text-${auth.color}-700` : 'text-slate-700'}`}>{auth.code}</p>
                              <p className="text-xs text-slate-500 mt-1 line-clamp-1">{auth.name}</p>
                              <span className={`inline-block mt-2 px-2 py-0.5 rounded-full text-xs ${isSelected ? `bg-${auth.color}-100 text-${auth.color}-700` : 'bg-slate-100 text-slate-500'
                                }`}>{auth.sector}</span>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Framework Selection */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-violet-50 px-5 py-3 border-b border-violet-100 flex items-center justify-between">
                      <h4 className="font-bold text-violet-700 flex items-center gap-2">
                        <FileText className="w-5 h-5" />
                        Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ / Ø§Ù„Ù„Ø§Ø¦Ø­Ø©
                      </h4>
                      {formData.frameworkId && <CheckCircle2 className="w-5 h-5 text-emerald-500" />}
                    </div>
                    <div className="p-5">
                      {formData.authorityId ? (
                        <div className="grid grid-cols-3 gap-3">
                          {[
                            { id: 1, code: 'SHOMOOS', title: 'Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ Ø§Ù„Ø£Ù…Ù†ÙŠ', version: 'v3.0', year: '2024', authorityId: 1 },
                            { id: 2, code: 'SAMA-CSF', title: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', version: 'v2.0', year: '2023', authorityId: 2 },
                            { id: 3, code: 'ECC', title: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', version: 'v2.0', year: '2024', authorityId: 3 },
                            { id: 4, code: 'PDPL', title: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', version: 'v1.0', year: '2023', authorityId: 4 },
                            { id: 5, code: 'VAT-REG', title: 'Ù„Ø§Ø¦Ø­Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©', version: 'v4.0', year: '2024', authorityId: 5 },
                            { id: 6, code: 'AML-REG', title: 'Ù„Ø§Ø¦Ø­Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', version: 'v3.0', year: '2023', authorityId: 6 },
                            { id: 7, code: 'LABOR-LAW', title: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„', version: 'v2.0', year: '2024', authorityId: 7 },
                            { id: 8, code: 'CBAHI-STD', title: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ØµØ­ÙŠ', version: 'v5.0', year: '2024', authorityId: 8 },
                          ].filter(f => f.authorityId === formData.authorityId).map(framework => {
                            const isSelected = formData.frameworkId === framework.id;
                            return (
                              <button key={framework.id} type="button" disabled={modalMode === 'view'}
                                onClick={() => setFormData({ ...formData, frameworkId: framework.id, frameworkCode: framework.code })}
                                className={`p-4 rounded-xl border-2 text-right transition-all ${isSelected
                                    ? 'bg-violet-50 border-violet-400 shadow-md'
                                    : 'bg-white border-slate-200 hover:border-violet-300'
                                  }`}>
                                <div className="flex items-start justify-between">
                                  <span className={`px-2 py-1 rounded-lg text-xs font-bold ${isSelected ? 'bg-violet-500 text-white' : 'bg-slate-100 text-slate-600'
                                    }`}>{framework.code}</span>
                                  {isSelected && <CheckCircle2 className="w-5 h-5 text-violet-500" />}
                                </div>
                                <p className={`font-bold mt-2 ${isSelected ? 'text-violet-700' : 'text-slate-700'}`}>{framework.title}</p>
                                <div className="flex items-center gap-2 mt-2 text-xs text-slate-500">
                                  <span className="px-2 py-0.5 bg-slate-100 rounded">{framework.version}</span>
                                  <span>{framework.year}</span>
                                </div>
                              </button>
                            );
                          })}
                          {[].filter(f => f.authorityId === formData.authorityId).length === 0 && (
                            <div className="col-span-3 text-center py-8 text-slate-400">
                              <FileText className="w-12 h-12 mx-auto mb-2 opacity-50" />
                              <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø·Ø± ØªÙ†Ø¸ÙŠÙ…ÙŠØ© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù‡Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                            </div>
                          )}
                        </div>
                      ) : (
                        <div className="text-center py-8 text-slate-400">
                          <Building2 className="w-12 h-12 mx-auto mb-2 opacity-50" />
                          <p>Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø·Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</p>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Article & Clause Details */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-indigo-50 px-5 py-3 border-b border-indigo-100">
                      <h4 className="font-bold text-indigo-700 flex items-center gap-2">
                        <Hash className="w-5 h-5" />
                        ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ø¯Ø© ÙˆØ§Ù„Ø¨Ù†Ø¯
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-4 gap-4">
                        <div className="bg-slate-50 rounded-xl p-4">
                          <label className="block text-xs font-bold text-slate-500 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</label>
                          <input type="text" value={formData.articleNumber || ''}
                            onChange={(e) => setFormData({ ...formData, articleNumber: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl text-center text-lg font-bold disabled:bg-white focus:border-indigo-400 focus:outline-none"
                            placeholder="18" />
                          <p className="text-center text-xs text-slate-400 mt-1">Article</p>
                        </div>
                        <div className="bg-slate-50 rounded-xl p-4">
                          <label className="block text-xs font-bold text-slate-500 mb-2">Ø±Ù‚Ù… Ø§Ù„ÙÙ‚Ø±Ø©</label>
                          <input type="text" value={formData.clauseNumber || ''}
                            onChange={(e) => setFormData({ ...formData, clauseNumber: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl text-center text-lg font-bold disabled:bg-white focus:border-indigo-400 focus:outline-none"
                            placeholder="3" />
                          <p className="text-center text-xs text-slate-400 mt-1">Clause</p>
                        </div>
                        <div className="bg-slate-50 rounded-xl p-4">
                          <label className="block text-xs font-bold text-slate-500 mb-2">Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„ÙØ±Ø¹ÙŠ</label>
                          <input type="text" value={formData.subClauseNumber || ''}
                            onChange={(e) => setFormData({ ...formData, subClauseNumber: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl text-center text-lg font-bold disabled:bg-white focus:border-indigo-400 focus:outline-none"
                            placeholder="Ø£" />
                          <p className="text-center text-xs text-slate-400 mt-1">Sub-Clause</p>
                        </div>
                        <div className="bg-slate-50 rounded-xl p-4">
                          <label className="block text-xs font-bold text-slate-500 mb-2">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</label>
                          <input type="text" value={formData.regulationVersion || ''}
                            onChange={(e) => setFormData({ ...formData, regulationVersion: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl text-center text-lg font-bold disabled:bg-white focus:border-indigo-400 focus:outline-none"
                            placeholder="v2.0" />
                          <p className="text-center text-xs text-slate-400 mt-1">Version</p>
                        </div>
                      </div>

                      {/* Reference Code Preview */}
                      {(formData.articleNumber || formData.clauseNumber) && (
                        <div className="mt-4 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-200">
                          <p className="text-sm text-indigo-600 mb-1">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ:</p>
                          <p className="text-2xl font-black text-indigo-700 font-mono">
                            {formData.authorityCode || 'XXX'}-{formData.frameworkCode || 'XXX'}-ART{formData.articleNumber || '00'}.{formData.clauseNumber || '0'}{formData.subClauseNumber ? `.${formData.subClauseNumber}` : ''}
                          </p>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Reference Links & Documents */}
                  <div className="grid grid-cols-2 gap-4">
                    {/* Official Link */}
                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-blue-50 px-5 py-3 border-b border-blue-100">
                        <h4 className="font-bold text-blue-700 flex items-center gap-2">
                          <Link2 className="w-5 h-5" />
                          Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø±Ø³Ù…ÙŠØ©
                        </h4>
                      </div>
                      <div className="p-4 space-y-3">
                        <div>
                          <label className="block text-xs font-bold text-slate-500 mb-1">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                          <div className="flex gap-2">
                            <input type="url" value={formData.referenceUrl || ''}
                              onChange={(e) => setFormData({ ...formData, referenceUrl: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="flex-1 px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-blue-400 focus:outline-none text-sm"
                              placeholder="https://..." />
                            {formData.referenceUrl && (
                              <button type="button" className="px-3 py-2.5 bg-blue-500 text-white rounded-xl hover:bg-blue-600">
                                <ExternalLink className="w-5 h-5" />
                              </button>
                            )}
                          </div>
                        </div>
                        <div>
                          <label className="block text-xs font-bold text-slate-500 mb-1">Ø±Ø§Ø¨Ø· Ø§Ù„Ù†Øµ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø§Ø¦Ø­Ø©</label>
                          <input type="url" value={formData.fullTextUrl || ''}
                            onChange={(e) => setFormData({ ...formData, fullTextUrl: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-blue-400 focus:outline-none text-sm"
                            placeholder="https://..." />
                        </div>
                      </div>
                    </div>

                    {/* Effective Dates */}
                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-amber-50 px-5 py-3 border-b border-amber-100">
                        <h4 className="font-bold text-amber-700 flex items-center gap-2">
                          <Calendar className="w-5 h-5" />
                          ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù†ÙØ§Ø°
                        </h4>
                      </div>
                      <div className="p-4 space-y-3">
                        <div className="grid grid-cols-2 gap-3">
                          <div>
                            <label className="block text-xs font-bold text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±</label>
                            <input type="date" value={formData.issuanceDate || ''}
                              onChange={(e) => setFormData({ ...formData, issuanceDate: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400 focus:outline-none text-sm" />
                          </div>
                          <div>
                            <label className="block text-xs font-bold text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†</label>
                            <input type="date" value={formData.effectiveDate || ''}
                              onChange={(e) => setFormData({ ...formData, effectiveDate: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400 focus:outline-none text-sm" />
                          </div>
                        </div>
                        <div>
                          <label className="block text-xs font-bold text-slate-500 mb-1">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                          <input type="text" value={formData.applicationNotes || ''}
                            onChange={(e) => setFormData({ ...formData, applicationNotes: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400 focus:outline-none text-sm"
                            placeholder="Ù…Ø«Ø§Ù„: ÙŠØ³Ø±ÙŠ Ø¨Ø¹Ø¯ 90 ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ù†Ø´Ø±" />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Reference Summary Dashboard */}
                  <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                    <h4 className="font-bold mb-4 flex items-center gap-2">
                      <BarChart3 className="w-5 h-5 text-purple-400" />
                      Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
                    </h4>
                    <div className="grid grid-cols-5 gap-4">
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-1">ğŸ›ï¸</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø¬Ù‡Ø©</p>
                        <p className="font-bold text-sm mt-1">{formData.authorityCode || '-'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-1">ğŸ“‹</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø¥Ø·Ø§Ø±</p>
                        <p className="font-bold text-sm mt-1">{formData.frameworkCode || '-'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-1">ğŸ“„</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ù…Ø§Ø¯Ø©</p>
                        <p className="font-bold text-sm mt-1">{formData.articleNumber || '-'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-1">ğŸ“</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„ÙÙ‚Ø±Ø©</p>
                        <p className="font-bold text-sm mt-1">{formData.clauseNumber || '-'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-1">ğŸ”–</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</p>
                        <p className="font-bold text-sm mt-1">{formData.regulationVersion || '-'}</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 3: Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙˆØ§Ù„ØªØµÙ†ÙŠÙ - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'program' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-emerald-500 to-teal-500 rounded-2xl p-5 text-white">
                    <div className="flex items-center gap-4">
                      <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                        <Layers className="w-7 h-7" />
                      </div>
                      <div>
                        <h3 className="text-xl font-black">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙˆØ§Ù„ØªØµÙ†ÙŠÙ</h3>
                        <p className="text-emerald-100 text-sm">Regulatory Program & Classification</p>
                      </div>
                    </div>
                  </div>

                  {/* Program Selection - Cards */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <Building2 className="w-5 h-5 text-emerald-500" />
                        Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ <span className="text-red-500">*</span>
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-3 gap-3 mb-4">
                        {[
                          { id: 'shomoos', name: 'Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³', icon: 'ğŸ”', authority: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©', color: 'blue' },
                          { id: 'sama-cyber', name: 'SAMA Cyber', icon: 'ğŸ¦', authority: 'Ø³Ø§Ù…Ø§', color: 'purple' },
                          { id: 'nca-ecc', name: 'NCA ECC', icon: 'ğŸ›¡ï¸', authority: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ©', color: 'red' },
                          { id: 'pdpl', name: 'PDPL', icon: 'ğŸ“‹', authority: 'SDAIA', color: 'indigo' },
                          { id: 'zatca-vat', name: 'ZATCA VAT', icon: 'ğŸ’°', authority: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø©', color: 'green' },
                          { id: 'cma-aml', name: 'CMA AML', icon: 'ğŸ›ï¸', authority: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚', color: 'amber' },
                          { id: 'mhrsd', name: 'MHRSD Labor', icon: 'ğŸ‘¥', authority: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', color: 'cyan' },
                          { id: 'civil-defense', name: 'Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ', icon: 'ğŸš’', authority: 'Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ', color: 'orange' },
                          { id: 'gahar', name: 'GAHAR', icon: 'ğŸ¥', authority: 'CBAHI', color: 'pink' },
                        ].map(prog => {
                          const isSelected = formData.programId === prog.id;
                          return (
                            <button key={prog.id} type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, programId: prog.id, programName: prog.name })}
                              className={`p-4 rounded-xl border-2 text-right transition-all transform hover:scale-[1.02] ${isSelected
                                  ? `bg-${prog.color}-50 border-${prog.color}-400 shadow-lg`
                                  : 'bg-white border-slate-200 hover:border-slate-300'
                                }`}>
                              <div className="flex items-center gap-3">
                                <span className="text-2xl">{prog.icon}</span>
                                <div className="flex-1">
                                  <p className={`font-bold ${isSelected ? `text-${prog.color}-700` : 'text-slate-700'}`}>{prog.name}</p>
                                  <p className="text-xs text-slate-500">{prog.authority}</p>
                                </div>
                                {isSelected && <CheckCircle2 className={`w-5 h-5 text-${prog.color}-500`} />}
                              </div>
                            </button>
                          );
                        })}
                      </div>

                      {/* International Programs */}
                      <div className="border-t border-slate-200 pt-4 mt-4">
                        <p className="text-sm font-bold text-slate-500 mb-3">ğŸŒ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</p>
                        <div className="grid grid-cols-4 gap-3">
                          {[
                            { id: 'iso27001', name: 'ISO 27001', icon: 'ğŸŒ' },
                            { id: 'gdpr', name: 'GDPR', icon: 'ğŸ‡ªğŸ‡º' },
                            { id: 'pci-dss', name: 'PCI DSS', icon: 'ğŸ’³' },
                            { id: 'soc2', name: 'SOC 2', icon: 'ğŸ“Š' },
                          ].map(prog => {
                            const isSelected = formData.programId === prog.id;
                            return (
                              <button key={prog.id} type="button" disabled={modalMode === 'view'}
                                onClick={() => setFormData({ ...formData, programId: prog.id, programName: prog.name })}
                                className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-violet-50 border-violet-400' : 'bg-white border-slate-200 hover:border-violet-300'
                                  }`}>
                                <span className="text-xl">{prog.icon}</span>
                                <p className={`text-sm font-bold mt-1 ${isSelected ? 'text-violet-700' : 'text-slate-600'}`}>{prog.name}</p>
                              </button>
                            );
                          })}
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Obligation Classification */}
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-purple-50 px-5 py-3 border-b border-purple-100">
                        <h4 className="font-bold text-purple-700 flex items-center gap-2">
                          <Tag className="w-5 h-5" />
                          ØªØµÙ†ÙŠÙ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…
                        </h4>
                      </div>
                      <div className="p-4 space-y-2">
                        {[
                          { value: 'regulatory', label: 'ğŸ“‹ ØªÙ†Ø¸ÙŠÙ…ÙŠ', desc: 'Ù…ØªØ·Ù„Ø¨ Ù…Ù† Ø¬Ù‡Ø© Ø±Ù‚Ø§Ø¨ÙŠØ©' },
                          { value: 'legal', label: 'âš–ï¸ Ù‚Ø§Ù†ÙˆÙ†ÙŠ', desc: 'Ù†Øµ Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ù…Ù„Ø²Ù…' },
                          { value: 'contractual', label: 'ğŸ“ ØªØ¹Ø§Ù‚Ø¯ÙŠ', desc: 'Ø§Ù„ØªØ²Ø§Ù… ØªØ¹Ø§Ù‚Ø¯ÙŠ' },
                          { value: 'internal', label: 'ğŸ¢ Ø¯Ø§Ø®Ù„ÙŠ', desc: 'Ø³ÙŠØ§Ø³Ø© Ø¯Ø§Ø®Ù„ÙŠØ©' },
                          { value: 'industry', label: 'ğŸ­ ØµÙ†Ø§Ø¹ÙŠ', desc: 'Ù…Ø¹ÙŠØ§Ø± ØµÙ†Ø§Ø¹ÙŠ' },
                        ].map(cat => (
                          <button key={cat.value} type="button" disabled={modalMode === 'view'}
                            onClick={() => setFormData({ ...formData, obligationType: cat.value })}
                            className={`w-full p-3 rounded-xl border-2 text-right transition-all flex items-center justify-between ${formData.obligationType === cat.value ? 'bg-purple-50 border-purple-400' : 'bg-white border-slate-200 hover:border-purple-300'
                              }`}>
                            <div>
                              <p className="font-bold text-slate-700">{cat.label}</p>
                              <p className="text-xs text-slate-500">{cat.desc}</p>
                            </div>
                            {formData.obligationType === cat.value && <CheckCircle2 className="w-5 h-5 text-purple-500" />}
                          </button>
                        ))}
                      </div>
                    </div>

                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-blue-50 px-5 py-3 border-b border-blue-100">
                        <h4 className="font-bold text-blue-700 flex items-center gap-2">
                          <Shield className="w-5 h-5" />
                          Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© (Control Type)
                        </h4>
                      </div>
                      <div className="p-4 space-y-2">
                        {[
                          { value: 'preventive', label: 'ğŸ›¡ï¸ ÙˆÙ‚Ø§Ø¦ÙŠ', desc: 'ÙŠÙ…Ù†Ø¹ Ø­Ø¯ÙˆØ« Ø§Ù„Ù…Ø®Ø§Ø·Ø±' },
                          { value: 'detective', label: 'ğŸ” ÙƒØ´ÙÙŠ', desc: 'ÙŠÙƒØªØ´Ù Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª' },
                          { value: 'corrective', label: 'ğŸ”§ ØªØµØ­ÙŠØ­ÙŠ', desc: 'ÙŠØµØ­Ø­ Ø§Ù„Ø§Ù†Ø­Ø±Ø§ÙØ§Øª' },
                          { value: 'directive', label: 'ğŸ“‹ ØªÙˆØ¬ÙŠÙ‡ÙŠ', desc: 'ÙŠÙˆØ¬Ù‡ Ø§Ù„Ø³Ù„ÙˆÙƒ' },
                          { value: 'compensating', label: 'âš–ï¸ ØªØ¹ÙˆÙŠØ¶ÙŠ', desc: 'ÙŠØ¹ÙˆØ¶ Ø¹Ù† Ø¶Ø§Ø¨Ø· Ø¢Ø®Ø±' },
                        ].map(ctrl => (
                          <button key={ctrl.value} type="button" disabled={modalMode === 'view'}
                            onClick={() => setFormData({ ...formData, controlType: ctrl.value })}
                            className={`w-full p-3 rounded-xl border-2 text-right transition-all flex items-center justify-between ${formData.controlType === ctrl.value ? 'bg-blue-50 border-blue-400' : 'bg-white border-slate-200 hover:border-blue-300'
                              }`}>
                            <div>
                              <p className="font-bold text-slate-700">{ctrl.label}</p>
                              <p className="text-xs text-slate-500">{ctrl.desc}</p>
                            </div>
                            {formData.controlType === ctrl.value && <CheckCircle2 className="w-5 h-5 text-blue-500" />}
                          </button>
                        ))}
                      </div>
                    </div>
                  </div>

                  {/* Domain & Scope */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-amber-50 px-5 py-3 border-b border-amber-100">
                      <h4 className="font-bold text-amber-700 flex items-center gap-2">
                        <Globe className="w-5 h-5" />
                        Ø§Ù„Ù…Ø¬Ø§Ù„ ÙˆØ§Ù„Ù†Ø·Ø§Ù‚
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-4 gap-3">
                        {[
                          { value: 'cybersecurity', label: 'Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', icon: 'ğŸ”’' },
                          { value: 'data_privacy', label: 'Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', icon: 'ğŸ”' },
                          { value: 'financial', label: 'Ù…Ø§Ù„ÙŠ ÙˆÙ…Ø­Ø§Ø³Ø¨ÙŠ', icon: 'ğŸ’°' },
                          { value: 'hr_labor', label: 'Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©', icon: 'ğŸ‘¥' },
                          { value: 'health_safety', label: 'ØµØ­Ø© ÙˆØ³Ù„Ø§Ù…Ø©', icon: 'ğŸ¥' },
                          { value: 'environment', label: 'Ø¨ÙŠØ¦Ø©', icon: 'ğŸŒ¿' },
                          { value: 'quality', label: 'Ø¬ÙˆØ¯Ø©', icon: 'âœ…' },
                          { value: 'operations', label: 'ØªØ´ØºÙŠÙ„', icon: 'âš™ï¸' },
                        ].map(domain => {
                          const isSelected = (formData.domains || []).includes(domain.value);
                          return (
                            <button key={domain.value} type="button" disabled={modalMode === 'view'}
                              onClick={() => {
                                if (isSelected) {
                                  setFormData({ ...formData, domains: (formData.domains || []).filter(d => d !== domain.value) });
                                } else {
                                  setFormData({ ...formData, domains: [...(formData.domains || []), domain.value] });
                                }
                              }}
                              className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-amber-50 border-amber-400' : 'bg-white border-slate-200 hover:border-amber-300'
                                }`}>
                              <span className="text-2xl">{domain.icon}</span>
                              <p className={`text-xs font-bold mt-1 ${isSelected ? 'text-amber-700' : 'text-slate-600'}`}>{domain.label}</p>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Tags & Keywords */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <Hash className="w-5 h-5 text-slate-500" />
                        Ø§Ù„ÙˆØ³ÙˆÙ… ÙˆØ§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
                      </h4>
                    </div>
                    <div className="p-4">
                      <div className="flex gap-2 mb-3">
                        <input type="text" id="tagInput" placeholder="Ø£Ø¶Ù ÙˆØ³Ù… Ø¬Ø¯ÙŠØ¯..."
                          disabled={modalMode === 'view'}
                          className="flex-1 px-4 py-2.5 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none"
                          onKeyPress={(e) => {
                            if (e.key === 'Enter' && e.target.value.trim()) {
                              setFormData({ ...formData, tags: [...(formData.tags || []), e.target.value.trim()] });
                              e.target.value = '';
                            }
                          }} />
                        <button type="button" disabled={modalMode === 'view'}
                          onClick={() => {
                            const input = document.getElementById('tagInput');
                            if (input.value.trim()) {
                              setFormData({ ...formData, tags: [...(formData.tags || []), input.value.trim()] });
                              input.value = '';
                            }
                          }}
                          className="px-4 py-2.5 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600 disabled:opacity-50">
                          <Plus className="w-5 h-5" />
                        </button>
                      </div>
                      <div className="flex flex-wrap gap-2">
                        {(formData.tags || []).map((tag, idx) => (
                          <span key={idx} className="inline-flex items-center gap-1 px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-full text-sm font-bold">
                            #{tag}
                            {modalMode !== 'view' && (
                              <button type="button" onClick={() => setFormData({ ...formData, tags: formData.tags.filter((_, i) => i !== idx) })}
                                className="hover:bg-emerald-200 rounded-full p-0.5">
                                <X className="w-3 h-3" />
                              </button>
                            )}
                          </span>
                        ))}
                        {(!formData.tags || formData.tags.length === 0) && (
                          <p className="text-slate-400 text-sm">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© ÙˆØ³ÙˆÙ… Ø¨Ø¹Ø¯</p>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Selection Summary */}
                  {formData.programId && (
                    <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-5 border border-emerald-200">
                      <h4 className="font-bold text-emerald-700 mb-3 flex items-center gap-2">
                        <CheckCircle2 className="w-5 h-5" />
                        Ù…Ù„Ø®Øµ Ø§Ù„ØªØµÙ†ÙŠÙ
                      </h4>
                      <div className="grid grid-cols-4 gap-4">
                        <div className="bg-white rounded-xl p-3 text-center">
                          <p className="text-2xl mb-1">{formData.programId === 'shomoos' ? 'ğŸ”' : formData.programId === 'sama-cyber' ? 'ğŸ¦' : 'ğŸ“‹'}</p>
                          <p className="text-xs text-slate-500">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
                          <p className="font-bold text-slate-700 text-sm">{formData.programName || formData.programId}</p>
                        </div>
                        <div className="bg-white rounded-xl p-3 text-center">
                          <p className="text-2xl mb-1">{formData.obligationType === 'regulatory' ? 'ğŸ“‹' : formData.obligationType === 'legal' ? 'âš–ï¸' : 'ğŸ“'}</p>
                          <p className="text-xs text-slate-500">Ø§Ù„ØªØµÙ†ÙŠÙ</p>
                          <p className="font-bold text-slate-700 text-sm">{formData.obligationType || '-'}</p>
                        </div>
                        <div className="bg-white rounded-xl p-3 text-center">
                          <p className="text-2xl mb-1">{formData.controlType === 'preventive' ? 'ğŸ›¡ï¸' : formData.controlType === 'detective' ? 'ğŸ”' : 'ğŸ”§'}</p>
                          <p className="text-xs text-slate-500">Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø©</p>
                          <p className="font-bold text-slate-700 text-sm">{formData.controlType || '-'}</p>
                        </div>
                        <div className="bg-white rounded-xl p-3 text-center">
                          <p className="text-2xl mb-1">ğŸ·ï¸</p>
                          <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª</p>
                          <p className="font-bold text-slate-700 text-sm">{(formData.domains || []).length} Ù…Ø¬Ø§Ù„</p>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 4: Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'applicability' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-amber-500 via-orange-500 to-yellow-500 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <CheckSquare className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª</h3>
                          <p className="text-amber-100 text-sm">Applicability & Exceptions Management</p>
                        </div>
                      </div>
                      <div className={`px-4 py-2 rounded-xl ${formData.applicability === 'applicable' || !formData.applicability ? 'bg-emerald-500' :
                          formData.applicability === 'partial' ? 'bg-amber-600' : 'bg-red-500'
                        }`}>
                        <p className="text-xs opacity-80">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</p>
                        <p className="font-bold">
                          {formData.applicability === 'applicable' || !formData.applicability ? 'âœ… Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚' :
                            formData.applicability === 'partial' ? 'âš ï¸ Ø¬Ø²Ø¦ÙŠ' : 'âŒ ØºÙŠØ± Ù‚Ø§Ø¨Ù„'}
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Applicability Status Selection */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <Target className="w-5 h-5 text-amber-500" />
                        Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Applicability Status)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-3 gap-4">
                        {/* Applicable */}
                        <button type="button" disabled={modalMode === 'view'}
                          onClick={() => setFormData({ ...formData, applicability: 'applicable' })}
                          className={`p-6 rounded-2xl border-3 transition-all transform hover:scale-[1.02] ${formData.applicability === 'applicable' || !formData.applicability
                              ? 'bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-400 shadow-lg shadow-emerald-500/20'
                              : 'bg-white border-slate-200 hover:border-emerald-300'
                            }`}>
                          <div className={`w-20 h-20 mx-auto rounded-2xl flex items-center justify-center mb-4 ${formData.applicability === 'applicable' || !formData.applicability
                              ? 'bg-emerald-500 shadow-lg shadow-emerald-500/50' : 'bg-slate-100'
                            }`}>
                            <CheckCircle2 className={`w-10 h-10 ${formData.applicability === 'applicable' || !formData.applicability ? 'text-white' : 'text-slate-400'
                              }`} />
                          </div>
                          <p className={`font-black text-lg ${formData.applicability === 'applicable' || !formData.applicability ? 'text-emerald-700' : 'text-slate-700'
                            }`}>Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</p>
                          <p className="text-sm text-slate-500 mt-1">Fully Applicable</p>
                          <p className="text-xs text-slate-400 mt-2">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙŠÙ†Ø·Ø¨Ù‚ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©</p>
                          {(formData.applicability === 'applicable' || !formData.applicability) && (
                            <div className="mt-3 px-3 py-1.5 bg-emerald-500 text-white rounded-full text-xs font-bold inline-block">
                              âœ“ Ù…Ø­Ø¯Ø¯
                            </div>
                          )}
                        </button>

                        {/* Partial */}
                        <button type="button" disabled={modalMode === 'view'}
                          onClick={() => setFormData({ ...formData, applicability: 'partial' })}
                          className={`p-6 rounded-2xl border-3 transition-all transform hover:scale-[1.02] ${formData.applicability === 'partial'
                              ? 'bg-gradient-to-br from-amber-50 to-orange-50 border-amber-400 shadow-lg shadow-amber-500/20'
                              : 'bg-white border-slate-200 hover:border-amber-300'
                            }`}>
                          <div className={`w-20 h-20 mx-auto rounded-2xl flex items-center justify-center mb-4 ${formData.applicability === 'partial'
                              ? 'bg-amber-500 shadow-lg shadow-amber-500/50' : 'bg-slate-100'
                            }`}>
                            <AlertTriangle className={`w-10 h-10 ${formData.applicability === 'partial' ? 'text-white' : 'text-slate-400'
                              }`} />
                          </div>
                          <p className={`font-black text-lg ${formData.applicability === 'partial' ? 'text-amber-700' : 'text-slate-700'
                            }`}>ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø²Ø¦ÙŠ</p>
                          <p className="text-sm text-slate-500 mt-1">Partially Applicable</p>
                          <p className="text-xs text-slate-400 mt-2">Ø¨Ø¹Ø¶ Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙÙ‚Ø· ØªÙ†Ø·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©</p>
                          {formData.applicability === 'partial' && (
                            <div className="mt-3 px-3 py-1.5 bg-amber-500 text-white rounded-full text-xs font-bold inline-block">
                              âš  ÙŠØªØ·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡
                            </div>
                          )}
                        </button>

                        {/* Not Applicable */}
                        <button type="button" disabled={modalMode === 'view'}
                          onClick={() => setFormData({ ...formData, applicability: 'not_applicable' })}
                          className={`p-6 rounded-2xl border-3 transition-all transform hover:scale-[1.02] ${formData.applicability === 'not_applicable'
                              ? 'bg-gradient-to-br from-red-50 to-rose-50 border-red-400 shadow-lg shadow-red-500/20'
                              : 'bg-white border-slate-200 hover:border-red-300'
                            }`}>
                          <div className={`w-20 h-20 mx-auto rounded-2xl flex items-center justify-center mb-4 ${formData.applicability === 'not_applicable'
                              ? 'bg-red-500 shadow-lg shadow-red-500/50' : 'bg-slate-100'
                            }`}>
                            <XCircle className={`w-10 h-10 ${formData.applicability === 'not_applicable' ? 'text-white' : 'text-slate-400'
                              }`} />
                          </div>
                          <p className={`font-black text-lg ${formData.applicability === 'not_applicable' ? 'text-red-700' : 'text-slate-700'
                            }`}>ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</p>
                          <p className="text-sm text-slate-500 mt-1">Not Applicable</p>
                          <p className="text-xs text-slate-400 mt-2">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ù„Ø§ ÙŠÙ†Ø·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø·Ø¨ÙŠØ¹Ø© Ø¹Ù…Ù„ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©</p>
                          {formData.applicability === 'not_applicable' && (
                            <div className="mt-3 px-3 py-1.5 bg-red-500 text-white rounded-full text-xs font-bold inline-block">
                              âœ— ÙŠØªØ·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø±Ø³Ù…ÙŠ
                            </div>
                          )}
                        </button>
                      </div>
                    </div>
                  </div>

                  {/* Scope of Application */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-blue-50 px-5 py-3 border-b border-blue-100">
                      <h4 className="font-bold text-blue-700 flex items-center gap-2">
                        <Building2 className="w-5 h-5" />
                        Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Scope of Application)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-4 gap-3">
                        {[
                          { value: 'all_org', label: 'ÙƒÙ„ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©', icon: 'ğŸ¢', desc: 'ÙŠÙ†Ø·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª' },
                          { value: 'it_dept', label: 'Ø¥Ø¯Ø§Ø±Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', icon: 'ğŸ’»', desc: 'IT Department' },
                          { value: 'hr_dept', label: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', icon: 'ğŸ‘¥', desc: 'HR Department' },
                          { value: 'finance', label: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©', icon: 'ğŸ’°', desc: 'Finance Department' },
                          { value: 'operations', label: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', icon: 'âš™ï¸', desc: 'Operations' },
                          { value: 'legal', label: 'Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©', icon: 'âš–ï¸', desc: 'Legal Affairs' },
                          { value: 'security', label: 'Ø§Ù„Ø£Ù…Ù†', icon: 'ğŸ”’', desc: 'Security' },
                          { value: 'compliance', label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', icon: 'âœ…', desc: 'Compliance' },
                        ].map(scope => {
                          const isSelected = (formData.applicationScope || ['all_org']).includes(scope.value);
                          return (
                            <button key={scope.value} type="button" disabled={modalMode === 'view'}
                              onClick={() => {
                                const current = formData.applicationScope || ['all_org'];
                                if (isSelected) {
                                  setFormData({ ...formData, applicationScope: current.filter(s => s !== scope.value) });
                                } else {
                                  setFormData({ ...formData, applicationScope: [...current.filter(s => s !== 'all_org'), scope.value] });
                                }
                              }}
                              className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-blue-50 border-blue-400' : 'bg-white border-slate-200 hover:border-blue-300'
                                }`}>
                              <span className="text-2xl">{scope.icon}</span>
                              <p className={`text-sm font-bold mt-1 ${isSelected ? 'text-blue-700' : 'text-slate-700'}`}>{scope.label}</p>
                              <p className="text-xs text-slate-400">{scope.desc}</p>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Exception Form - Only for Partial or Not Applicable */}
                  {(formData.applicability === 'not_applicable' || formData.applicability === 'partial') && (
                    <div className="bg-white rounded-2xl border-2 border-red-200 overflow-hidden">
                      <div className="bg-gradient-to-r from-red-500 to-rose-500 px-5 py-4 text-white">
                        <div className="flex items-center gap-3">
                          <div className="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center">
                            <AlertCircle className="w-6 h-6" />
                          </div>
                          <div>
                            <h4 className="font-bold">Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø±Ø³Ù…ÙŠ (Exception Request)</h4>
                            <p className="text-red-200 text-sm">ÙŠØ¬Ø¨ ØªÙˆØ«ÙŠÙ‚ Ù…Ø¨Ø±Ø±Ø§Øª Ø¹Ø¯Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© Ø±Ø³Ù…ÙŠØ©</p>
                          </div>
                        </div>
                      </div>
                      <div className="p-5 space-y-5">
                        {/* Exception Reason */}
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">
                            Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ <span className="text-red-500">*</span>
                          </label>
                          <select value={formData.exceptionReason || ''}
                            onChange={(e) => setFormData({ ...formData, exceptionReason: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-red-400">
                            <option value="">Ø§Ø®ØªØ± Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡...</option>
                            <option value="not_in_scope">Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø¹Ù…Ù„ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©</option>
                            <option value="different_industry">Ù‚Ø·Ø§Ø¹ ØµÙ†Ø§Ø¹ÙŠ Ù…Ø®ØªÙ„Ù</option>
                            <option value="size_threshold">Ø­Ø¬Ù… Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</option>
                            <option value="geographic">Ù‚ÙŠÙˆØ¯ Ø¬ØºØ±Ø§ÙÙŠØ©</option>
                            <option value="technical">Ù‚ÙŠÙˆØ¯ ØªÙ‚Ù†ÙŠØ©</option>
                            <option value="compensating_control">ÙŠÙˆØ¬Ø¯ Ø¶Ø§Ø¨Ø· ØªØ¹ÙˆÙŠØ¶ÙŠ Ø¨Ø¯ÙŠÙ„</option>
                            <option value="regulatory_exemption">Ø¥Ø¹ÙØ§Ø¡ ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø±Ø³Ù…ÙŠ</option>
                            <option value="other">Ø£Ø®Ø±Ù‰</option>
                          </select>
                        </div>

                        {/* Justification */}
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">
                            Ø§Ù„Ù…Ø¨Ø±Ø± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ <span className="text-red-500">*</span>
                          </label>
                          <textarea value={formData.exceptionJustification || ''}
                            onChange={(e) => setFormData({ ...formData, exceptionJustification: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-red-400 focus:outline-none h-28 resize-none"
                            placeholder="Ø§Ø´Ø±Ø­ Ø¨Ø§Ù„ØªÙØµÙŠÙ„ Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù†Ø·Ø¨Ø§Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¸Ù…Ø© ÙˆÙ…Ø§ Ù‡ÙŠ Ø§Ù„Ø¨Ø¯Ø§Ø¦Ù„ Ø§Ù„Ù…ØªØ§Ø­Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª..." />
                        </div>

                        {/* Compensating Control */}
                        <div className="bg-amber-50 rounded-xl p-4 border border-amber-200">
                          <div className="flex items-center justify-between mb-3">
                            <label className="font-bold text-amber-700 flex items-center gap-2">
                              <Shield className="w-5 h-5" />
                              Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¶Ø§Ø¨Ø· ØªØ¹ÙˆÙŠØ¶ÙŠ Ø¨Ø¯ÙŠÙ„ØŸ
                            </label>
                            <label className="relative inline-flex items-center cursor-pointer">
                              <input type="checkbox" checked={formData.hasCompensatingControl || false}
                                onChange={(e) => setFormData({ ...formData, hasCompensatingControl: e.target.checked })}
                                disabled={modalMode === 'view'} className="sr-only peer" />
                              <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-amber-500"></div>
                            </label>
                          </div>
                          {formData.hasCompensatingControl && (
                            <textarea value={formData.compensatingControlDesc || ''}
                              onChange={(e) => setFormData({ ...formData, compensatingControlDesc: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-amber-200 rounded-xl disabled:bg-white focus:border-amber-400 focus:outline-none h-20 resize-none"
                              placeholder="ØµÙ Ø§Ù„Ø¶Ø§Ø¨Ø· Ø§Ù„ØªØ¹ÙˆÙŠØ¶ÙŠ Ø§Ù„Ø¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø·Ø¨Ù‚..." />
                          )}
                        </div>

                        {/* Risk Assessment */}
                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</label>
                            <div className="flex gap-2">
                              {[
                                { value: 'low', label: 'Ù…Ù†Ø®ÙØ¶', color: 'green' },
                                { value: 'medium', label: 'Ù…ØªÙˆØ³Ø·', color: 'amber' },
                                { value: 'high', label: 'Ø¹Ø§Ù„ÙŠ', color: 'red' },
                              ].map(risk => (
                                <button key={risk.value} type="button" disabled={modalMode === 'view'}
                                  onClick={() => setFormData({ ...formData, residualRisk: risk.value })}
                                  className={`flex-1 py-3 rounded-xl border-2 font-bold text-sm transition-all ${formData.residualRisk === risk.value
                                      ? `bg-${risk.color}-100 border-${risk.color}-400 text-${risk.color}-700`
                                      : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300'
                                    }`}>
                                  {risk.label}
                                </button>
                              ))}
                            </div>
                          </div>
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡</label>
                            <input type="date" value={formData.exceptionReviewDate || ''}
                              onChange={(e) => setFormData({ ...formData, exceptionReviewDate: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-red-400" />
                          </div>
                        </div>

                        {/* Approval Section */}
                        <div className="bg-slate-50 rounded-xl p-4">
                          <h5 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                            <UserCheck className="w-5 h-5 text-purple-500" />
                            Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯
                          </h5>
                          <div className="grid grid-cols-3 gap-4">
                            <div>
                              <label className="block text-xs font-bold text-slate-500 mb-1">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ (Approver) *</label>
                              <input type="text" value={formData.exceptionApprover || ''}
                                onChange={(e) => setFormData({ ...formData, exceptionApprover: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-purple-400"
                                placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹ØªÙ…Ø¯" />
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-500 mb-1">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</label>
                              <input type="text" value={formData.approverTitle || ''}
                                onChange={(e) => setFormData({ ...formData, approverTitle: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-purple-400"
                                placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¯ÙŠØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…" />
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ *</label>
                              <input type="date" value={formData.exceptionDate || ''}
                                onChange={(e) => setFormData({ ...formData, exceptionDate: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-purple-400" />
                            </div>
                          </div>
                        </div>

                        {/* Exception Status */}
                        <div className="flex items-center justify-between p-4 bg-slate-100 rounded-xl">
                          <div>
                            <p className="font-bold text-slate-700">Ø­Ø§Ù„Ø© Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡</p>
                            <p className="text-sm text-slate-500">Exception Request Status</p>
                          </div>
                          <select value={formData.exceptionStatus || 'pending'}
                            onChange={(e) => setFormData({ ...formData, exceptionStatus: e.target.value })}
                            disabled={modalMode === 'view'}
                            className={`px-4 py-2.5 rounded-xl font-bold border-2 ${formData.exceptionStatus === 'approved' ? 'bg-green-100 border-green-400 text-green-700' :
                                formData.exceptionStatus === 'rejected' ? 'bg-red-100 border-red-400 text-red-700' :
                                  formData.exceptionStatus === 'under_review' ? 'bg-blue-100 border-blue-400 text-blue-700' :
                                    'bg-amber-100 border-amber-400 text-amber-700'
                              }`}>
                            <option value="pending">â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                            <option value="under_review">ğŸ” Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                            <option value="approved">âœ… Ù…Ø¹ØªÙ…Ø¯</option>
                            <option value="rejected">âŒ Ù…Ø±ÙÙˆØ¶</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Summary Dashboard */}
                  <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                    <h4 className="font-bold mb-4 flex items-center gap-2">
                      <BarChart3 className="w-5 h-5 text-amber-400" />
                      Ù…Ù„Ø®Øµ Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                    </h4>
                    <div className="grid grid-cols-4 gap-4">
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className={`text-4xl mb-2 ${formData.applicability === 'applicable' || !formData.applicability ? '' :
                            formData.applicability === 'partial' ? '' : ''
                          }`}>
                          {formData.applicability === 'applicable' || !formData.applicability ? 'âœ…' :
                            formData.applicability === 'partial' ? 'âš ï¸' : 'âŒ'}
                        </p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø­Ø§Ù„Ø©</p>
                        <p className="font-bold text-sm mt-1">
                          {formData.applicability === 'applicable' || !formData.applicability ? 'Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚' :
                            formData.applicability === 'partial' ? 'Ø¬Ø²Ø¦ÙŠ' : 'ØºÙŠØ± Ù‚Ø§Ø¨Ù„'}
                        </p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-4xl mb-2">ğŸ¢</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ù†Ø·Ø§Ù‚</p>
                        <p className="font-bold text-sm mt-1">{(formData.applicationScope || ['all_org']).length} Ø¥Ø¯Ø§Ø±Ø©</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-4xl mb-2">ğŸ“‹</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡</p>
                        <p className="font-bold text-sm mt-1">
                          {formData.applicability === 'applicable' || !formData.applicability ? 'ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨' :
                            formData.exceptionStatus === 'approved' ? 'Ù…Ø¹ØªÙ…Ø¯' : 'Ù…Ø·Ù„ÙˆØ¨'}
                        </p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className={`text-4xl mb-2`}>
                          {formData.residualRisk === 'low' ? 'ğŸŸ¢' :
                            formData.residualRisk === 'medium' ? 'ğŸŸ¡' :
                              formData.residualRisk === 'high' ? 'ğŸ”´' : 'âšª'}
                        </p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</p>
                        <p className="font-bold text-sm mt-1">
                          {formData.residualRisk === 'low' ? 'Ù…Ù†Ø®ÙØ¶' :
                            formData.residualRisk === 'medium' ? 'Ù…ØªÙˆØ³Ø·' :
                              formData.residualRisk === 'high' ? 'Ø¹Ø§Ù„ÙŠ' : '-'}
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 5: Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø© - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'evidence' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-teal-500 to-cyan-500 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <FileCheck className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„Ø¥Ø«Ø¨Ø§Øª</h3>
                          <p className="text-teal-100 text-sm">Evidence Requirements & Attachments</p>
                        </div>
                      </div>
                      <div className="text-left">
                        <p className="text-teal-200 text-xs">Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø©</p>
                        <p className="text-4xl font-black">{(formData.attachments || []).length}</p>
                      </div>
                    </div>
                  </div>

                  {/* Evidence Toggle */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="p-5 flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all ${formData.evidenceRequired !== false ? 'bg-teal-100' : 'bg-slate-100'
                          }`}>
                          <FileCheck className={`w-7 h-7 ${formData.evidenceRequired !== false ? 'text-teal-600' : 'text-slate-400'}`} />
                        </div>
                        <div>
                          <p className="font-bold text-slate-800 text-lg">Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø£Ø¯Ù„Ø© Ø¥Ø«Ø¨Ø§ØªØŸ</p>
                          <p className="text-slate-500 text-sm">ØªÙØ¹ÙŠÙ„ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                        </div>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={formData.evidenceRequired !== false} onChange={(e) => setFormData({ ...formData, evidenceRequired: e.target.checked })}
                          disabled={modalMode === 'view'} className="sr-only peer" />
                        <div className="w-16 h-8 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-teal-500 shadow-inner"></div>
                        <span className="mr-3 text-lg font-black text-slate-700">{formData.evidenceRequired !== false ? 'âœ… Ù†Ø¹Ù…' : 'âŒ Ù„Ø§'}</span>
                      </label>
                    </div>
                  </div>

                  {formData.evidenceRequired !== false && (
                    <>
                      {/* Evidence Types - Interactive Cards */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-slate-50 px-5 py-3 border-b border-slate-200 flex items-center justify-between">
                          <h4 className="font-bold text-slate-700 flex items-center gap-2">
                            <Layers className="w-5 h-5 text-teal-500" />
                            Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                          </h4>
                          <span className="px-3 py-1 bg-teal-100 text-teal-700 rounded-full text-sm font-bold">
                            {(formData.evidenceTypes || []).length} Ù†ÙˆØ¹ Ù…Ø­Ø¯Ø¯
                          </span>
                        </div>
                        <div className="p-5">
                          <div className="grid grid-cols-3 gap-3">
                            {[
                              { value: 'certificate', label: 'Ø´Ù‡Ø§Ø¯Ø© Ø±Ø³Ù…ÙŠØ©', icon: 'ğŸ“œ', desc: 'Ø´Ù‡Ø§Ø¯Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø£Ùˆ Ø§Ø¹ØªÙ…Ø§Ø¯' },
                              { value: 'audit_report', label: 'ØªÙ‚Ø±ÙŠØ± ØªØ¯Ù‚ÙŠÙ‚', icon: 'ğŸ“Š', desc: 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚' },
                              { value: 'system_log', label: 'Ø³Ø¬Ù„ Ù†Ø¸Ø§Ù…', icon: 'ğŸ’»', desc: 'Ø³Ø¬Ù„Ø§Øª Ù…Ù† Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©' },
                              { value: 'screenshot', label: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', icon: 'ğŸ“¸', desc: 'ØµÙˆØ± Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© ÙƒØ¯Ù„ÙŠÙ„' },
                              { value: 'meeting_minutes', label: 'Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹', icon: 'ğŸ“', desc: 'Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ©' },
                              { value: 'policy_doc', label: 'ÙˆØ«ÙŠÙ‚Ø© Ø³ÙŠØ§Ø³Ø©', icon: 'ğŸ“‹', desc: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©' },
                              { value: 'contract', label: 'Ø¹Ù‚Ø¯/Ø§ØªÙØ§Ù‚ÙŠØ©', icon: 'ğŸ“„', desc: 'Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ø§ØªÙØ§Ù‚ÙŠØ§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹Ø©' },
                              { value: 'photo', label: 'ØµÙˆØ±Ø© ÙÙˆØªÙˆØºØ±Ø§ÙÙŠØ©', icon: 'ğŸ“·', desc: 'ØµÙˆØ± ØªÙˆØ«ÙŠÙ‚ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹' },
                              { value: 'video', label: 'ØªØ³Ø¬ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ', icon: 'ğŸ¥', desc: 'ØªØ³Ø¬ÙŠÙ„Ø§Øª Ù…ØµÙˆØ±Ø©' },
                              { value: 'email', label: 'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', icon: 'ğŸ“§', desc: 'Ù…Ø±Ø§Ø³Ù„Ø§Øª Ø±Ø³Ù…ÙŠØ© Ù…ÙˆØ«Ù‚Ø©' },
                              { value: 'approval', label: 'Ù…ÙˆØ§ÙÙ‚Ø© Ø±Ø³Ù…ÙŠØ©', icon: 'âœ…', desc: 'Ø§Ø¹ØªÙ…Ø§Ø¯Ø§Øª ÙˆÙ…ÙˆØ§ÙÙ‚Ø§Øª' },
                              { value: 'training_record', label: 'Ø³Ø¬Ù„ ØªØ¯Ø±ÙŠØ¨', icon: 'ğŸ“', desc: 'Ø´Ù‡Ø§Ø¯Ø§Øª ÙˆØ³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨' },
                            ].map(type => {
                              const isSelected = (formData.evidenceTypes || []).includes(type.value);
                              return (
                                <button key={type.value} type="button" disabled={modalMode === 'view'}
                                  onClick={() => {
                                    if (isSelected) {
                                      setFormData({ ...formData, evidenceTypes: (formData.evidenceTypes || []).filter(t => t !== type.value) });
                                    } else {
                                      setFormData({ ...formData, evidenceTypes: [...(formData.evidenceTypes || []), type.value] });
                                    }
                                  }}
                                  className={`p-3 rounded-xl border-2 text-right transition-all transform hover:scale-[1.02] ${isSelected ? 'bg-teal-50 border-teal-400 shadow-md' : 'bg-white border-slate-200 hover:border-teal-300'
                                    }`}>
                                  <div className="flex items-center gap-3">
                                    <span className="text-2xl">{type.icon}</span>
                                    <div className="flex-1">
                                      <p className={`font-bold text-sm ${isSelected ? 'text-teal-700' : 'text-slate-700'}`}>{type.label}</p>
                                      <p className="text-xs text-slate-500">{type.desc}</p>
                                    </div>
                                    {isSelected && <CheckCircle2 className="w-5 h-5 text-teal-500" />}
                                  </div>
                                </button>
                              );
                            })}
                          </div>
                        </div>
                      </div>

                      {/* Evidence Settings */}
                      <div className="grid grid-cols-3 gap-4">
                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-blue-50 px-4 py-3 border-b border-blue-100">
                            <h4 className="font-bold text-blue-700 flex items-center gap-2 text-sm">
                              <Clock className="w-4 h-4" />
                              ÙØªØ±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
                            </h4>
                          </div>
                          <div className="p-4">
                            <div className="flex items-center gap-2">
                              <input type="number" min="1" value={formData.evidenceValidityDays || 365}
                                onChange={(e) => setFormData({ ...formData, evidenceValidityDays: parseInt(e.target.value) || 365 })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl text-center text-2xl font-black disabled:bg-slate-50 focus:border-blue-400" />
                            </div>
                            <p className="text-center text-slate-500 text-sm mt-2">ÙŠÙˆÙ…</p>
                            <div className="flex gap-2 mt-3">
                              {[30, 90, 180, 365].map(days => (
                                <button key={days} type="button" disabled={modalMode === 'view'}
                                  onClick={() => setFormData({ ...formData, evidenceValidityDays: days })}
                                  className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${formData.evidenceValidityDays === days ? 'bg-blue-500 text-white' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                                    }`}>
                                  {days}
                                </button>
                              ))}
                            </div>
                          </div>
                        </div>

                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-purple-50 px-4 py-3 border-b border-purple-100">
                            <h4 className="font-bold text-purple-700 flex items-center gap-2 text-sm">
                              <Hash className="w-4 h-4" />
                              Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø£Ø¯Ù„Ø©
                            </h4>
                          </div>
                          <div className="p-4">
                            <div className="flex items-center justify-center gap-3">
                              <button type="button" disabled={modalMode === 'view' || (formData.minEvidenceCount || 1) <= 1}
                                onClick={() => setFormData({ ...formData, minEvidenceCount: Math.max(1, (formData.minEvidenceCount || 1) - 1) })}
                                className="w-12 h-12 rounded-xl bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-black text-xl disabled:opacity-50">
                                -
                              </button>
                              <span className="text-4xl font-black text-purple-600 w-16 text-center">{formData.minEvidenceCount || 1}</span>
                              <button type="button" disabled={modalMode === 'view'}
                                onClick={() => setFormData({ ...formData, minEvidenceCount: (formData.minEvidenceCount || 1) + 1 })}
                                className="w-12 h-12 rounded-xl bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-black text-xl disabled:opacity-50">
                                +
                              </button>
                            </div>
                            <p className="text-center text-slate-500 text-sm mt-2">Ø¯Ù„ÙŠÙ„ Ù…Ø·Ù„ÙˆØ¨</p>
                          </div>
                        </div>

                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-amber-50 px-4 py-3 border-b border-amber-100">
                            <h4 className="font-bold text-amber-700 flex items-center gap-2 text-sm">
                              <AlertTriangle className="w-4 h-4" />
                              Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©
                            </h4>
                          </div>
                          <div className="p-4 space-y-2">
                            {[
                              { value: 'mandatory', label: 'Ø¥Ù„Ø²Ø§Ù…ÙŠ', color: 'red' },
                              { value: 'recommended', label: 'Ù…ÙˆØµÙ‰ Ø¨Ù‡', color: 'amber' },
                              { value: 'optional', label: 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ', color: 'green' },
                            ].map(level => (
                              <button key={level.value} type="button" disabled={modalMode === 'view'}
                                onClick={() => setFormData({ ...formData, evidenceLevel: level.value })}
                                className={`w-full p-2.5 rounded-xl border-2 text-sm font-bold transition-all flex items-center justify-between ${formData.evidenceLevel === level.value ? `bg-${level.color}-50 border-${level.color}-400` : 'bg-white border-slate-200 hover:border-slate-300'
                                  }`}>
                                <span>{level.label}</span>
                                {formData.evidenceLevel === level.value && <CheckCircle2 className={`w-4 h-4 text-${level.color}-500`} />}
                              </button>
                            ))}
                          </div>
                        </div>
                      </div>

                      {/* File Upload Section */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-gradient-to-r from-teal-50 to-cyan-50 px-5 py-3 border-b border-teal-100 flex items-center justify-between">
                          <h4 className="font-bold text-teal-700 flex items-center gap-2">
                            <Upload className="w-5 h-5" />
                            Ø¥Ø±ÙØ§Ù‚ Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª
                          </h4>
                          <span className="px-3 py-1 bg-teal-500 text-white rounded-full text-sm font-bold">
                            {(formData.attachments || []).length} Ù…Ù„Ù
                          </span>
                        </div>
                        <div className="p-5">
                          {/* Upload Zone */}
                          <div className={`border-3 border-dashed rounded-2xl p-8 text-center transition-all ${modalMode === 'view' ? 'bg-slate-50 border-slate-200' : 'bg-teal-50/50 border-teal-300 hover:border-teal-400 hover:bg-teal-50 cursor-pointer'
                            }`}>
                            <div className="w-16 h-16 mx-auto rounded-2xl bg-teal-100 flex items-center justify-center mb-4">
                              <Upload className="w-8 h-8 text-teal-600" />
                            </div>
                            <p className="font-bold text-slate-700 mb-1">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ­Ù…ÙŠÙ„</p>
                            <p className="text-sm text-slate-500">PDF, DOC, DOCX, XLS, XLSX, PNG, JPG, ZIP (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 25MB Ù„ÙƒÙ„ Ù…Ù„Ù)</p>
                            <button type="button" disabled={modalMode === 'view'}
                              onClick={() => {
                                const newAttachment = {
                                  id: Date.now(),
                                  name: `Ù…Ø³ØªÙ†Ø¯_${(formData.attachments || []).length + 1}.pdf`,
                                  size: '2.5 MB',
                                  type: 'PDF',
                                  uploadedAt: new Date().toLocaleDateString('ar-SA'),
                                  uploadedBy: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ',
                                  status: 'pending'
                                };
                                setFormData({ ...formData, attachments: [...(formData.attachments || []), newAttachment] });
                              }}
                              className="mt-4 px-6 py-2.5 bg-teal-500 text-white rounded-xl font-bold hover:bg-teal-600 disabled:opacity-50 transition-all">
                              <span className="flex items-center gap-2">
                                <Plus className="w-5 h-5" />
                                Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù (Ù…Ø­Ø§ÙƒØ§Ø©)
                              </span>
                            </button>
                          </div>

                          {/* Attached Files List */}
                          {(formData.attachments || []).length > 0 && (
                            <div className="mt-5 space-y-3">
                              <p className="font-bold text-slate-700">Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙ‚Ø©:</p>
                              {(formData.attachments || []).map((file, idx) => (
                                <div key={file.id || idx} className="flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200 hover:border-teal-300 transition-all">
                                  <div className="flex items-center gap-4">
                                    <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${file.type === 'PDF' ? 'bg-red-100 text-red-600' :
                                        file.type === 'DOC' || file.type === 'DOCX' ? 'bg-blue-100 text-blue-600' :
                                          file.type === 'XLS' || file.type === 'XLSX' ? 'bg-green-100 text-green-600' :
                                            'bg-slate-100 text-slate-600'
                                      }`}>
                                      <FileText className="w-6 h-6" />
                                    </div>
                                    <div>
                                      <p className="font-bold text-slate-800">{file.name}</p>
                                      <div className="flex items-center gap-3 text-sm text-slate-500">
                                        <span>{file.size}</span>
                                        <span>â€¢</span>
                                        <span>{file.uploadedAt}</span>
                                        <span>â€¢</span>
                                        <span>{file.uploadedBy}</span>
                                      </div>
                                    </div>
                                  </div>
                                  <div className="flex items-center gap-2">
                                    <span className={`px-3 py-1 rounded-full text-xs font-bold ${file.status === 'approved' ? 'bg-green-100 text-green-700' :
                                        file.status === 'rejected' ? 'bg-red-100 text-red-700' :
                                          'bg-amber-100 text-amber-700'
                                      }`}>
                                      {file.status === 'approved' ? 'âœ… Ù…Ø¹ØªÙ…Ø¯' : file.status === 'rejected' ? 'âŒ Ù…Ø±ÙÙˆØ¶' : 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'}
                                    </span>
                                    <button type="button" className="p-2 text-blue-500 hover:bg-blue-50 rounded-lg">
                                      <Eye className="w-5 h-5" />
                                    </button>
                                    <button type="button" className="p-2 text-slate-500 hover:bg-slate-100 rounded-lg">
                                      <Download className="w-5 h-5" />
                                    </button>
                                    {modalMode !== 'view' && (
                                      <button type="button" onClick={() => setFormData({ ...formData, attachments: formData.attachments.filter((_, i) => i !== idx) })}
                                        className="p-2 text-red-500 hover:bg-red-50 rounded-lg">
                                        <Trash2 className="w-5 h-5" />
                                      </button>
                                    )}
                                  </div>
                                </div>
                              ))}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Evidence Instructions */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                          <h4 className="font-bold text-slate-700 flex items-center gap-2">
                            <BookOpen className="w-5 h-5 text-slate-500" />
                            Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©
                          </h4>
                        </div>
                        <div className="p-4">
                          <textarea value={formData.evidenceInstructions || ''}
                            onChange={(e) => setFormData({ ...formData, evidenceInstructions: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-teal-400 focus:outline-none h-24 resize-none"
                            placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù…Ø­Ø¯Ø¯Ø© Ù„Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©... Ù…Ø«Ø§Ù„: ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ù…Ø®ØªÙˆÙ…Ø© Ù…Ù† Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…ØµØ¯Ø±Ø© ÙˆÙ…ÙˆÙ‚Ø¹Ø© Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø®ØªØµ..." />
                        </div>
                      </div>

                      {/* Evidence Summary Dashboard */}
                      <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                        <h4 className="font-bold mb-4 flex items-center gap-2">
                          <BarChart3 className="w-5 h-5 text-teal-400" />
                          Ù…Ù„Ø®Øµ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø©
                        </h4>
                        <div className="grid grid-cols-5 gap-4">
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl font-black text-teal-400">{(formData.evidenceTypes || []).length}</p>
                            <p className="text-slate-300 text-xs mt-1">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl font-black text-blue-400">{formData.evidenceValidityDays || 365}</p>
                            <p className="text-slate-300 text-xs mt-1">ÙŠÙˆÙ… ØµÙ„Ø§Ø­ÙŠØ©</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl font-black text-purple-400">{formData.minEvidenceCount || 1}</p>
                            <p className="text-slate-300 text-xs mt-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl font-black text-cyan-400">{(formData.attachments || []).length}</p>
                            <p className="text-slate-300 text-xs mt-1">Ù…Ù„ÙØ§Øª Ù…Ø±ÙÙ‚Ø©</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className={`text-3xl font-black ${formData.evidenceLevel === 'mandatory' ? 'text-red-400' :
                                formData.evidenceLevel === 'recommended' ? 'text-amber-400' : 'text-green-400'
                              }`}>
                              {formData.evidenceLevel === 'mandatory' ? 'âš ï¸' : formData.evidenceLevel === 'recommended' ? 'ğŸ“Œ' : 'âœ“'}
                            </p>
                            <p className="text-slate-300 text-xs mt-1">Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©</p>
                          </div>
                        </div>
                      </div>
                    </>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 6: Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ… - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'schedule' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-blue-600 via-indigo-600 to-violet-600 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <Calendar className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…</h3>
                          <p className="text-blue-200 text-sm">Scheduling & Calendar Management</p>
                        </div>
                      </div>
                      <div className="text-left bg-white/10 rounded-xl px-4 py-2 backdrop-blur">
                        <p className="text-blue-200 text-xs">Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</p>
                        <p className="font-bold text-lg">{FREQUENCIES.find(f => f.code === formData.frequency)?.nameAr || 'Ø´Ù‡Ø±ÙŠ'}</p>
                      </div>
                    </div>
                  </div>

                  {/* Frequency Selection - Visual Cards */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <RefreshCw className="w-5 h-5 text-blue-500" />
                        Ø¯ÙˆØ±ÙŠØ© Ø§Ù„ØªÙƒØ±Ø§Ø± (Frequency)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-5 gap-3">
                        {[
                          { code: 'Daily', name: 'ÙŠÙˆÙ…ÙŠ', icon: 'ğŸ“…', desc: 'ÙƒÙ„ ÙŠÙˆÙ…', color: 'red' },
                          { code: 'Weekly', name: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ', icon: 'ğŸ“†', desc: 'Ù…Ø±Ø© Ø¨Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', color: 'orange' },
                          { code: 'Monthly', name: 'Ø´Ù‡Ø±ÙŠ', icon: 'ğŸ—“ï¸', desc: 'Ù…Ø±Ø© Ø¨Ø§Ù„Ø´Ù‡Ø±', color: 'blue' },
                          { code: 'Quarterly', name: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', icon: 'ğŸ“Š', desc: 'ÙƒÙ„ 3 Ø£Ø´Ù‡Ø±', color: 'purple' },
                          { code: 'Annually', name: 'Ø³Ù†ÙˆÙŠ', icon: 'ğŸ¯', desc: 'Ù…Ø±Ø© Ø¨Ø§Ù„Ø³Ù†Ø©', color: 'green' },
                          { code: 'Biweekly', name: 'Ù†ØµÙ Ø´Ù‡Ø±ÙŠ', icon: 'ğŸ“‹', desc: 'ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†', color: 'cyan' },
                          { code: 'SemiAnnual', name: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ', icon: 'ğŸ“ˆ', desc: 'ÙƒÙ„ 6 Ø£Ø´Ù‡Ø±', color: 'indigo' },
                          { code: 'OnDemand', name: 'Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨', icon: 'âš¡', desc: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©', color: 'amber' },
                          { code: 'RealTime', name: 'ÙÙˆØ±ÙŠ', icon: 'ğŸ”´', desc: 'Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø±', color: 'rose' },
                          { code: 'Event', name: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¯Ø«', icon: 'ğŸª', desc: 'Ù…Ø±ØªØ¨Ø· Ø¨Ø­Ø¯Ø«', color: 'teal' },
                        ].map(freq => {
                          const isSelected = formData.frequency === freq.code;
                          return (
                            <button key={freq.code} type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, frequency: freq.code })}
                              className={`p-4 rounded-xl border-2 text-center transition-all transform hover:scale-[1.03] ${isSelected
                                  ? `bg-${freq.color}-50 border-${freq.color}-400 shadow-lg`
                                  : 'bg-white border-slate-200 hover:border-slate-300'
                                }`}>
                              <span className="text-2xl block mb-2">{freq.icon}</span>
                              <p className={`font-bold text-sm ${isSelected ? `text-${freq.color}-700` : 'text-slate-700'}`}>{freq.name}</p>
                              <p className="text-xs text-slate-500 mt-1">{freq.desc}</p>
                              {isSelected && (
                                <div className={`mt-2 w-6 h-6 mx-auto rounded-full bg-${freq.color}-500 flex items-center justify-center`}>
                                  <CheckCircle2 className="w-4 h-4 text-white" />
                                </div>
                              )}
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Due Rule Configuration */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-indigo-50 px-5 py-3 border-b border-indigo-100">
                      <h4 className="font-bold text-indigo-700 flex items-center gap-2">
                        <Clock className="w-5 h-5" />
                        Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ (Due Rule Builder)
                      </h4>
                    </div>
                    <div className="p-5 space-y-5">
                      {/* Rule Type Selection */}
                      <div className="grid grid-cols-4 gap-3">
                        {[
                          { value: 'fixed', label: 'ÙŠÙˆÙ… Ø«Ø§Ø¨Øª', icon: 'ğŸ“Œ', desc: 'ØªØ§Ø±ÙŠØ® Ù…Ø­Ø¯Ø¯ Ø´Ù‡Ø±ÙŠØ§Ù‹/Ø³Ù†ÙˆÙŠØ§Ù‹' },
                          { value: 'relative', label: 'Ù†Ø³Ø¨ÙŠ', icon: 'â†”ï¸', desc: 'Ø¨Ø¹Ø¯ X Ø£ÙŠØ§Ù… Ù…Ù† Ø­Ø¯Ø« Ù…Ø¹ÙŠÙ†' },
                          { value: 'realtime', label: 'ÙÙˆØ±ÙŠ', icon: 'âš¡', desc: 'ÙŠØ¬Ø¨ Ø§Ù„ØªÙ†ÙÙŠØ° ÙÙˆØ±Ø§Ù‹' },
                          { value: 'window', label: 'Ù†Ø§ÙØ°Ø© Ø²Ù…Ù†ÙŠØ©', icon: 'ğŸªŸ', desc: 'Ø®Ù„Ø§Ù„ ÙØªØ±Ø© Ù…Ø­Ø¯Ø¯Ø©' },
                        ].map(rule => {
                          const isSelected = formData.dueRuleType === rule.value;
                          return (
                            <button key={rule.value} type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, dueRuleType: rule.value })}
                              className={`p-4 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-indigo-50 border-indigo-400' : 'bg-white border-slate-200 hover:border-indigo-300'
                                }`}>
                              <span className="text-2xl">{rule.icon}</span>
                              <p className={`font-bold text-sm mt-2 ${isSelected ? 'text-indigo-700' : 'text-slate-700'}`}>{rule.label}</p>
                              <p className="text-xs text-slate-500 mt-1">{rule.desc}</p>
                            </button>
                          );
                        })}
                      </div>

                      {/* Rule Configuration Based on Type */}
                      <div className="bg-slate-50 rounded-xl p-4">
                        {formData.dueRuleType === 'fixed' && (
                          <div className="grid grid-cols-3 gap-4">
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø´Ù‡Ø±</label>
                              <select value={formData.fixedDay || '1'}
                                onChange={(e) => setFormData({ ...formData, fixedDay: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400">
                                {[...Array(28)].map((_, i) => (
                                  <option key={i + 1} value={i + 1}>Ø§Ù„ÙŠÙˆÙ… {i + 1}</option>
                                ))}
                                <option value="last">Ø¢Ø®Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø´Ù‡Ø±</option>
                              </select>
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„Ø´Ù‡Ø± (Ù„Ù„Ø³Ù†ÙˆÙŠ)</label>
                              <select value={formData.fixedMonth || ''}
                                onChange={(e) => setFormData({ ...formData, fixedMonth: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400">
                                <option value="">ÙƒÙ„ Ø´Ù‡Ø±</option>
                                <option value="1">ÙŠÙ†Ø§ÙŠØ±</option>
                                <option value="2">ÙØ¨Ø±Ø§ÙŠØ±</option>
                                <option value="3">Ù…Ø§Ø±Ø³</option>
                                <option value="4">Ø£Ø¨Ø±ÙŠÙ„</option>
                                <option value="5">Ù…Ø§ÙŠÙˆ</option>
                                <option value="6">ÙŠÙˆÙ†ÙŠÙˆ</option>
                                <option value="7">ÙŠÙˆÙ„ÙŠÙˆ</option>
                                <option value="8">Ø£ØºØ³Ø·Ø³</option>
                                <option value="9">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
                                <option value="10">Ø£ÙƒØªÙˆØ¨Ø±</option>
                                <option value="11">Ù†ÙˆÙÙ…Ø¨Ø±</option>
                                <option value="12">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
                              </select>
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„ÙˆÙ‚Øª</label>
                              <input type="time" value={formData.fixedTime || '17:00'}
                                onChange={(e) => setFormData({ ...formData, fixedTime: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400" />
                            </div>
                          </div>
                        )}

                        {formData.dueRuleType === 'relative' && (
                          <div className="grid grid-cols-3 gap-4">
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠ</label>
                              <select value={formData.relativeEvent || 'period_start'}
                                onChange={(e) => setFormData({ ...formData, relativeEvent: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400">
                                <option value="period_start">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©</option>
                                <option value="period_end">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©</option>
                                <option value="fiscal_year">Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
                                <option value="contract_date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯</option>
                                <option value="incident">ÙˆÙ‚ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯Ø«Ø©</option>
                                <option value="request">ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨</option>
                              </select>
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„Ù…Ø¯Ø©</label>
                              <div className="flex gap-2">
                                <input type="number" min="1" value={formData.dueRuleValue || 5}
                                  onChange={(e) => setFormData({ ...formData, dueRuleValue: parseInt(e.target.value) || 1 })}
                                  disabled={modalMode === 'view'}
                                  className="w-20 px-3 py-3 border-2 border-slate-200 rounded-xl text-center font-bold disabled:bg-white focus:border-indigo-400" />
                                <select value={formData.dueRuleUnit || 'days'}
                                  onChange={(e) => setFormData({ ...formData, dueRuleUnit: e.target.value })}
                                  disabled={modalMode === 'view'}
                                  className="flex-1 px-3 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400">
                                  <option value="hours">Ø³Ø§Ø¹Ø©</option>
                                  <option value="days">ÙŠÙˆÙ…</option>
                                  <option value="weeks">Ø£Ø³Ø¨ÙˆØ¹</option>
                                  <option value="months">Ø´Ù‡Ø±</option>
                                </select>
                              </div>
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„Ø§ØªØ¬Ø§Ù‡</label>
                              <select value={formData.relativeDirection || 'after'}
                                onChange={(e) => setFormData({ ...formData, relativeDirection: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400">
                                <option value="before">Ù‚Ø¨Ù„</option>
                                <option value="after">Ø¨Ø¹Ø¯</option>
                              </select>
                            </div>
                          </div>
                        )}

                        {formData.dueRuleType === 'window' && (
                          <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù†Ø§ÙØ°Ø©</label>
                              <input type="date" value={formData.windowStart || ''}
                                onChange={(e) => setFormData({ ...formData, windowStart: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400" />
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-2">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù†Ø§ÙØ°Ø©</label>
                              <input type="date" value={formData.windowEnd || ''}
                                onChange={(e) => setFormData({ ...formData, windowEnd: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-white focus:border-indigo-400" />
                            </div>
                          </div>
                        )}

                        {formData.dueRuleType === 'realtime' && (
                          <div className="text-center py-6">
                            <div className="w-16 h-16 mx-auto rounded-full bg-red-100 flex items-center justify-center mb-3 animate-pulse">
                              <Zap className="w-8 h-8 text-red-500" />
                            </div>
                            <p className="font-bold text-slate-700">Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙÙˆØ±ÙŠ Ù…Ø·Ù„ÙˆØ¨</p>
                            <p className="text-sm text-slate-500 mt-1">ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙÙˆØ± ÙˆÙ‚ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø« Ø£Ùˆ Ø§Ù„Ù…ØªØ·Ù„Ø¨</p>
                          </div>
                        )}

                        {/* Due Rule Preview */}
                        <div className="mt-4 p-4 bg-indigo-100 rounded-xl">
                          <p className="text-sm text-indigo-600 mb-1">ğŸ“‹ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</p>
                          <p className="text-lg font-black text-indigo-700">
                            {formData.dueRuleType === 'fixed' ?
                              `ÙÙŠ Ø§Ù„ÙŠÙˆÙ… ${formData.fixedDay || '1'} ${formData.fixedMonth ? `Ù…Ù† Ø´Ù‡Ø± ${formData.fixedMonth}` : 'Ù…Ù† ÙƒÙ„ Ø´Ù‡Ø±'} Ø§Ù„Ø³Ø§Ø¹Ø© ${formData.fixedTime || '17:00'}` :
                              formData.dueRuleType === 'relative' ?
                                `${formData.dueRuleValue || 5} ${formData.dueRuleUnit === 'hours' ? 'Ø³Ø§Ø¹Ø§Øª' : formData.dueRuleUnit === 'days' ? 'Ø£ÙŠØ§Ù…' : formData.dueRuleUnit === 'weeks' ? 'Ø£Ø³Ø§Ø¨ÙŠØ¹' : 'Ø£Ø´Ù‡Ø±'} ${formData.relativeDirection === 'before' ? 'Ù‚Ø¨Ù„' : 'Ø¨Ø¹Ø¯'} ${formData.relativeEvent === 'period_start' ? 'Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©' : formData.relativeEvent === 'period_end' ? 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©' : 'Ø§Ù„Ø­Ø¯Ø«'}` :
                                formData.dueRuleType === 'window' ?
                                  `Ù…Ù† ${formData.windowStart || '...'} Ø¥Ù„Ù‰ ${formData.windowEnd || '...'}` :
                                  'ÙÙˆØ±ÙŠ - ÙŠØ¬Ø¨ Ø§Ù„ØªÙ†ÙÙŠØ° Ø­Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨'}
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Reminders & Notifications */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-amber-50 px-5 py-3 border-b border-amber-100">
                      <h4 className="font-bold text-amber-700 flex items-center gap-2">
                        <Bell className="w-5 h-5" />
                        Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="space-y-3">
                        {[
                          { id: 'reminder1', label: 'ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ 7 Ø£ÙŠØ§Ù…', days: 7, enabled: true },
                          { id: 'reminder2', label: 'ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ 3 Ø£ÙŠØ§Ù…', days: 3, enabled: true },
                          { id: 'reminder3', label: 'ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯', days: 1, enabled: true },
                          { id: 'reminder4', label: 'ØªØ°ÙƒÙŠØ± ÙŠÙˆÙ… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚', days: 0, enabled: true },
                          { id: 'reminder5', label: 'ØªØ°ÙƒÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£Ø®ÙŠØ±', days: -1, enabled: false },
                        ].map(reminder => {
                          const isEnabled = (formData.reminders || []).includes(reminder.id) || reminder.enabled;
                          return (
                            <div key={reminder.id} className={`flex items-center justify-between p-3 rounded-xl border-2 transition-all ${isEnabled ? 'bg-amber-50 border-amber-200' : 'bg-white border-slate-200'
                              }`}>
                              <div className="flex items-center gap-3">
                                <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${isEnabled ? 'bg-amber-500 text-white' : 'bg-slate-100 text-slate-400'
                                  }`}>
                                  <Bell className="w-5 h-5" />
                                </div>
                                <div>
                                  <p className={`font-bold ${isEnabled ? 'text-amber-700' : 'text-slate-600'}`}>{reminder.label}</p>
                                  <p className="text-xs text-slate-500">
                                    {reminder.days > 0 ? `Ù‚Ø¨Ù„ ${reminder.days} ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ù…ÙˆØ¹Ø¯` :
                                      reminder.days === 0 ? 'ÙÙŠ ÙŠÙˆÙ… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚' : 'ÙÙŠ Ø­Ø§Ù„ Ø§Ù„ØªØ£Ø®ÙŠØ±'}
                                  </p>
                                </div>
                              </div>
                              <label className="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked={isEnabled}
                                  onChange={(e) => {
                                    const current = formData.reminders || [];
                                    if (e.target.checked) {
                                      setFormData({ ...formData, reminders: [...current, reminder.id] });
                                    } else {
                                      setFormData({ ...formData, reminders: current.filter(r => r !== reminder.id) });
                                    }
                                  }}
                                  disabled={modalMode === 'view'} className="sr-only peer" />
                                <div className="w-12 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"></div>
                              </label>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Auto Task Generation */}
                  <div className="bg-white rounded-2xl border-2 border-blue-200 overflow-hidden">
                    <div className="bg-gradient-to-r from-blue-500 to-indigo-500 px-5 py-4 text-white">
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-3">
                          <div className="w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center">
                            <Zap className="w-6 h-6" />
                          </div>
                          <div>
                            <h4 className="font-bold">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (Auto Task Generation)</h4>
                            <p className="text-blue-200 text-sm">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø¯ÙˆÙ„</p>
                          </div>
                        </div>
                        <label className="relative inline-flex items-center cursor-pointer">
                          <input type="checkbox" checked={formData.autoTaskGeneration !== false}
                            onChange={(e) => setFormData({ ...formData, autoTaskGeneration: e.target.checked })}
                            disabled={modalMode === 'view'} className="sr-only peer" />
                          <div className="w-16 h-8 bg-white/30 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-emerald-500"></div>
                        </label>
                      </div>
                    </div>
                    {formData.autoTaskGeneration !== false && (
                      <div className="p-5 space-y-4">
                        <div className="grid grid-cols-3 gap-4">
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
                            <select value={formData.defaultAssignee || ''}
                              onChange={(e) => setFormData({ ...formData, defaultAssignee: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-blue-400">
                              <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„...</option>
                              <option value="compliance_officer">Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</option>
                              <option value="department_head">Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                              <option value="it_manager">Ù…Ø¯ÙŠØ± ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                              <option value="risk_manager">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø®Ø§Ø·Ø±</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-2">Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                            <select value={formData.taskPriority || 'medium'}
                              onChange={(e) => setFormData({ ...formData, taskPriority: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-blue-400">
                              <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
                              <option value="medium">Ù…ØªÙˆØ³Ø·Ø©</option>
                              <option value="high">Ø¹Ø§Ù„ÙŠØ©</option>
                              <option value="critical">Ø­Ø±Ø¬Ø©</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-2">ÙˆÙ‚Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</label>
                            <select value={formData.taskCreationTime || 'period_start'}
                              onChange={(e) => setFormData({ ...formData, taskCreationTime: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-blue-400">
                              <option value="period_start">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©</option>
                              <option value="week_before">Ù‚Ø¨Ù„ Ø£Ø³Ø¨ÙˆØ¹</option>
                              <option value="month_before">Ù‚Ø¨Ù„ Ø´Ù‡Ø±</option>
                            </select>
                          </div>
                        </div>
                        <div className="flex items-center gap-3 p-3 bg-blue-50 rounded-xl">
                          <CheckCircle2 className="w-5 h-5 text-blue-500" />
                          <p className="text-sm text-blue-700">Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù‡Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</p>
                        </div>
                      </div>
                    )}
                  </div>

                  {/* Summary Dashboard */}
                  <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                    <h4 className="font-bold mb-4 flex items-center gap-2">
                      <BarChart3 className="w-5 h-5 text-blue-400" />
                      Ù…Ù„Ø®Øµ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©
                    </h4>
                    <div className="grid grid-cols-5 gap-4">
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ”„</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</p>
                        <p className="font-bold text-sm mt-1">{FREQUENCIES.find(f => f.code === formData.frequency)?.nameAr || 'Ø´Ù‡Ø±ÙŠ'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ“…</p>
                        <p className="text-slate-300 text-xs">Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</p>
                        <p className="font-bold text-sm mt-1">
                          {formData.dueRuleType === 'fixed' ? 'ÙŠÙˆÙ… Ø«Ø§Ø¨Øª' :
                            formData.dueRuleType === 'relative' ? 'Ù†Ø³Ø¨ÙŠ' :
                              formData.dueRuleType === 'window' ? 'Ù†Ø§ÙØ°Ø©' : 'ÙÙˆØ±ÙŠ'}
                        </p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ””</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</p>
                        <p className="font-bold text-sm mt-1">{(formData.reminders || []).length || 4} ØªØ°ÙƒÙŠØ±</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">{formData.autoTaskGeneration !== false ? 'âš¡' : 'ğŸ”˜'}</p>
                        <p className="text-slate-300 text-xs">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                        <p className="font-bold text-sm mt-1">{formData.autoTaskGeneration !== false ? 'Ù…ÙØ¹Ù‘Ù„' : 'Ù…Ø¹Ø·Ù‘Ù„'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ‘¤</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</p>
                        <p className="font-bold text-sm mt-1">{formData.defaultAssignee ? 'Ù…Ø­Ø¯Ø¯' : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 7: Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'testing' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-cyan-500 via-teal-500 to-emerald-500 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <ClipboardList className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</h3>
                          <p className="text-cyan-100 text-sm">Compliance Testing Plan</p>
                        </div>
                      </div>
                      <div className="text-left bg-white/10 rounded-xl px-4 py-2 backdrop-blur">
                        <p className="text-cyan-200 text-xs">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                        <p className="font-bold text-lg">{formData.testingRequired !== false ? 'âœ… Ù…Ø·Ù„ÙˆØ¨' : 'â¸ï¸ ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨'}</p>
                      </div>
                    </div>
                  </div>

                  {/* Testing Required Toggle */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="p-5 flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className={`w-14 h-14 rounded-2xl flex items-center justify-center transition-all ${formData.testingRequired !== false ? 'bg-cyan-100' : 'bg-slate-100'
                          }`}>
                          <ClipboardList className={`w-7 h-7 ${formData.testingRequired !== false ? 'text-cyan-600' : 'text-slate-400'}`} />
                        </div>
                        <div>
                          <p className="font-bold text-slate-800 text-lg">Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„ØŸ</p>
                          <p className="text-slate-500 text-sm">ØªÙØ¹ÙŠÙ„ Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø¯ÙˆØ±ÙŠØ© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                        </div>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={formData.testingRequired !== false}
                          onChange={(e) => setFormData({ ...formData, testingRequired: e.target.checked })}
                          disabled={modalMode === 'view'} className="sr-only peer" />
                        <div className="w-16 h-8 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-cyan-500 shadow-inner"></div>
                        <span className="mr-3 text-lg font-black text-slate-700">{formData.testingRequired !== false ? 'âœ… Ù†Ø¹Ù…' : 'âŒ Ù„Ø§'}</span>
                      </label>
                    </div>
                  </div>

                  {formData.testingRequired !== false && (
                    <>
                      {/* Test Type Selection - Visual Cards */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                          <h4 className="font-bold text-slate-700 flex items-center gap-2">
                            <Settings className="w-5 h-5 text-cyan-500" />
                            Ù†ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Test Type)
                          </h4>
                        </div>
                        <div className="p-5">
                          <div className="grid grid-cols-4 gap-4">
                            {[
                              { value: 'manual', label: 'Ø§Ø®ØªØ¨Ø§Ø± ÙŠØ¯ÙˆÙŠ', icon: 'ğŸ‘¤', desc: 'ÙØ­Øµ ÙŠØ¯ÙˆÙŠ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø®ØªØµ', color: 'blue' },
                              { value: 'automated', label: 'Ø§Ø®ØªØ¨Ø§Ø± Ø¢Ù„ÙŠ', icon: 'ğŸ¤–', desc: 'ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù†Ø¸Ø§Ù…', color: 'purple' },
                              { value: 'sampling', label: 'Ø§Ø®ØªØ¨Ø§Ø± Ø¹ÙŠÙ†Ø§Øª', icon: 'ğŸ“Š', desc: 'ÙØ­Øµ Ø¹ÙŠÙ†Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©', color: 'amber' },
                              { value: 'walkthrough', label: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª', icon: 'ğŸš¶', desc: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©', color: 'green' },
                              { value: 'inspection', label: 'ØªÙØªÙŠØ´ Ù…ÙŠØ¯Ø§Ù†ÙŠ', icon: 'ğŸ”', desc: 'Ø²ÙŠØ§Ø±Ø© Ù…ÙŠØ¯Ø§Ù†ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹', color: 'orange' },
                              { value: 'interview', label: 'Ù…Ù‚Ø§Ø¨Ù„Ø§Øª', icon: 'ğŸ¤', desc: 'Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù…Ø¹Ù†ÙŠÙŠÙ†', color: 'pink' },
                              { value: 'documentation', label: 'Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ«Ø§Ø¦Ù‚', icon: 'ğŸ“„', desc: 'ÙØ­Øµ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª', color: 'indigo' },
                              { value: 'simulation', label: 'Ù…Ø­Ø§ÙƒØ§Ø©', icon: 'ğŸ®', desc: 'Ø§Ø®ØªØ¨Ø§Ø± Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©', color: 'rose' },
                            ].map(test => {
                              const isSelected = formData.testType === test.value;
                              return (
                                <button key={test.value} type="button" disabled={modalMode === 'view'}
                                  onClick={() => setFormData({ ...formData, testType: test.value })}
                                  className={`p-4 rounded-xl border-2 text-center transition-all transform hover:scale-[1.02] ${isSelected
                                      ? `bg-${test.color}-50 border-${test.color}-400 shadow-lg`
                                      : 'bg-white border-slate-200 hover:border-slate-300'
                                    }`}>
                                  <span className="text-3xl block mb-2">{test.icon}</span>
                                  <p className={`font-bold text-sm ${isSelected ? `text-${test.color}-700` : 'text-slate-700'}`}>{test.label}</p>
                                  <p className="text-xs text-slate-500 mt-1">{test.desc}</p>
                                  {isSelected && (
                                    <div className={`mt-2 w-6 h-6 mx-auto rounded-full bg-${test.color}-500 flex items-center justify-center`}>
                                      <CheckCircle2 className="w-4 h-4 text-white" />
                                    </div>
                                  )}
                                </button>
                              );
                            })}
                          </div>
                        </div>
                      </div>

                      {/* Test Frequency & Schedule */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-indigo-50 px-5 py-3 border-b border-indigo-100">
                            <h4 className="font-bold text-indigo-700 flex items-center gap-2">
                              <RefreshCw className="w-5 h-5" />
                              Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                            </h4>
                          </div>
                          <div className="p-4">
                            <div className="grid grid-cols-2 gap-2">
                              {[
                                { value: 'Monthly', label: 'Ø´Ù‡Ø±ÙŠ', icon: 'ğŸ“…' },
                                { value: 'Quarterly', label: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', icon: 'ğŸ“Š' },
                                { value: 'SemiAnnual', label: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ', icon: 'ğŸ“ˆ' },
                                { value: 'Annual', label: 'Ø³Ù†ÙˆÙŠ', icon: 'ğŸ¯' },
                              ].map(freq => {
                                const isSelected = formData.testFrequency === freq.value;
                                return (
                                  <button key={freq.value} type="button" disabled={modalMode === 'view'}
                                    onClick={() => setFormData({ ...formData, testFrequency: freq.value })}
                                    className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-indigo-50 border-indigo-400' : 'bg-white border-slate-200 hover:border-indigo-300'
                                      }`}>
                                    <span className="text-xl">{freq.icon}</span>
                                    <p className={`font-bold text-sm mt-1 ${isSelected ? 'text-indigo-700' : 'text-slate-600'}`}>{freq.label}</p>
                                  </button>
                                );
                              })}
                            </div>
                          </div>
                        </div>

                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-purple-50 px-5 py-3 border-b border-purple-100">
                            <h4 className="font-bold text-purple-700 flex items-center gap-2">
                              <Target className="w-5 h-5" />
                              Ø­Ø¬Ù… Ø§Ù„Ø¹ÙŠÙ†Ø©
                            </h4>
                          </div>
                          <div className="p-4 space-y-3">
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-1">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                              <div className="flex items-center gap-3">
                                <input type="range" min="5" max="100" step="5"
                                  value={formData.sampleSize || 25}
                                  onChange={(e) => setFormData({ ...formData, sampleSize: parseInt(e.target.value) })}
                                  disabled={modalMode === 'view'}
                                  className="flex-1 h-2 bg-purple-200 rounded-lg appearance-none cursor-pointer" />
                                <span className="w-16 text-center text-xl font-black text-purple-600">{formData.sampleSize || 25}%</span>
                              </div>
                            </div>
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø¹ÙŠÙ†Ø§Øª</label>
                              <input type="number" min="1" value={formData.minSamples || 5}
                                onChange={(e) => setFormData({ ...formData, minSamples: parseInt(e.target.value) })}
                                disabled={modalMode === 'view'}
                                className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-purple-400" />
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* Test Criteria & Checklist */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-teal-50 px-5 py-3 border-b border-teal-100 flex items-center justify-between">
                          <h4 className="font-bold text-teal-700 flex items-center gap-2">
                            <ListChecks className="w-5 h-5" />
                            Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Test Criteria)
                          </h4>
                          <span className="px-3 py-1 bg-teal-500 text-white rounded-full text-sm font-bold">
                            {(formData.testCriteria || []).length} Ù…Ø¹ÙŠØ§Ø±
                          </span>
                        </div>
                        <div className="p-5">
                          <div className="grid grid-cols-3 gap-3 mb-4">
                            {[
                              { id: 'completeness', label: 'Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„', icon: 'âœ…', desc: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù…Ø³ØªÙˆÙØ§Ø©' },
                              { id: 'accuracy', label: 'Ø§Ù„Ø¯Ù‚Ø©', icon: 'ğŸ¯', desc: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØµØ­ÙŠØ­Ø© ÙˆØ¯Ù‚ÙŠÙ‚Ø©' },
                              { id: 'timeliness', label: 'Ø§Ù„ØªÙˆÙ‚ÙŠØª', icon: 'â°', desc: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯' },
                              { id: 'authorization', label: 'Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª', icon: 'ğŸ”', desc: 'Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©' },
                              { id: 'documentation', label: 'Ø§Ù„ØªÙˆØ«ÙŠÙ‚', icon: 'ğŸ“‹', desc: 'Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©' },
                              { id: 'effectiveness', label: 'Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©', icon: 'ğŸ“Š', desc: 'ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù' },
                            ].map(criteria => {
                              const isSelected = (formData.testCriteria || []).includes(criteria.id);
                              return (
                                <button key={criteria.id} type="button" disabled={modalMode === 'view'}
                                  onClick={() => {
                                    if (isSelected) {
                                      setFormData({ ...formData, testCriteria: (formData.testCriteria || []).filter(c => c !== criteria.id) });
                                    } else {
                                      setFormData({ ...formData, testCriteria: [...(formData.testCriteria || []), criteria.id] });
                                    }
                                  }}
                                  className={`p-3 rounded-xl border-2 text-right transition-all ${isSelected ? 'bg-teal-50 border-teal-400' : 'bg-white border-slate-200 hover:border-teal-300'
                                    }`}>
                                  <div className="flex items-center gap-2">
                                    <span className="text-xl">{criteria.icon}</span>
                                    <div>
                                      <p className={`font-bold text-sm ${isSelected ? 'text-teal-700' : 'text-slate-700'}`}>{criteria.label}</p>
                                      <p className="text-xs text-slate-500">{criteria.desc}</p>
                                    </div>
                                    {isSelected && <CheckCircle2 className="w-5 h-5 text-teal-500 mr-auto" />}
                                  </div>
                                </button>
                              );
                            })}
                          </div>
                        </div>
                      </div>

                      {/* Test Procedure & Steps */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-amber-50 px-5 py-3 border-b border-amber-100">
                          <h4 className="font-bold text-amber-700 flex items-center gap-2">
                            <FileText className="w-5 h-5" />
                            Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                          </h4>
                        </div>
                        <div className="p-5 space-y-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                            <select value={formData.testTemplate || ''}
                              onChange={(e) => setFormData({ ...formData, testTemplate: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400">
                              <option value="">Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...</option>
                              <option value="soc2_template">SOC 2 Testing Template</option>
                              <option value="iso27001_template">ISO 27001 Audit Checklist</option>
                              <option value="pci_template">PCI DSS Testing Procedures</option>
                              <option value="gdpr_template">GDPR Compliance Checklist</option>
                              <option value="custom">Ù‚Ø§Ù„Ø¨ Ù…Ø®ØµØµ</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                            <textarea value={formData.testProcedure || ''}
                              onChange={(e) => setFormData({ ...formData, testProcedure: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400 h-28 resize-none"
                              placeholder="1. Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª - 2. ÙØ­Øµ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø³Ø¬Ù„Ø§Øª - 3. Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø§Øª Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† - 4. ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª" />
                          </div>
                        </div>
                      </div>

                      {/* Test Team & Responsibilities */}
                      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                        <div className="bg-blue-50 px-5 py-3 border-b border-blue-100">
                          <h4 className="font-bold text-blue-700 flex items-center gap-2">
                            <Users className="w-5 h-5" />
                            ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                          </h4>
                        </div>
                        <div className="p-5">
                          <div className="grid grid-cols-3 gap-4">
                            <div className="bg-slate-50 rounded-xl p-4">
                              <div className="flex items-center gap-3 mb-3">
                                <div className="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                                  <User className="w-5 h-5 text-blue-600" />
                                </div>
                                <div>
                                  <p className="text-xs text-slate-500">Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                                  <p className="font-bold text-slate-700">Test Lead</p>
                                </div>
                              </div>
                              <input type="text" value={formData.testLead || ''}
                                onChange={(e) => setFormData({ ...formData, testLead: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm disabled:bg-white focus:border-blue-400"
                                placeholder="Ø§Ø³Ù… Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" />
                            </div>

                            <div className="bg-slate-50 rounded-xl p-4">
                              <div className="flex items-center gap-3 mb-3">
                                <div className="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center">
                                  <Users className="w-5 h-5 text-purple-600" />
                                </div>
                                <div>
                                  <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø®ØªØ¨Ø±ÙˆÙ†</p>
                                  <p className="font-bold text-slate-700">Testers</p>
                                </div>
                              </div>
                              <input type="text" value={formData.testers || ''}
                                onChange={(e) => setFormData({ ...formData, testers: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm disabled:bg-white focus:border-purple-400"
                                placeholder="Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø®ØªØ¨Ø±ÙŠÙ†" />
                            </div>

                            <div className="bg-slate-50 rounded-xl p-4">
                              <div className="flex items-center gap-3 mb-3">
                                <div className="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center">
                                  <CheckCircle2 className="w-5 h-5 text-emerald-600" />
                                </div>
                                <div>
                                  <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</p>
                                  <p className="font-bold text-slate-700">Reviewer</p>
                                </div>
                              </div>
                              <input type="text" value={formData.testReviewer || ''}
                                onChange={(e) => setFormData({ ...formData, testReviewer: e.target.value })}
                                disabled={modalMode === 'view'}
                                className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm disabled:bg-white focus:border-emerald-400"
                                placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹" />
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* Expected Results & Pass Criteria */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-emerald-50 px-5 py-3 border-b border-emerald-100">
                            <h4 className="font-bold text-emerald-700 flex items-center gap-2">
                              <CheckCircle2 className="w-5 h-5" />
                              Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­
                            </h4>
                          </div>
                          <div className="p-4 space-y-3">
                            <div>
                              <label className="block text-xs font-bold text-slate-600 mb-1">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                              <div className="flex items-center gap-3">
                                <input type="range" min="50" max="100" step="5"
                                  value={formData.passThreshold || 80}
                                  onChange={(e) => setFormData({ ...formData, passThreshold: parseInt(e.target.value) })}
                                  disabled={modalMode === 'view'}
                                  className="flex-1 h-2 bg-emerald-200 rounded-lg appearance-none cursor-pointer" />
                                <span className={`w-16 text-center text-xl font-black ${(formData.passThreshold || 80) >= 90 ? 'text-emerald-600' :
                                    (formData.passThreshold || 80) >= 70 ? 'text-amber-600' : 'text-red-600'
                                  }`}>{formData.passThreshold || 80}%</span>
                              </div>
                            </div>
                            <div className="p-3 bg-emerald-50 rounded-xl">
                              <p className="text-sm text-emerald-700">
                                âœ… ÙŠØ¹ØªØ¨Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¬Ø­Ø§Ù‹ Ø¥Ø°Ø§ ØªØ­Ù‚Ù‚ {formData.passThreshold || 80}% Ù…Ù† Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±
                              </p>
                            </div>
                          </div>
                        </div>

                        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                          <div className="bg-red-50 px-5 py-3 border-b border-red-100">
                            <h4 className="font-bold text-red-700 flex items-center gap-2">
                              <AlertTriangle className="w-5 h-5" />
                              Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ÙØ´Ù„
                            </h4>
                          </div>
                          <div className="p-4 space-y-2">
                            {[
                              { id: 'escalate', label: 'ØªØµØ¹ÙŠØ¯ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©', icon: 'ğŸ“¢' },
                              { id: 'remediate', label: 'Ø®Ø·Ø© Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: 'ğŸ”§' },
                              { id: 'retest', label: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: 'ğŸ”„' },
                              { id: 'document', label: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù', icon: 'ğŸ“' },
                            ].map(action => {
                              const isSelected = (formData.failureActions || []).includes(action.id);
                              return (
                                <button key={action.id} type="button" disabled={modalMode === 'view'}
                                  onClick={() => {
                                    if (isSelected) {
                                      setFormData({ ...formData, failureActions: (formData.failureActions || []).filter(a => a !== action.id) });
                                    } else {
                                      setFormData({ ...formData, failureActions: [...(formData.failureActions || []), action.id] });
                                    }
                                  }}
                                  className={`w-full p-2.5 rounded-xl border-2 text-right transition-all flex items-center gap-2 ${isSelected ? 'bg-red-50 border-red-300' : 'bg-white border-slate-200 hover:border-red-200'
                                    }`}>
                                  <span>{action.icon}</span>
                                  <span className={`font-bold text-sm ${isSelected ? 'text-red-700' : 'text-slate-600'}`}>{action.label}</span>
                                  {isSelected && <CheckCircle2 className="w-4 h-4 text-red-500 mr-auto" />}
                                </button>
                              );
                            })}
                          </div>
                        </div>
                      </div>

                      {/* Summary Dashboard */}
                      <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                        <h4 className="font-bold mb-4 flex items-center gap-2">
                          <BarChart3 className="w-5 h-5 text-cyan-400" />
                          Ù…Ù„Ø®Øµ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                        </h4>
                        <div className="grid grid-cols-5 gap-4">
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl mb-2">
                              {formData.testType === 'manual' ? 'ğŸ‘¤' :
                                formData.testType === 'automated' ? 'ğŸ¤–' :
                                  formData.testType === 'sampling' ? 'ğŸ“Š' : 'ğŸ”'}
                            </p>
                            <p className="text-slate-300 text-xs">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                            <p className="font-bold text-sm mt-1">
                              {formData.testType === 'manual' ? 'ÙŠØ¯ÙˆÙŠ' :
                                formData.testType === 'automated' ? 'Ø¢Ù„ÙŠ' :
                                  formData.testType === 'sampling' ? 'Ø¹ÙŠÙ†Ø§Øª' : 'Ù…Ø±Ø§Ø¬Ø¹Ø©'}
                            </p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl mb-2">ğŸ”„</p>
                            <p className="text-slate-300 text-xs">Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</p>
                            <p className="font-bold text-sm mt-1">
                              {formData.testFrequency === 'Monthly' ? 'Ø´Ù‡Ø±ÙŠ' :
                                formData.testFrequency === 'Quarterly' ? 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ' :
                                  formData.testFrequency === 'SemiAnnual' ? 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ' : 'Ø³Ù†ÙˆÙŠ'}
                            </p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl mb-2">ğŸ“Š</p>
                            <p className="text-slate-300 text-xs">Ø­Ø¬Ù… Ø§Ù„Ø¹ÙŠÙ†Ø©</p>
                            <p className="font-bold text-sm mt-1">{formData.sampleSize || 25}%</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl mb-2">âœ…</p>
                            <p className="text-slate-300 text-xs">Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­</p>
                            <p className="font-bold text-sm mt-1">{formData.passThreshold || 80}%</p>
                          </div>
                          <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                            <p className="text-3xl mb-2">ğŸ“‹</p>
                            <p className="text-slate-300 text-xs">Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</p>
                            <p className="font-bold text-sm mt-1">{(formData.testCriteria || []).length} Ù…Ø¹ÙŠØ§Ø±</p>
                          </div>
                        </div>
                      </div>
                    </>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 8: Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø° - PREMIUM COMPREHENSIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'enforcement' && (
                <div className="space-y-6">
                  {/* Header */}
                  <div className="bg-gradient-to-r from-red-600 via-rose-600 to-pink-600 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <AlertTriangle className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø° ÙˆÙ…Ø­ÙØ²Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚</h3>
                          <p className="text-red-200 text-sm">Enforcement Rules & Breach Triggers</p>
                        </div>
                      </div>
                      <div className="text-left bg-white/10 rounded-xl px-4 py-2 backdrop-blur">
                        <p className="text-red-200 text-xs">Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù†Ø´Ø·Ø©</p>
                        <p className="font-bold text-2xl">
                          {[formData.breachOnOverdue, formData.breachOnRejection, formData.breachOnMissing, formData.breachOnFailed, formData.autoEscalate].filter(Boolean).length} / 5
                        </p>
                      </div>
                    </div>
                  </div>

                  {/* Auto Breach Triggers */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-red-50 px-5 py-3 border-b border-red-100">
                      <h4 className="font-bold text-red-700 flex items-center gap-2">
                        <Zap className="w-5 h-5" />
                        Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (Auto Breach Triggers)
                      </h4>
                    </div>
                    <div className="p-5 space-y-4">
                      {/* Breach on Overdue */}
                      <div className={`p-4 rounded-xl border-2 transition-all ${formData.breachOnOverdue ? 'bg-red-50 border-red-300' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <button type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, breachOnOverdue: !formData.breachOnOverdue })}
                              className={`w-14 h-14 rounded-xl flex items-center justify-center text-2xl transition-all ${formData.breachOnOverdue ? 'bg-red-500 text-white shadow-lg' : 'bg-slate-100'
                                }`}>
                              {formData.breachOnOverdue ? 'ğŸš¨' : 'â°'}
                            </button>
                            <div>
                              <p className="font-bold text-slate-800 text-lg">Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ£Ø®Ø±</p>
                              <p className="text-sm text-slate-500">Overdue â†’ Critical Breach</p>
                              <p className="text-xs text-slate-400 mt-1">ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ù„Ø§Ø®ØªØ±Ø§Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªØ£Ø®Ø±</p>
                            </div>
                          </div>
                          <div className="flex items-center gap-3">
                            <div className="text-center">
                              <p className="text-xs text-slate-500 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</p>
                              <div className="flex items-center gap-2">
                                <button type="button" disabled={modalMode === 'view' || !formData.breachOnOverdue}
                                  onClick={() => setFormData({ ...formData, overdueThreshold: Math.max(0, (formData.overdueThreshold || 0) - 1) })}
                                  className="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-bold disabled:opacity-50">-</button>
                                <span className={`w-12 h-10 flex items-center justify-center rounded-xl font-black text-xl ${formData.breachOnOverdue ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-400'
                                  }`}>{formData.overdueThreshold || 0}</span>
                                <button type="button" disabled={modalMode === 'view' || !formData.breachOnOverdue}
                                  onClick={() => setFormData({ ...formData, overdueThreshold: (formData.overdueThreshold || 0) + 1 })}
                                  className="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-bold disabled:opacity-50">+</button>
                              </div>
                            </div>
                            <label className="relative inline-flex items-center cursor-pointer">
                              <input type="checkbox" checked={formData.breachOnOverdue || false}
                                onChange={(e) => setFormData({ ...formData, breachOnOverdue: e.target.checked })}
                                disabled={modalMode === 'view'} className="sr-only peer" />
                              <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-red-500"></div>
                            </label>
                          </div>
                        </div>
                      </div>

                      {/* Breach on Rejection */}
                      <div className={`p-4 rounded-xl border-2 transition-all ${formData.breachOnRejection ? 'bg-orange-50 border-orange-300' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <button type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, breachOnRejection: !formData.breachOnRejection })}
                              className={`w-14 h-14 rounded-xl flex items-center justify-center text-2xl transition-all ${formData.breachOnRejection ? 'bg-orange-500 text-white shadow-lg' : 'bg-slate-100'
                                }`}>
                              {formData.breachOnRejection ? 'âŒ' : 'ğŸ“‹'}
                            </button>
                            <div>
                              <p className="font-bold text-slate-800 text-lg">ØªØµØ¹ÙŠØ¯ Ø¹Ù†Ø¯ Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„</p>
                              <p className="text-sm text-slate-500">Evidence Rejected â†’ Escalate</p>
                              <p className="text-xs text-slate-400 mt-1">Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø±ÙØ¶ Ø§Ù„Ø£Ø¯Ù„Ø© Ø¹Ø¯Ø© Ù…Ø±Ø§Øª</p>
                            </div>
                          </div>
                          <div className="flex items-center gap-3">
                            <div className="text-center">
                              <p className="text-xs text-slate-500 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª</p>
                              <div className="flex items-center gap-2">
                                <button type="button" disabled={modalMode === 'view' || !formData.breachOnRejection}
                                  onClick={() => setFormData({ ...formData, rejectionThreshold: Math.max(1, (formData.rejectionThreshold || 2) - 1) })}
                                  className="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-bold disabled:opacity-50">-</button>
                                <span className={`w-12 h-10 flex items-center justify-center rounded-xl font-black text-xl ${formData.breachOnRejection ? 'bg-orange-100 text-orange-700' : 'bg-slate-100 text-slate-400'
                                  }`}>{formData.rejectionThreshold || 2}</span>
                                <button type="button" disabled={modalMode === 'view' || !formData.breachOnRejection}
                                  onClick={() => setFormData({ ...formData, rejectionThreshold: (formData.rejectionThreshold || 2) + 1 })}
                                  className="w-8 h-8 rounded-lg bg-slate-100 hover:bg-slate-200 flex items-center justify-center font-bold disabled:opacity-50">+</button>
                              </div>
                            </div>
                            <label className="relative inline-flex items-center cursor-pointer">
                              <input type="checkbox" checked={formData.breachOnRejection || false}
                                onChange={(e) => setFormData({ ...formData, breachOnRejection: e.target.checked })}
                                disabled={modalMode === 'view'} className="sr-only peer" />
                              <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-orange-500"></div>
                            </label>
                          </div>
                        </div>
                      </div>

                      {/* Breach on Missing Evidence */}
                      <div className={`p-4 rounded-xl border-2 transition-all ${formData.breachOnMissing ? 'bg-purple-50 border-purple-300' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <button type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, breachOnMissing: !formData.breachOnMissing })}
                              className={`w-14 h-14 rounded-xl flex items-center justify-center text-2xl transition-all ${formData.breachOnMissing ? 'bg-purple-500 text-white shadow-lg' : 'bg-slate-100'
                                }`}>
                              {formData.breachOnMissing ? 'ğŸ“­' : 'ğŸ“„'}
                            </button>
                            <div>
                              <p className="font-bold text-slate-800 text-lg">Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ ÙÙ‚Ø¯ Ø§Ù„Ø¯Ù„ÙŠÙ„</p>
                              <p className="text-sm text-slate-500">Missing Evidence â†’ Auto Breach</p>
                              <p className="text-xs text-slate-400 mt-1">ØªØ³Ø¬ÙŠÙ„ Ø§Ø®ØªØ±Ø§Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ØªÙˆÙØ± Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
                            </div>
                          </div>
                          <label className="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" checked={formData.breachOnMissing || false}
                              onChange={(e) => setFormData({ ...formData, breachOnMissing: e.target.checked })}
                              disabled={modalMode === 'view'} className="sr-only peer" />
                            <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-purple-500"></div>
                          </label>
                        </div>
                      </div>

                      {/* Breach on Failed Test */}
                      <div className={`p-4 rounded-xl border-2 transition-all ${formData.breachOnFailed ? 'bg-rose-50 border-rose-300' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <button type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, breachOnFailed: !formData.breachOnFailed })}
                              className={`w-14 h-14 rounded-xl flex items-center justify-center text-2xl transition-all ${formData.breachOnFailed ? 'bg-rose-500 text-white shadow-lg' : 'bg-slate-100'
                                }`}>
                              {formData.breachOnFailed ? 'ğŸ”´' : 'âœ…'}
                            </button>
                            <div>
                              <p className="font-bold text-slate-800 text-lg">Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                              <p className="text-sm text-slate-500">Failed Test â†’ Breach</p>
                              <p className="text-xs text-slate-400 mt-1">ØªØ³Ø¬ÙŠÙ„ Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                            </div>
                          </div>
                          <label className="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" checked={formData.breachOnFailed || false}
                              onChange={(e) => setFormData({ ...formData, breachOnFailed: e.target.checked })}
                              disabled={modalMode === 'view'} className="sr-only peer" />
                            <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-rose-500"></div>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Escalation Rules */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-amber-50 px-5 py-3 border-b border-amber-100">
                      <h4 className="font-bold text-amber-700 flex items-center gap-2">
                        <ArrowUpCircle className="w-5 h-5" />
                        Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØµØ¹ÙŠØ¯ (Escalation Rules)
                      </h4>
                    </div>
                    <div className="p-5 space-y-4">
                      {/* Auto Escalate Toggle */}
                      <div className={`p-4 rounded-xl border-2 transition-all ${formData.autoEscalate ? 'bg-amber-50 border-amber-300' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between mb-4">
                          <div className="flex items-center gap-4">
                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-xl ${formData.autoEscalate ? 'bg-amber-500 text-white' : 'bg-slate-100'
                              }`}>
                              {formData.autoEscalate ? 'ğŸ“¢' : 'ğŸ”•'}
                            </div>
                            <div>
                              <p className="font-bold text-slate-800">Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</p>
                              <p className="text-sm text-slate-500">Auto Escalation Enabled</p>
                            </div>
                          </div>
                          <label className="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" checked={formData.autoEscalate || false}
                              onChange={(e) => setFormData({ ...formData, autoEscalate: e.target.checked })}
                              disabled={modalMode === 'view'} className="sr-only peer" />
                            <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-amber-500"></div>
                          </label>
                        </div>

                        {formData.autoEscalate && (
                          <div className="space-y-4 pt-4 border-t border-amber-200">
                            {/* Escalation Chain */}
                            <div>
                              <p className="text-sm font-bold text-slate-700 mb-3">Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØªØµØ¹ÙŠØ¯:</p>
                              <div className="flex items-center gap-2">
                                {[
                                  { level: 1, role: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', time: '24 Ø³Ø§Ø¹Ø©', icon: 'ğŸ‘¤' },
                                  { level: 2, role: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', time: '48 Ø³Ø§Ø¹Ø©', icon: 'ğŸ‘”' },
                                  { level: 3, role: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', time: '72 Ø³Ø§Ø¹Ø©', icon: 'ğŸ¯' },
                                  { level: 4, role: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§', time: '96 Ø³Ø§Ø¹Ø©', icon: 'ğŸ‘‘' },
                                ].map((item, idx) => (
                                  <React.Fragment key={item.level}>
                                    <div className="flex-1 bg-white rounded-xl p-3 border-2 border-amber-200 text-center">
                                      <span className="text-2xl block mb-1">{item.icon}</span>
                                      <p className="text-xs font-bold text-slate-700">{item.role}</p>
                                      <p className="text-xs text-amber-600">{item.time}</p>
                                    </div>
                                    {idx < 3 && <ChevronLeft className="w-5 h-5 text-amber-400" />}
                                  </React.Fragment>
                                ))}
                              </div>
                            </div>

                            {/* Escalation Timing */}
                            <div className="grid grid-cols-2 gap-4">
                              <div>
                                <label className="block text-xs font-bold text-slate-600 mb-1">ÙˆÙ‚Øª Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„Ø£ÙˆÙ„</label>
                                <select value={formData.firstEscalationHours || '24'}
                                  onChange={(e) => setFormData({ ...formData, firstEscalationHours: e.target.value })}
                                  disabled={modalMode === 'view'}
                                  className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400">
                                  <option value="12">12 Ø³Ø§Ø¹Ø©</option>
                                  <option value="24">24 Ø³Ø§Ø¹Ø©</option>
                                  <option value="48">48 Ø³Ø§Ø¹Ø©</option>
                                  <option value="72">72 Ø³Ø§Ø¹Ø©</option>
                                </select>
                              </div>
                              <div>
                                <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„ÙØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØµØ¹ÙŠØ¯Ø§Øª</label>
                                <select value={formData.escalationInterval || '24'}
                                  onChange={(e) => setFormData({ ...formData, escalationInterval: e.target.value })}
                                  disabled={modalMode === 'view'}
                                  className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-amber-400">
                                  <option value="12">12 Ø³Ø§Ø¹Ø©</option>
                                  <option value="24">24 Ø³Ø§Ø¹Ø©</option>
                                  <option value="48">48 Ø³Ø§Ø¹Ø©</option>
                                </select>
                              </div>
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Notification Settings */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-blue-50 px-5 py-3 border-b border-blue-100">
                      <h4 className="font-bold text-blue-700 flex items-center gap-2">
                        <Bell className="w-5 h-5" />
                        Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (Notification Settings)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-2 gap-4">
                        {[
                          { id: 'notifyOwner', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„', desc: 'Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', icon: 'ğŸ‘¤', color: 'blue' },
                          { id: 'notifyManager', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯ÙŠØ±', desc: 'Ø¹Ù†Ø¯ Ø§Ù„ØªØµØ¹ÙŠØ¯', icon: 'ğŸ‘”', color: 'indigo' },
                          { id: 'notifyCompliance', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', desc: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª', icon: 'ğŸ¯', color: 'purple' },
                          { id: 'notifyExternal', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ', desc: 'Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©', icon: 'ğŸ›ï¸', color: 'red' },
                        ].map(item => {
                          const isEnabled = formData[item.id];
                          return (
                            <button key={item.id} type="button" disabled={modalMode === 'view'}
                              onClick={() => setFormData({ ...formData, [item.id]: !formData[item.id] })}
                              className={`p-4 rounded-xl border-2 text-right transition-all ${isEnabled ? `bg-${item.color}-50 border-${item.color}-300` : 'bg-white border-slate-200 hover:border-slate-300'
                                }`}>
                              <div className="flex items-center gap-3">
                                <span className={`w-12 h-12 rounded-xl flex items-center justify-center text-xl ${isEnabled ? `bg-${item.color}-500 text-white` : 'bg-slate-100'
                                  }`}>{item.icon}</span>
                                <div className="flex-1">
                                  <p className={`font-bold ${isEnabled ? `text-${item.color}-700` : 'text-slate-700'}`}>{item.label}</p>
                                  <p className="text-xs text-slate-500">{item.desc}</p>
                                </div>
                                {isEnabled && <CheckCircle2 className={`w-6 h-6 text-${item.color}-500`} />}
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Remediation Actions */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-emerald-50 px-5 py-3 border-b border-emerald-100">
                      <h4 className="font-bold text-emerald-700 flex items-center gap-2">
                        <Settings className="w-5 h-5" />
                        Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© (Remediation Actions)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-3 gap-3">
                        {[
                          { id: 'autoCreateTask', label: 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ù…Ø© Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: 'ğŸ“‹' },
                          { id: 'requireRCA', label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ', icon: 'ğŸ”' },
                          { id: 'requireActionPlan', label: 'Ø®Ø·Ø© Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªØµØ­ÙŠØ­ÙŠØ©', icon: 'ğŸ“' },
                          { id: 'requireApproval', label: 'Ù…ÙˆØ§ÙÙ‚Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚', icon: 'âœ…' },
                          { id: 'documentEvidence', label: 'ØªÙˆØ«ÙŠÙ‚ Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: 'ğŸ“' },
                          { id: 'scheduleRetest', label: 'Ø¬Ø¯ÙˆÙ„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: 'ğŸ”„' },
                        ].map(action => {
                          const isSelected = (formData.remediationActions || []).includes(action.id);
                          return (
                            <button key={action.id} type="button" disabled={modalMode === 'view'}
                              onClick={() => {
                                if (isSelected) {
                                  setFormData({ ...formData, remediationActions: (formData.remediationActions || []).filter(a => a !== action.id) });
                                } else {
                                  setFormData({ ...formData, remediationActions: [...(formData.remediationActions || []), action.id] });
                                }
                              }}
                              className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-emerald-50 border-emerald-400' : 'bg-white border-slate-200 hover:border-emerald-300'
                                }`}>
                              <span className="text-2xl block mb-1">{action.icon}</span>
                              <p className={`text-sm font-bold ${isSelected ? 'text-emerald-700' : 'text-slate-600'}`}>{action.label}</p>
                              {isSelected && <CheckCircle2 className="w-4 h-4 text-emerald-500 mx-auto mt-1" />}
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Summary Dashboard */}
                  <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                    <h4 className="font-bold mb-4 flex items-center gap-2">
                      <BarChart3 className="w-5 h-5 text-red-400" />
                      Ù…Ù„Ø®Øµ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø°
                    </h4>
                    <div className="grid grid-cols-5 gap-4">
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸš¨</p>
                        <p className="text-slate-300 text-xs">Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚</p>
                        <p className="font-bold text-lg mt-1">
                          {[formData.breachOnOverdue, formData.breachOnRejection, formData.breachOnMissing, formData.breachOnFailed].filter(Boolean).length}
                        </p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">{formData.autoEscalate ? 'ğŸ“¢' : 'ğŸ”•'}</p>
                        <p className="text-slate-300 text-xs">Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</p>
                        <p className="font-bold text-lg mt-1">{formData.autoEscalate ? 'Ù…ÙØ¹Ù‘Ù„' : 'Ù…Ø¹Ø·Ù‘Ù„'}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ””</p>
                        <p className="text-slate-300 text-xs">Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</p>
                        <p className="font-bold text-lg mt-1">
                          {[formData.notifyOwner, formData.notifyManager, formData.notifyCompliance, formData.notifyExternal].filter(Boolean).length}
                        </p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">ğŸ”§</p>
                        <p className="text-slate-300 text-xs">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</p>
                        <p className="font-bold text-lg mt-1">{(formData.remediationActions || []).length}</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-3xl mb-2">â±ï¸</p>
                        <p className="text-slate-300 text-xs">Ø£ÙˆÙ„ ØªØµØ¹ÙŠØ¯</p>
                        <p className="font-bold text-lg mt-1">{formData.firstEscalationHours || 24}h</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 9: Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª - PREMIUM INTERACTIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'impact' && (
                <div className="space-y-6">
                  {/* Header Info */}
                  <div className="bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl p-5 text-white">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                          <Scale className="w-7 h-7" />
                        </div>
                        <div>
                          <h3 className="text-xl font-black">Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</h3>
                          <p className="text-orange-100 text-sm">Impact & Regulatory Exposure Assessment</p>
                        </div>
                      </div>
                      <div className="text-left">
                        <p className="text-orange-200 text-xs">Risk Score</p>
                        <p className="text-4xl font-black">{((formData.impactLevel || 3) * 2) + ((formData.exposureTypes || []).length * 1.5)}</p>
                      </div>
                    </div>
                  </div>

                  {/* Impact Level - Interactive */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <TrendingUp className="w-5 h-5 text-orange-500" />
                        Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ£Ø«ÙŠØ± (Impact Level)
                      </h4>
                    </div>
                    <div className="p-5">
                      <div className="flex items-center gap-6">
                        {/* Impact Scale Visual */}
                        <div className="flex-1">
                          <div className="flex justify-between mb-2">
                            {[1, 2, 3, 4, 5].map(level => (
                              <button key={level} type="button" disabled={modalMode === 'view'}
                                onClick={() => setFormData({ ...formData, impactLevel: level })}
                                className={`w-16 h-16 rounded-2xl font-black text-xl transition-all transform hover:scale-110 ${(formData.impactLevel || 3) === level
                                    ? level >= 4 ? 'bg-red-500 text-white shadow-lg shadow-red-500/50 scale-110' :
                                      level >= 3 ? 'bg-amber-500 text-white shadow-lg shadow-amber-500/50 scale-110' :
                                        'bg-emerald-500 text-white shadow-lg shadow-emerald-500/50 scale-110'
                                    : 'bg-slate-100 text-slate-400 hover:bg-slate-200'
                                  }`}>
                                {level}
                              </button>
                            ))}
                          </div>
                          <div className="flex justify-between text-xs font-bold mt-3">
                            <span className="text-emerald-600">ğŸŸ¢ Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ø§Ù‹</span>
                            <span className="text-emerald-500">Ù…Ù†Ø®ÙØ¶</span>
                            <span className="text-amber-500">âš ï¸ Ù…ØªÙˆØ³Ø·</span>
                            <span className="text-orange-500">Ø¹Ø§Ù„ÙŠ</span>
                            <span className="text-red-600">ğŸ”´ Ø­Ø±Ø¬</span>
                          </div>
                          {/* Progress Bar */}
                          <div className="mt-4 h-3 bg-slate-200 rounded-full overflow-hidden">
                            <div className={`h-full transition-all duration-500 rounded-full ${(formData.impactLevel || 3) >= 4 ? 'bg-gradient-to-r from-orange-500 to-red-500' :
                                (formData.impactLevel || 3) >= 3 ? 'bg-gradient-to-r from-amber-400 to-amber-500' :
                                  'bg-gradient-to-r from-emerald-400 to-emerald-500'
                              }`} style={{ width: `${((formData.impactLevel || 3) / 5) * 100}%` }} />
                          </div>
                        </div>

                        {/* Impact Summary Card */}
                        <div className={`w-48 p-4 rounded-2xl text-center transition-all ${(formData.impactLevel || 3) >= 4 ? 'bg-red-50 border-2 border-red-300' :
                            (formData.impactLevel || 3) >= 3 ? 'bg-amber-50 border-2 border-amber-300' :
                              'bg-emerald-50 border-2 border-emerald-300'
                          }`}>
                          <div className={`text-5xl mb-2 ${(formData.impactLevel || 3) >= 4 ? 'animate-pulse' : ''
                            }`}>
                            {(formData.impactLevel || 3) >= 4 ? 'ğŸš¨' : (formData.impactLevel || 3) >= 3 ? 'âš ï¸' : 'âœ…'}
                          </div>
                          <p className={`text-lg font-black ${(formData.impactLevel || 3) >= 4 ? 'text-red-700' :
                              (formData.impactLevel || 3) >= 3 ? 'text-amber-700' : 'text-emerald-700'
                            }`}>
                            {(formData.impactLevel || 3) >= 4 ? 'ØªØ£Ø«ÙŠØ± Ø­Ø±Ø¬' :
                              (formData.impactLevel || 3) >= 3 ? 'ØªØ£Ø«ÙŠØ± Ù…ØªÙˆØ³Ø·' : 'ØªØ£Ø«ÙŠØ± Ù…Ù†Ø®ÙØ¶'}
                          </p>
                          <p className="text-sm text-slate-500 mt-1">
                            {(formData.impactLevel || 3) >= 4 ? 'ÙŠØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙÙˆØ±ÙŠ' :
                              (formData.impactLevel || 3) >= 3 ? 'ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©' : 'Ø¶Ù…Ù† Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„'}
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Exposure Types - Interactive Cards */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200 flex items-center justify-between">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <AlertTriangle className="w-5 h-5 text-red-500" />
                        Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ (Regulatory Exposure)
                      </h4>
                      <span className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-bold">
                        {(formData.exposureTypes || []).length} Ù…Ø­Ø¯Ø¯
                      </span>
                    </div>
                    <div className="p-5">
                      <div className="grid grid-cols-2 gap-4">
                        {[
                          { value: 'financial', label: 'Ù…Ø§Ù„ÙŠ', desc: 'ØºØ±Ø§Ù…Ø§Øª ÙˆØ¹Ù‚ÙˆØ¨Ø§Øª Ù…Ø§Ù„ÙŠØ©', icon: 'ğŸ’°', color: 'red', examples: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 5 Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„' },
                          { value: 'license', label: 'ØªØ±Ø®ÙŠØµ', desc: 'Ø¥ÙŠÙ‚Ø§Ù Ø£Ùˆ Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ', icon: 'ğŸ“œ', color: 'purple', examples: 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø·ØŒ Ø³Ø­Ø¨ Ø§Ù„Ø±Ø®ØµØ©' },
                          { value: 'reputation', label: 'Ø³Ù…Ø¹Ø©', desc: 'Ø¶Ø±Ø± Ù„Ù„Ø³Ù…Ø¹Ø© ÙˆØ§Ù„Ø«Ù‚Ø©', icon: 'ğŸ¢', color: 'orange', examples: 'ØªØ´Ù‡ÙŠØ±ØŒ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø«Ù‚Ø©' },
                          { value: 'criminal', label: 'Ø¬Ù†Ø§Ø¦ÙŠ', desc: 'Ù…Ù„Ø§Ø­Ù‚Ø© Ø¬Ù†Ø§Ø¦ÙŠØ©', icon: 'âš–ï¸', color: 'slate', examples: 'Ø§Ù„Ø³Ø¬Ù†ØŒ Ø§Ù„Ù…Ù†Ø¹ Ù…Ù† Ø§Ù„Ø³ÙØ±' },
                          { value: 'operational', label: 'ØªØ´ØºÙŠÙ„ÙŠ', desc: 'ØªÙˆÙ‚Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', icon: 'âš™ï¸', color: 'blue', examples: 'Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù†Ø´Ø£Ø©ØŒ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª' },
                          { value: 'contractual', label: 'ØªØ¹Ø§Ù‚Ø¯ÙŠ', desc: 'ÙØ³Ø® Ø§Ù„Ø¹Ù‚ÙˆØ¯', icon: 'ğŸ“‹', color: 'indigo', examples: 'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø´Ø±Ø§ÙƒØ§ØªØŒ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡' },
                        ].map(exp => {
                          const isSelected = (formData.exposureTypes || []).includes(exp.value);
                          return (
                            <button key={exp.value} type="button" disabled={modalMode === 'view'}
                              onClick={() => {
                                if (isSelected) {
                                  setFormData({ ...formData, exposureTypes: (formData.exposureTypes || []).filter(t => t !== exp.value) });
                                } else {
                                  setFormData({ ...formData, exposureTypes: [...(formData.exposureTypes || []), exp.value] });
                                }
                              }}
                              className={`p-4 rounded-2xl border-2 text-right transition-all transform hover:scale-[1.02] ${isSelected
                                  ? `bg-${exp.color}-50 border-${exp.color}-400 shadow-lg`
                                  : 'bg-white border-slate-200 hover:border-slate-300'
                                }`}>
                              <div className="flex items-start gap-3">
                                <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-2xl ${isSelected ? `bg-${exp.color}-100` : 'bg-slate-100'
                                  }`}>
                                  {exp.icon}
                                </div>
                                <div className="flex-1">
                                  <div className="flex items-center justify-between">
                                    <p className={`font-bold ${isSelected ? `text-${exp.color}-700` : 'text-slate-700'}`}>{exp.label}</p>
                                    <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${isSelected ? `bg-${exp.color}-500 border-${exp.color}-500` : 'border-slate-300'
                                      }`}>
                                      {isSelected && <CheckCircle2 className="w-4 h-4 text-white" />}
                                    </div>
                                  </div>
                                  <p className="text-sm text-slate-500 mt-1">{exp.desc}</p>
                                  <p className={`text-xs mt-2 px-2 py-1 rounded-lg inline-block ${isSelected ? `bg-${exp.color}-100 text-${exp.color}-600` : 'bg-slate-100 text-slate-500'
                                    }`}>{exp.examples}</p>
                                </div>
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>

                  {/* Penalty Calculator */}
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-red-50 px-5 py-3 border-b border-red-100">
                        <h4 className="font-bold text-red-700 flex items-center gap-2">
                          <AlertCircle className="w-5 h-5" />
                          Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØºØ±Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©
                        </h4>
                      </div>
                      <div className="p-4 space-y-3">
                        <div className="grid grid-cols-2 gap-3">
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ (Ø±ÙŠØ§Ù„)</label>
                            <input type="number" value={formData.penaltyMin || 0} onChange={(e) => setFormData({ ...formData, penaltyMin: parseInt(e.target.value) || 0 })}
                              disabled={modalMode === 'view'} className="w-full px-3 py-2 border-2 border-slate-200 rounded-xl text-sm disabled:bg-slate-50" placeholder="0" />
                          </div>
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (Ø±ÙŠØ§Ù„)</label>
                            <input type="number" value={formData.penaltyMax || 0} onChange={(e) => setFormData({ ...formData, penaltyMax: parseInt(e.target.value) || 0 })}
                              disabled={modalMode === 'view'} className="w-full px-3 py-2 border-2 border-slate-200 rounded-xl text-sm disabled:bg-slate-50" placeholder="0" />
                          </div>
                        </div>
                        {(formData.penaltyMin || formData.penaltyMax) && (
                          <div className="p-3 bg-red-50 rounded-xl">
                            <p className="text-red-700 text-sm font-bold">
                              ğŸ’° Ù†Ø·Ø§Ù‚ Ø§Ù„ØºØ±Ø§Ù…Ø©: {(formData.penaltyMin || 0).toLocaleString()} - {(formData.penaltyMax || 0).toLocaleString()} Ø±ÙŠØ§Ù„
                            </p>
                          </div>
                        )}
                      </div>
                    </div>

                    <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                      <div className="bg-purple-50 px-5 py-3 border-b border-purple-100">
                        <h4 className="font-bold text-purple-700 flex items-center gap-2">
                          <Clock className="w-5 h-5" />
                          Ù…Ø¯Ø© Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù/Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©
                        </h4>
                      </div>
                      <div className="p-4 space-y-3">
                        <div className="grid grid-cols-2 gap-3">
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ù…Ø¯Ø©</label>
                            <input type="number" value={formData.suspensionDuration || 0} onChange={(e) => setFormData({ ...formData, suspensionDuration: parseInt(e.target.value) || 0 })}
                              disabled={modalMode === 'view'} className="w-full px-3 py-2 border-2 border-slate-200 rounded-xl text-sm disabled:bg-slate-50" placeholder="0" />
                          </div>
                          <div>
                            <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„ÙˆØ­Ø¯Ø©</label>
                            <select value={formData.suspensionUnit || 'days'} onChange={(e) => setFormData({ ...formData, suspensionUnit: e.target.value })}
                              disabled={modalMode === 'view'} className="w-full px-3 py-2 border-2 border-slate-200 rounded-xl text-sm disabled:bg-slate-50">
                              <option value="hours">Ø³Ø§Ø¹Ø§Øª</option>
                              <option value="days">Ø£ÙŠØ§Ù…</option>
                              <option value="months">Ø£Ø´Ù‡Ø±</option>
                              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
                            </select>
                          </div>
                        </div>
                        {formData.suspensionDuration > 0 && (
                          <div className="p-3 bg-purple-50 rounded-xl">
                            <p className="text-purple-700 text-sm font-bold">
                              â±ï¸ Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©: {formData.suspensionDuration} {formData.suspensionUnit === 'hours' ? 'Ø³Ø§Ø¹Ø©' : formData.suspensionUnit === 'days' ? 'ÙŠÙˆÙ…' : formData.suspensionUnit === 'months' ? 'Ø´Ù‡Ø±' : 'Ø³Ù†Ø©'}
                            </p>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Penalty Details */}
                  <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                    <div className="bg-slate-50 px-5 py-3 border-b border-slate-200">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <FileText className="w-5 h-5 text-slate-500" />
                        ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
                      </h4>
                    </div>
                    <div className="p-4">
                      <textarea value={formData.penaltyDetails || ''} onChange={(e) => setFormData({ ...formData, penaltyDetails: e.target.value })} disabled={modalMode === 'view'}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 focus:border-orange-400 focus:outline-none h-24 resize-none"
                        placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© Ø¨Ø´ÙƒÙ„ ØªÙØµÙŠÙ„ÙŠ... Ù…Ø«Ø§Ù„: ØºØ±Ø§Ù…Ø© Ù…Ø§Ù„ÙŠØ© ØªØµÙ„ Ø¥Ù„Ù‰ 100,000 Ø±ÙŠØ§Ù„ ÙÙŠ Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ØŒ ÙˆÙ…Ø¶Ø§Ø¹ÙØ© Ø§Ù„ØºØ±Ø§Ù…Ø© ÙÙŠ Ø­Ø§Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø±ØŒ Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù…Ø¯Ø© 30 ÙŠÙˆÙ…..." />
                    </div>
                  </div>

                  {/* Risk Summary Dashboard */}
                  <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                    <h4 className="font-bold mb-4 flex items-center gap-2">
                      <BarChart3 className="w-5 h-5 text-orange-400" />
                      Ù…Ù„Ø®Øµ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±
                    </h4>
                    <div className="grid grid-cols-4 gap-4">
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className={`text-4xl font-black ${(formData.impactLevel || 3) >= 4 ? 'text-red-400' :
                            (formData.impactLevel || 3) >= 3 ? 'text-amber-400' : 'text-emerald-400'
                          }`}>{formData.impactLevel || 3}/5</p>
                        <p className="text-slate-300 text-sm mt-1">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ£Ø«ÙŠØ±</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-4xl font-black text-orange-400">{(formData.exposureTypes || []).length}</p>
                        <p className="text-slate-300 text-sm mt-1">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØ¹Ø±Ø¶</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className="text-4xl font-black text-red-400">
                          {formData.penaltyMax ? (formData.penaltyMax / 1000).toFixed(0) + 'K' : '0'}
                        </p>
                        <p className="text-slate-300 text-sm mt-1">Ø£Ù‚ØµÙ‰ ØºØ±Ø§Ù…Ø© (Ø£Ù„Ù)</p>
                      </div>
                      <div className="bg-white/10 rounded-xl p-4 text-center backdrop-blur">
                        <p className={`text-4xl font-black ${((formData.impactLevel || 3) * 2 + (formData.exposureTypes || []).length * 1.5) >= 10 ? 'text-red-400' :
                            ((formData.impactLevel || 3) * 2 + (formData.exposureTypes || []).length * 1.5) >= 6 ? 'text-amber-400' : 'text-emerald-400'
                          }`}>
                          {(((formData.impactLevel || 3) * 2 + (formData.exposureTypes || []).length * 1.5)).toFixed(1)}
                        </p>
                        <p className="text-slate-300 text-sm mt-1">Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 10: Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚ - ENHANCED â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'audit' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 border-2 border-purple-200">
                    <h3 className="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                      <Layers className="w-5 h-5" />Ø§Ù„ØªØµÙ†ÙŠÙ
                    </h3>
                    <div className="grid grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-3">ØªØµÙ†ÙŠÙ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</label>
                        <div className="grid grid-cols-2 gap-2">
                          {CATEGORIES.map(cat => (
                            <button key={cat.code} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, category: cat.code })}
                              disabled={modalMode === 'view'}
                              className={`p-3 rounded-xl border-2 text-sm font-bold transition-all ${formData.category === cat.code
                                  ? 'border-purple-500 bg-purple-100 text-purple-700'
                                  : 'border-slate-200 bg-white hover:border-purple-300 text-slate-600'
                                } disabled:opacity-50`}>
                              {cat.nameAr}
                            </button>
                          ))}
                        </div>
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</label>
                        <div className="space-y-2">
                          {[
                            { value: 'Mandatory', label: 'Ø¥Ù„Ø²Ø§Ù…ÙŠ', icon: AlertCircle, color: 'red' },
                            { value: 'Recommended', label: 'Ù…ÙˆØµÙ‰ Ø¨Ù‡', icon: CheckCircle2, color: 'amber' },
                            { value: 'Optional', label: 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ', icon: Info, color: 'blue' },
                          ].map(type => {
                            const TypeIcon = type.icon;
                            return (
                              <button key={type.value} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, obligationType: type.value })}
                                disabled={modalMode === 'view'}
                                className={`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${formData.obligationType === type.value
                                    ? `border-${type.color}-500 bg-${type.color}-50`
                                    : 'border-slate-200 bg-white hover:border-slate-300'
                                  } disabled:opacity-50`}>
                                <TypeIcon className={`w-5 h-5 text-${type.color}-500`} />
                                <span className="font-bold">{type.label}</span>
                              </button>
                            );
                          })}
                        </div>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                    <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                      <Target className="w-5 h-5 text-emerald-500" />Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                    </h3>
                    <div className="grid grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-3">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ø·Ø§Ù‚</label>
                        <div className="space-y-2">
                          {[
                            { value: 'Enterprise', label: 'Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø´Ø£Ø©', desc: 'ÙŠØ·Ø¨Ù‚ Ø¹Ù„Ù‰ ÙƒØ§ÙØ© Ø§Ù„ÙˆØ­Ø¯Ø§Øª' },
                            { value: 'Department', label: 'Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', desc: 'ÙŠØ·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø§Øª Ù…Ø­Ø¯Ø¯Ø©' },
                            { value: 'Process', label: 'Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', desc: 'ÙŠØ·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø©' },
                          ].map(scope => (
                            <button key={scope.value} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, scopeLevel: scope.value })}
                              disabled={modalMode === 'view'}
                              className={`w-full text-right p-4 rounded-xl border-2 transition-all ${formData.scopeLevel === scope.value
                                  ? 'border-emerald-500 bg-emerald-50'
                                  : 'border-slate-200 bg-white hover:border-emerald-300'
                                } disabled:opacity-50`}>
                              <span className="font-bold block">{scope.label}</span>
                              <span className="text-sm text-slate-500">{scope.desc}</span>
                            </button>
                          ))}
                        </div>
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-3">Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                        <div className="space-y-2">
                          {[
                            { value: 'Applicable', label: 'Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚', color: 'emerald' },
                            { value: 'PartiallyApplicable', label: 'Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø²Ø¦ÙŠØ§Ù‹', color: 'amber' },
                            { value: 'NotApplicable', label: 'ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚', color: 'red' },
                          ].map(app => (
                            <button key={app.value} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, applicability: app.value })}
                              disabled={modalMode === 'view'}
                              className={`w-full p-3 rounded-xl border-2 font-bold transition-all ${formData.applicability === app.value
                                  ? `border-${app.color}-500 bg-${app.color}-50 text-${app.color}-700`
                                  : 'border-slate-200 bg-white hover:border-slate-300 text-slate-600'
                                } disabled:opacity-50`}>
                              {app.label}
                            </button>
                          ))}
                        </div>
                        {formData.applicability !== 'Applicable' && (
                          <div className="mt-4">
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø¨Ø±Ø± Ø¹Ø¯Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                            <textarea rows={2} value={formData.applicabilityJustification || ''}
                              onChange={(e) => setFormData({ ...formData, applicabilityJustification: e.target.value })}
                              disabled={modalMode === 'view'}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 resize-none"
                              placeholder="Ø§Ø°ÙƒØ± Ø³Ø¨Ø¨ Ø¹Ø¯Ù… ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…..." />
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 3: Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'priority' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border-2 border-red-200">
                    <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                      <AlertTriangle className="w-5 h-5" />Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù‡Ù…ÙŠØ© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      {[
                        { value: 'Critical', label: 'Ø­Ø±Ø¬', desc: 'ÙŠØªØ·Ù„Ø¨ Ø§Ù‡ØªÙ…Ø§Ù… ÙÙˆØ±ÙŠ', color: 'red', icon: AlertCircle },
                        { value: 'High', label: 'Ø¹Ø§Ù„ÙŠ', desc: 'Ø£ÙˆÙ„ÙˆÙŠØ© Ù‚ØµÙˆÙ‰', color: 'orange', icon: TrendingUp },
                        { value: 'Medium', label: 'Ù…ØªÙˆØ³Ø·', desc: 'Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ø¹ØªØ¯Ù„Ø©', color: 'amber', icon: Activity },
                        { value: 'Low', label: 'Ù…Ù†Ø®ÙØ¶', desc: 'ÙŠÙ…ÙƒÙ† Ø¬Ø¯ÙˆÙ„ØªÙ‡', color: 'emerald', icon: CheckCircle2 },
                      ].map(crit => {
                        const CritIcon = crit.icon;
                        const isSelected = formData.criticality === crit.value;
                        return (
                          <button key={crit.value} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, criticality: crit.value })}
                            disabled={modalMode === 'view'}
                            className={`p-4 rounded-2xl border-2 transition-all text-center ${isSelected
                                ? `border-${crit.color}-500 bg-${crit.color}-100 shadow-lg`
                                : 'border-slate-200 bg-white hover:border-slate-300'
                              } disabled:opacity-50`}>
                            <div className={`w-12 h-12 mx-auto rounded-xl flex items-center justify-center mb-2 ${isSelected ? `bg-${crit.color}-500 text-white` : 'bg-slate-100 text-slate-500'
                              }`}>
                              <CritIcon className="w-6 h-6" />
                            </div>
                            <span className={`font-bold block ${isSelected ? `text-${crit.color}-700` : 'text-slate-700'}`}>{crit.label}</span>
                            <span className="text-xs text-slate-500">{crit.desc}</span>
                          </button>
                        );
                      })}
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                      <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <Scale className="w-5 h-5 text-purple-500" />ØªØ£Ø«ÙŠØ± Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„
                      </h4>
                      <div className="space-y-2">
                        {[
                          { value: 'Financial', label: 'Ù…Ø§Ù„ÙŠ - ØºØ±Ø§Ù…Ø§Øª ÙˆØ¹Ù‚ÙˆØ¨Ø§Øª', icon: 'ğŸ’°' },
                          { value: 'Reputational', label: 'Ø³Ù…Ø¹Ø© - Ø¶Ø±Ø± Ù„Ù„Ø³Ù…Ø¹Ø©', icon: 'ğŸ“¢' },
                          { value: 'Operational', label: 'ØªØ´ØºÙŠÙ„ÙŠ - ØªÙˆÙ‚Ù Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', icon: 'âš™ï¸' },
                          { value: 'Legal', label: 'Ù‚Ø§Ù†ÙˆÙ†ÙŠ - Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù‚Ø¶Ø§Ø¦ÙŠØ©', icon: 'âš–ï¸' },
                          { value: 'Regulatory', label: 'ØªÙ†Ø¸ÙŠÙ…ÙŠ - Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ', icon: 'ğŸ›ï¸' },
                        ].map(impact => (
                          <label key={impact.value} className="flex items-center gap-3 p-3 rounded-xl border-2 border-slate-200 hover:bg-slate-50 cursor-pointer">
                            <input type="checkbox" checked={formData.impactTypes?.includes(impact.value) || false}
                              onChange={(e) => {
                                if (modalMode === 'view') return;
                                const current = formData.impactTypes || [];
                                setFormData({
                                  ...formData,
                                  impactTypes: e.target.checked
                                    ? [...current, impact.value]
                                    : current.filter(i => i !== impact.value)
                                });
                              }}
                              disabled={modalMode === 'view'}
                              className="w-5 h-5 rounded text-purple-500" />
                            <span className="text-xl">{impact.icon}</span>
                            <span className="font-bold text-slate-700">{impact.label}</span>
                          </label>
                        ))}
                      </div>
                    </div>
                    <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                      <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <AlertTriangle className="w-5 h-5 text-red-500" />ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±
                      </h4>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-600 mb-2">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©</label>
                          <div className="flex gap-2">
                            {['Low', 'Medium', 'High', 'VeryHigh'].map(level => (
                              <button key={level} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, riskLikelihood: level })}
                                disabled={modalMode === 'view'}
                                className={`flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all ${formData.riskLikelihood === level
                                    ? level === 'Low' ? 'bg-emerald-500 text-white' :
                                      level === 'Medium' ? 'bg-amber-500 text-white' :
                                        level === 'High' ? 'bg-orange-500 text-white' :
                                          'bg-red-500 text-white'
                                    : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                                  } disabled:opacity-50`}>
                                {level === 'Low' ? 'Ù…Ù†Ø®ÙØ¶' : level === 'Medium' ? 'Ù…ØªÙˆØ³Ø·' : level === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹'}
                              </button>
                            ))}
                          </div>
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-600 mb-2">Ø­Ø¬Ù… Ø§Ù„ØªØ£Ø«ÙŠØ±</label>
                          <div className="flex gap-2">
                            {['Low', 'Medium', 'High', 'VeryHigh'].map(level => (
                              <button key={level} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, riskImpact: level })}
                                disabled={modalMode === 'view'}
                                className={`flex-1 py-2 px-3 rounded-lg text-sm font-bold transition-all ${formData.riskImpact === level
                                    ? level === 'Low' ? 'bg-emerald-500 text-white' :
                                      level === 'Medium' ? 'bg-amber-500 text-white' :
                                        level === 'High' ? 'bg-orange-500 text-white' :
                                          'bg-red-500 text-white'
                                    : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                                  } disabled:opacity-50`}>
                                {level === 'Low' ? 'Ù…Ù†Ø®ÙØ¶' : level === 'Medium' ? 'Ù…ØªÙˆØ³Ø·' : level === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹'}
                              </button>
                            ))}
                          </div>
                        </div>
                        {formData.riskLikelihood && formData.riskImpact && (
                          <div className={`p-4 rounded-xl text-center ${(formData.riskLikelihood === 'VeryHigh' || formData.riskImpact === 'VeryHigh') ? 'bg-red-100 border-2 border-red-300' :
                              (formData.riskLikelihood === 'High' || formData.riskImpact === 'High') ? 'bg-orange-100 border-2 border-orange-300' :
                                (formData.riskLikelihood === 'Medium' || formData.riskImpact === 'Medium') ? 'bg-amber-100 border-2 border-amber-300' :
                                  'bg-emerald-100 border-2 border-emerald-300'
                            }`}>
                            <span className="text-sm font-bold">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„ÙƒÙ„ÙŠ: </span>
                            <span className="text-lg font-bold">
                              {(formData.riskLikelihood === 'VeryHigh' || formData.riskImpact === 'VeryHigh') ? 'ğŸ”´ Ø­Ø±Ø¬' :
                                (formData.riskLikelihood === 'High' || formData.riskImpact === 'High') ? 'ğŸŸ  Ø¹Ø§Ù„ÙŠ' :
                                  (formData.riskLikelihood === 'Medium' || formData.riskImpact === 'Medium') ? 'ğŸŸ¡ Ù…ØªÙˆØ³Ø·' :
                                    'ğŸŸ¢ Ù…Ù†Ø®ÙØ¶'}
                            </span>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 4: Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø¯ÙˆØ±ÙŠØ© â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'dates' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-amber-50 to-yellow-50 rounded-2xl p-6 border-2 border-amber-200">
                    <h3 className="text-lg font-bold text-amber-800 mb-4 flex items-center gap-2">
                      <Calendar className="w-5 h-5" />Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </h3>
                    <div className="grid grid-cols-3 gap-6">
                      <div className="bg-white rounded-xl p-4 border border-amber-200">
                        <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†</label>
                        <input type="date" value={formData.effectiveDate || ''} onChange={(e) => setFormData({ ...formData, effectiveDate: e.target.value })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50" />
                        <p className="text-xs text-slate-500 mt-2">ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø¡ Ø³Ø±ÙŠØ§Ù† Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 border border-amber-200">
                        <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ *</label>
                        <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50" />
                        <p className="text-xs text-slate-500 mt-2">Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 border border-amber-200">
                        <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</label>
                        <input type="date" value={formData.nextReviewDate || ''} onChange={(e) => setFormData({ ...formData, nextReviewDate: e.target.value })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50" />
                        <p className="text-xs text-slate-500 mt-2">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</p>
                      </div>
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                      <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <RefreshCw className="w-5 h-5 text-blue-500" />Ø¯ÙˆØ±ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚
                      </h4>
                      <div className="grid grid-cols-2 gap-2">
                        {FREQUENCIES.map(freq => (
                          <button key={freq.code} type="button" onClick={() => modalMode !== 'view' && setFormData({ ...formData, frequency: freq.code })}
                            disabled={modalMode === 'view'}
                            className={`p-3 rounded-xl border-2 text-sm font-bold transition-all ${formData.frequency === freq.code
                                ? 'border-blue-500 bg-blue-100 text-blue-700'
                                : 'border-slate-200 bg-white hover:border-blue-300 text-slate-600'
                              } disabled:opacity-50`}>
                            {freq.nameAr}
                          </button>
                        ))}
                      </div>
                    </div>
                    <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                      <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                        <Bell className="w-5 h-5 text-amber-500" />Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª
                      </h4>
                      <div className="space-y-3">
                        <label className="flex items-center gap-3 p-3 rounded-xl border-2 border-slate-200 hover:bg-slate-50 cursor-pointer">
                          <input type="checkbox" checked={formData.reminderBefore30 || false}
                            onChange={(e) => modalMode !== 'view' && setFormData({ ...formData, reminderBefore30: e.target.checked })}
                            disabled={modalMode === 'view'} className="w-5 h-5 rounded text-amber-500" />
                          <span className="font-bold text-slate-700">Ù‚Ø¨Ù„ 30 ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span>
                        </label>
                        <label className="flex items-center gap-3 p-3 rounded-xl border-2 border-slate-200 hover:bg-slate-50 cursor-pointer">
                          <input type="checkbox" checked={formData.reminderBefore14 || false}
                            onChange={(e) => modalMode !== 'view' && setFormData({ ...formData, reminderBefore14: e.target.checked })}
                            disabled={modalMode === 'view'} className="w-5 h-5 rounded text-amber-500" />
                          <span className="font-bold text-slate-700">Ù‚Ø¨Ù„ 14 ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span>
                        </label>
                        <label className="flex items-center gap-3 p-3 rounded-xl border-2 border-slate-200 hover:bg-slate-50 cursor-pointer">
                          <input type="checkbox" checked={formData.reminderBefore7 || false}
                            onChange={(e) => modalMode !== 'view' && setFormData({ ...formData, reminderBefore7: e.target.checked })}
                            disabled={modalMode === 'view'} className="w-5 h-5 rounded text-amber-500" />
                          <span className="font-bold text-slate-700">Ù‚Ø¨Ù„ 7 Ø£ÙŠØ§Ù… Ù…Ù† Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span>
                        </label>
                        <label className="flex items-center gap-3 p-3 rounded-xl border-2 border-red-200 bg-red-50 hover:bg-red-100 cursor-pointer">
                          <input type="checkbox" checked={formData.reminderOnDue || false}
                            onChange={(e) => modalMode !== 'view' && setFormData({ ...formData, reminderOnDue: e.target.checked })}
                            disabled={modalMode === 'view'} className="w-5 h-5 rounded text-red-500" />
                          <span className="font-bold text-red-700">ÙŠÙˆÙ… Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span>
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 5: Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'responsibilities' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl p-6 border-2 border-blue-200">
                    <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                      <Users className="w-5 h-5" />ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„
                    </h3>
                    <div className="grid grid-cols-3 gap-6">
                      <div className="bg-white rounded-xl p-5 border-2 border-blue-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center">
                            <User className="w-5 h-5 text-white" />
                          </div>
                          <div>
                            <span className="font-bold text-slate-800 block">Ø§Ù„Ù…Ø§Ù„Ùƒ</span>
                            <span className="text-xs text-slate-500">Owner</span>
                          </div>
                        </div>
                        <select value={formData.ownerId || ''} onChange={(e) => setFormData({ ...formData, ownerId: parseInt(e.target.value) })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50">
                          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ù„Ùƒ...</option>
                          {USERS.map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
                        </select>
                        <p className="text-xs text-slate-500 mt-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¹Ù† Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                      </div>
                      <div className="bg-white rounded-xl p-5 border-2 border-amber-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 rounded-xl bg-amber-500 flex items-center justify-center">
                            <UserCheck className="w-5 h-5 text-white" />
                          </div>
                          <div>
                            <span className="font-bold text-slate-800 block">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</span>
                            <span className="text-xs text-slate-500">Reviewer</span>
                          </div>
                        </div>
                        <select value={formData.reviewerId || ''} onChange={(e) => setFormData({ ...formData, reviewerId: parseInt(e.target.value) })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50">
                          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹...</option>
                          {USERS.map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
                        </select>
                        <p className="text-xs text-slate-500 mt-2">Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø©</p>
                      </div>
                      <div className="bg-white rounded-xl p-5 border-2 border-emerald-200">
                        <div className="flex items-center gap-3 mb-4">
                          <div className="w-10 h-10 rounded-xl bg-emerald-500 flex items-center justify-center">
                            <CheckCircle2 className="w-5 h-5 text-white" />
                          </div>
                          <div>
                            <span className="font-bold text-slate-800 block">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</span>
                            <span className="text-xs text-slate-500">Approver</span>
                          </div>
                        </div>
                        <select value={formData.approverId || ''} onChange={(e) => setFormData({ ...formData, approverId: parseInt(e.target.value) })} disabled={modalMode === 'view'}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50">
                          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯...</option>
                          {USERS.map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
                        </select>
                        <p className="text-xs text-slate-500 mt-2">Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                    <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                      <Building className="w-5 h-5 text-purple-500" />Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ©
                    </h4>
                    <div className="flex flex-wrap gap-2">
                      {['Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', 'Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©', 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ'].map(dept => (
                        <button key={dept} type="button" onClick={() => {
                          if (modalMode === 'view') return;
                          const current = formData.departments || [];
                          setFormData({
                            ...formData,
                            departments: current.includes(dept)
                              ? current.filter(d => d !== dept)
                              : [...current, dept]
                          });
                        }}
                          disabled={modalMode === 'view'}
                          className={`px-4 py-2 rounded-xl font-bold transition-all ${formData.departments?.includes(dept)
                              ? 'bg-purple-500 text-white'
                              : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                            } disabled:opacity-50`}>
                          {dept}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 6: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ø£Ø¯Ù„Ø© â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'links' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border-2 border-emerald-200">
                    <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                      <FileCheck className="w-5 h-5" />Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø©
                    </h3>
                    <div className="grid grid-cols-2 gap-6">
                      <div>
                        <label className="flex items-center gap-3 mb-4">
                          <input type="checkbox" checked={formData.evidenceRequired !== false}
                            onChange={(e) => modalMode !== 'view' && setFormData({ ...formData, evidenceRequired: e.target.checked })}
                            disabled={modalMode === 'view'} className="w-5 h-5 rounded text-emerald-500" />
                          <span className="font-bold text-slate-700">ÙŠØªØ·Ù„Ø¨ Ø£Ø¯Ù„Ø© Ø¥Ø«Ø¨Ø§Øª</span>
                        </label>
                        {formData.evidenceRequired !== false && (
                          <div className="space-y-2">
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                            {[
                              { value: 'Document', label: 'Ù…Ø³ØªÙ†Ø¯Ø§Øª', icon: FileText },
                              { value: 'Screenshot', label: 'Ù„Ù‚Ø·Ø§Øª Ø´Ø§Ø´Ø©', icon: Eye },
                              { value: 'Report', label: 'ØªÙ‚Ø§Ø±ÙŠØ±', icon: BarChart3 },
                              { value: 'Log', label: 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', icon: History },
                              { value: 'Attestation', label: 'Ø¥Ù‚Ø±Ø§Ø±Ø§Øª', icon: CheckSquare },
                            ].map(type => {
                              const TypeIcon = type.icon;
                              return (
                                <label key={type.value} className="flex items-center gap-3 p-3 rounded-xl border border-slate-200 hover:bg-emerald-50 cursor-pointer">
                                  <input type="checkbox" checked={formData.evidenceTypes?.includes(type.value) || false}
                                    onChange={(e) => {
                                      if (modalMode === 'view') return;
                                      const current = formData.evidenceTypes || [];
                                      setFormData({
                                        ...formData,
                                        evidenceTypes: e.target.checked
                                          ? [...current, type.value]
                                          : current.filter(t => t !== type.value)
                                      });
                                    }}
                                    disabled={modalMode === 'view'} className="w-4 h-4 rounded text-emerald-500" />
                                  <TypeIcon className="w-4 h-4 text-slate-500" />
                                  <span className="text-sm font-bold text-slate-700">{type.label}</span>
                                </label>
                              );
                            })}
                          </div>
                        )}
                      </div>
                      <div>
                        <div className="mb-4">
                          <label className="block text-sm font-bold text-slate-700 mb-2">ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¯Ù„ÙŠÙ„ (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…)</label>
                          <input type="number" value={formData.evidenceValidityDays || 365}
                            onChange={(e) => setFormData({ ...formData, evidenceValidityDays: parseInt(e.target.value) })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50" />
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„</label>
                          <textarea rows={4} value={formData.acceptanceCriteria || ''}
                            onChange={(e) => setFormData({ ...formData, acceptanceCriteria: e.target.value })}
                            disabled={modalMode === 'view'}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl disabled:bg-slate-50 resize-none"
                            placeholder="Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ø£Ù† ØªØ³ØªÙˆÙÙŠÙ‡Ø§ Ø§Ù„Ø£Ø¯Ù„Ø© Ù„ØªÙƒÙˆÙ† Ù…Ù‚Ø¨ÙˆÙ„Ø©..." />
                        </div>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                    <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                      <Link2 className="w-5 h-5 text-indigo-500" />Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
                    </h4>
                    <div className="grid grid-cols-3 gap-4">
                      <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                        <div className="flex items-center gap-2 mb-2">
                          <Shield className="w-5 h-5 text-indigo-500" />
                          <span className="font-bold text-indigo-700">Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·</span>
                        </div>
                        <p className="text-2xl font-bold text-indigo-600">{formData.linkedControls?.length || 0}</p>
                        <p className="text-xs text-indigo-500">Ø¶Ø§Ø¨Ø· Ù…Ø±ØªØ¨Ø·</p>
                      </div>
                      <div className="bg-purple-50 rounded-xl p-4 border border-purple-200">
                        <div className="flex items-center gap-2 mb-2">
                          <FileText className="w-5 h-5 text-purple-500" />
                          <span className="font-bold text-purple-700">Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª</span>
                        </div>
                        <p className="text-2xl font-bold text-purple-600">{formData.linkedPolicies?.length || 0}</p>
                        <p className="text-xs text-purple-500">Ø³ÙŠØ§Ø³Ø© Ù…Ø±ØªØ¨Ø·Ø©</p>
                      </div>
                      <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                        <div className="flex items-center gap-2 mb-2">
                          <FileCheck className="w-5 h-5 text-emerald-500" />
                          <span className="font-bold text-emerald-700">Ø§Ù„Ø£Ø¯Ù„Ø©</span>
                        </div>
                        <p className="text-2xl font-bold text-emerald-600">{formData.linkedEvidence?.length || 0}</p>
                        <p className="text-xs text-emerald-500">Ø¯Ù„ÙŠÙ„ Ù…Ø±ÙÙ‚</p>
                      </div>
                    </div>
                    {modalMode !== 'view' && (
                      <button className="mt-4 w-full flex items-center justify-center gap-2 p-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-xl hover:bg-indigo-50 font-bold">
                        <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯
                      </button>
                    )}
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB 7: Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
              {modalTab === 'audit' && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-slate-50 to-gray-50 rounded-2xl p-6 border-2 border-slate-200">
                    <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                      <History className="w-5 h-5" />Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØªØ¨Ø¹
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                        <Calendar className="w-8 h-8 text-blue-500 mx-auto mb-2" />
                        <p className="text-xs text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</p>
                        <p className="font-bold text-slate-800">{formData.createdAt || '-'}</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                        <User className="w-8 h-8 text-emerald-500 mx-auto mb-2" />
                        <p className="text-xs text-slate-500 mb-1">Ø£Ù†Ø´Ø¦ Ø¨ÙˆØ§Ø³Ø·Ø©</p>
                        <p className="font-bold text-slate-800">{getUser(formData.createdBy)?.name || '-'}</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                        <RefreshCw className="w-8 h-8 text-amber-500 mx-auto mb-2" />
                        <p className="text-xs text-slate-500 mb-1">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</p>
                        <p className="font-bold text-slate-800">{formData.updatedAt || '-'}</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                        <Edit className="w-8 h-8 text-purple-500 mx-auto mb-2" />
                        <p className="text-xs text-slate-500 mb-1">Ø¹ÙØ¯Ù‘Ù„ Ø¨ÙˆØ§Ø³Ø·Ø©</p>
                        <p className="font-bold text-slate-800">{getUser(formData.updatedBy)?.name || '-'}</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                    <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                      <History className="w-5 h-5 text-slate-500" />Ø³Ø¬Ù„ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                    </h4>
                    {formData.auditTrail?.length > 0 ? (
                      <div className="space-y-3 max-h-64 overflow-y-auto">
                        {formData.auditTrail.map((entry, idx) => (
                          <div key={idx} className="flex items-start gap-4 p-3 bg-slate-50 rounded-xl">
                            <div className="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center flex-shrink-0">
                              <History className="w-5 h-5 text-slate-500" />
                            </div>
                            <div className="flex-1">
                              <p className="font-bold text-slate-800">{entry.action}</p>
                              <p className="text-sm text-slate-500">{entry.details}</p>
                              <div className="flex items-center gap-2 mt-1 text-xs text-slate-400">
                                <span>{entry.user}</span>
                                <span>â€¢</span>
                                <span>{entry.date}</span>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : (
                      <div className="text-center py-8 text-slate-400">
                        <History className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ø¹Ø¯</p>
                      </div>
                    )}
                  </div>
                </div>
              )}
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER - ENHANCED 10 TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className="border-t border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between">
              <div className="flex items-center gap-2">
                <button onClick={() => { setShowModal(false); setModalTab('basic'); }}
                  className="px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all text-sm">
                  {modalMode === 'view' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Ø¥Ù„ØºØ§Ø¡'}
                </button>
                {modalMode !== 'view' && (
                  <button onClick={() => setFormData(createEmptyForm())}
                    className="px-3 py-2.5 text-slate-500 hover:text-slate-700 font-bold transition-all">
                    <RotateCcw className="w-4 h-4" />
                  </button>
                )}
              </div>
              <div className="flex items-center gap-2">
                {modalTab !== 'basic' && (
                  <button onClick={() => {
                    const tabs = ['basic', 'reference', 'program', 'applicability', 'evidence', 'schedule', 'testing', 'enforcement', 'impact', 'audit'];
                    const currentIdx = tabs.indexOf(modalTab);
                    if (currentIdx > 0) setModalTab(tabs[currentIdx - 1]);
                  }} className="flex items-center gap-1.5 px-4 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all text-sm">
                    <ChevronRight className="w-4 h-4" />Ø§Ù„Ø³Ø§Ø¨Ù‚
                  </button>
                )}
                {modalTab !== 'audit' && modalMode !== 'view' && (
                  <button onClick={() => {
                    const tabs = ['basic', 'reference', 'program', 'applicability', 'evidence', 'schedule', 'testing', 'enforcement', 'impact', 'audit'];
                    const currentIdx = tabs.indexOf(modalTab);
                    if (currentIdx < tabs.length - 1) setModalTab(tabs[currentIdx + 1]);
                  }} className="flex items-center gap-1.5 px-4 py-2.5 bg-slate-700 text-white rounded-xl font-bold hover:bg-slate-800 transition-all text-sm">
                    Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-4 h-4" />
                  </button>
                )}
                {modalMode !== 'view' && (
                  <button onClick={handleSave} disabled={!formData.title || !formData.authorityId}
                    className="flex items-center gap-1.5 px-6 py-2.5 bg-gradient-to-r from-indigo-500 via-purple-500 to-violet-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 text-sm">
                    <Save className="w-4 h-4" />{modalMode === 'create' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…' : 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª'}
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Delete Confirmation */}
      {showDeleteConfirm && deleteTarget && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center"><Trash2 className="w-6 h-6" /></div>
                <div><h2 className="text-xl font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h2><p className="text-red-200">Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡</p></div>
              </div>
            </div>
            <div className="p-6">
              <p className="text-slate-600">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù:</p>
              <p className="font-bold text-slate-800 mt-2">{deleteTarget.code} - {deleteTarget.title}</p>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex justify-between">
              <button onClick={() => setShowDeleteConfirm(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={confirmDelete} className="flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-bold"><Trash2 className="w-5 h-5" />Ø­Ø°Ù</button>
            </div>
          </div>
        </div>
      )}

      {/* Bulk Actions Modal */}
      {showBulkModal && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-indigo-500 to-purple-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center"><CheckSquare className="w-6 h-6" /></div>
                <div><h2 className="text-xl font-bold">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ©</h2><p className="text-indigo-200">{selectedItems.length} Ø¹Ù†ØµØ± Ù…Ø­Ø¯Ø¯</p></div>
              </div>
            </div>
            <div className="p-6 space-y-3">
              <button onClick={() => handleBulkStatusChange('Active')} className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-emerald-500 hover:bg-emerald-50">
                <CheckCircle2 className="w-6 h-6 text-emerald-500" /><span className="font-bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙ„</span>
              </button>
              <button onClick={() => handleBulkStatusChange('Draft')} className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-slate-400 hover:bg-slate-50">
                <FileText className="w-6 h-6 text-slate-500" /><span className="font-bold">ØªØ­ÙˆÙŠÙ„ Ù„Ù…Ø³ÙˆØ¯Ø©</span>
              </button>
              <button onClick={handleBulkDelete} className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-red-200 bg-red-50 hover:bg-red-100">
                <Trash2 className="w-6 h-6 text-red-500" /><span className="font-bold text-red-700">Ø­Ø°Ù Ø§Ù„ÙƒÙ„</span>
              </button>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50">
              <button onClick={() => { setShowBulkModal(false); setSelectedItems([]); }} className="w-full px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const Dashboard = () => {
  const [timeRange, setTimeRange] = useState('month');
  const [showNotifications, setShowNotifications] = useState(false);

  const stats = useMemo(() => ({
    obligations: INITIAL_OBLIGATIONS.length,
    active: INITIAL_OBLIGATIONS.filter(o => o.status === 'Active').length,
    policies: POLICIES.length,
    activePolicies: POLICIES.filter(p => p.status === 'Active').length,
    controls: CONTROLS.length,
    implemented: CONTROLS.filter(c => c.implementationStatus === 'Implemented').length,
    risks: RISKS.length,
    highRisks: RISKS.filter(r => r.inherentRisk === 'High' || r.inherentRisk === 'Critical').length,
    complianceRate: Math.round((INITIAL_OBLIGATIONS.filter(o => o.status === 'Active').length / INITIAL_OBLIGATIONS.length) * 100) || 0,
  }), []);

  const notifications = [
    { id: 1, type: 'urgent', title: 'Ø§Ù„ØªØ²Ø§Ù… Ù…ØªØ£Ø®Ø±', message: 'SAMA-AML Ù…ØªØ£Ø®Ø± 5 Ø£ÙŠØ§Ù…', time: 'Ù…Ù†Ø° Ø³Ø§Ø¹Ø©' },
    { id: 2, type: 'warning', title: 'ØªØ³ØªØ­Ù‚ Ù‚Ø±ÙŠØ¨Ø§Ù‹', message: '3 Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù…', time: 'Ù…Ù†Ø° 3 Ø³Ø§Ø¹Ø§Øª' },
    { id: 3, type: 'success', title: 'ØªÙ… Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', message: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', time: 'Ù…Ù†Ø° ÙŠÙˆÙ…' },
  ];

  const activities = [
    { id: 1, action: 'Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„', user: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', target: 'ØªÙ‚Ø±ÙŠØ± AML', time: 'Ù…Ù†Ø° 30 Ø¯Ù‚ÙŠÙ‚Ø©', icon: Upload, color: 'blue' },
    { id: 2, action: 'Ø§Ø¹ØªÙ…Ø§Ø¯', user: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', target: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù†', time: 'Ù…Ù†Ø° Ø³Ø§Ø¹ØªÙŠÙ†', icon: CheckCircle2, color: 'emerald' },
    { id: 3, action: 'Ø¥Ù†Ø´Ø§Ø¡', user: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', target: 'NCA-ECC-4.1', time: 'Ù…Ù†Ø° 4 Ø³Ø§Ø¹Ø§Øª', icon: Plus, color: 'indigo' },
  ];

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-slate-900">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
          <p className="text-slate-500">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
        </div>
        <div className="flex items-center gap-3">
          <div className="flex border-2 border-slate-200 rounded-xl overflow-hidden">
            {['week', 'month', 'quarter'].map(r => (
              <button key={r} onClick={() => setTimeRange(r)} className={`px-4 py-2 text-sm font-bold ${timeRange === r ? 'bg-indigo-500 text-white' : 'text-slate-600'}`}>
                {r === 'week' ? 'Ø£Ø³Ø¨ÙˆØ¹' : r === 'month' ? 'Ø´Ù‡Ø±' : 'Ø±Ø¨Ø¹'}
              </button>
            ))}
          </div>
          <div className="relative">
            <button onClick={() => setShowNotifications(!showNotifications)} className="relative p-3 bg-white border-2 border-slate-200 rounded-xl hover:bg-slate-50">
              <Bell className="w-5 h-5 text-slate-600" />
              <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center">3</span>
            </button>
            {showNotifications && (
              <div className="absolute left-0 top-full mt-2 w-80 bg-white rounded-2xl shadow-2xl border-2 border-slate-200 z-50 overflow-hidden">
                <div className="px-4 py-3 bg-slate-50 border-b font-bold">Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</div>
                {notifications.map(n => (
                  <div key={n.id} className="px-4 py-3 border-b border-slate-100 hover:bg-slate-50">
                    <p className="font-bold text-sm">{n.title}</p>
                    <p className="text-xs text-slate-500">{n.message}</p>
                    <p className="text-xs text-slate-400 mt-1">{n.time}</p>
                  </div>
                ))}
              </div>
            )}
          </div>
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
          </button>
        </div>
      </div>

      {/* Main Stats */}
      <div className="grid grid-cols-5 gap-4">
        <div className="col-span-2 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 text-white">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-indigo-100 text-sm">Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
              <p className="text-4xl font-bold mt-1">{stats.complianceRate}%</p>
              <p className="text-indigo-200 text-sm mt-2">+5% Ø¹Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ</p>
            </div>
            <div className="w-20 h-20 relative">
              <svg className="w-20 h-20 transform -rotate-90">
                <circle cx="40" cy="40" r="35" stroke="rgba(255,255,255,0.2)" strokeWidth="8" fill="none" />
                <circle cx="40" cy="40" r="35" stroke="white" strokeWidth="8" fill="none" strokeDasharray={`${(stats.complianceRate / 100) * 220} 220`} strokeLinecap="round" />
              </svg>
              <Target className="w-8 h-8 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white/80" />
            </div>
          </div>
        </div>

        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
          <div className="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center mb-3"><ClipboardCheck className="w-5 h-5 text-blue-600" /></div>
          <p className="text-2xl font-bold text-slate-800">{stats.obligations}</p>
          <p className="text-sm text-slate-500">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</p>
          <p className="text-xs text-blue-600 mt-1">{stats.active} Ù†Ø´Ø·</p>
        </div>

        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
          <div className="w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center mb-3"><FileText className="w-5 h-5 text-purple-600" /></div>
          <p className="text-2xl font-bold text-slate-800">{stats.policies}</p>
          <p className="text-sm text-slate-500">Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª</p>
          <p className="text-xs text-purple-600 mt-1">{stats.activePolicies} Ù†Ø´Ø·</p>
        </div>

        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
          <div className="w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center mb-3"><Shield className="w-5 h-5 text-emerald-600" /></div>
          <p className="text-2xl font-bold text-slate-800">{stats.controls}</p>
          <p className="text-sm text-slate-500">Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·</p>
          <p className="text-xs text-emerald-600 mt-1">{stats.implemented} Ù…ÙØ·Ø¨Ù‘Ù‚</p>
        </div>
      </div>

      {/* Charts Row */}
      <div className="grid grid-cols-3 gap-6">
        {/* Authority Distribution */}
        <div className="bg-white rounded-2xl border-2 border-slate-200 p-5">
          <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©</h3>
          {['SAMA', 'NCA', 'CMA', 'SDAIA'].map((auth, i) => {
            const count = INITIAL_OBLIGATIONS.filter(o => AUTHORITIES.find(a => a.id === o.authorityId)?.code === auth).length;
            const pct = Math.round((count / stats.obligations) * 100) || 0;
            const colors = ['bg-emerald-500', 'bg-purple-500', 'bg-blue-500', 'bg-indigo-500'];
            return (
              <div key={auth} className="mb-3">
                <div className="flex justify-between mb-1">
                  <span className="text-sm text-slate-600">{auth}</span>
                  <span className="text-sm font-bold">{count}</span>
                </div>
                <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                  <div className={`h-full ${colors[i]} rounded-full`} style={{ width: `${pct}%` }}></div>
                </div>
              </div>
            );
          })}
        </div>

        {/* Recent Activities */}
        <div className="bg-white rounded-2xl border-2 border-slate-200 p-5">
          <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©</h3>
          {activities.map(a => (
            <div key={a.id} className="flex items-start gap-3 mb-3">
              <div className={`w-8 h-8 rounded-lg ${a.color === 'blue' ? 'bg-blue-100' : a.color === 'emerald' ? 'bg-emerald-100' : 'bg-indigo-100'} flex items-center justify-center`}>
                <a.icon className={`w-4 h-4 ${a.color === 'blue' ? 'text-blue-600' : a.color === 'emerald' ? 'text-emerald-600' : 'text-indigo-600'}`} />
              </div>
              <div>
                <p className="text-sm"><span className="font-bold">{a.user}</span> {a.action}</p>
                <p className="text-xs text-slate-500">{a.target} â€¢ {a.time}</p>
              </div>
            </div>
          ))}
        </div>

        {/* Quick Actions */}
        <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
          <h3 className="font-bold mb-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
          <div className="space-y-2">
            <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
              <div className="w-8 h-8 rounded-lg bg-indigo-500 flex items-center justify-center"><Plus className="w-4 h-4 text-white" /></div>
              <span className="font-medium">Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ²Ø§Ù…</span>
            </button>
            <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
              <div className="w-8 h-8 rounded-lg bg-purple-500 flex items-center justify-center"><FileText className="w-4 h-4 text-white" /></div>
              <span className="font-medium">Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙŠØ§Ø³Ø©</span>
            </button>
            <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
              <div className="w-8 h-8 rounded-lg bg-blue-500 flex items-center justify-center"><Upload className="w-4 h-4 text-white" /></div>
              <span className="font-medium">Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„</span>
            </button>
            <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
              <div className="w-8 h-8 rounded-lg bg-emerald-500 flex items-center justify-center"><Shield className="w-4 h-4 text-white" /></div>
              <span className="font-medium">Ø¥Ø¶Ø§ÙØ© Ø¶Ø§Ø¨Ø·</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

const PlaceholderScreen = ({ title, subtitle }) => (
  <div className="flex flex-col items-center justify-center h-96 bg-gradient-to-br from-slate-50 to-slate-100 rounded-3xl border-2 border-dashed border-slate-300">
    <Shield className="w-10 h-10 text-emerald-600" />
    <h2 className="text-xl font-bold text-slate-700 mt-4">{title}</h2>
    <p className="text-slate-500 mt-1">{subtitle}</p>
  </div>
);

const PoliciesStandards = () => {
  const [view, setView] = useState('dashboard');
  const [selectedPolicyId, setSelectedPolicyId] = useState(null);
  const [activeTab, setActiveTab] = useState('all');
  const [searchTerm, setSearchTerm] = useState('');
  const [filterCategory, setFilterCategory] = useState('');
  const [filterType, setFilterType] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [viewMode, setViewMode] = useState('table');
  const [showCreateModal, setShowCreateModal] = useState(false);
  const [createData, setCreateData] = useState(null);
  // Attestation Manager State
  const [showAttestationManager, setShowAttestationManager] = useState(false);
  const [selectedCampaign, setSelectedCampaign] = useState(null);
  const [selectedPolicyForAttestation, setSelectedPolicyForAttestation] = useState(null);
  // Edit & Delete State
  const [showEditModal, setShowEditModal] = useState(false);
  const [editingPolicy, setEditingPolicy] = useState(null);
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [deletingPolicy, setDeletingPolicy] = useState(null);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // EDIT & DELETE HANDLERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const handleEditPolicy = (policy, e) => {
    e?.stopPropagation();
    setEditingPolicy({ ...policy });
    setShowEditModal(true);
  };

  const handleSaveEdit = () => {
    // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ: Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù€ API
    alert(`ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ø³Ø©: ${editingPolicy.title}`);
    setShowEditModal(false);
    setEditingPolicy(null);
  };

  const handleDeletePolicy = (policy, e) => {
    e?.stopPropagation();
    setDeletingPolicy(policy);
    setShowDeleteConfirm(true);
  };

  const confirmDelete = () => {
    // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ: Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù€ API
    const typeLabel = deletingPolicy.type === 'Standard' ? 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø±' : deletingPolicy.type === 'Procedure' ? 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡' : 'Ø§Ù„Ø³ÙŠØ§Ø³Ø©';
    alert(`ØªÙ… Ø­Ø°Ù ${typeLabel}: ${deletingPolicy.title}`);
    setShowDeleteConfirm(false);
    setDeletingPolicy(null);
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ATTESTATION HELPERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const getAttestationSummary = (policyId) => {
    const campaign = ATTESTATION_CAMPAIGNS.find(c => c.policyId === policyId);
    if (!campaign) return { status: 'NotLaunched', completionPercent: 0, overdueCount: 0, campaign: null };
    const completionPercent = campaign.totalRecipients > 0 ? Math.round((campaign.acknowledged / campaign.totalRecipients) * 100) : 0;
    return {
      status: campaign.status === 'Completed' ? 'Closed' : campaign.status,
      completionPercent,
      overdueCount: campaign.overdue || 0,
      pendingCount: campaign.pending || 0,
      campaign,
    };
  };

  const handleLaunchAttestation = (policyId) => {
    const policy = POLICIES.find(p => p.id === policyId);
    setSelectedPolicyForAttestation(policy);
    setSelectedCampaign(null);
    setShowAttestationManager(true);
  };

  const handleManageAttestation = (campaign) => {
    const policy = POLICIES.find(p => p.id === campaign.policyId);
    setSelectedPolicyForAttestation(policy);
    setSelectedCampaign(campaign);
    setShowAttestationManager(true);
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // COMPUTED KPIs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const kpis = useMemo(() => {
    const today = new Date().toISOString().split('T')[0];
    const in30Days = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
    return {
      total: POLICIES.length,
      active: POLICIES.filter(p => p.status === 'Active').length,
      draft: POLICIES.filter(p => p.status === 'Draft').length,
      underReview: POLICIES.filter(p => p.status === 'UnderReview').length,
      dueReviews: POLICIES.filter(p => p.nextReviewDate && p.nextReviewDate <= in30Days && p.status === 'Active').length,
      overdueReviews: POLICIES.filter(p => p.nextReviewDate && p.nextReviewDate < today && p.status === 'Active').length,
      critical: POLICIES.filter(p => p.impactLevel === 'Critical').length,
      highImpact: POLICIES.filter(p => ['UnderReview', 'Draft'].includes(p.status) && ['Critical', 'High'].includes(p.impactLevel)).length,
      overdueAttestations: ATTESTATION_CAMPAIGNS.reduce((s, c) => s + c.overdue, 0),
      pendingAttestations: ATTESTATION_CAMPAIGNS.reduce((s, c) => s + c.pending, 0),
      totalReqs: STANDARD_REQUIREMENTS.length,
      policies: POLICIES.filter(p => p.type === 'Policy').length,
      standards: POLICIES.filter(p => p.type === 'Standard').length,
      procedures: POLICIES.filter(p => p.type === 'Procedure').length,
    };
  }, []);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // FILTERED DATA
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const filtered = useMemo(() => {
    return POLICIES.filter(p => {
      const matchSearch = !searchTerm || p.title.includes(searchTerm) || p.code.includes(searchTerm);
      const matchCategory = !filterCategory || p.category === filterCategory;
      const matchType = !filterType || p.type === filterType;
      const matchStatus = !filterStatus || p.status === filterStatus;
      const matchTab = activeTab === 'all' ||
        (activeTab === 'policies' && p.type === 'Policy') ||
        (activeTab === 'standards' && p.type === 'Standard') ||
        (activeTab === 'procedures' && p.type === 'Procedure') ||
        (activeTab === 'pending' && ['Draft', 'UnderReview'].includes(p.status)) ||
        (activeTab === 'review' && p.nextReviewDate && p.nextReviewDate <= new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]);
      return matchSearch && matchCategory && matchType && matchStatus && matchTab;
    });
  }, [searchTerm, filterCategory, filterType, filterStatus, activeTab]);

  const getUser = (id) => USERS.find(u => u.id === id);
  const getCat = (c) => CATEGORIES.find(x => x.code === c);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // HANDLERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const openWorkspace = (id) => { setSelectedPolicyId(id); setView('workspace'); };
  const closeWorkspace = () => { setSelectedPolicyId(null); setView('dashboard'); };

  const handleCreate = () => {
    setCreateData({
      id: null, code: `POL-${String(POLICIES.length + 1).padStart(3, '0')}`,
      title: '', titleEn: '', type: 'Policy', category: 'Compliance',
      ownerId: null, reviewerId: null, approverId: null, currentVersion: '1.0',
      effectiveDate: '', nextReviewDate: '', status: 'Draft', impactLevel: 'Medium',
      summary: '', scope: '', objectives: [],
    });
    setShowCreateModal(true);
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER WORKSPACE VIEW
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  if (view === 'workspace' && selectedPolicyId) {
    return <PolicyWorkspace policyId={selectedPolicyId} onClose={closeWorkspace} />;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER COMMAND CENTER DASHBOARD - PREMIUM EDITION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PREMIUM HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-gradient-to-r from-emerald-600 via-teal-600 to-cyan-600 rounded-3xl p-6 text-white shadow-2xl shadow-emerald-500/20">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-5">
            <div className="w-16 h-16 rounded-2xl bg-white/20 backdrop-blur flex items-center justify-center">
              <FileText className="w-8 h-8" />
            </div>
            <div>
              <h1 className="text-2xl font-black">Ù…Ø±ÙƒØ² Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</h1>
              <p className="text-emerald-100 text-sm mt-1">Policy & Standards Command Center - Enterprise Edition</p>
            </div>
          </div>
          <div className="flex items-center gap-3">
            <div className="bg-white/10 backdrop-blur rounded-xl px-5 py-3 text-center">
              <p className="text-emerald-200 text-xs">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚</p>
              <p className="text-3xl font-black">{kpis.total}</p>
            </div>
            <div className="bg-white/10 backdrop-blur rounded-xl px-5 py-3 text-center">
              <p className="text-emerald-200 text-xs">Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
              <p className="text-3xl font-black">{Math.round((kpis.active / kpis.total) * 100)}%</p>
            </div>
            <button className="flex items-center gap-2 px-4 py-3 bg-white/10 backdrop-blur rounded-xl text-sm hover:bg-white/20 transition-all">
              <Download className="w-5 h-5" />
              ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±
            </button>
            <button onClick={handleCreate} className="flex items-center gap-2 px-5 py-3 bg-white text-emerald-700 rounded-xl text-sm font-bold hover:bg-emerald-50 transition-all shadow-lg">
              <Plus className="w-5 h-5" />
              Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙŠØ§Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </button>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXECUTIVE DASHBOARD KPIs â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="grid grid-cols-8 gap-4">
        {/* Active Policies */}
        <div className="col-span-1 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-4 text-white shadow-lg shadow-emerald-500/20">
          <div className="flex items-center justify-between mb-3">
            <CheckCircle2 className="w-8 h-8 opacity-80" />
            <span className="text-3xl font-black">{kpis.active}</span>
          </div>
          <p className="text-sm font-medium text-emerald-100">Ø³ÙŠØ§Ø³Ø§Øª Ù†Ø´Ø·Ø©</p>
          <p className="text-xs text-emerald-200 mt-1">Active Policies</p>
        </div>

        {/* Under Review */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-amber-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <Clock className="w-8 h-8 text-amber-500" />
            <span className="text-3xl font-black text-amber-600">{kpis.underReview}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
          <p className="text-xs text-slate-500 mt-1">Under Review</p>
        </div>

        {/* Drafts */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-blue-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <FileText className="w-8 h-8 text-blue-500" />
            <span className="text-3xl font-black text-blue-600">{kpis.draft}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ù…Ø³ÙˆØ¯Ø§Øª</p>
          <p className="text-xs text-slate-500 mt-1">Drafts</p>
        </div>

        {/* Due Reviews */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-orange-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <Calendar className="w-8 h-8 text-orange-500" />
            <span className="text-3xl font-black text-orange-600">{kpis.dueReviews}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø³ØªØ­Ù‚Ø©</p>
          <p className="text-xs text-slate-500 mt-1">Due Reviews</p>
        </div>

        {/* Overdue */}
        <div className="col-span-1 bg-gradient-to-br from-red-500 to-rose-600 rounded-2xl p-4 text-white shadow-lg shadow-red-500/20">
          <div className="flex items-center justify-between mb-3">
            <AlertTriangle className="w-8 h-8 opacity-80" />
            <span className="text-3xl font-black">{kpis.overdueReviews}</span>
          </div>
          <p className="text-sm font-medium text-red-100">Ù…ØªØ£Ø®Ø±Ø©</p>
          <p className="text-xs text-red-200 mt-1">Overdue</p>
        </div>

        {/* Attestations */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-purple-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <CheckSquare className="w-8 h-8 text-purple-500" />
            <span className="text-3xl font-black text-purple-600">{kpis.pendingAttestations}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ø¥Ù‚Ø±Ø§Ø±Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</p>
          <p className="text-xs text-slate-500 mt-1">Pending</p>
        </div>

        {/* Critical */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-rose-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <Zap className="w-8 h-8 text-rose-500" />
            <span className="text-3xl font-black text-rose-600">{kpis.critical}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ø­Ø±Ø¬Ø©</p>
          <p className="text-xs text-slate-500 mt-1">Critical</p>
        </div>

        {/* Requirements */}
        <div className="col-span-1 bg-white rounded-2xl p-4 border-2 border-indigo-200 shadow-lg">
          <div className="flex items-center justify-between mb-3">
            <ClipboardCheck className="w-8 h-8 text-indigo-500" />
            <span className="text-3xl font-black text-indigo-600">{kpis.totalReqs}</span>
          </div>
          <p className="text-sm font-medium text-slate-700">Ù…ØªØ·Ù„Ø¨Ø§Øª</p>
          <p className="text-xs text-slate-500 mt-1">Requirements</p>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DOCUMENT TYPE BREAKDOWN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="grid grid-cols-3 gap-4">
        {/* Policies */}
        <div className="bg-white rounded-2xl border-2 border-slate-200 p-5 hover:border-emerald-300 hover:shadow-lg transition-all cursor-pointer group"
          onClick={() => setActiveTab('policies')}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <div className="w-14 h-14 rounded-2xl bg-emerald-100 flex items-center justify-center group-hover:bg-emerald-500 transition-all">
                <span className="text-3xl group-hover:scale-110 transition-transform">ğŸ“œ</span>
              </div>
              <div>
                <h3 className="text-lg font-bold text-slate-800">Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª</h3>
                <p className="text-sm text-slate-500">Policies</p>
              </div>
            </div>
            <div className="text-left">
              <p className="text-4xl font-black text-emerald-600">{kpis.policies}</p>
              <p className="text-xs text-slate-400">ÙˆØ«ÙŠÙ‚Ø©</p>
            </div>
          </div>
          <div className="mt-4 flex items-center gap-2">
            <div className="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
              <div className="h-full bg-emerald-500 rounded-full" style={{ width: `${(kpis.policies / kpis.total) * 100}%` }} />
            </div>
            <span className="text-sm font-bold text-emerald-600">{Math.round((kpis.policies / kpis.total) * 100)}%</span>
          </div>
        </div>

        {/* Standards */}
        <div className="bg-white rounded-2xl border-2 border-slate-200 p-5 hover:border-blue-300 hover:shadow-lg transition-all cursor-pointer group"
          onClick={() => setActiveTab('standards')}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <div className="w-14 h-14 rounded-2xl bg-blue-100 flex items-center justify-center group-hover:bg-blue-500 transition-all">
                <span className="text-3xl group-hover:scale-110 transition-transform">ğŸ“‹</span>
              </div>
              <div>
                <h3 className="text-lg font-bold text-slate-800">Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</h3>
                <p className="text-sm text-slate-500">Standards</p>
              </div>
            </div>
            <div className="text-left">
              <p className="text-4xl font-black text-blue-600">{kpis.standards}</p>
              <p className="text-xs text-slate-400">ÙˆØ«ÙŠÙ‚Ø©</p>
            </div>
          </div>
          <div className="mt-4 flex items-center gap-2">
            <div className="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
              <div className="h-full bg-blue-500 rounded-full" style={{ width: `${(kpis.standards / kpis.total) * 100}%` }} />
            </div>
            <span className="text-sm font-bold text-blue-600">{Math.round((kpis.standards / kpis.total) * 100)}%</span>
          </div>
        </div>

        {/* Procedures */}
        <div className="bg-white rounded-2xl border-2 border-slate-200 p-5 hover:border-purple-300 hover:shadow-lg transition-all cursor-pointer group"
          onClick={() => setActiveTab('procedures')}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <div className="w-14 h-14 rounded-2xl bg-purple-100 flex items-center justify-center group-hover:bg-purple-500 transition-all">
                <span className="text-3xl group-hover:scale-110 transition-transform">ğŸ“</span>
              </div>
              <div>
                <h3 className="text-lg font-bold text-slate-800">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</h3>
                <p className="text-sm text-slate-500">Procedures</p>
              </div>
            </div>
            <div className="text-left">
              <p className="text-4xl font-black text-purple-600">{kpis.procedures}</p>
              <p className="text-xs text-slate-400">ÙˆØ«ÙŠÙ‚Ø©</p>
            </div>
          </div>
          <div className="mt-4 flex items-center gap-2">
            <div className="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
              <div className="h-full bg-purple-500 rounded-full" style={{ width: `${(kpis.procedures / kpis.total) * 100}%` }} />
            </div>
            <span className="text-sm font-bold text-purple-600">{Math.round((kpis.procedures / kpis.total) * 100)}%</span>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN TABLE SECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
        {/* Tabs */}
        <div className="flex items-center justify-between border-b border-slate-200 px-4 bg-slate-50">
          <div className="flex">
            {[
              { id: 'all', label: 'Ø§Ù„ÙƒÙ„', count: kpis.total },
              { id: 'policies', label: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', count: kpis.policies, icon: 'ğŸ“œ' },
              { id: 'standards', label: 'Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±', count: kpis.standards, icon: 'ğŸ“‹' },
              { id: 'procedures', label: 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª', count: kpis.procedures, icon: 'ğŸ“' },
              { id: 'pending', label: 'Ù‚ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„', count: kpis.draft + kpis.underReview, badge: 'amber' },
              { id: 'review', label: 'ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø©', count: kpis.dueReviews, badge: 'red' },
            ].map(tab => (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)}
                className={`flex items-center gap-2 px-5 py-4 font-medium border-b-2 transition-all ${activeTab === tab.id ? 'border-emerald-500 text-emerald-700 bg-white -mb-px' : 'border-transparent text-slate-500 hover:text-slate-700'
                  }`}>
                {tab.icon && <span>{tab.icon}</span>}
                {tab.label}
                <span className={`px-2 py-0.5 rounded-lg text-xs font-bold ${tab.badge === 'amber' ? 'bg-amber-100 text-amber-700' :
                    tab.badge === 'red' ? 'bg-red-100 text-red-700' :
                      activeTab === tab.id ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'
                  }`}>{tab.count}</span>
              </button>
            ))}
          </div>
          <div className="flex items-center gap-2">
            <button onClick={() => setViewMode('table')} className={`p-2.5 rounded-lg ${viewMode === 'table' ? 'bg-emerald-100 text-emerald-700' : 'text-slate-400'}`}>
              <LayoutList className="w-5 h-5" />
            </button>
            <button onClick={() => setViewMode('cards')} className={`p-2.5 rounded-lg ${viewMode === 'cards' ? 'bg-emerald-100 text-emerald-700' : 'text-slate-400'}`}>
              <LayoutGrid className="w-5 h-5" />
            </button>
          </div>
        </div>

        {/* Filters */}
        <div className="flex items-center gap-4 p-4 border-b border-slate-100">
          <div className="flex-1 relative">
            <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
            <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)}
              className="w-full pr-12 pl-4 py-2.5 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500" />
          </div>
          <select value={filterType} onChange={(e) => setFilterType(e.target.value)}
            className="px-4 py-2.5 border-2 border-slate-200 rounded-xl bg-white">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
            {POLICY_TYPES.map(t => <option key={t.code} value={t.code}>{t.icon} {t.nameAr}</option>)}
          </select>
          <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}
            className="px-4 py-2.5 border-2 border-slate-200 rounded-xl bg-white">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
            {CATEGORIES.map(c => <option key={c.code} value={c.code}>{c.nameAr}</option>)}
          </select>
          <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
            className="px-4 py-2.5 border-2 border-slate-200 rounded-xl bg-white">
            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
            <option value="Active">Ù†Ø´Ø·</option>
            <option value="Draft">Ù…Ø³ÙˆØ¯Ø©</option>
            <option value="UnderReview">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
          </select>
        </div>

        {/* Table View */}
        {viewMode === 'table' ? (
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead>
                <tr className="bg-slate-50 border-b border-slate-200">
                  <th className="text-right px-5 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                  <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù†ÙˆØ¹</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø£Ø«Ø±</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù…Ø§Ù„Ùƒ</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700 w-24">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
              </thead>
              <tbody>
                {filtered.map((p, idx) => {
                  const owner = getUser(p.ownerId);
                  const isOverdue = p.nextReviewDate && p.nextReviewDate < new Date().toISOString().split('T')[0];
                  return (
                    <tr key={p.id} onClick={() => openWorkspace(p.id)}
                      className={`border-b border-slate-100 hover:bg-emerald-50/50 cursor-pointer ${idx % 2 === 0 ? 'bg-white' : 'bg-slate-50/30'}`}>
                      <td className="px-5 py-4">
                        <span className="font-mono text-sm font-bold text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-lg">{p.code}</span>
                      </td>
                      <td className="px-4 py-4">
                        <p className="font-semibold text-slate-900">{p.title}</p>
                        <p className="text-xs text-slate-500">{p.titleEn}</p>
                      </td>
                      <td className="px-4 py-4 text-center text-lg">{POLICY_TYPES.find(t => t.code === p.type)?.icon}</td>
                      <td className="px-4 py-4 text-center"><span className="font-mono text-sm font-bold text-blue-600">v{p.currentVersion}</span></td>
                      <td className="px-4 py-4 text-center">
                        <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${p.impactLevel === 'Critical' ? 'bg-red-100 text-red-700' :
                            p.impactLevel === 'High' ? 'bg-orange-100 text-orange-700' :
                              p.impactLevel === 'Medium' ? 'bg-amber-100 text-amber-700' : 'bg-slate-100 text-slate-600'
                          }`}>
                          {p.impactLevel === 'Critical' ? 'Ø­Ø±Ø¬' : p.impactLevel === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : p.impactLevel === 'Medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶'}
                        </span>
                      </td>
                      <td className="px-4 py-4 text-center">
                        <span className={`px-3 py-1.5 rounded-xl text-xs font-bold ${p.status === 'Active' ? 'bg-emerald-100 text-emerald-700' :
                            p.status === 'Draft' ? 'bg-slate-100 text-slate-600' :
                              p.status === 'UnderReview' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'
                          }`}>
                          {p.status === 'Active' ? 'â— Ù†Ø´Ø·' : p.status === 'Draft' ? 'â—‹ Ù…Ø³ÙˆØ¯Ø©' : p.status === 'UnderReview' ? 'â— Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' : p.status}
                        </span>
                      </td>
                      {/* Attestation Column */}
                      <td className="px-4 py-4 text-center" onClick={(e) => e.stopPropagation()}>
                        {(() => {
                          const att = getAttestationSummary(p.id);
                          if (att.status === 'NotLaunched') {
                            return (
                              <div className="flex items-center justify-center gap-2">
                                <span className="px-2.5 py-1 bg-slate-100 text-slate-500 rounded-lg text-xs font-medium">Ù„Ù… ØªÙØ·Ù„Ù‚</span>
                                <button onClick={() => handleLaunchAttestation(p.id)} className="px-2 py-1 bg-emerald-50 text-emerald-600 rounded text-xs font-bold hover:bg-emerald-100">Ø¥Ø·Ù„Ø§Ù‚</button>
                              </div>
                            );
                          }
                          if (att.status === 'Draft') {
                            return (
                              <div className="flex items-center justify-center gap-2">
                                <span className="px-2.5 py-1 bg-slate-100 text-slate-600 rounded-lg text-xs font-medium">â—‹ Ù…Ø³ÙˆØ¯Ø©</span>
                                <button onClick={() => handleManageAttestation(att.campaign)} className="px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs font-bold hover:bg-blue-100">Ø¥Ø¯Ø§Ø±Ø©</button>
                              </div>
                            );
                          }
                          if (att.status === 'Active' && att.overdueCount > 0) {
                            return (
                              <div className="flex items-center justify-center gap-2">
                                <div className="flex flex-col items-center">
                                  <span className="px-2.5 py-1 bg-red-100 text-red-700 rounded-lg text-xs font-bold flex items-center gap-1">
                                    <AlertTriangle className="w-3 h-3" /> Ù…ØªØ£Ø®Ø± {att.overdueCount}
                                  </span>
                                  <span className="text-xs text-slate-500 mt-0.5">{att.completionPercent}%</span>
                                </div>
                                <button onClick={() => handleManageAttestation(att.campaign)} className="px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs font-bold hover:bg-blue-100">Ø¥Ø¯Ø§Ø±Ø©</button>
                              </div>
                            );
                          }
                          if (att.status === 'Active') {
                            return (
                              <div className="flex items-center justify-center gap-2">
                                <div className="flex flex-col items-center">
                                  <span className="px-2.5 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-medium">Ø¬Ø§Ø±Ù {att.completionPercent}%</span>
                                  <div className="w-14 h-1.5 bg-slate-200 rounded-full mt-1 overflow-hidden">
                                    <div className="h-full bg-blue-500 rounded-full" style={{ width: `${att.completionPercent}%` }} />
                                  </div>
                                </div>
                                <button onClick={() => handleManageAttestation(att.campaign)} className="px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs font-bold hover:bg-blue-100">Ø¥Ø¯Ø§Ø±Ø©</button>
                              </div>
                            );
                          }
                          if (att.status === 'Closed' && att.completionPercent === 100) {
                            return (
                              <div className="flex items-center justify-center gap-2">
                                <span className="px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-bold flex items-center gap-1">
                                  <CheckCircle2 className="w-3 h-3" /> Ù…ÙƒØªÙ…Ù„Ø©
                                </span>
                                <button onClick={() => handleManageAttestation(att.campaign)} className="px-2 py-1 bg-slate-50 text-slate-600 rounded text-xs font-bold hover:bg-slate-100">Ø¹Ø±Ø¶</button>
                              </div>
                            );
                          }
                          return (
                            <div className="flex items-center justify-center gap-2">
                              <span className="px-2.5 py-1 bg-slate-200 text-slate-700 rounded-lg text-xs font-medium">Ù…ØºÙ„Ù‚Ø© {att.completionPercent}%</span>
                              <button onClick={() => handleManageAttestation(att.campaign)} className="px-2 py-1 bg-slate-50 text-slate-600 rounded text-xs font-bold hover:bg-slate-100">Ø¹Ø±Ø¶</button>
                            </div>
                          );
                        })()}
                      </td>
                      <td className="px-4 py-4 text-center">
                        <span className={`text-sm ${isOverdue ? 'text-red-600 font-bold' : 'text-slate-600'}`}>
                          {p.nextReviewDate || '-'}
                          {isOverdue && <AlertTriangle className="w-4 h-4 inline mr-1" />}
                        </span>
                      </td>
                      <td className="px-4 py-4 text-center text-sm text-slate-600">{owner?.name}</td>
                      <td className="px-4 py-4 text-center">
                        <div className="flex items-center justify-center gap-1">
                          <button onClick={(e) => { e.stopPropagation(); openWorkspace(p.id); }}
                            className="p-2 hover:bg-blue-50 rounded-lg group/btn transition-all" title="Ø§Ø³ØªØ¹Ø±Ø§Ø¶">
                            <Eye className="w-4 h-4 text-blue-500 group-hover/btn:text-blue-700" />
                          </button>
                          <button onClick={(e) => handleEditPolicy(p, e)}
                            className="p-2 hover:bg-emerald-50 rounded-lg group/btn transition-all" title="ØªØ¹Ø¯ÙŠÙ„">
                            <Edit className="w-4 h-4 text-emerald-500 group-hover/btn:text-emerald-700" />
                          </button>
                          <button onClick={(e) => handleDeletePolicy(p, e)}
                            className="p-2 hover:bg-red-50 rounded-lg group/btn transition-all" title="Ø­Ø°Ù">
                            <Trash2 className="w-4 h-4 text-red-500 group-hover/btn:text-red-700" />
                          </button>
                        </div>
                      </td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        ) : (
          /* Cards View */
          <div className="grid grid-cols-3 gap-5 p-6">
            {filtered.map(p => {
              const owner = getUser(p.ownerId);
              const reqCount = p.standardRequirements?.length || 0;
              const oblCount = p.linkedObligations?.length || 0;
              const ctrlCount = p.linkedControls?.length || 0;
              return (
                <div key={p.id} className="bg-white rounded-2xl border-2 border-slate-200 hover:border-emerald-400 hover:shadow-xl cursor-pointer group overflow-hidden">
                  <div className={`px-5 py-3 flex items-center justify-between ${p.impactLevel === 'Critical' ? 'bg-red-50 border-b border-red-200' :
                      p.impactLevel === 'High' ? 'bg-orange-50 border-b border-orange-200' : 'bg-slate-50 border-b border-slate-200'
                    }`}>
                    <div className="flex items-center gap-2">
                      <span className="text-xl">{POLICY_TYPES.find(t => t.code === p.type)?.icon}</span>
                      <span className="font-mono text-sm font-bold text-emerald-600">{p.code}</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <span className="text-xs font-bold text-blue-600 bg-blue-100 px-2 py-0.5 rounded">v{p.currentVersion}</span>
                      <span className={`w-2.5 h-2.5 rounded-full ${p.status === 'Active' ? 'bg-emerald-500' : p.status === 'Draft' ? 'bg-slate-400' : 'bg-amber-500'
                        }`} />
                    </div>
                  </div>
                  <div className="p-5" onClick={() => openWorkspace(p.id)}>
                    <h3 className="font-bold text-slate-900 mb-2 line-clamp-2 group-hover:text-emerald-600">{p.title}</h3>
                    <p className="text-sm text-slate-500 mb-4 line-clamp-2">{p.summary}</p>
                    <div className="flex items-center gap-2 text-sm text-slate-500 mb-4">
                      <User className="w-4 h-4" />
                      <span>{owner?.name}</span>
                    </div>
                    <div className="flex items-center gap-3">
                      <span className="text-xs bg-purple-50 text-purple-700 px-2.5 py-1.5 rounded-lg">{reqCount} Ù…ØªØ·Ù„Ø¨</span>
                      <span className="text-xs bg-blue-50 text-blue-700 px-2.5 py-1.5 rounded-lg">{oblCount} Ø§Ù„ØªØ²Ø§Ù…</span>
                      <span className="text-xs bg-emerald-50 text-emerald-700 px-2.5 py-1.5 rounded-lg">{ctrlCount} Ø¶Ø§Ø¨Ø·</span>
                    </div>
                  </div>
                  {/* Actions Bar */}
                  <div className="px-5 py-3 border-t border-slate-100 flex items-center justify-between bg-slate-50/50">
                    <div className="flex items-center gap-1">
                      <button onClick={(e) => { e.stopPropagation(); openWorkspace(p.id); }}
                        className="flex items-center gap-1.5 px-3 py-1.5 text-blue-600 hover:bg-blue-50 rounded-lg text-sm font-medium transition-all">
                        <Eye className="w-4 h-4" /> Ø§Ø³ØªØ¹Ø±Ø§Ø¶
                      </button>
                      <button onClick={(e) => handleEditPolicy(p, e)}
                        className="flex items-center gap-1.5 px-3 py-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg text-sm font-medium transition-all">
                        <Edit className="w-4 h-4" /> ØªØ¹Ø¯ÙŠÙ„
                      </button>
                    </div>
                    <button onClick={(e) => handleDeletePolicy(p, e)}
                      className="flex items-center gap-1.5 px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium transition-all">
                      <Trash2 className="w-4 h-4" /> Ø­Ø°Ù
                    </button>
                  </div>
                </div>
              );
            })}
          </div>
        )}

        {filtered.length === 0 && (
          <div className="text-center py-16">
            <div className="w-20 h-20 mx-auto mb-4 rounded-2xl bg-slate-100 flex items-center justify-center">
              <FileSearch className="w-10 h-10 text-slate-400" />
            </div>
            <h3 className="text-lg font-bold text-slate-700 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</h3>
            <p className="text-slate-500">Ø­Ø§ÙˆÙ„ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
          </div>
        )}
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BOTTOM STATS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="grid grid-cols-3 gap-6">
        {/* Requirements Distribution */}
        <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
          <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <ClipboardCheck className="w-5 h-5 text-purple-600" />
            ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
          </h3>
          <div className="space-y-3">
            {[
              { label: 'Ø¥Ù„Ø²Ø§Ù…ÙŠ', count: STANDARD_REQUIREMENTS.filter(r => r.mandatoryLevel === 'Mandatory').length, color: 'bg-red-500' },
              { label: 'ÙŠÙ†Ø¨ØºÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', count: STANDARD_REQUIREMENTS.filter(r => r.mandatoryLevel === 'ShouldComply').length, color: 'bg-amber-500' },
              { label: 'Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª', count: STANDARD_REQUIREMENTS.filter(r => r.mandatoryLevel === 'BestPractice').length, color: 'bg-blue-500' },
            ].map(item => (
              <div key={item.label} className="flex items-center justify-between">
                <div className="flex items-center gap-2">
                  <span className={`w-3 h-3 rounded-full ${item.color}`} />
                  <span className="text-sm text-slate-600">{item.label}</span>
                </div>
                <span className="font-bold text-slate-800">{item.count}</span>
              </div>
            ))}
          </div>
        </div>

        {/* Attestation Summary */}
        <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
          <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <CheckSquare className="w-5 h-5 text-emerald-600" />
            Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª
          </h3>
          <div className="space-y-3">
            {ATTESTATION_CAMPAIGNS.filter(c => c.status === 'Active').slice(0, 4).map(c => {
              const pol = POLICIES.find(p => p.id === c.policyId);
              const pct = Math.round((c.acknowledged / c.totalRecipients) * 100);
              return (
                <div key={c.id} className="p-3 bg-slate-50 rounded-xl">
                  <div className="flex items-center justify-between mb-2">
                    <span className="text-sm font-medium text-slate-700 truncate flex-1">{pol?.code}</span>
                    <span className={`text-xs font-bold px-2 py-0.5 rounded ${pct === 100 ? 'bg-emerald-100 text-emerald-700' : c.overdue > 0 ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'
                      }`}>{pct}%</span>
                  </div>
                  <div className="h-1.5 bg-slate-200 rounded-full overflow-hidden">
                    <div className={`h-full rounded-full ${pct === 100 ? 'bg-emerald-500' : 'bg-amber-500'}`} style={{ width: `${pct}%` }} />
                  </div>
                </div>
              );
            })}
          </div>
        </div>

        {/* Version Changes */}
        <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
          <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <History className="w-5 h-5 text-blue-600" />
            Ø¢Ø®Ø± Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
          </h3>
          <div className="space-y-3">
            {POLICY_VERSIONS.filter(v => v.status === 'Active').slice(0, 4).map(v => {
              const pol = POLICIES.find(p => p.id === v.policyId);
              const usr = getUser(v.changedBy);
              return (
                <div key={v.id} className="flex items-center gap-3 p-3 bg-slate-50 rounded-xl">
                  <div className="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                    <GitBranch className="w-5 h-5 text-blue-600" />
                  </div>
                  <div className="flex-1 min-w-0">
                    <p className="text-sm font-medium text-slate-800 truncate">{pol?.code} â†’ v{v.version}</p>
                    <p className="text-xs text-slate-500">{usr?.name} â€¢ {v.effectiveDate}</p>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CREATE MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showCreateModal && createData && (
        <PolicyFormModal
          data={createData}
          mode="create"
          onClose={() => { setShowCreateModal(false); setCreateData(null); }}
          onUpdate={(field, value) => setCreateData(prev => ({ ...prev, [field]: value }))}
        />
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EDIT MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showEditModal && editingPolicy && (
        <PolicyFormModal
          data={editingPolicy}
          mode="edit"
          onClose={() => { setShowEditModal(false); setEditingPolicy(null); }}
          onUpdate={(field, value) => setEditingPolicy(prev => ({ ...prev, [field]: value }))}
        />
      )}

      {/* Attestation Campaign Manager */}
      {showAttestationManager && (
        <AttestationCampaignManager
          campaign={selectedCampaign}
          policy={selectedPolicyForAttestation}
          onClose={() => { setShowAttestationManager(false); setSelectedCampaign(null); setSelectedPolicyForAttestation(null); }}
        />
      )}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DELETE CONFIRM MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDeleteConfirm && deletingPolicy && (
        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            {/* Header */}
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <Trash2 className="w-6 h-6" />
                </div>
                <div>
                  <h2 className="text-xl font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h2>
                  <p className="text-white/80 text-sm">Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡</p>
                </div>
              </div>
            </div>

            {/* Content */}
            <div className="p-6">
              <div className="bg-red-50 border-2 border-red-200 rounded-2xl p-4 mb-6">
                <p className="text-slate-700 mb-2">
                  Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù {deletingPolicy.type === 'Standard' ? 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø±' : deletingPolicy.type === 'Procedure' ? 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡' : 'Ø§Ù„Ø³ÙŠØ§Ø³Ø©'} Ø§Ù„ØªØ§Ù„ÙŠØŸ
                </p>
                <div className="bg-white rounded-xl p-4 border border-red-100">
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">{POLICY_TYPES.find(t => t.code === deletingPolicy.type)?.icon}</span>
                    <div>
                      <p className="font-bold text-slate-800">{deletingPolicy.code}</p>
                      <p className="text-sm text-slate-600">{deletingPolicy.title}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div className="bg-amber-50 border-2 border-amber-200 rounded-2xl p-4">
                <div className="flex items-start gap-3">
                  <AlertTriangle className="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" />
                  <div className="text-sm text-amber-800">
                    <p className="font-bold mb-1">ØªØ­Ø°ÙŠØ±:</p>
                    <ul className="list-disc list-inside space-y-1">
                      <li>Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</li>
                      <li>Ø³ÙŠØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ù†Ø´Ø·Ø©</li>
                      <li>Ù„Ù† ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>

            {/* Footer */}
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowDeleteConfirm(false); setDeletingPolicy(null); }}
                className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <button onClick={confirmDelete}
                className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-red-500 to-rose-500 text-white rounded-xl font-bold hover:from-red-600 hover:to-rose-600 shadow-lg shadow-red-500/30">
                <Trash2 className="w-5 h-5" />
                Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù {deletingPolicy.type === 'Standard' ? 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø±' : deletingPolicy.type === 'Procedure' ? 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡' : 'Ø§Ù„Ø³ÙŠØ§Ø³Ø©'}
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ATTESTATION VALIDATION RULES & API CONTRACTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * API CONTRACT SIGNATURES:
 * 
 * GET /policies - Response: { policies: Policy[], attestationSummary: { policyId, status, completionPercent, overdueCount }[] }
 * GET /policies/:id/attestation-campaign - Response: { campaign: AttestationCampaign | null }
 * POST /policies/:id/attestation-campaign - Body: { title, dueDate } - Response: { campaign }
 * POST /attestation-campaign/:id/launch - Response: { success, campaign }
 * POST /attestation-campaign/:id/close - Response: { success, campaign }
 * POST /attestation-campaign/:id/audience - Body: { targetType, selections[], includeNewJoiners }
 * POST /attestation-campaign/:id/schedule - Body: { reminderDays[], escalationLevels[] }
 * GET /attestation-campaign/:id/recipients - Response: { recipients[] }
 * POST /attestation-campaign/:id/export - Response: { downloadUrl, auditTrailId }
 */

const ATTESTATION_VALIDATION = {
  canLaunch: (campaign) => {
    const errors = [];
    if (!campaign.dueDate) errors.push('ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚');
    if (!campaign.targetAudience || (campaign.targetAudience.type !== 'All' && !campaign.targetAudience.selections?.length)) {
      errors.push('ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù');
    }
    if (campaign.dueDate && new Date(campaign.dueDate) <= new Date()) errors.push('ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„');
    return { valid: errors.length === 0, errors };
  },
  canDecline: (comment) => {
    if (!comment || comment.trim().length < 20) return { valid: false, error: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (20 Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)' };
    return { valid: true };
  },
  canTransition: (from, to) => ({ 'Draft': ['Active'], 'Active': ['Closed'], 'Closed': [] }[from]?.includes(to) || false),
  isEditable: (c) => c?.status === 'Draft',
  isReadOnly: (c) => c?.status === 'Closed',
};

// Mock Data for Recipients
const ATTESTATION_RECIPIENTS = [
  { id: 1, campaignId: 1, userId: 1, userName: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', status: 'Acknowledged', acknowledgedAt: '2024-01-20 09:30', ipAddress: '192.168.1.100', comment: null },
  { id: 2, campaignId: 1, userId: 2, userName: 'Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯', department: 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±', status: 'Acknowledged', acknowledgedAt: '2024-01-21 14:15', ipAddress: '192.168.1.101', comment: null },
  { id: 3, campaignId: 1, userId: 3, userName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', department: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', status: 'Overdue', acknowledgedAt: null, ipAddress: null, comment: null },
  { id: 4, campaignId: 1, userId: 4, userName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø³Ø§Ù„Ù…', department: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', status: 'Pending', acknowledgedAt: null, ipAddress: null, comment: null },
  { id: 5, campaignId: 1, userId: 5, userName: 'Ù…Ø­Ù…Ø¯ Ø§Ù„ÙÙ‡Ø¯', department: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', status: 'Declined', acknowledgedAt: '2024-01-22 11:00', ipAddress: '192.168.1.105', comment: 'Ø£Ø­ØªØ§Ø¬ ØªÙˆØ¶ÙŠØ­ Ø¨Ø¹Ø¶ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±' },
  { id: 6, campaignId: 3, userId: 1, userName: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', department: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', status: 'Acknowledged', acknowledgedAt: '2024-03-01 10:00', ipAddress: '192.168.1.100', comment: null },
  { id: 7, campaignId: 3, userId: 8, userName: 'Ø±ÙŠÙ… Ø§Ù„Ø´Ù…Ø±ÙŠ', department: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', status: 'Overdue', acknowledgedAt: null, ipAddress: null, comment: null },
];

const BUSINESS_UNITS = [
  { id: 1, code: 'HQ', name: 'Ø§Ù„Ù…Ù‚Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ' },
  { id: 2, code: 'RETAIL', name: 'Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªØ¬Ø²Ø¦Ø©' },
  { id: 3, code: 'CORP', name: 'Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø´Ø±ÙƒØ§Øª' },
];

const LOCATIONS = [
  { id: 1, code: 'RUH', name: 'Ø§Ù„Ø±ÙŠØ§Ø¶' },
  { id: 2, code: 'JED', name: 'Ø¬Ø¯Ø©' },
  { id: 3, code: 'DMM', name: 'Ø§Ù„Ø¯Ù…Ø§Ù…' },
];

const ROLE_OPTIONS = [
  { id: 1, code: 'EXEC', name: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©' },
  { id: 2, code: 'MGR', name: 'Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡' },
  { id: 3, code: 'EMP', name: 'Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ†' },
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ATTESTATION CAMPAIGN MANAGER COMPONENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const AttestationCampaignManager = ({ campaign, policy, onClose }) => {
  const [activeTab, setActiveTab] = useState(0);
  const [campaignData, setCampaignData] = useState(campaign || {
    id: null, policyId: policy?.id,
    title: `Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± - ${policy?.title} ${new Date().getFullYear()}`,
    status: 'Draft', dueDate: '', startDate: '',
    targetAudience: { type: 'All', selections: [], includeNewJoiners: false },
    reminderDays: [14, 7, 3, 1],
    escalationLevels: [{ afterDays: 1, notifyRole: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±' }, { afterDays: 3, notifyRole: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©' }],
    totalRecipients: 0, acknowledged: 0, pending: 0, overdue: 0,
  });
  const [validationErrors, setValidationErrors] = useState([]);
  const [recipients, setRecipients] = useState([]);
  const [recipientFilter, setRecipientFilter] = useState('');
  const [recipientSearch, setRecipientSearch] = useState('');

  useEffect(() => {
    if (activeTab === 3 && campaign?.id) {
      setRecipients(ATTESTATION_RECIPIENTS.filter(r => r.campaignId === campaign.id));
    }
  }, [activeTab, campaign?.id]);

  const isReadOnly = ATTESTATION_VALIDATION.isReadOnly(campaignData);
  const isEditable = ATTESTATION_VALIDATION.isEditable(campaignData);
  const completionPercent = campaignData.totalRecipients > 0 ? Math.round((campaignData.acknowledged / campaignData.totalRecipients) * 100) : 0;

  const tabs = [
    { id: 0, label: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©', icon: Eye },
    { id: 1, label: 'Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±', icon: Users },
    { id: 2, label: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©', icon: Calendar },
    { id: 3, label: 'Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©', icon: Activity },
    { id: 4, label: 'Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', icon: FileCheck },
  ];

  const handleLaunch = () => {
    const validation = ATTESTATION_VALIDATION.canLaunch(campaignData);
    if (!validation.valid) { setValidationErrors(validation.errors); return; }
    setCampaignData(prev => ({ ...prev, status: 'Active', startDate: new Date().toISOString().split('T')[0] }));
    setValidationErrors([]);
  };

  const handleCloseCampaign = () => {
    if (window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø©ØŸ Ù„Ù† ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­Ù‡Ø§.')) {
      setCampaignData(prev => ({ ...prev, status: 'Closed' }));
    }
  };

  const updateAudience = (field, value) => {
    setCampaignData(prev => ({ ...prev, targetAudience: { ...prev.targetAudience, [field]: value } }));
  };

  const filteredRecipients = recipients.filter(r => {
    const matchFilter = !recipientFilter || r.status === recipientFilter;
    const matchSearch = !recipientSearch || r.userName.includes(recipientSearch);
    return matchFilter && matchSearch;
  });

  return (
    <div className="fixed inset-0 bg-black/50 z-50 flex justify-end backdrop-blur-sm">
      <div className="w-[850px] bg-white h-full flex flex-col shadow-2xl">
        {/* Header */}
        <div className={`px-6 py-5 text-white ${isReadOnly ? 'bg-gradient-to-l from-slate-500 to-slate-600' :
            campaignData.status === 'Active' ? 'bg-gradient-to-l from-blue-500 to-indigo-600' :
              'bg-gradient-to-l from-emerald-500 to-teal-600'
          }`}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                <CheckSquare className="w-6 h-6" />
              </div>
              <div>
                <h2 className="text-xl font-bold">Ø¥Ø¯Ø§Ø±Ø© Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±</h2>
                <p className="text-white/80 text-sm">{policy?.code} - {policy?.title}</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <span className={`px-3 py-1.5 rounded-lg text-sm font-bold ${campaignData.status === 'Draft' ? 'bg-white/20' : campaignData.status === 'Active' ? 'bg-white/30' : 'bg-white/20'}`}>
                {campaignData.status === 'Draft' ? 'â—‹ Ù…Ø³ÙˆØ¯Ø©' : campaignData.status === 'Active' ? 'â— Ù†Ø´Ø·Ø©' : 'â–  Ù…ØºÙ„Ù‚Ø©'}
              </span>
              <button onClick={onClose} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                <X className="w-5 h-5" />
              </button>
            </div>
          </div>
        </div>

        {/* Validation Errors */}
        {validationErrors.length > 0 && (
          <div className="px-6 py-3 bg-red-50 border-b border-red-200">
            <div className="flex items-start gap-2">
              <AlertTriangle className="w-5 h-5 text-red-500 flex-shrink-0 mt-0.5" />
              <div>{validationErrors.map((err, i) => <p key={i} className="text-sm text-red-700">{err}</p>)}</div>
            </div>
          </div>
        )}

        {/* Tabs */}
        <div className="flex border-b border-slate-200 px-4 bg-slate-50">
          {tabs.map((tab) => {
            const Icon = tab.icon;
            return (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)}
                className={`flex items-center gap-2 px-5 py-3 font-medium border-b-2 transition-all ${activeTab === tab.id ? 'border-emerald-500 text-emerald-700 bg-white -mb-px' : 'border-transparent text-slate-500 hover:text-slate-700'
                  }`}>
                <Icon className="w-4 h-4" />
                {tab.label}
              </button>
            );
          })}
        </div>

        {/* Content */}
        <div className="flex-1 overflow-y-auto p-6">
          {/* Tab 0: Overview */}
          {activeTab === 0 && (
            <div className="space-y-6">
              <div className="grid grid-cols-4 gap-4">
                <div className="bg-emerald-50 rounded-xl p-4 border-2 border-emerald-200">
                  <div className="text-2xl font-bold text-emerald-600">{campaignData.acknowledged}</div>
                  <div className="text-sm text-emerald-700">Ø£Ù‚Ø±Ù‘ÙˆØ§</div>
                </div>
                <div className="bg-amber-50 rounded-xl p-4 border-2 border-amber-200">
                  <div className="text-2xl font-bold text-amber-600">{campaignData.pending}</div>
                  <div className="text-sm text-amber-700">Ù…Ø¹Ù„Ù‚</div>
                </div>
                <div className="bg-red-50 rounded-xl p-4 border-2 border-red-200">
                  <div className="text-2xl font-bold text-red-600">{campaignData.overdue}</div>
                  <div className="text-sm text-red-700">Ù…ØªØ£Ø®Ø±</div>
                </div>
                <div className="bg-slate-50 rounded-xl p-4 border-2 border-slate-200">
                  <div className="text-2xl font-bold text-slate-600">{campaignData.totalRecipients}</div>
                  <div className="text-sm text-slate-700">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                </div>
              </div>

              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <div className="flex items-center justify-between mb-3">
                  <h3 className="font-bold text-slate-800">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h3>
                  <span className="text-2xl font-bold text-emerald-600">{completionPercent}%</span>
                </div>
                <div className="h-4 bg-slate-200 rounded-full overflow-hidden">
                  <div className={`h-full rounded-full transition-all ${completionPercent === 100 ? 'bg-emerald-500' : 'bg-blue-500'}`} style={{ width: `${completionPercent}%` }} />
                </div>
              </div>

              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ù…Ù„Ø©</h3>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-slate-700 mb-1">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ù…Ù„Ø©</label>
                    <input type="text" value={campaignData.title} onChange={(e) => !isReadOnly && setCampaignData(prev => ({ ...prev, title: e.target.value }))}
                      disabled={!isEditable} className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 disabled:bg-slate-50" />
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-slate-700 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</label>
                      <input type="date" value={campaignData.startDate || ''} disabled className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl bg-slate-50" />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-slate-700 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ *</label>
                      <input type="date" value={campaignData.dueDate} onChange={(e) => !isReadOnly && setCampaignData(prev => ({ ...prev, dueDate: e.target.value }))}
                        disabled={!isEditable} className="w-full px-4 py-2.5 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 disabled:bg-slate-50" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Tab 1: Audience */}
          {activeTab === 1 && (
            <div className="space-y-6">
              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</h3>
                <div className="grid grid-cols-5 gap-3">
                  {[
                    { type: 'All', label: 'Ø§Ù„Ø¬Ù…ÙŠØ¹', icon: Users },
                    { type: 'Users', label: 'Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†', icon: User },
                    { type: 'Roles', label: 'Ø£Ø¯ÙˆØ§Ø±', icon: Shield },
                    { type: 'BusinessUnits', label: 'ÙˆØ­Ø¯Ø§Øª', icon: Building2 },
                    { type: 'Locations', label: 'Ù…ÙˆØ§Ù‚Ø¹', icon: MapPin },
                  ].map(item => {
                    const Icon = item.icon;
                    return (
                      <button key={item.type} onClick={() => !isReadOnly && updateAudience('type', item.type)} disabled={!isEditable}
                        className={`p-4 rounded-xl border-2 transition-all ${campaignData.targetAudience?.type === item.type ? 'border-emerald-500 bg-emerald-50' : 'border-slate-200 hover:border-slate-300'
                          } ${!isEditable ? 'opacity-50 cursor-not-allowed' : ''}`}>
                        <Icon className={`w-6 h-6 mx-auto mb-2 ${campaignData.targetAudience?.type === item.type ? 'text-emerald-600' : 'text-slate-400'}`} />
                        <p className="text-sm font-medium text-slate-700">{item.label}</p>
                      </button>
                    );
                  })}
                </div>
              </div>

              {campaignData.targetAudience?.type !== 'All' && (
                <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                  <h3 className="font-bold text-slate-800 mb-4">
                    {campaignData.targetAudience?.type === 'Users' && 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†'}
                    {campaignData.targetAudience?.type === 'Roles' && 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø¯ÙˆØ§Ø±'}
                    {campaignData.targetAudience?.type === 'BusinessUnits' && 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆØ­Ø¯Ø§Øª'}
                    {campaignData.targetAudience?.type === 'Locations' && 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹'}
                  </h3>
                  <div className="space-y-2 max-h-60 overflow-y-auto">
                    {(campaignData.targetAudience?.type === 'Roles' ? ROLE_OPTIONS :
                      campaignData.targetAudience?.type === 'BusinessUnits' ? BUSINESS_UNITS :
                        campaignData.targetAudience?.type === 'Locations' ? LOCATIONS : USERS).map(item => (
                          <label key={item.id} className="flex items-center gap-3 p-3 bg-slate-50 rounded-xl cursor-pointer hover:bg-slate-100">
                            <input type="checkbox" checked={campaignData.targetAudience?.selections?.includes(item.id)}
                              onChange={(e) => {
                                if (isReadOnly) return;
                                const selections = campaignData.targetAudience?.selections || [];
                                updateAudience('selections', e.target.checked ? [...selections, item.id] : selections.filter(s => s !== item.id));
                              }}
                              disabled={!isEditable} className="w-5 h-5 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500" />
                            <span className="font-medium text-slate-700">{item.name}</span>
                          </label>
                        ))}
                  </div>
                </div>
              )}

              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <label className="flex items-center gap-3 cursor-pointer">
                  <input type="checkbox" checked={campaignData.targetAudience?.includeNewJoiners || false}
                    onChange={(e) => !isReadOnly && updateAudience('includeNewJoiners', e.target.checked)}
                    disabled={!isEditable} className="w-5 h-5 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500" />
                  <div>
                    <p className="font-medium text-slate-800">ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
                    <p className="text-sm text-slate-500">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ù„Ù„Ø­Ù…Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
                  </div>
                </label>
              </div>
            </div>
          )}

          {/* Tab 2: Schedule */}
          {activeTab === 2 && (
            <div className="space-y-6">
              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <Bell className="w-5 h-5 text-amber-600" />
                  Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª
                </h3>
                <p className="text-sm text-slate-500 mb-4">Ø­Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ù‚Ø¨Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª</p>
                <div className="flex flex-wrap gap-2">
                  {[30, 14, 7, 3, 1].map(day => (
                    <button key={day}
                      onClick={() => {
                        if (isReadOnly) return;
                        const days = campaignData.reminderDays || [];
                        setCampaignData(prev => ({ ...prev, reminderDays: days.includes(day) ? days.filter(d => d !== day) : [...days, day].sort((a, b) => b - a) }));
                      }}
                      disabled={!isEditable}
                      className={`px-4 py-2 rounded-xl border-2 font-medium transition-all ${campaignData.reminderDays?.includes(day) ? 'border-amber-500 bg-amber-50 text-amber-700' : 'border-slate-200 text-slate-600 hover:border-slate-300'
                        } ${!isEditable ? 'opacity-50 cursor-not-allowed' : ''}`}>
                      Ù‚Ø¨Ù„ {day} ÙŠÙˆÙ…
                    </button>
                  ))}
                </div>
              </div>

              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <TrendingUp className="w-5 h-5 text-red-600" />
                  Ø§Ù„ØªØµØ¹ÙŠØ¯
                </h3>
                <p className="text-sm text-slate-500 mb-4">Ø­Ø¯Ø¯ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø¨Ø¹Ø¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</p>
                <div className="space-y-3">
                  {campaignData.escalationLevels?.map((level, idx) => (
                    <div key={idx} className="flex items-center gap-4 p-4 bg-slate-50 rounded-xl">
                      <span className="w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center font-bold text-sm">{idx + 1}</span>
                      <div className="flex-1 grid grid-cols-2 gap-4">
                        <div>
                          <label className="text-xs text-slate-500">Ø¨Ø¹Ø¯ (Ø£ÙŠØ§Ù…)</label>
                          <input type="number" value={level.afterDays}
                            onChange={(e) => {
                              if (isReadOnly) return;
                              const levels = [...campaignData.escalationLevels];
                              levels[idx].afterDays = parseInt(e.target.value);
                              setCampaignData(prev => ({ ...prev, escalationLevels: levels }));
                            }}
                            disabled={!isEditable} className="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm" />
                        </div>
                        <div>
                          <label className="text-xs text-slate-500">Ø¥Ø¨Ù„Ø§Øº</label>
                          <input type="text" value={level.notifyRole}
                            onChange={(e) => {
                              if (isReadOnly) return;
                              const levels = [...campaignData.escalationLevels];
                              levels[idx].notifyRole = e.target.value;
                              setCampaignData(prev => ({ ...prev, escalationLevels: levels }));
                            }}
                            disabled={!isEditable} className="w-full px-3 py-2 border border-slate-200 rounded-lg text-sm" />
                        </div>
                      </div>
                      {isEditable && (
                        <button onClick={() => {
                          const levels = campaignData.escalationLevels.filter((_, i) => i !== idx);
                          setCampaignData(prev => ({ ...prev, escalationLevels: levels }));
                        }} className="p-2 hover:bg-red-50 rounded-lg text-red-500">
                          <X className="w-4 h-4" />
                        </button>
                      )}
                    </div>
                  ))}
                  {isEditable && (
                    <button onClick={() => setCampaignData(prev => ({ ...prev, escalationLevels: [...(prev.escalationLevels || []), { afterDays: 5, notifyRole: '' }] }))}
                      className="w-full py-3 border-2 border-dashed border-slate-300 rounded-xl text-slate-500 hover:border-slate-400 hover:text-slate-600">
                      + Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙˆÙ‰ ØªØµØ¹ÙŠØ¯
                    </button>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Tab 3: Tracking */}
          {activeTab === 3 && (
            <div className="space-y-4">
              <div className="flex items-center gap-3">
                <select value={recipientFilter} onChange={(e) => setRecipientFilter(e.target.value)}
                  className="px-4 py-2 border-2 border-slate-200 rounded-xl bg-white text-sm">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                  <option value="Acknowledged">Ø£Ù‚Ø±Ù‘</option>
                  <option value="Pending">Ù…Ø¹Ù„Ù‚</option>
                  <option value="Overdue">Ù…ØªØ£Ø®Ø±</option>
                  <option value="Declined">Ø±ÙØ¶</option>
                  <option value="Exempted">Ù…Ø¹ÙÙ‰</option>
                </select>
                <input type="text" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…..." value={recipientSearch} onChange={(e) => setRecipientSearch(e.target.value)}
                  className="flex-1 px-4 py-2 border-2 border-slate-200 rounded-xl text-sm" />
              </div>

              <div className="bg-white rounded-xl border-2 border-slate-200 overflow-hidden">
                <table className="w-full">
                  <thead>
                    <tr className="bg-slate-50 border-b border-slate-200">
                      <th className="text-right px-4 py-3 font-bold text-slate-700 text-sm">Ø§Ù„Ù…ÙˆØ¸Ù</th>
                      <th className="text-right px-4 py-3 font-bold text-slate-700 text-sm">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700 text-sm">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-right px-4 py-3 font-bold text-slate-700 text-sm">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                      <th className="text-right px-4 py-3 font-bold text-slate-700 text-sm">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredRecipients.map(r => (
                      <tr key={r.id} className="border-b border-slate-100 hover:bg-slate-50">
                        <td className="px-4 py-3 font-medium text-slate-800">{r.userName}</td>
                        <td className="px-4 py-3 text-slate-600 text-sm">{r.department}</td>
                        <td className="px-4 py-3 text-center">
                          <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${r.status === 'Acknowledged' ? 'bg-emerald-100 text-emerald-700' :
                              r.status === 'Pending' ? 'bg-amber-100 text-amber-700' :
                                r.status === 'Overdue' ? 'bg-red-100 text-red-700' :
                                  r.status === 'Declined' ? 'bg-purple-100 text-purple-700' : 'bg-slate-100 text-slate-600'
                            }`}>
                            {r.status === 'Acknowledged' ? 'Ø£Ù‚Ø±Ù‘' : r.status === 'Pending' ? 'Ù…Ø¹Ù„Ù‚' : r.status === 'Overdue' ? 'Ù…ØªØ£Ø®Ø±' : r.status === 'Declined' ? 'Ø±ÙØ¶' : 'Ù…Ø¹ÙÙ‰'}
                          </span>
                        </td>
                        <td className="px-4 py-3 text-slate-500 text-sm">{r.acknowledgedAt || '-'}</td>
                        <td className="px-4 py-3 text-slate-500 text-sm max-w-[200px] truncate" title={r.comment}>{r.comment || '-'}</td>
                      </tr>
                    ))}
                    {filteredRecipients.length === 0 && (
                      <tr><td colSpan={5} className="px-4 py-8 text-center text-slate-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</td></tr>
                    )}
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* Tab 4: Audit Proof */}
          {activeTab === 4 && (
            <div className="space-y-6">
              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <FileCheck className="w-5 h-5 text-emerald-600" />
                  ØªØµØ¯ÙŠØ± Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
                </h3>
                <p className="text-slate-600 mb-6">ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ ÙƒØ§Ù…Ù„ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª ÙŠØªØ¶Ù…Ù†: Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ Ø¹Ù†ÙˆØ§Ù† IPØŒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠ</p>
                <div className="flex gap-4">
                  <button className="flex items-center gap-2 px-6 py-3 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                    <Download className="w-5 h-5" />
                    ØªØµØ¯ÙŠØ± PDF
                  </button>
                  <button className="flex items-center gap-2 px-6 py-3 border-2 border-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-50">
                    <Download className="w-5 h-5" />
                    ØªØµØ¯ÙŠØ± Excel
                  </button>
                </div>
              </div>

              <div className="bg-white rounded-xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <History className="w-5 h-5 text-blue-600" />
                  Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ (Immutable Audit Trail)
                </h3>
                <div className="space-y-3">
                  {[
                    { action: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ù…Ù„Ø©', user: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', date: campaign?.createdAt || new Date().toISOString().split('T')[0], time: '09:00' },
                    ...(campaign?.status !== 'Draft' ? [{ action: 'ØªÙ… Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø©', user: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', date: campaign?.startDate || '', time: '08:00' }] : []),
                    ...(campaign?.status === 'Closed' ? [{ action: 'ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø©', user: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', date: new Date().toISOString().split('T')[0], time: '16:00' }] : []),
                  ].map((log, idx) => (
                    <div key={idx} className="flex items-center gap-4 p-3 bg-slate-50 rounded-xl">
                      <div className="w-2 h-2 rounded-full bg-blue-500" />
                      <div className="flex-1">
                        <p className="text-sm font-medium text-slate-800">{log.action}</p>
                        <p className="text-xs text-slate-500">{log.user}</p>
                      </div>
                      <span className="text-xs text-slate-400">{log.date} {log.time}</span>
                    </div>
                  ))}
                </div>
              </div>

              <div className="bg-blue-50 rounded-xl p-4 border-2 border-blue-200">
                <p className="text-sm text-blue-700 flex items-center gap-2">
                  <Shield className="w-5 h-5" />
                  Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ù…Ø­Ù…ÙŠØ© ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ø£Ùˆ Ø­Ø°ÙÙ‡Ø§ (Immutable Audit Trail)
                </p>
              </div>
            </div>
          )}
        </div>

        {/* Footer */}
        <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50">
          <div className="flex items-center justify-between">
            <button onClick={onClose} className="px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
              {isReadOnly ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Ø¥Ù„ØºØ§Ø¡'}
            </button>
            <div className="flex items-center gap-3">
              {campaignData.status === 'Draft' && (
                <>
                  <button className="px-5 py-2.5 bg-slate-700 text-white rounded-xl font-bold hover:bg-slate-800">Ø­ÙØ¸ Ø§Ù„Ù…Ø³ÙˆØ¯Ø©</button>
                  <button onClick={handleLaunch} className="flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold hover:from-emerald-600 hover:to-teal-600 shadow-lg shadow-emerald-500/30">
                    <Send className="w-5 h-5" />
                    Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø©
                  </button>
                </>
              )}
              {campaignData.status === 'Active' && (
                <button onClick={handleCloseCampaign} className="flex items-center gap-2 px-6 py-2.5 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">
                  <XCircle className="w-5 h-5" />
                  Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø­Ù…Ù„Ø©
                </button>
              )}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POLICY WORKSPACE - SINGLE POLICY LIFECYCLE VIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Policy Rules Helper
const POLICY_RULES = {
  canEdit: (policy) => policy && ['Draft', 'UnderReview', 'Active'].includes(policy.status),
  canApprove: (policy) => policy && policy.status === 'UnderReview',
  canArchive: (policy) => policy && policy.status === 'Active',
  requiresImpactAnalysis: (policy) => policy && ['UnderReview', 'Active'].includes(policy.status),
  canDelete: (policy) => policy && policy.status === 'Draft',
};

const PolicyWorkspace = ({ policyId, onClose }) => {
  const [activeTab, setActiveTab] = useState(0);
  const [isEditing, setIsEditing] = useState(false);
  const [editData, setEditData] = useState(null);
  const [showVersionModal, setShowVersionModal] = useState(false);
  const policy = POLICIES.find(p => p.id === policyId);
  if (!policy) return null;

  // Initialize edit data
  const startEdit = () => {
    setEditData({ ...policy });
    setIsEditing(true);
  };

  const cancelEdit = () => {
    setEditData(null);
    setIsEditing(false);
  };

  const saveEdit = () => {
    // In real app, would call API
    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
    setIsEditing(false);
  };

  const handleExportPDF = () => {
    alert('Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± PDF...');
  };

  const handleNewVersion = () => {
    setShowVersionModal(true);
  };

  const getUser = (id) => USERS.find(u => u.id === id);
  const owner = getUser(policy.ownerId);
  const reviewer = getUser(policy.reviewerId);
  const approver = getUser(policy.approverId);

  const requirements = STANDARD_REQUIREMENTS.filter(r => policy.standardRequirements?.includes(r.id));
  const versions = POLICY_VERSIONS.filter(v => v.policyId === policy.id).sort((a, b) => b.id - a.id);
  const campaigns = ATTESTATION_CAMPAIGNS.filter(c => c.policyId === policy.id);
  const obligations = INITIAL_OBLIGATIONS.filter(o => policy.linkedObligations?.includes(o.id));
  const controls = CONTROLS.filter(c => policy.linkedControls?.includes(c.id));
  const risks = RISKS.filter(r => policy.linkedRisks?.includes(r.id));

  const tabs = [
    { id: 0, label: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©', icon: Eye },
    { id: 1, label: 'Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª', icon: GitBranch },
    { id: 2, label: 'Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', icon: ClipboardCheck, count: requirements.length },
    { id: 3, label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', icon: Link2, count: obligations.length },
    { id: 4, label: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·', icon: Shield, count: controls.length },
    { id: 5, label: 'Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª', icon: CheckSquare, count: campaigns.length },
    { id: 6, label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±', icon: TrendingUp },
    { id: 7, label: 'Ø­Ø²Ù…Ø© Ø§Ù„Ø£Ø¯Ù„Ø©', icon: FileCheck },
  ];

  return (
    <div className="min-h-screen bg-slate-50">
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WORKSPACE HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className={`text-white px-8 py-6 ${policy.impactLevel === 'Critical' ? 'bg-gradient-to-l from-red-500 to-rose-600' :
          policy.impactLevel === 'High' ? 'bg-gradient-to-l from-orange-500 to-amber-600' :
            'bg-gradient-to-l from-emerald-500 to-teal-600'
        }`}>
        <div className="flex items-center justify-between mb-4">
          <button onClick={onClose} className="flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-xl">
            <ChevronRight className="w-5 h-5" />
            Ø§Ù„Ø¹ÙˆØ¯Ø©
          </button>
          <div className="flex items-center gap-3">
            {POLICY_RULES.canEdit(policy) && !isEditing && (
              <button onClick={startEdit} className="flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-medium transition-all">
                <Edit className="w-5 h-5" />
                ØªØ¹Ø¯ÙŠÙ„
              </button>
            )}
            {isEditing && (
              <>
                <button onClick={cancelEdit} className="flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-medium transition-all">
                  <X className="w-5 h-5" />
                  Ø¥Ù„ØºØ§Ø¡
                </button>
                <button onClick={saveEdit} className="flex items-center gap-2 px-5 py-2.5 bg-white text-emerald-600 rounded-xl font-bold hover:bg-emerald-50 transition-all">
                  <Save className="w-5 h-5" />
                  Ø­ÙØ¸
                </button>
              </>
            )}
            {policy.status === 'Active' && !isEditing && (
              <button onClick={handleNewVersion} className="flex items-center gap-2 px-5 py-2.5 bg-white/20 hover:bg-white/30 rounded-xl font-medium transition-all">
                <Copy className="w-5 h-5" />
                Ø¥ØµØ¯Ø§Ø± Ø¬Ø¯ÙŠØ¯
              </button>
            )}
            <button onClick={handleExportPDF} className="flex items-center gap-2 px-5 py-2.5 bg-white text-slate-800 rounded-xl font-bold hover:bg-slate-100 transition-all">
              <Download className="w-5 h-5" />
              ØªØµØ¯ÙŠØ± PDF
            </button>
          </div>
        </div>

        <div className="flex items-start gap-6">
          <div className="w-20 h-20 rounded-2xl bg-white/20 backdrop-blur flex items-center justify-center text-4xl">
            {POLICY_TYPES.find(t => t.code === policy.type)?.icon}
          </div>
          <div className="flex-1">
            <div className="flex items-center gap-3 mb-2">
              <span className="px-4 py-1.5 bg-white/20 rounded-xl font-mono font-bold">{policy.code}</span>
              <span className="px-3 py-1 bg-white/20 rounded-lg text-sm">v{policy.currentVersion}</span>
              <span className={`px-3 py-1 rounded-lg text-sm font-bold ${policy.status === 'Active' ? 'bg-white/30' : 'bg-white/20'}`}>
                {policy.status === 'Active' ? 'â— Ù†Ø´Ø·' : policy.status === 'Draft' ? 'â—‹ Ù…Ø³ÙˆØ¯Ø©' : policy.status}
              </span>
              <span className="px-3 py-1 bg-white/20 rounded-lg text-sm font-bold">
                âš¡ {policy.impactLevel === 'Critical' ? 'Ø­Ø±Ø¬' : policy.impactLevel === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·'}
              </span>
            </div>
            <h1 className="text-3xl font-bold mb-2">{policy.title}</h1>
            <p className="text-white/80">{policy.titleEn}</p>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-white border-b border-slate-200 px-8">
        <div className="flex overflow-x-auto">
          {tabs.map((tab) => {
            const Icon = tab.icon;
            return (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)}
                className={`flex items-center gap-2 px-6 py-4 font-medium whitespace-nowrap border-b-2 ${activeTab === tab.id ? 'border-emerald-500 text-emerald-700 bg-emerald-50/50' : 'border-transparent text-slate-500 hover:text-slate-700'
                  }`}>
                <Icon className="w-5 h-5" />
                {tab.label}
                {tab.count !== undefined && (
                  <span className={`px-2 py-0.5 rounded-lg text-xs font-bold ${activeTab === tab.id ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'
                    }`}>{tab.count}</span>
                )}
              </button>
            );
          })}
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="p-8">
        {/* Tab 0: Overview */}
        {activeTab === 0 && (
          <div className="grid grid-cols-3 gap-6">
            <div className="col-span-2 space-y-6">
              <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <BookOpen className="w-5 h-5 text-emerald-600" />
                  Ù…Ù„Ø®Øµ Ø§Ù„Ø³ÙŠØ§Ø³Ø©
                </h3>
                <p className="text-slate-700 leading-relaxed">{policy.summary}</p>
              </div>

              <div className="grid grid-cols-2 gap-6">
                <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                  <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <Target className="w-5 h-5 text-blue-600" />
                    Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
                  </h3>
                  <p className="text-slate-600">{policy.scope}</p>
                </div>
                <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                  <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <CheckCircle2 className="w-5 h-5 text-emerald-600" />
                    Ø§Ù„Ø£Ù‡Ø¯Ø§Ù
                  </h3>
                  <ul className="space-y-2">
                    {policy.objectives?.map((obj, i) => (
                      <li key={i} className="flex items-center gap-2 text-slate-600">
                        <Check className="w-4 h-4 text-emerald-500" />
                        {obj}
                      </li>
                    ))}
                  </ul>
                </div>
              </div>

              <div className="grid grid-cols-4 gap-4">
                <div onClick={() => setActiveTab(2)} className="bg-purple-50 rounded-2xl p-5 border-2 border-purple-200 cursor-pointer hover:border-purple-400 hover:shadow-lg transition-all">
                  <div className="text-3xl font-bold text-purple-600 mb-1">{requirements.length}</div>
                  <div className="text-sm text-purple-700">Ù…ØªØ·Ù„Ø¨</div>
                </div>
                <div onClick={() => setActiveTab(3)} className="bg-blue-50 rounded-2xl p-5 border-2 border-blue-200 cursor-pointer hover:border-blue-400 hover:shadow-lg transition-all">
                  <div className="text-3xl font-bold text-blue-600 mb-1">{obligations.length}</div>
                  <div className="text-sm text-blue-700">Ø§Ù„ØªØ²Ø§Ù…</div>
                </div>
                <div onClick={() => setActiveTab(4)} className="bg-emerald-50 rounded-2xl p-5 border-2 border-emerald-200 cursor-pointer hover:border-emerald-400 hover:shadow-lg transition-all">
                  <div className="text-3xl font-bold text-emerald-600 mb-1">{controls.length}</div>
                  <div className="text-sm text-emerald-700">Ø¶Ø§Ø¨Ø·</div>
                </div>
                <div onClick={() => setActiveTab(6)} className="bg-amber-50 rounded-2xl p-5 border-2 border-amber-200 cursor-pointer hover:border-amber-400 hover:shadow-lg transition-all">
                  <div className="text-3xl font-bold text-amber-600 mb-1">{risks.length}</div>
                  <div className="text-sm text-amber-700">Ù…Ø®Ø§Ø·Ø±</div>
                </div>
              </div>
            </div>

            <div className="space-y-6">
              <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h3>
                <div className="space-y-4">
                  <div className="flex items-center gap-3 p-3 bg-emerald-50 rounded-xl">
                    <div className="w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center">
                      <User className="w-5 h-5 text-emerald-600" />
                    </div>
                    <div>
                      <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø§Ù„Ùƒ</p>
                      <p className="font-medium text-slate-800">{owner?.name}</p>
                    </div>
                  </div>
                  <div className="flex items-center gap-3 p-3 bg-blue-50 rounded-xl">
                    <div className="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                      <UserCheck className="w-5 h-5 text-blue-600" />
                    </div>
                    <div>
                      <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</p>
                      <p className="font-medium text-slate-800">{reviewer?.name}</p>
                    </div>
                  </div>
                  <div className="flex items-center gap-3 p-3 bg-purple-50 rounded-xl">
                    <div className="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center">
                      <Shield className="w-5 h-5 text-purple-600" />
                    </div>
                    <div>
                      <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</p>
                      <p className="font-medium text-slate-800">{approver?.name}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</h3>
                <div className="space-y-3">
                  <div className="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                    <span className="text-sm text-slate-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†ÙØ§Ø°</span>
                    <span className="font-bold text-slate-800">{policy.effectiveDate}</span>
                  </div>
                  <div className="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                    <span className="text-sm text-slate-600">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</span>
                    <span className={`font-bold ${policy.nextReviewDate < new Date().toISOString().split('T')[0] ? 'text-red-600' : 'text-slate-800'}`}>
                      {policy.nextReviewDate}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Tab 1: Versions */}
        {activeTab === 1 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
            <div className="p-6 border-b border-slate-200 flex items-center justify-between">
              <h3 className="font-bold text-slate-800 flex items-center gap-2">
                <GitBranch className="w-5 h-5 text-blue-600" />
                Ø³Ø¬Ù„ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª
              </h3>
              {policy.status === 'Active' && (
                <button className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-medium hover:bg-blue-600">
                  <Plus className="w-5 h-5" />
                  Ø¥ØµØ¯Ø§Ø± Ø¬Ø¯ÙŠØ¯
                </button>
              )}
            </div>
            <div className="divide-y divide-slate-100">
              {versions.map((v, idx) => {
                const usr = getUser(v.changedBy);
                return (
                  <div key={v.id} className={`p-5 flex items-center gap-6 ${idx === 0 ? 'bg-emerald-50/50' : ''}`}>
                    <div className={`w-14 h-14 rounded-xl flex items-center justify-center ${v.status === 'Active' ? 'bg-emerald-100' : 'bg-slate-100'}`}>
                      <span className={`text-lg font-bold ${v.status === 'Active' ? 'text-emerald-600' : 'text-slate-500'}`}>v{v.version}</span>
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-1">
                        <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${v.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'
                          }`}>{v.status === 'Active' ? 'Ù†Ø´Ø·' : 'Ø³Ø§Ø¨Ù‚'}</span>
                        <span className="text-sm text-slate-500">{v.effectiveDate}</span>
                      </div>
                      <p className="font-medium text-slate-800">{v.changeReason}</p>
                      <p className="text-sm text-slate-500 mt-1">Ø¨ÙˆØ§Ø³Ø·Ø©: {usr?.name}</p>
                    </div>
                    <button className="p-2 hover:bg-slate-100 rounded-lg"><Eye className="w-5 h-5 text-slate-500" /></button>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        {/* Tab 2: Requirements */}
        {activeTab === 2 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
            <div className="p-6 border-b border-slate-200 flex items-center justify-between">
              <h3 className="font-bold text-slate-800 flex items-center gap-2">
                <ClipboardCheck className="w-5 h-5 text-purple-600" />
                Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± ({requirements.length})
              </h3>
              {POLICY_RULES.canEdit(policy) && (
                <button className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-xl font-medium hover:bg-purple-600">
                  <Plus className="w-5 h-5" />
                  Ø¥Ø¶Ø§ÙØ© Ù…ØªØ·Ù„Ø¨
                </button>
              )}
            </div>
            <table className="w-full">
              <thead>
                <tr className="bg-slate-50 border-b border-slate-200">
                  <th className="text-right px-5 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                  <th className="text-right px-4 py-4 font-bold text-slate-700">Ù†Øµ Ø§Ù„Ù…ØªØ·Ù„Ø¨</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¥Ù„Ø²Ø§Ù…</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø¯Ù„ÙŠÙ„</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø±Ø¨Ø·</th>
                </tr>
              </thead>
              <tbody>
                {requirements.map(req => (
                  <tr key={req.id} className="border-b border-slate-100 hover:bg-slate-50">
                    <td className="px-5 py-4">
                      <span className="font-mono text-sm font-bold text-purple-600 bg-purple-50 px-2.5 py-1 rounded-lg">{req.refCode}</span>
                    </td>
                    <td className="px-4 py-4 text-slate-700">{req.statement}</td>
                    <td className="px-4 py-4 text-center">
                      <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${req.mandatoryLevel === 'Mandatory' ? 'bg-red-100 text-red-700' :
                          req.mandatoryLevel === 'ShouldComply' ? 'bg-amber-100 text-amber-700' : 'bg-blue-100 text-blue-700'
                        }`}>{MANDATORY_LEVELS.find(l => l.code === req.mandatoryLevel)?.nameAr}</span>
                    </td>
                    <td className="px-4 py-4 text-center">
                      {req.evidenceRequired ? <CheckCircle2 className="w-5 h-5 text-emerald-500 mx-auto" /> : <XCircle className="w-5 h-5 text-slate-300 mx-auto" />}
                    </td>
                    <td className="px-4 py-4 text-center text-sm text-slate-600">
                      {FREQUENCIES.find(f => f.code === req.testingFrequency)?.nameAr || req.testingFrequency}
                    </td>
                    <td className="px-4 py-4 text-center">
                      <div className="flex items-center justify-center gap-2">
                        <span className="px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs font-bold">{req.linkedObligations?.length || 0}</span>
                        <span className="px-2 py-1 bg-emerald-50 text-emerald-700 rounded text-xs font-bold">{req.linkedControls?.length || 0}</span>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        )}

        {/* Tab 3: Obligations */}
        {activeTab === 3 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
            <div className="p-6 border-b border-slate-200">
              <h3 className="font-bold text-slate-800 flex items-center gap-2">
                <Link2 className="w-5 h-5 text-blue-600" />
                Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© ({obligations.length})
              </h3>
            </div>
            <div className="divide-y divide-slate-100">
              {obligations.map(obl => (
                <div key={obl.id} className="p-5 flex items-center gap-4 hover:bg-slate-50">
                  <span className="font-mono text-sm font-bold text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-lg">{obl.code}</span>
                  <div className="flex-1"><p className="font-medium text-slate-800">{obl.title}</p></div>
                  <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${obl.criticality === 'High' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'
                    }`}>{obl.criticality === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·'}</span>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Tab 4: Controls */}
        {activeTab === 4 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
            <div className="p-6 border-b border-slate-200">
              <h3 className="font-bold text-slate-800 flex items-center gap-2">
                <Shield className="w-5 h-5 text-emerald-600" />
                Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© ({controls.length})
              </h3>
            </div>
            <div className="divide-y divide-slate-100">
              {controls.map(ctrl => (
                <div key={ctrl.id} className="p-5 flex items-center gap-4 hover:bg-slate-50">
                  <span className="font-mono text-sm font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-lg">{ctrl.code}</span>
                  <div className="flex-1"><p className="font-medium text-slate-800">{ctrl.title}</p></div>
                  <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${ctrl.type === 'Preventive' ? 'bg-emerald-100 text-emerald-700' :
                      ctrl.type === 'Detective' ? 'bg-blue-100 text-blue-700' : 'bg-amber-100 text-amber-700'
                    }`}>{ctrl.type === 'Preventive' ? 'ÙˆÙ‚Ø§Ø¦ÙŠ' : ctrl.type === 'Detective' ? 'ÙƒØ§Ø´Ù' : 'ØªØµØ­ÙŠØ­ÙŠ'}</span>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Tab 5: Attestations */}
        {activeTab === 5 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
            <div className="p-6 border-b border-slate-200 flex items-center justify-between">
              <h3 className="font-bold text-slate-800 flex items-center gap-2">
                <CheckSquare className="w-5 h-5 text-emerald-600" />
                Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±
              </h3>
              <button className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-medium hover:bg-emerald-600">
                <Plus className="w-5 h-5" />
                Ø­Ù…Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
              </button>
            </div>
            <div className="divide-y divide-slate-100">
              {campaigns.map(c => {
                const pct = Math.round((c.acknowledged / c.totalRecipients) * 100);
                return (
                  <div key={c.id} className="p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div>
                        <h4 className="font-bold text-slate-800">{c.title}</h4>
                        <p className="text-sm text-slate-500 mt-1">Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: {c.dueDate}</p>
                      </div>
                      <span className={`px-3 py-1.5 rounded-xl text-sm font-bold ${c.status === 'Completed' ? 'bg-emerald-100 text-emerald-700' :
                          c.status === 'Active' ? 'bg-blue-100 text-blue-700' : 'bg-slate-100 text-slate-600'
                        }`}>{c.status === 'Completed' ? 'Ù…ÙƒØªÙ…Ù„Ø©' : c.status === 'Active' ? 'Ù†Ø´Ø·Ø©' : 'Ù…Ø³ÙˆØ¯Ø©'}</span>
                    </div>

                    <div className="grid grid-cols-4 gap-4 mb-4">
                      <div className="bg-slate-50 rounded-xl p-4 text-center">
                        <div className="text-2xl font-bold text-slate-800">{c.totalRecipients}</div>
                        <div className="text-xs text-slate-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                      </div>
                      <div className="bg-emerald-50 rounded-xl p-4 text-center">
                        <div className="text-2xl font-bold text-emerald-600">{c.acknowledged}</div>
                        <div className="text-xs text-emerald-700">ØªÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±</div>
                      </div>
                      <div className="bg-amber-50 rounded-xl p-4 text-center">
                        <div className="text-2xl font-bold text-amber-600">{c.pending}</div>
                        <div className="text-xs text-amber-700">Ù…Ø¹Ù„Ù‚</div>
                      </div>
                      <div className="bg-red-50 rounded-xl p-4 text-center">
                        <div className="text-2xl font-bold text-red-600">{c.overdue}</div>
                        <div className="text-xs text-red-700">Ù…ØªØ£Ø®Ø±</div>
                      </div>
                    </div>

                    <div className="h-3 bg-slate-200 rounded-full overflow-hidden flex">
                      <div className="bg-emerald-500 h-full" style={{ width: `${(c.acknowledged / c.totalRecipients) * 100}%` }} />
                      <div className="bg-amber-500 h-full" style={{ width: `${(c.pending / c.totalRecipients) * 100}%` }} />
                      <div className="bg-red-500 h-full" style={{ width: `${(c.overdue / c.totalRecipients) * 100}%` }} />
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        {/* Tab 6: Impact Analysis */}
        {activeTab === 6 && (
          <div className="space-y-6">
            <div className="bg-gradient-to-br from-purple-50 to-violet-50 rounded-2xl p-6 border-2 border-purple-200">
              <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                <TrendingUp className="w-5 h-5 text-purple-600" />
                ØªØ­Ù„ÙŠÙ„ Ø£Ø«Ø± Ø§Ù„ØªØºÙŠÙŠØ±
              </h3>
              <p className="text-slate-600 mb-6">Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø©ØŒ Ø³ØªØªØ£Ø«Ø± Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>

              <div className="grid grid-cols-3 gap-6">
                <div className="bg-white rounded-2xl p-5 border border-purple-200">
                  <div className="flex items-center gap-3 mb-3">
                    <div className="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                      <Link2 className="w-5 h-5 text-blue-600" />
                    </div>
                    <div>
                      <p className="text-2xl font-bold text-blue-600">{obligations.length}</p>
                      <p className="text-xs text-slate-500">Ø§Ù„ØªØ²Ø§Ù… Ù…ØªØ£Ø«Ø±</p>
                    </div>
                  </div>
                  <div className="space-y-2">
                    {obligations.slice(0, 3).map(o => (
                      <div key={o.id} className="text-sm text-slate-600 truncate">â€¢ {o.code}</div>
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-2xl p-5 border border-purple-200">
                  <div className="flex items-center gap-3 mb-3">
                    <div className="w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center">
                      <Shield className="w-5 h-5 text-emerald-600" />
                    </div>
                    <div>
                      <p className="text-2xl font-bold text-emerald-600">{controls.length}</p>
                      <p className="text-xs text-slate-500">Ø¶Ø§Ø¨Ø· Ù…ØªØ£Ø«Ø±</p>
                    </div>
                  </div>
                  <div className="space-y-2">
                    {controls.slice(0, 3).map(c => (
                      <div key={c.id} className="text-sm text-slate-600 truncate">â€¢ {c.code}</div>
                    ))}
                  </div>
                </div>

                <div className="bg-white rounded-2xl p-5 border border-purple-200">
                  <div className="flex items-center gap-3 mb-3">
                    <div className="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
                      <AlertTriangle className="w-5 h-5 text-amber-600" />
                    </div>
                    <div>
                      <p className="text-2xl font-bold text-amber-600">{risks.length}</p>
                      <p className="text-xs text-slate-500">Ù…Ø®Ø§Ø·Ø± Ù…ØªØ£Ø«Ø±Ø©</p>
                    </div>
                  </div>
                  <div className="space-y-2">
                    {risks.slice(0, 3).map(r => (
                      <div key={r.id} className="text-sm text-slate-600 truncate">â€¢ {r.code}</div>
                    ))}
                  </div>
                </div>
              </div>
            </div>

            {POLICY_RULES.requiresImpactAnalysis(policy) && (
              <div className="bg-amber-50 rounded-2xl p-6 border-2 border-amber-200">
                <div className="flex items-start gap-4">
                  <AlertTriangle className="w-6 h-6 text-amber-600 flex-shrink-0 mt-1" />
                  <div>
                    <h4 className="font-bold text-amber-800 mb-2">ØªÙ†Ø¨ÙŠÙ‡: ÙŠØªØ·Ù„Ø¨ Ù…ÙˆØ§ÙÙ‚Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªÙØ¹ÙŠÙ„</h4>
                    <p className="text-amber-700">Ù†Ø¸Ø±Ø§Ù‹ Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¨Ù€ {obligations.length} Ø§Ù„ØªØ²Ø§Ù… Ùˆ {controls.length} Ø¶Ø§Ø¨Ø·ØŒ ÙŠØ¬Ø¨ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ù‚Ø¨Ù„ ØªÙØ¹ÙŠÙ„ Ø£ÙŠ ØªØºÙŠÙŠØ±.</p>
                  </div>
                </div>
              </div>
            )}
          </div>
        )}

        {/* Tab 7: Evidence Pack */}
        {activeTab === 7 && (
          <div className="bg-white rounded-2xl border-2 border-slate-200 p-8 text-center">
            <div className="w-20 h-20 mx-auto mb-4 rounded-2xl bg-emerald-100 flex items-center justify-center">
              <FileCheck className="w-10 h-10 text-emerald-600" />
            </div>
            <h3 className="text-xl font-bold text-slate-800 mb-2">Ù…ÙˆÙ„Ù‘Ø¯ Ø­Ø²Ù…Ø© Ø§Ù„Ø£Ø¯Ù„Ø©</h3>
            <p className="text-slate-500 mb-6">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø£Ø¯Ù„Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„ØªØ¯Ù‚ÙŠÙ‚</p>
            <div className="flex items-center justify-center gap-4">
              <button className="flex items-center gap-2 px-6 py-3 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                <Download className="w-5 h-5" />
                ØªØ­Ù…ÙŠÙ„ PDF
              </button>
              <button className="flex items-center gap-2 px-6 py-3 border-2 border-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-50">
                <FileText className="w-5 h-5" />
                ØªØµØ¯ÙŠØ± Excel
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POLICY CREATE MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PolicyFormModal - World-Class Enterprise Edition v3.0
// ÙŠØªÙÙˆÙ‚ Ø¹Ù„Ù‰: Archer, ServiceNow, MetricStream, SAP GRC, IBM OpenPages
//            OneTrust, LogicGate, Workiva, Diligent, NAVEX Global
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 10 Tabs Ø´Ø§Ù…Ù„Ø© | SoD Validation | RACI Matrix | Dynamic Regulatory Mapping
// Document Hierarchy | Exception Management | Attestation Campaigns
// Cross-Framework Mapping | Impact Analysis | Audit Trail
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PolicyFormModal = ({ data, onClose, onUpdate, mode = 'create' }) => {
  const [activeTab, setActiveTab] = useState(0);
  const [validationErrors, setValidationErrors] = useState({});
  const [showPreview, setShowPreview] = useState(false);
  const [expandedSections, setExpandedSections] = useState({});

  const isEditMode = mode === 'edit';
  const isViewMode = mode === 'view';
  const isReadOnly = isViewMode;

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ¯ COMPREHENSIVE REFERENCE DATA
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  // 8 Ø¬Ù‡Ø§Øª Ø±Ù‚Ø§Ø¨ÙŠØ© Ø³Ø¹ÙˆØ¯ÙŠØ© + Ø£Ø·Ø± Ø¯ÙˆÙ„ÙŠØ©
  const REGULATORY_AUTHORITIES_DATA = [
    { id: 'sama', code: 'SAMA', nameAr: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', nameEn: 'Saudi Central Bank', color: 'emerald', icon: 'ğŸ¦', sector: 'Ù…Ø§Ù„ÙŠ', priority: 1 },
    { id: 'cma', code: 'CMA', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', nameEn: 'Capital Market Authority', color: 'blue', icon: 'ğŸ“ˆ', sector: 'Ù…Ø§Ù„ÙŠ', priority: 2 },
    { id: 'nca', code: 'NCA', nameAr: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'National Cybersecurity Authority', color: 'purple', icon: 'ğŸ›¡ï¸', sector: 'Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', priority: 1 },
    { id: 'sdaia', code: 'SDAIA', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', nameEn: 'Saudi Data & AI Authority', color: 'cyan', icon: 'ğŸ¤–', sector: 'Ø¨ÙŠØ§Ù†Ø§Øª', priority: 2 },
    { id: 'citc', code: 'CITC', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', nameEn: 'Communications & IT Commission', color: 'indigo', icon: 'ğŸ“¡', sector: 'Ø§ØªØµØ§Ù„Ø§Øª', priority: 3 },
    { id: 'mhrsd', code: 'MHRSD', nameAr: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', nameEn: 'Ministry of Human Resources', color: 'teal', icon: 'ğŸ‘¥', sector: 'Ø¹Ù…Ø§Ù„ÙŠ', priority: 3 },
    { id: 'cchi', code: 'CCHI', nameAr: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØµØ­ÙŠ', nameEn: 'Council of Health Insurance', color: 'rose', icon: 'ğŸ¥', sector: 'ØµØ­ÙŠ', priority: 4 },
    { id: 'zatca', code: 'ZATCA', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ', nameEn: 'Zakat, Tax & Customs', color: 'amber', icon: 'ğŸ’°', sector: 'Ø¶Ø±ÙŠØ¨ÙŠ', priority: 2 },
  ];

  // Ø§Ù„Ø£Ø·Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ù„ÙƒÙ„ Ø¬Ù‡Ø©
  const REGULATORY_FRAMEWORKS_DATA = {
    sama: [
      { code: 'SAMA-CSF', nameAr: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'Cybersecurity Framework', version: '1.0', year: 2017, controls: 86, domains: 4 },
      { code: 'SAMA-BCM', nameAr: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', nameEn: 'Business Continuity Management', version: '2.0', year: 2020, controls: 45, domains: 5 },
      { code: 'SAMA-AML', nameAr: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', nameEn: 'Anti-Money Laundering', version: '3.0', year: 2021, controls: 62, domains: 6 },
      { code: 'SAMA-ITGF', nameAr: 'Ø­ÙˆÙƒÙ…Ø© ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', nameEn: 'IT Governance Framework', version: '1.5', year: 2019, controls: 78, domains: 5 },
      { code: 'SAMA-ORF', nameAr: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©', nameEn: 'Operational Risk Framework', version: '2.0', year: 2022, controls: 55, domains: 4 },
      { code: 'SAMA-TPR', nameAr: 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù„Ø«', nameEn: 'Third Party Risk', version: '1.0', year: 2023, controls: 38, domains: 3 },
    ],
    cma: [
      { code: 'CMA-CGR', nameAr: 'Ù„Ø§Ø¦Ø­Ø© Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª', nameEn: 'Corporate Governance Regulations', version: '2021', year: 2021, controls: 95, domains: 8 },
      { code: 'CMA-MAR', nameAr: 'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³ÙˆÙ‚', nameEn: 'Market Rules', version: '2023', year: 2023, controls: 120, domains: 7 },
      { code: 'CMA-AML', nameAr: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', nameEn: 'AML Rules', version: '2022', year: 2022, controls: 55, domains: 4 },
      { code: 'CMA-DIS', nameAr: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥ÙØµØ§Ø­', nameEn: 'Disclosure Requirements', version: '2023', year: 2023, controls: 42, domains: 3 },
    ],
    nca: [
      { code: 'NCA-ECC', nameAr: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'Essential Cybersecurity Controls', version: '2.0', year: 2024, controls: 114, domains: 5 },
      { code: 'NCA-CSCC', nameAr: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©', nameEn: 'Critical Systems Controls', version: '1.0', year: 2022, controls: 75, domains: 4 },
      { code: 'NCA-DCC', nameAr: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Cybersecurity Controls', version: '1.0', year: 2023, controls: 48, domains: 3 },
      { code: 'NCA-CCC', nameAr: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø­ÙˆØ³Ø¨Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©', nameEn: 'Cloud Cybersecurity Controls', version: '1.0', year: 2023, controls: 65, domains: 4 },
      { code: 'NCA-TCC', nameAr: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù† Ø¨Ø¹Ø¯', nameEn: 'Telework Cybersecurity Controls', version: '1.0', year: 2020, controls: 32, domains: 2 },
      { code: 'NCA-OT', nameAr: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©', nameEn: 'OT Security Controls', version: '1.0', year: 2024, controls: 58, domains: 4 },
    ],
    sdaia: [
      { code: 'PDPL', nameAr: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', nameEn: 'Personal Data Protection Law', version: '2023', year: 2023, controls: 43, domains: 5 },
      { code: 'NDMO', nameAr: 'ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ©', nameEn: 'National Data Classification', version: '1.0', year: 2022, controls: 28, domains: 3 },
      { code: 'AI-ETH', nameAr: 'Ø£Ø®Ù„Ø§Ù‚ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', nameEn: 'AI Ethics Guidelines', version: '1.0', year: 2023, controls: 35, domains: 4 },
      { code: 'DG-FW', nameAr: 'Ø¥Ø·Ø§Ø± Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Governance Framework', version: '1.0', year: 2024, controls: 52, domains: 5 },
    ],
    citc: [
      { code: 'CRF', nameAr: 'Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ù„Ù„Ø§ØªØµØ§Ù„Ø§Øª', nameEn: 'Communications Regulatory Framework', version: '2022', year: 2022, controls: 88, domains: 6 },
      { code: 'IOT-SEC', nameAr: 'Ø£Ù…Ù† Ø¥Ù†ØªØ±Ù†Øª Ø§Ù„Ø£Ø´ÙŠØ§Ø¡', nameEn: 'IoT Security Framework', version: '1.0', year: 2023, controls: 42, domains: 3 },
    ],
    mhrsd: [
      { code: 'LABOR', nameAr: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„', nameEn: 'Labor Law', version: '2023', year: 2023, controls: 156, domains: 12 },
      { code: 'WPS', nameAr: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±', nameEn: 'Wage Protection System', version: '2.0', year: 2022, controls: 18, domains: 2 },
      { code: 'NITAQAT', nameAr: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù†Ø·Ø§Ù‚Ø§Øª', nameEn: 'Nitaqat Program', version: '3.0', year: 2023, controls: 22, domains: 3 },
      { code: 'QIWA', nameAr: 'Ù…Ù†ØµØ© Ù‚ÙˆÙ‰', nameEn: 'Qiwa Platform', version: '2.0', year: 2024, controls: 35, domains: 4 },
    ],
    cchi: [
      { code: 'CHI', nameAr: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØµØ­ÙŠ', nameEn: 'Cooperative Health Insurance', version: '2023', year: 2023, controls: 67, domains: 5 },
      { code: 'NPHIES', nameAr: 'Ù…Ù†ØµØ© ØµØ­ÙŠ', nameEn: 'NPHIES Platform', version: '1.0', year: 2022, controls: 45, domains: 4 },
    ],
    zatca: [
      { code: 'VAT', nameAr: 'Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©', nameEn: 'Value Added Tax', version: '2023', year: 2023, controls: 89, domains: 7 },
      { code: 'FATOORA', nameAr: 'Ø§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', nameEn: 'E-Invoicing', version: '2.0', year: 2023, controls: 34, domains: 3 },
      { code: 'ZAKAT', nameAr: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙƒØ§Ø©', nameEn: 'Zakat Regulations', version: '2022', year: 2022, controls: 42, domains: 4 },
      { code: 'CUSTOMS', nameAr: 'Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ', nameEn: 'Customs Law', version: '2023', year: 2023, controls: 68, domains: 5 },
    ],
  };

  // Ø§Ù„Ø£Ø·Ø± Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„Ù€ Cross-Mapping
  const INTERNATIONAL_FRAMEWORKS = [
    { code: 'ISO27001', nameAr: 'Ø¢ÙŠØ²Ùˆ 27001', nameEn: 'ISO 27001:2022', icon: 'ğŸ”', controls: 93 },
    { code: 'ISO22301', nameAr: 'Ø¢ÙŠØ²Ùˆ 22301', nameEn: 'ISO 22301:2019', icon: 'ğŸ”„', controls: 54 },
    { code: 'NIST-CSF', nameAr: 'Ø¥Ø·Ø§Ø± NIST', nameEn: 'NIST CSF 2.0', icon: 'ğŸ‡ºğŸ‡¸', controls: 108 },
    { code: 'COBIT', nameAr: 'ÙƒÙˆØ¨Øª', nameEn: 'COBIT 2019', icon: 'ğŸ“Š', controls: 40 },
    { code: 'PCI-DSS', nameAr: 'Ù…Ø¹ÙŠØ§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙØ¹', nameEn: 'PCI DSS 4.0', icon: 'ğŸ’³', controls: 253 },
    { code: 'SOC2', nameAr: 'Ù…Ø¹Ø§ÙŠÙŠØ± SOC2', nameEn: 'SOC 2 Type II', icon: 'âœ…', controls: 64 },
    { code: 'GDPR', nameAr: 'Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠØ©', nameEn: 'GDPR', icon: 'ğŸ‡ªğŸ‡º', controls: 99 },
    { code: 'SWIFT-CSP', nameAr: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø³ÙˆÙŠÙØª', nameEn: 'SWIFT CSP', icon: 'ğŸ’±', controls: 32 },
  ];

  // Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ (Document Hierarchy)
  const DOCUMENT_TYPES = [
    { code: 'Policy', level: 1, nameAr: 'Ø³ÙŠØ§Ø³Ø©', nameEn: 'Policy', icon: 'ğŸ“œ', color: 'emerald', description: 'ÙˆØ«ÙŠÙ‚Ø© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ØªØ­Ø¯Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ ÙˆØ§Ù„ØªÙˆØ¬Ù‡Ø§Øª' },
    { code: 'Standard', level: 2, nameAr: 'Ù…Ø¹ÙŠØ§Ø±', nameEn: 'Standard', icon: 'ğŸ“‹', color: 'blue', description: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø¥Ù„Ø²Ø§Ù…ÙŠØ© Ù…Ø­Ø¯Ø¯Ø© ÙˆÙ‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù‚ÙŠØ§Ø³' },
    { code: 'Procedure', level: 3, nameAr: 'Ø¥Ø¬Ø±Ø§Ø¡', nameEn: 'Procedure', icon: 'ğŸ“', color: 'purple', description: 'Ø®Ø·ÙˆØ§Øª ØªÙØµÙŠÙ„ÙŠØ© Ù„Ù„ØªÙ†ÙÙŠØ° ÙˆØ§Ù„ØªØ´ØºÙŠÙ„' },
    { code: 'Guideline', level: 3, nameAr: 'Ø¯Ù„ÙŠÙ„ Ø¥Ø±Ø´Ø§Ø¯ÙŠ', nameEn: 'Guideline', icon: 'ğŸ“–', color: 'cyan', description: 'ØªÙˆØµÙŠØ§Øª ÙˆØ£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª ØºÙŠØ± Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©' },
    { code: 'Baseline', level: 2, nameAr: 'Ø®Ø· Ø£Ø³Ø§Ø³', nameEn: 'Baseline', icon: 'ğŸ“Š', color: 'amber', description: 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù…Ù† Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©' },
    { code: 'Playbook', level: 4, nameAr: 'Ø¯Ù„ÙŠÙ„ ØªØ´ØºÙŠÙ„ÙŠ', nameEn: 'Playbook', icon: 'ğŸ“•', color: 'rose', description: 'Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙˆØ§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø­ÙˆØ§Ø¯Ø«' },
  ];

  // Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© (5 Ù…Ø³ØªÙˆÙŠØ§Øª)
  const CLASSIFICATION_LEVELS = [
    { code: 'Public', level: 1, nameAr: 'Ø¹Ø§Ù…', nameEn: 'Public', color: 'emerald', icon: 'ğŸŒ', description: 'ÙŠÙ…ÙƒÙ† Ù†Ø´Ø±Ù‡ Ù„Ù„Ø¹Ù…ÙˆÙ…' },
    { code: 'Internal', level: 2, nameAr: 'Ø¯Ø§Ø®Ù„ÙŠ', nameEn: 'Internal', color: 'blue', icon: 'ğŸ¢', description: 'Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ ÙÙ‚Ø·' },
    { code: 'Confidential', level: 3, nameAr: 'Ø³Ø±ÙŠ', nameEn: 'Confidential', color: 'amber', icon: 'ğŸ”’', description: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø© Ù…Ø­Ø¯ÙˆØ¯Ø© Ø§Ù„ÙˆØµÙˆÙ„' },
    { code: 'Restricted', level: 4, nameAr: 'Ù…Ø­Ø¯ÙˆØ¯', nameEn: 'Restricted', color: 'orange', icon: 'âš ï¸', description: 'ÙˆØµÙˆÙ„ Ù…Ù‚ÙŠØ¯ Ø¬Ø¯Ø§Ù‹' },
    { code: 'TopSecret', level: 5, nameAr: 'Ø³Ø±ÙŠ Ù„Ù„ØºØ§ÙŠØ©', nameEn: 'Top Secret', color: 'red', icon: 'ğŸš«', description: 'Ø£Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ø±ÙŠØ©' },
  ];

  // Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø£Ù‡Ù…ÙŠØ©/Ø§Ù„Ø­Ø±Ø¬ÙŠØ©
  const CRITICALITY_LEVELS = [
    { code: 'Low', score: 1, nameAr: 'Ù…Ù†Ø®ÙØ¶', nameEn: 'Low', color: 'emerald', sla: 30, description: 'ØªØ£Ø«ÙŠØ± Ù…Ø­Ø¯ÙˆØ¯' },
    { code: 'Medium', score: 2, nameAr: 'Ù…ØªÙˆØ³Ø·', nameEn: 'Medium', color: 'amber', sla: 14, description: 'ØªØ£Ø«ÙŠØ± Ù…ØªÙˆØ³Ø·' },
    { code: 'High', score: 3, nameAr: 'Ø¹Ø§Ù„ÙŠ', nameEn: 'High', color: 'orange', sla: 7, description: 'ØªØ£Ø«ÙŠØ± ÙƒØ¨ÙŠØ±' },
    { code: 'Critical', score: 4, nameAr: 'Ø­Ø±Ø¬', nameEn: 'Critical', color: 'red', sla: 1, description: 'ØªØ£Ø«ÙŠØ± Ø®Ø·ÙŠØ±' },
  ];

  // Ø­Ø§Ù„Ø§Øª Ø¯ÙˆØ±Ø© Ø§Ù„Ø­ÙŠØ§Ø© (8 Ø­Ø§Ù„Ø§Øª)
  const LIFECYCLE_STATES = [
    { code: 'Draft', nameAr: 'Ù…Ø³ÙˆØ¯Ø©', nameEn: 'Draft', color: 'slate', icon: 'âœï¸', next: ['PendingReview', 'Cancelled'] },
    { code: 'PendingReview', nameAr: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', nameEn: 'Pending Review', color: 'blue', icon: 'ğŸ‘ï¸', next: ['PendingApproval', 'Draft', 'Rejected'] },
    { code: 'PendingApproval', nameAr: 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', nameEn: 'Pending Approval', color: 'purple', icon: 'âœï¸', next: ['Approved', 'PendingReview', 'Rejected'] },
    { code: 'Approved', nameAr: 'Ù…Ø¹ØªÙ…Ø¯', nameEn: 'Approved', color: 'indigo', icon: 'âœ…', next: ['Published'] },
    { code: 'Published', nameAr: 'Ù…Ù†Ø´ÙˆØ±', nameEn: 'Published', color: 'emerald', icon: 'ğŸ“¢', next: ['UnderRevision', 'Retired'] },
    { code: 'UnderRevision', nameAr: 'Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«', nameEn: 'Under Revision', color: 'amber', icon: 'ğŸ”„', next: ['PendingReview'] },
    { code: 'Retired', nameAr: 'Ù…ØªÙ‚Ø§Ø¹Ø¯', nameEn: 'Retired', color: 'gray', icon: 'ğŸ“¦', next: ['Archived'] },
    { code: 'Archived', nameAr: 'Ù…Ø¤Ø±Ø´Ù', nameEn: 'Archived', color: 'gray', icon: 'ğŸ—„ï¸', next: [] },
  ];

  // Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
  const REVIEW_FREQUENCIES = [
    { code: 'Monthly', nameAr: 'Ø´Ù‡Ø±ÙŠ', nameEn: 'Monthly', days: 30, icon: 'ğŸ“…' },
    { code: 'Quarterly', nameAr: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', nameEn: 'Quarterly', days: 90, icon: 'ğŸ“Š' },
    { code: 'SemiAnnual', nameAr: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ', nameEn: 'Semi-Annual', days: 180, icon: 'ğŸ“ˆ' },
    { code: 'Annual', nameAr: 'Ø³Ù†ÙˆÙŠ', nameEn: 'Annual', days: 365, icon: 'ğŸ“†' },
    { code: 'Biennial', nameAr: 'ÙƒÙ„ Ø³Ù†ØªÙŠÙ†', nameEn: 'Biennial', days: 730, icon: 'ğŸ—“ï¸' },
    { code: 'Triennial', nameAr: 'ÙƒÙ„ 3 Ø³Ù†ÙˆØ§Øª', nameEn: 'Triennial', days: 1095, icon: 'ğŸ“‹' },
    { code: 'EventDriven', nameAr: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¯Ø«', nameEn: 'Event-Driven', days: null, icon: 'âš¡' },
  ];

  // Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
  const REVIEW_TRIGGERS = [
    { code: 'RegulatoryChange', nameAr: 'ØªØºÙŠÙŠØ± ØªÙ†Ø¸ÙŠÙ…ÙŠ', icon: 'ğŸ“œ' },
    { code: 'SecurityIncident', nameAr: 'Ø­Ø§Ø¯Ø« Ø£Ù…Ù†ÙŠ', icon: 'ğŸš¨' },
    { code: 'AuditFinding', nameAr: 'Ù…Ù„Ø§Ø­Ø¸Ø© ØªØ¯Ù‚ÙŠÙ‚', icon: 'ğŸ”' },
    { code: 'BusinessChange', nameAr: 'ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', icon: 'ğŸ¢' },
    { code: 'TechnologyChange', nameAr: 'ØªØºÙŠÙŠØ± ØªÙ‚Ù†ÙŠ', icon: 'ğŸ’»' },
    { code: 'RiskAssessment', nameAr: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø±', icon: 'âš ï¸' },
    { code: 'ManagementRequest', nameAr: 'Ø·Ù„Ø¨ Ø¥Ø¯Ø§Ø±ÙŠ', icon: 'ğŸ‘”' },
  ];

  // Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©
  const EVIDENCE_TYPES = [
    { code: 'Document', nameAr: 'Ù…Ø³ØªÙ†Ø¯', nameEn: 'Document', icon: FileText },
    { code: 'Screenshot', nameAr: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', nameEn: 'Screenshot', icon: Eye },
    { code: 'Report', nameAr: 'ØªÙ‚Ø±ÙŠØ±', nameEn: 'Report', icon: BarChart3 },
    { code: 'Log', nameAr: 'Ø³Ø¬Ù„ Ù†Ø¸Ø§Ù…', nameEn: 'System Log', icon: FileCheck },
    { code: 'Attestation', nameAr: 'Ø¥Ù‚Ø±Ø§Ø±', nameEn: 'Attestation', icon: CheckSquare },
    { code: 'Audit', nameAr: 'ØªØ¯Ù‚ÙŠÙ‚', nameEn: 'Audit Report', icon: ClipboardCheck },
    { code: 'Config', nameAr: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', nameEn: 'Configuration', icon: Settings },
    { code: 'Email', nameAr: 'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', nameEn: 'Email', icon: Mail },
  ];

  // Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±
  const ATTESTATION_TYPES = [
    { code: 'ReadAcknowledge', nameAr: 'Ù‚Ø±Ø§Ø¡Ø© ÙˆØ¥Ù‚Ø±Ø§Ø±', icon: Eye, description: 'Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© ÙˆØ§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø¨ÙÙ‡Ù…Ù‡Ø§' },
    { code: 'TrainingComplete', nameAr: 'Ø¥ØªÙ…Ø§Ù… ØªØ¯Ø±ÙŠØ¨', icon: BookOpen, description: 'Ø¥ÙƒÙ…Ø§Ù„ Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ÙŠ Ù…Ø±ØªØ¨Ø·' },
    { code: 'AnnualCertification', nameAr: 'Ø´Ù‡Ø§Ø¯Ø© Ø³Ù†ÙˆÙŠØ©', icon: CheckCircle2, description: 'Ø¥Ù‚Ø±Ø§Ø± Ø³Ù†ÙˆÙŠ Ø¨Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
    { code: 'ComplianceDeclaration', nameAr: 'Ø¥Ù‚Ø±Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„', icon: Shield, description: 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª' },
    { code: 'QuizPassed', nameAr: 'Ø§Ø¬ØªÙŠØ§Ø² Ø§Ø®ØªØ¨Ø§Ø±', icon: ClipboardCheck, description: 'Ø§Ø¬ØªÙŠØ§Ø² Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙÙ‡Ù…' },
  ];

  // Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡
  const EXCEPTION_APPROVAL_LEVELS = [
    { code: 'Manager', level: 1, nameAr: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', nameEn: 'Direct Manager', maxDays: 30 },
    { code: 'Director', level: 2, nameAr: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', nameEn: 'Director', maxDays: 90 },
    { code: 'VP', level: 3, nameAr: 'Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³', nameEn: 'Vice President', maxDays: 180 },
    { code: 'CXO', level: 4, nameAr: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ', nameEn: 'C-Level Executive', maxDays: 365 },
    { code: 'Board', level: 5, nameAr: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', nameEn: 'Board of Directors', maxDays: null },
  ];

  // Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª
  const DEPARTMENTS = [
    { code: 'IT', nameAr: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', color: 'blue' },
    { code: 'HR', nameAr: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', color: 'teal' },
    { code: 'Finance', nameAr: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©', color: 'emerald' },
    { code: 'Legal', nameAr: 'Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©', color: 'purple' },
    { code: 'Operations', nameAr: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', color: 'amber' },
    { code: 'Compliance', nameAr: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', color: 'indigo' },
    { code: 'Risk', nameAr: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', color: 'orange' },
    { code: 'Audit', nameAr: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', color: 'rose' },
    { code: 'Security', nameAr: 'Ø§Ù„Ø£Ù…Ù†', color: 'red' },
    { code: 'Procurement', nameAr: 'Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', color: 'cyan' },
    { code: 'Marketing', nameAr: 'Ø§Ù„ØªØ³ÙˆÙŠÙ‚', color: 'pink' },
    { code: 'Sales', nameAr: 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', color: 'lime' },
    { code: 'CustomerService', nameAr: 'Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', color: 'sky' },
    { code: 'All', nameAr: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª', color: 'slate' },
  ];

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“‘ 10 TABS CONFIGURATION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const tabs = [
    { id: 0, code: 'basic', labelAr: 'Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', labelEn: 'Basic', icon: FileText, color: 'emerald' },
    { id: 1, code: 'regulatory', labelAr: 'Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', labelEn: 'Regulatory', icon: Scale, color: 'blue' },
    { id: 2, code: 'scope', labelAr: 'Ø§Ù„Ù†Ø·Ø§Ù‚', labelEn: 'Scope', icon: Target, color: 'cyan' },
    { id: 3, code: 'accountability', labelAr: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª', labelEn: 'RACI', icon: Users, color: 'purple' },
    { id: 4, code: 'requirements', labelAr: 'Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', labelEn: 'Requirements', icon: ClipboardCheck, color: 'amber' },
    { id: 5, code: 'schedule', labelAr: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©', labelEn: 'Schedule', icon: Calendar, color: 'indigo' },
    { id: 6, code: 'attestation', labelAr: 'Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª', labelEn: 'Attestation', icon: CheckSquare, color: 'rose' },
    { id: 7, code: 'exceptions', labelAr: 'Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', labelEn: 'Exceptions', icon: AlertTriangle, color: 'orange' },
    { id: 8, code: 'linkages', labelAr: 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', labelEn: 'Linkages', icon: Network, color: 'teal' },
    { id: 9, code: 'publish', labelAr: 'Ø§Ù„Ù†Ø´Ø±', labelEn: 'Publish', icon: Send, color: 'green' },
  ];

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“Š COMPUTED VALUES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
  const completionChecks = useMemo(() => [
    { field: 'title', check: data?.title?.length >= 5, label: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', tab: 0, weight: 2 },
    { field: 'titleEn', check: data?.titleEn?.length >= 5, label: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (EN)', tab: 0, weight: 1 },
    { field: 'type', check: !!data?.type, label: 'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©', tab: 0, weight: 2 },
    { field: 'summary', check: data?.summary?.length >= 20, label: 'Ø§Ù„ÙˆØµÙ', tab: 0, weight: 1 },
    { field: 'classification', check: !!data?.classification, label: 'Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø£Ù…Ù†ÙŠ', tab: 0, weight: 1 },
    { field: 'impactLevel', check: !!data?.impactLevel, label: 'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø«Ø±', tab: 0, weight: 1 },
    { field: 'primaryAuthority', check: !!data?.primaryAuthority, label: 'Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©', tab: 1, weight: 2 },
    { field: 'primaryFramework', check: !!data?.primaryFramework, label: 'Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', tab: 1, weight: 2 },
    { field: 'scopeType', check: !!data?.scopeType, label: 'Ù†ÙˆØ¹ Ø§Ù„Ù†Ø·Ø§Ù‚', tab: 2, weight: 1 },
    { field: 'applicableDepartments', check: data?.applicableDepartments?.length > 0, label: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ©', tab: 2, weight: 1 },
    { field: 'ownerId', check: !!data?.ownerId, label: 'Ø§Ù„Ù…Ø§Ù„Ùƒ', tab: 3, weight: 2 },
    { field: 'reviewerId', check: !!data?.reviewerId, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹', tab: 3, weight: 2 },
    { field: 'approverId', check: !!data?.approverId, label: 'Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', tab: 3, weight: 1 },
    { field: 'effectiveDate', check: !!data?.effectiveDate, label: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†', tab: 5, weight: 2 },
    { field: 'reviewFrequency', check: !!data?.reviewFrequency, label: 'Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', tab: 5, weight: 1 },
  ], [data]);

  const progressPct = useMemo(() => {
    const totalWeight = completionChecks.reduce((sum, c) => sum + c.weight, 0);
    const completedWeight = completionChecks.filter(c => c.check).reduce((sum, c) => sum + c.weight, 0);
    return Math.round((completedWeight / totalWeight) * 100);
  }, [completionChecks]);

  // Ø­Ø³Ø§Ø¨ Ø§ÙƒØªÙ…Ø§Ù„ ÙƒÙ„ ØªØ§Ø¨
  const tabCompletion = useMemo(() => {
    const result = {};
    tabs.forEach(tab => {
      const tabChecks = completionChecks.filter(c => c.tab === tab.id);
      if (tabChecks.length === 0) {
        result[tab.id] = 100;
      } else {
        const completed = tabChecks.filter(c => c.check).length;
        result[tab.id] = Math.round((completed / tabChecks.length) * 100);
      }
    });
    return result;
  }, [completionChecks]);

  // SoD Validation
  const sodValidation = useMemo(() => {
    const violations = [];
    if (data?.ownerId && data?.reviewerId && data?.ownerId === data?.reviewerId) {
      violations.push({ type: 'owner-reviewer', msg: 'Ø§Ù„Ù…Ø§Ù„Ùƒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹', severity: 'error' });
    }
    if (data?.ownerId && data?.approverId && data?.ownerId === data?.approverId) {
      violations.push({ type: 'owner-approver', msg: 'Ø§Ù„Ù…Ø§Ù„Ùƒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', severity: 'error' });
    }
    if (data?.reviewerId && data?.approverId && data?.reviewerId === data?.approverId) {
      violations.push({ type: 'reviewer-approver', msg: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', severity: 'warning' });
    }
    return { isValid: violations.filter(v => v.severity === 'error').length === 0, violations };
  }, [data?.ownerId, data?.reviewerId, data?.approverId]);

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ù„Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
  const documentTypeInfo = useMemo(() => {
    const typeMap = {
      'Policy': {
        nameAr: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø©',
        nameArIndefinite: 'Ø³ÙŠØ§Ø³Ø©',
        icon: 'ğŸ“œ',
        color: 'emerald',
        gradientCreate: 'from-emerald-600 via-teal-600 to-cyan-600',
        gradientEdit: 'from-emerald-600 via-emerald-500 to-teal-500'
      },
      'Standard': {
        nameAr: 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø±',
        nameArIndefinite: 'Ù…Ø¹ÙŠØ§Ø±',
        icon: 'ğŸ“‹',
        color: 'blue',
        gradientCreate: 'from-blue-600 via-indigo-600 to-purple-600',
        gradientEdit: 'from-blue-600 via-blue-500 to-indigo-500'
      },
      'Procedure': {
        nameAr: 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡',
        nameArIndefinite: 'Ø¥Ø¬Ø±Ø§Ø¡',
        icon: 'ğŸ“',
        color: 'purple',
        gradientCreate: 'from-purple-600 via-violet-600 to-indigo-600',
        gradientEdit: 'from-purple-600 via-purple-500 to-violet-500'
      },
      'Guideline': {
        nameAr: 'Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ',
        nameArIndefinite: 'Ø¯Ù„ÙŠÙ„ Ø¥Ø±Ø´Ø§Ø¯ÙŠ',
        icon: 'ğŸ“–',
        color: 'cyan',
        gradientCreate: 'from-cyan-600 via-teal-600 to-emerald-600',
        gradientEdit: 'from-cyan-600 via-cyan-500 to-teal-500'
      },
      'Baseline': {
        nameAr: 'Ø®Ø· Ø§Ù„Ø£Ø³Ø§Ø³',
        nameArIndefinite: 'Ø®Ø· Ø£Ø³Ø§Ø³',
        icon: 'ğŸ“Š',
        color: 'amber',
        gradientCreate: 'from-amber-600 via-orange-600 to-red-600',
        gradientEdit: 'from-amber-600 via-amber-500 to-orange-500'
      },
      'Playbook': {
        nameAr: 'Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ',
        nameArIndefinite: 'Ø¯Ù„ÙŠÙ„ ØªØ´ØºÙŠÙ„ÙŠ',
        icon: 'ğŸ“•',
        color: 'rose',
        gradientCreate: 'from-rose-600 via-pink-600 to-fuchsia-600',
        gradientEdit: 'from-rose-600 via-rose-500 to-pink-500'
      },
    };
    return typeMap[data?.type] || typeMap['Policy'];
  }, [data?.type]);

  // Ø§Ù„Ø£Ø·Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©
  const availableFrameworks = useMemo(() => {
    if (!data?.primaryAuthority) return [];
    return REGULATORY_FRAMEWORKS_DATA[data.primaryAuthority] || [];
  }, [data?.primaryAuthority]);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ”§ HANDLERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const handleFieldChange = (field, value) => {
    onUpdate(field, value);
    if (validationErrors[field]) setValidationErrors(prev => ({ ...prev, [field]: null }));
  };

  const handleSave = (asDraft = false) => {
    const errors = {};
    if (!data?.title || data.title.length < 5) errors.title = 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨ (5 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)';
    if (!data?.type) errors.type = 'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ù…Ø·Ù„ÙˆØ¨';
    if (!asDraft && !sodValidation.isValid) errors.sod = 'ÙŠÙˆØ¬Ø¯ Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª ÙÙŠ ÙØµÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª';
    if (Object.keys(errors).length > 0) { setValidationErrors(errors); setActiveTab(0); return; }

    const typeNames = {
      'Policy': 'Ø§Ù„Ø³ÙŠØ§Ø³Ø©',
      'Standard': 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø±',
      'Procedure': 'Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡',
      'Guideline': 'Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ',
      'Baseline': 'Ø®Ø· Ø§Ù„Ø£Ø³Ø§Ø³',
      'Playbook': 'Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ',
    };
    const typeName = typeNames[data?.type] || 'Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©';
    const action = isEditMode ? 'ØªØ¹Ø¯ÙŠÙ„' : (asDraft ? 'Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©' : 'Ø¥Ù†Ø´Ø§Ø¡');
    alert(`ØªÙ… ${action} ${typeName}: ${data.title}`);
    onClose();
  };

  const toggleSection = (section) => {
    setExpandedSections(prev => ({ ...prev, [section]: !prev[section] }));
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ¨ RENDER HELPERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderFieldLabel = (labelAr, labelEn, required = false, hint = null) => (
    <div className="flex items-center justify-between mb-2">
      <label className="text-sm font-bold text-slate-700">
        {labelAr}
        {required && <span className="text-red-500 mr-1">*</span>}
      </label>
      <div className="flex items-center gap-2">
        {hint && (
          <span className="text-xs text-slate-400 flex items-center gap-1">
            <Info className="w-3 h-3" />
            {hint}
          </span>
        )}
        <span className="text-xs text-slate-400">{labelEn}</span>
      </div>
    </div>
  );

  const renderSectionHeader = (titleAr, titleEn, IconComponent, expanded, onToggle, count = null) => (
    <button
      type="button"
      onClick={onToggle}
      className="w-full flex items-center justify-between p-4 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl border border-slate-200 hover:border-slate-300 transition-all"
    >
      <div className="flex items-center gap-3">
        <div className="w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center">
          <IconComponent className="w-5 h-5 text-slate-600" />
        </div>
        <div className="text-right">
          <h4 className="font-bold text-slate-800">{titleAr}</h4>
          <p className="text-xs text-slate-500">{titleEn}</p>
        </div>
        {count !== null && (
          <span className="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-bold rounded-lg">{count}</span>
        )}
      </div>
      <ChevronDown className={`w-5 h-5 text-slate-400 transition-transform ${expanded ? 'rotate-180' : ''}`} />
    </button>
  );

  const getColorClasses = (color, isSelected) => {
    const colors = {
      emerald: isSelected ? 'bg-emerald-50 border-emerald-400 text-emerald-700' : 'border-slate-200 hover:border-emerald-300',
      blue: isSelected ? 'bg-blue-50 border-blue-400 text-blue-700' : 'border-slate-200 hover:border-blue-300',
      purple: isSelected ? 'bg-purple-50 border-purple-400 text-purple-700' : 'border-slate-200 hover:border-purple-300',
      cyan: isSelected ? 'bg-cyan-50 border-cyan-400 text-cyan-700' : 'border-slate-200 hover:border-cyan-300',
      indigo: isSelected ? 'bg-indigo-50 border-indigo-400 text-indigo-700' : 'border-slate-200 hover:border-indigo-300',
      teal: isSelected ? 'bg-teal-50 border-teal-400 text-teal-700' : 'border-slate-200 hover:border-teal-300',
      rose: isSelected ? 'bg-rose-50 border-rose-400 text-rose-700' : 'border-slate-200 hover:border-rose-300',
      amber: isSelected ? 'bg-amber-50 border-amber-400 text-amber-700' : 'border-slate-200 hover:border-amber-300',
      orange: isSelected ? 'bg-orange-50 border-orange-400 text-orange-700' : 'border-slate-200 hover:border-orange-300',
      red: isSelected ? 'bg-red-50 border-red-400 text-red-700' : 'border-slate-200 hover:border-red-300',
      slate: isSelected ? 'bg-slate-100 border-slate-400 text-slate-700' : 'border-slate-200 hover:border-slate-300',
      gray: isSelected ? 'bg-gray-100 border-gray-400 text-gray-700' : 'border-slate-200 hover:border-gray-300',
    };
    return colors[color] || colors.slate;
  };


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 1: Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - BASIC INFORMATION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabBasic = () => (
    <div className="space-y-6">
      {/* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙŠØ§Ø³Ø© */}
      <div className="grid grid-cols-2 gap-6">
        <div>
          {renderFieldLabel('Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙŠØ§Ø³Ø©', 'Policy Title (Arabic)', true)}
          <input
            type="text"
            value={data?.title || ''}
            onChange={(e) => handleFieldChange('title', e.target.value)}
            disabled={isReadOnly}
            className={`w-full px-4 py-3 border-2 rounded-xl focus:outline-none focus:border-emerald-500 text-lg ${validationErrors.title ? 'border-red-400 bg-red-50' : 'border-slate-200'
              }`}
            placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©..."
          />
          {validationErrors.title && <p className="text-red-500 text-sm mt-1">{validationErrors.title}</p>}
        </div>
        <div>
          {renderFieldLabel('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', 'Policy Title (English)')}
          <input
            type="text"
            value={data?.titleEn || ''}
            onChange={(e) => handleFieldChange('titleEn', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 text-lg"
            placeholder="Enter policy title in English..."
            dir="ltr"
          />
        </div>
      </div>

      {/* Ø§Ù„ÙˆØµÙ */}
      <div>
        {renderFieldLabel('Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ', 'Executive Summary', true, 'Ø­Ø¯ Ø£Ø¯Ù†Ù‰ 20 Ø­Ø±Ù')}
        <textarea
          value={data?.summary || ''}
          onChange={(e) => handleFieldChange('summary', e.target.value)}
          disabled={isReadOnly}
          rows={4}
          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 resize-none"
          placeholder="Ù…Ù„Ø®Øµ Ù…ÙˆØ¬Ø² Ù„Ù„Ø³ÙŠØ§Ø³Ø© ÙŠÙˆØ¶Ø­ Ø§Ù„ØºØ±Ø¶ ÙˆØ§Ù„Ù†Ø·Ø§Ù‚..."
        />
        <div className="flex justify-between mt-1">
          <span className="text-xs text-slate-400">{data?.summary?.length || 0} Ø­Ø±Ù</span>
          <span className={`text-xs ${(data?.summary?.length || 0) >= 20 ? 'text-emerald-600' : 'text-amber-600'}`}>
            {(data?.summary?.length || 0) >= 20 ? 'âœ“ Ù…ÙƒØªÙ…Ù„' : `${20 - (data?.summary?.length || 0)} Ø­Ø±Ù Ù…ØªØ¨Ù‚ÙŠ`}
          </span>
        </div>
      </div>

      {/* Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© */}
      <div>
        {renderFieldLabel('Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©', 'Document Type', true)}
        <div className="grid grid-cols-6 gap-3">
          {DOCUMENT_TYPES.map(type => {
            const isSelected = data?.type === type.code;
            return (
              <button
                key={type.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => handleFieldChange('type', type.code)}
                className={`p-4 rounded-xl border-2 text-center transition-all group relative ${isSelected
                    ? `${getColorClasses(type.color, true)} shadow-md`
                    : 'bg-white border-slate-200 hover:border-slate-300 hover:shadow'
                  }`}>
                <span className="text-3xl block mb-2">{type.icon}</span>
                <span className={`text-sm font-bold block ${isSelected ? '' : 'text-slate-700'}`}>{type.nameAr}</span>
                <span className="text-xs text-slate-400 block">L{type.level}</span>
                {/* Tooltip */}
                <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-slate-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none z-10">
                  {type.description}
                </div>
              </button>
            );
          })}
        </div>
      </div>

      {/* Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø£Ù…Ù†ÙŠ ÙˆÙ…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø«Ø± */}
      <div className="grid grid-cols-2 gap-6">
        <div>
          {renderFieldLabel('Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø£Ù…Ù†ÙŠ', 'Security Classification', true)}
          <div className="grid grid-cols-5 gap-2">
            {CLASSIFICATION_LEVELS.map(level => {
              const isSelected = data?.classification === level.code;
              return (
                <button
                  key={level.code}
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('classification', level.code)}
                  className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? `${getColorClasses(level.color, true)} shadow-md` : 'bg-white border-slate-200 hover:border-slate-300'
                    }`}>
                  <span className="text-xl block mb-1">{level.icon}</span>
                  <span className={`text-xs font-bold block ${isSelected ? '' : 'text-slate-600'}`}>{level.nameAr}</span>
                </button>
              );
            })}
          </div>
        </div>

        <div>
          {renderFieldLabel('Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø«Ø±', 'Impact Level')}
          <div className="grid grid-cols-4 gap-3">
            {CRITICALITY_LEVELS.map(level => {
              const isSelected = data?.impactLevel === level.code;
              return (
                <button
                  key={level.code}
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('impactLevel', level.code)}
                  className={`p-4 rounded-xl border-2 text-center transition-all ${isSelected ? `${getColorClasses(level.color, true)} shadow-md` : 'bg-white border-slate-200 hover:border-slate-300'
                    }`}>
                  <div className={`text-2xl font-black mb-1 ${isSelected ? '' : 'text-slate-400'}`}>{level.score}</div>
                  <div className={`text-sm font-bold ${isSelected ? '' : 'text-slate-600'}`}>{level.nameAr}</div>
                  <div className="text-xs text-slate-400 mt-1">SLA: {level.sla}d</div>
                </button>
              );
            })}
          </div>
        </div>
      </div>

      {/* Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù… */}
      <div className="grid grid-cols-2 gap-6">
        <div>
          {renderFieldLabel('Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ', 'Functional Category')}
          <select
            value={data?.category || 'Compliance'}
            onChange={(e) => handleFieldChange('category', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 bg-white">
            <option value="Compliance">ğŸ¯ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ø­ÙˆÙƒÙ…Ø©</option>
            <option value="IT">ğŸ’» ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
            <option value="Security">ğŸ” Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ</option>
            <option value="HR">ğŸ‘¥ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
            <option value="Finance">ğŸ’° Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
            <option value="Operations">âš™ï¸ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
            <option value="Risk">âš ï¸ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±</option>
            <option value="Legal">âš–ï¸ Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</option>
            <option value="Privacy">ğŸ”’ Ø§Ù„Ø®ØµÙˆØµÙŠØ©</option>
            <option value="BCM">ğŸ”„ Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</option>
          </select>
        </div>
        <div>
          {renderFieldLabel('Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…', 'Parent Policy', false, 'Ù„Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù‡Ø±Ù…ÙŠ')}
          <select
            value={data?.parentPolicyId || ''}
            onChange={(e) => handleFieldChange('parentPolicyId', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 bg-white">
            <option value="">-- Ø¨Ø¯ÙˆÙ† Ø³ÙŠØ§Ø³Ø© Ø£Ù… (ÙˆØ«ÙŠÙ‚Ø© Ù…Ø³ØªÙ‚Ù„Ø©) --</option>
            <option value="POL-001">ğŸ“œ POL-001 - Ø³ÙŠØ§Ø³Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
            <option value="POL-002">ğŸ“œ POL-002 - Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</option>
            <option value="POL-003">ğŸ“œ POL-003 - Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</option>
          </select>
        </div>
      </div>

      {/* Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© */}
      <div>
        {renderFieldLabel('Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©', 'Tags / Keywords', false, 'Ø§ÙØµÙ„ Ø¨ÙØ§ØµÙ„Ø©')}
        <input
          type="text"
          value={data?.tags?.join(', ') || ''}
          onChange={(e) => handleFieldChange('tags', e.target.value.split(',').map(t => t.trim()).filter(Boolean))}
          disabled={isReadOnly}
          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500"
          placeholder="Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ, Ø­ÙˆÙƒÙ…Ø©, Ø®ØµÙˆØµÙŠØ©, SAMA, NCA..."
        />
        {data?.tags?.length > 0 && (
          <div className="flex flex-wrap gap-2 mt-2">
            {data.tags.map((tag, idx) => (
              <span key={idx} className="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium">
                #{tag}
              </span>
            ))}
          </div>
        )}
      </div>
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 2: Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ - REGULATORY REFERENCE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabRegulatory = () => {
    const selectedAuth = REGULATORY_AUTHORITIES_DATA.find(a => a.id === data?.primaryAuthority);

    return (
      <div className="space-y-6">
        {/* Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */}
        <div>
          {renderFieldLabel('Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'Primary Regulatory Authority', true)}
          <div className="grid grid-cols-4 gap-3">
            {REGULATORY_AUTHORITIES_DATA.map(auth => {
              const isSelected = data?.primaryAuthority === auth.id;
              return (
                <button
                  key={auth.id}
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => {
                    handleFieldChange('primaryAuthority', auth.id);
                    handleFieldChange('primaryFramework', '');
                  }}
                  className={`p-4 rounded-xl border-2 text-center transition-all ${isSelected ? `${getColorClasses(auth.color, true)} shadow-lg` : 'bg-white border-slate-200 hover:border-slate-300 hover:shadow'
                    }`}>
                  <span className="text-3xl block mb-2">{auth.icon}</span>
                  <span className={`text-sm font-bold block ${isSelected ? '' : 'text-slate-700'}`}>{auth.code}</span>
                  <span className="text-xs text-slate-500 block mt-1">{auth.sector}</span>
                </button>
              );
            })}
          </div>
        </div>

        {/* Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ */}
        {selectedAuth && availableFrameworks.length > 0 && (
          <div>
            {renderFieldLabel('Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', 'Regulatory Framework', true)}
            <div className="grid grid-cols-2 gap-3">
              {availableFrameworks.map(fw => {
                const isSelected = data?.primaryFramework === fw.code;
                return (
                  <button
                    key={fw.code}
                    type="button"
                    disabled={isReadOnly}
                    onClick={() => handleFieldChange('primaryFramework', fw.code)}
                    className={`p-4 rounded-xl border-2 text-right transition-all ${isSelected ? `${getColorClasses(selectedAuth.color, true)} shadow-md` : 'bg-white border-slate-200 hover:border-slate-300'
                      }`}>
                    <div className="flex items-center justify-between mb-2">
                      <span className={`px-2 py-1 rounded text-xs font-bold ${isSelected ? 'bg-white/50' : 'bg-slate-100 text-slate-600'
                        }`}>{fw.code}</span>
                      <span className="text-xs text-slate-400">v{fw.version} ({fw.year})</span>
                    </div>
                    <p className={`font-bold ${isSelected ? '' : 'text-slate-700'}`}>{fw.nameAr}</p>
                    <div className="flex items-center gap-4 mt-2 text-xs text-slate-500">
                      <span>ğŸ“Š {fw.controls} Ø¶Ø§Ø¨Ø·</span>
                      <span>ğŸ“ {fw.domains} Ù†Ø·Ø§Ù‚</span>
                    </div>
                  </button>
                );
              })}
            </div>
          </div>
        )}

        {/* Ø¬Ù‡Ø§Øª Ø±Ù‚Ø§Ø¨ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ© */}
        <div>
          {renderFieldLabel('Ø¬Ù‡Ø§Øª Ø±Ù‚Ø§Ø¨ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ©', 'Additional Authorities', false, 'Ø§Ø®ØªØ± Ù…ØªØ¹Ø¯Ø¯')}
          <div className="flex flex-wrap gap-2">
            {REGULATORY_AUTHORITIES_DATA.filter(a => a.id !== data?.primaryAuthority).map(auth => {
              const isSelected = data?.additionalAuthorities?.includes(auth.id);
              return (
                <button
                  key={auth.id}
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => {
                    const current = data?.additionalAuthorities || [];
                    handleFieldChange('additionalAuthorities',
                      isSelected ? current.filter(id => id !== auth.id) : [...current, auth.id]
                    );
                  }}
                  className={`px-4 py-2 rounded-xl border-2 transition-all flex items-center gap-2 ${isSelected ? `${getColorClasses(auth.color, true)}` : 'bg-white border-slate-200 hover:border-slate-300'
                    }`}>
                  <span>{auth.icon}</span>
                  <span className={`text-sm font-bold ${isSelected ? '' : 'text-slate-600'}`}>{auth.code}</span>
                </button>
              );
            })}
          </div>
        </div>

        {/* Cross-Framework Mapping */}
        <div>
          {renderFieldLabel('Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ø£Ø·Ø± Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©', 'International Framework Mapping')}
          <div className="flex flex-wrap gap-2">
            {INTERNATIONAL_FRAMEWORKS.map(fw => {
              const isSelected = data?.internationalFrameworks?.includes(fw.code);
              return (
                <button
                  key={fw.code}
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => {
                    const current = data?.internationalFrameworks || [];
                    handleFieldChange('internationalFrameworks',
                      isSelected ? current.filter(c => c !== fw.code) : [...current, fw.code]
                    );
                  }}
                  className={`px-4 py-2 rounded-xl border-2 transition-all flex items-center gap-2 ${isSelected ? 'bg-indigo-50 border-indigo-400 text-indigo-700' : 'bg-white border-slate-200 hover:border-slate-300'
                    }`}>
                  <span>{fw.icon}</span>
                  <span className={`text-sm font-bold ${isSelected ? '' : 'text-slate-600'}`}>{fw.code}</span>
                </button>
              );
            })}
          </div>
        </div>

        {/* Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ø¯Ø© */}
        <div className="grid grid-cols-2 gap-6">
          <div>
            {renderFieldLabel('Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ø¯Ø© / Ø§Ù„Ø¨Ù†Ø¯', 'Article Reference')}
            <input
              type="text"
              value={data?.articleNumber || ''}
              onChange={(e) => handleFieldChange('articleNumber', e.target.value)}
              disabled={isReadOnly}
              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500"
              placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø§Ø¯Ø© 5-2-1 Ø£Ùˆ Control 3.4.2"
            />
          </div>
          <div>
            {renderFieldLabel('Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ', 'Official Reference URL')}
            <input
              type="url"
              value={data?.referenceUrl || ''}
              onChange={(e) => handleFieldChange('referenceUrl', e.target.value)}
              disabled={isReadOnly}
              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-blue-500"
              placeholder="https://..."
              dir="ltr"
            />
          </div>
        </div>

        {/* Ù…Ù„Ø®Øµ */}
        {selectedAuth && data?.primaryFramework && (
          <div className={`p-5 rounded-2xl border-2 ${getColorClasses(selectedAuth.color, true)}`}>
            <div className="flex items-center gap-4">
              <span className="text-5xl">{selectedAuth.icon}</span>
              <div className="flex-1">
                <p className="font-bold text-lg">{selectedAuth.nameAr}</p>
                <p className="text-sm opacity-80">{selectedAuth.nameEn}</p>
                <div className="mt-2 flex items-center gap-3">
                  <span className="px-3 py-1 bg-white/50 rounded-lg text-sm font-bold">{data.primaryFramework}</span>
                  {data?.additionalAuthorities?.length > 0 && (
                    <span className="text-sm">+ {data.additionalAuthorities.length} Ø¬Ù‡Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</span>
                  )}
                  {data?.internationalFrameworks?.length > 0 && (
                    <span className="text-sm">| {data.internationalFrameworks.length} Ø£Ø·Ø± Ø¯ÙˆÙ„ÙŠØ©</span>
                  )}
                </div>
              </div>
            </div>
          </div>
        )}
      </div>
    );
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 3: Ø§Ù„Ù†Ø·Ø§Ù‚ ÙˆØ§Ù„Ø£Ù‡Ø¯Ø§Ù - SCOPE & OBJECTIVES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabScope = () => (
    <div className="space-y-6">
      {/* Ù†ÙˆØ¹ Ø§Ù„Ù†Ø·Ø§Ù‚ */}
      <div>
        {renderFieldLabel('Ù†ÙˆØ¹ Ø§Ù„Ù†Ø·Ø§Ù‚', 'Scope Type', true)}
        <div className="grid grid-cols-3 gap-4">
          {[
            { code: 'Enterprise', nameAr: 'Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©', nameEn: 'Enterprise-wide', icon: Building2, description: 'ØªØ·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª ÙˆØ§Ù„ÙØ±ÙˆØ¹' },
            { code: 'BusinessUnit', nameAr: 'ÙˆØ­Ø¯Ø© Ø£Ø¹Ù…Ø§Ù„ Ù…Ø­Ø¯Ø¯Ø©', nameEn: 'Business Unit', icon: Briefcase, description: 'ØªØ·Ø¨Ù‚ Ø¹Ù„Ù‰ Ù‚Ø·Ø§Ø¹ Ø£Ùˆ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø­Ø¯Ø¯Ø©' },
            { code: 'FunctionSpecific', nameAr: 'ÙˆØ¸ÙŠÙØ© Ù…Ø­Ø¯Ø¯Ø©', nameEn: 'Function Specific', icon: Target, description: 'ØªØ·Ø¨Ù‚ Ø¹Ù„Ù‰ ÙˆØ¸ÙŠÙØ© Ø£Ùˆ Ù†Ø´Ø§Ø· Ù…Ø¹ÙŠÙ†' },
          ].map(scope => {
            const isSelected = data?.scopeType === scope.code;
            const Icon = scope.icon;
            return (
              <button
                key={scope.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => handleFieldChange('scopeType', scope.code)}
                className={`p-5 rounded-xl border-2 transition-all text-right ${isSelected ? 'bg-cyan-50 border-cyan-400 shadow-md' : 'bg-white border-slate-200 hover:border-slate-300'
                  }`}>
                <Icon className={`w-8 h-8 mb-3 ${isSelected ? 'text-cyan-600' : 'text-slate-400'}`} />
                <h4 className={`font-bold ${isSelected ? 'text-cyan-700' : 'text-slate-700'}`}>{scope.nameAr}</h4>
                <p className="text-xs text-slate-500 mt-1">{scope.description}</p>
              </button>
            );
          })}
        </div>
      </div>

      {/* Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ© */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ©', 'Applicable Departments', true, 'Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„ØªÙŠ ØªØ·Ø¨Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø³ÙŠØ§Ø³Ø©')}
        <div className="flex flex-wrap gap-2">
          {DEPARTMENTS.map(dept => {
            const isSelected = data?.applicableDepartments?.includes(dept.code);
            return (
              <button
                key={dept.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => {
                  const current = data?.applicableDepartments || [];
                  if (dept.code === 'All') {
                    handleFieldChange('applicableDepartments', isSelected ? [] : ['All']);
                  } else {
                    const newDepts = isSelected
                      ? current.filter(d => d !== dept.code)
                      : [...current.filter(d => d !== 'All'), dept.code];
                    handleFieldChange('applicableDepartments', newDepts);
                  }
                }}
                className={`px-4 py-2 rounded-xl border-2 transition-all ${isSelected ? `${getColorClasses(dept.color, true)} font-bold` : 'bg-white border-slate-200 text-slate-600 hover:border-slate-300'
                  }`}>
                {dept.nameAr}
              </button>
            );
          })}
        </div>
      </div>

      {/* ÙˆØµÙ Ø§Ù„Ù†Ø·Ø§Ù‚ */}
      <div>
        {renderFieldLabel('ÙˆØµÙ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ', 'Detailed Scope Description')}
        <textarea
          value={data?.scopeDescription || ''}
          onChange={(e) => handleFieldChange('scopeDescription', e.target.value)}
          disabled={isReadOnly}
          rows={3}
          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-cyan-500 resize-none"
          placeholder="ØªÙ†Ø·Ø¨Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙˆØ§Ù„Ù…ØªØ¹Ø§Ù‚Ø¯ÙŠÙ† Ø§Ù„Ø°ÙŠÙ†..."
        />
      </div>

      {/* Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©', 'Strategic Objectives')}
        <div className="space-y-2">
          {(data?.objectives || []).map((obj, idx) => (
            <div key={idx} className="flex items-center gap-2">
              <span className="w-8 h-8 rounded-lg bg-cyan-100 text-cyan-700 flex items-center justify-center font-bold text-sm">{idx + 1}</span>
              <input
                type="text"
                value={obj}
                onChange={(e) => {
                  const newObjs = [...(data?.objectives || [])];
                  newObjs[idx] = e.target.value;
                  handleFieldChange('objectives', newObjs);
                }}
                disabled={isReadOnly}
                className="flex-1 px-4 py-2 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-cyan-500"
                placeholder="Ù‡Ø¯Ù..."
              />
              {!isReadOnly && (
                <button type="button" onClick={() => handleFieldChange('objectives', data.objectives.filter((_, i) => i !== idx))}
                  className="p-2 text-red-500 hover:bg-red-50 rounded-lg">
                  <Trash2 className="w-5 h-5" />
                </button>
              )}
            </div>
          ))}
          {!isReadOnly && (
            <button type="button" onClick={() => handleFieldChange('objectives', [...(data?.objectives || []), ''])}
              className="flex items-center gap-2 px-4 py-2 text-cyan-600 hover:bg-cyan-50 rounded-xl font-medium">
              <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù
            </button>
          )}
        </div>
      </div>

      {/* Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ù…Ù† Ø§Ù„Ù†Ø·Ø§Ù‚ */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ù…Ù† Ø§Ù„Ù†Ø·Ø§Ù‚', 'Scope Exclusions')}
        <textarea
          value={data?.scopeExclusions || ''}
          onChange={(e) => handleFieldChange('scopeExclusions', e.target.value)}
          disabled={isReadOnly}
          rows={2}
          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-cyan-500 resize-none"
          placeholder="Ù„Ø§ ØªØ·Ø¨Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¹Ù„Ù‰..."
        />
      </div>
    </div>
  );


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 4: Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª - ACCOUNTABILITY & RACI
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabAccountability = () => (
    <div className="space-y-6">
      {/* SoD Warning */}
      {!sodValidation.isValid && (
        <div className="p-4 bg-red-50 border-2 border-red-200 rounded-xl">
          <div className="flex items-center gap-3">
            <AlertTriangle className="w-6 h-6 text-red-500 flex-shrink-0" />
            <div>
              <p className="font-bold text-red-700">âš ï¸ ØªØ­Ø°ÙŠØ±: Ø§Ù†ØªÙ‡Ø§Ùƒ ÙØµÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Segregation of Duties)</p>
              <ul className="text-sm text-red-600 mt-1 space-y-1">
                {sodValidation.violations.map((v, i) => (
                  <li key={i} className="flex items-center gap-2">
                    <span className={`w-2 h-2 rounded-full ${v.severity === 'error' ? 'bg-red-500' : 'bg-amber-500'}`}></span>
                    {v.msg}
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </div>
      )}

      {/* Ø§Ù„Ù…Ø§Ù„Ùƒ ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ ÙˆØ§Ù„Ù…Ø¹ØªÙ…Ø¯ */}
      <div className="grid grid-cols-3 gap-6">
        <div>
          {renderFieldLabel('Ø§Ù„Ù…Ø§Ù„Ùƒ (Owner)', 'Policy Owner', true)}
          <select
            value={data?.ownerId || ''}
            onChange={(e) => handleFieldChange('ownerId', parseInt(e.target.value) || null)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-purple-500 bg-white">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ù„Ùƒ...</option>
            {USERS?.map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
          </select>
          <p className="text-xs text-slate-500 mt-1">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† ØµÙŠØ§ØºØ© ÙˆØµÙŠØ§Ù†Ø© Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
        </div>

        <div>
          {renderFieldLabel('Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ (Reviewer)', 'Reviewer', true)}
          <select
            value={data?.reviewerId || ''}
            onChange={(e) => handleFieldChange('reviewerId', parseInt(e.target.value) || null)}
            disabled={isReadOnly}
            className={`w-full px-4 py-3 border-2 rounded-xl focus:outline-none bg-white ${data?.ownerId && data?.reviewerId && data.ownerId === data.reviewerId
                ? 'border-red-400 bg-red-50' : 'border-slate-200 focus:border-purple-500'
              }`}>
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹...</option>
            {USERS?.filter(u => u.id !== data?.ownerId).map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
          </select>
          <p className="text-xs text-slate-500 mt-1">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰</p>
        </div>

        <div>
          {renderFieldLabel('Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ (Approver)', 'Approver')}
          <select
            value={data?.approverId || ''}
            onChange={(e) => handleFieldChange('approverId', parseInt(e.target.value) || null)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-purple-500 bg-white">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯...</option>
            {USERS?.filter(u => u.id !== data?.ownerId && u.id !== data?.reviewerId).map(u => <option key={u.id} value={u.id}>{u.name} - {u.department}</option>)}
          </select>
          <p className="text-xs text-slate-500 mt-1">ØµØ§Ø­Ø¨ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</p>
        </div>
      </div>

      {/* RACI Matrix - Interactive & Dynamic */}
      <div className="p-5 bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl border-2 border-purple-200">
        <div className="flex items-center justify-between mb-4">
          <h4 className="font-bold text-purple-800 flex items-center gap-2">
            <Users className="w-5 h-5" /> Ù…ØµÙÙˆÙØ© RACI Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
          </h4>
          <span className="text-xs text-purple-600 bg-purple-100 px-3 py-1 rounded-full">
            Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠ Ø®Ù„ÙŠØ© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
          </span>
        </div>
        <div className="overflow-x-auto">
          <table className="w-full text-sm">
            <thead>
              <tr className="border-b-2 border-purple-200">
                <th className="text-right py-3 px-4 text-purple-700 font-bold w-48">Ø§Ù„Ù†Ø´Ø§Ø· / Ø§Ù„Ù…Ø±Ø­Ù„Ø©</th>
                <th className="text-center py-3 px-2">
                  <div className="p-2 bg-blue-100 rounded-lg">
                    <span className="font-black text-blue-700 text-lg">R</span>
                    <p className="text-xs text-blue-600">Responsible</p>
                    <p className="text-xs text-blue-500">Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
                  </div>
                </th>
                <th className="text-center py-3 px-2">
                  <div className="p-2 bg-red-100 rounded-lg">
                    <span className="font-black text-red-700 text-lg">A</span>
                    <p className="text-xs text-red-600">Accountable</p>
                    <p className="text-xs text-red-500">ØµØ§Ø­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø±</p>
                  </div>
                </th>
                <th className="text-center py-3 px-2">
                  <div className="p-2 bg-amber-100 rounded-lg">
                    <span className="font-black text-amber-700 text-lg">C</span>
                    <p className="text-xs text-amber-600">Consulted</p>
                    <p className="text-xs text-amber-500">Ù…Ø³ØªØ´Ø§Ø±</p>
                  </div>
                </th>
                <th className="text-center py-3 px-2">
                  <div className="p-2 bg-emerald-100 rounded-lg">
                    <span className="font-black text-emerald-700 text-lg">I</span>
                    <p className="text-xs text-emerald-600">Informed</p>
                    <p className="text-xs text-emerald-500">Ù…ÙØ¨Ù„ÙÙ‘Øº</p>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              {[
                { id: 'drafting', activity: 'ØµÙŠØ§ØºØ© Ø§Ù„Ø³ÙŠØ§Ø³Ø©', activityEn: 'Policy Drafting' },
                { id: 'technicalReview', activity: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙÙ†ÙŠØ©', activityEn: 'Technical Review' },
                { id: 'approval', activity: 'Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ', activityEn: 'Final Approval' },
                { id: 'publishing', activity: 'Ø§Ù„Ù†Ø´Ø± ÙˆØ§Ù„ØªÙˆØ²ÙŠØ¹', activityEn: 'Publishing' },
                { id: 'periodicReview', activity: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©', activityEn: 'Periodic Review' },
                { id: 'exceptionMgmt', activity: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', activityEn: 'Exception Management' },
                { id: 'update', activity: 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙŠØ§Ø³Ø©', activityEn: 'Policy Update' },
                { id: 'training', activity: 'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªÙˆØ¹ÙŠØ©', activityEn: 'Training & Awareness' },
              ].map((row) => {
                const raciData = data?.raciMatrix?.[row.id] || {};
                const ownerName = USERS?.find(u => u.id === data?.ownerId)?.name?.split(' ')[0] || 'Ø§Ù„Ù…Ø§Ù„Ùƒ';
                const reviewerName = USERS?.find(u => u.id === data?.reviewerId)?.name?.split(' ')[0] || 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹';
                const approverName = USERS?.find(u => u.id === data?.approverId)?.name?.split(' ')[0] || 'Ø§Ù„Ù…Ø¹ØªÙ…Ø¯';

                const roleOptions = [
                  { value: 'owner', label: ownerName, color: 'purple' },
                  { value: 'reviewer', label: reviewerName, color: 'blue' },
                  { value: 'approver', label: approverName, color: 'indigo' },
                  { value: 'compliance', label: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', color: 'teal' },
                  { value: 'legal', label: 'Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©', color: 'slate' },
                  { value: 'risk', label: 'Ø§Ù„Ù…Ø®Ø§Ø·Ø±', color: 'orange' },
                  { value: 'audit', label: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', color: 'rose' },
                  { value: 'it', label: 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', color: 'cyan' },
                  { value: 'hr', label: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', color: 'green' },
                  { value: 'all', label: 'Ø§Ù„Ø¬Ù…ÙŠØ¹', color: 'gray' },
                  { value: 'depts', label: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ©', color: 'amber' },
                  { value: 'experts', label: 'Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡', color: 'violet' },
                  { value: 'none', label: '-', color: 'slate' },
                ];

                const getDisplayValue = (role) => {
                  if (role === 'owner') return ownerName;
                  if (role === 'reviewer') return reviewerName;
                  if (role === 'approver') return approverName;
                  return roleOptions.find(r => r.value === role)?.label || '-';
                };

                const getCellColor = (role, type) => {
                  const baseColors = {
                    R: { bg: 'bg-blue-50', hover: 'hover:bg-blue-100', text: 'text-blue-700', border: 'border-blue-200' },
                    A: { bg: 'bg-red-50', hover: 'hover:bg-red-100', text: 'text-red-700', border: 'border-red-200' },
                    C: { bg: 'bg-amber-50', hover: 'hover:bg-amber-100', text: 'text-amber-700', border: 'border-amber-200' },
                    I: { bg: 'bg-emerald-50', hover: 'hover:bg-emerald-100', text: 'text-emerald-700', border: 'border-emerald-200' },
                  };
                  return baseColors[type] || baseColors.R;
                };

                return (
                  <tr key={row.id} className="border-b border-purple-100">
                    <td className="py-2 px-4">
                      <div className="font-medium text-slate-700">{row.activity}</div>
                      <div className="text-xs text-slate-400">{row.activityEn}</div>
                    </td>
                    {['R', 'A', 'C', 'I'].map((type) => {
                      const cellColors = getCellColor(null, type);
                      const currentValue = raciData[type] || (
                        type === 'R' ? (row.id === 'drafting' ? 'owner' : row.id === 'technicalReview' ? 'reviewer' : row.id === 'approval' ? 'approver' : 'owner') :
                          type === 'A' ? (row.id === 'drafting' ? 'approver' : row.id === 'approval' ? 'approver' : 'owner') :
                            type === 'C' ? (row.id === 'drafting' ? 'reviewer' : row.id === 'approval' ? 'legal' : 'experts') :
                              (row.id === 'publishing' ? 'all' : 'depts')
                      );

                      return (
                        <td key={type} className={`py-2 px-1 ${cellColors.bg}`}>
                          <select
                            value={currentValue}
                            onChange={(e) => {
                              const newMatrix = { ...(data?.raciMatrix || {}) };
                              if (!newMatrix[row.id]) newMatrix[row.id] = {};
                              newMatrix[row.id][type] = e.target.value;
                              handleFieldChange('raciMatrix', newMatrix);
                            }}
                            disabled={isReadOnly}
                            className={`w-full px-2 py-2 text-xs font-bold rounded-lg border-2 ${cellColors.border} ${cellColors.bg} ${cellColors.text} ${cellColors.hover} focus:outline-none focus:ring-2 focus:ring-purple-300 cursor-pointer transition-all text-center`}
                          >
                            {roleOptions.map(opt => (
                              <option key={opt.value} value={opt.value}>{opt.label}</option>
                            ))}
                          </select>
                        </td>
                      );
                    })}
                  </tr>
                );
              })}
            </tbody>
          </table>
        </div>

        {/* RACI Legend */}
        <div className="mt-4 p-3 bg-white/50 rounded-xl">
          <div className="grid grid-cols-4 gap-2 text-xs">
            <div className="flex items-center gap-2">
              <span className="w-6 h-6 rounded bg-blue-500 text-white flex items-center justify-center font-bold">R</span>
              <span className="text-slate-600">Ù…Ù† ÙŠÙ‚ÙˆÙ… Ø¨Ø§Ù„Ø¹Ù…Ù„</span>
            </div>
            <div className="flex items-center gap-2">
              <span className="w-6 h-6 rounded bg-red-500 text-white flex items-center justify-center font-bold">A</span>
              <span className="text-slate-600">Ù…Ù† ÙŠØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</span>
            </div>
            <div className="flex items-center gap-2">
              <span className="w-6 h-6 rounded bg-amber-500 text-white flex items-center justify-center font-bold">C</span>
              <span className="text-slate-600">Ù…Ù† ÙŠÙØ³ØªØ´Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ù‚Ø±Ø§Ø±</span>
            </div>
            <div className="flex items-center gap-2">
              <span className="w-6 h-6 rounded bg-emerald-500 text-white flex items-center justify-center font-bold">I</span>
              <span className="text-slate-600">Ù…Ù† ÙŠÙØ¨Ù„Ù‘Øº Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Ø±Ø§Ø±</span>
            </div>
          </div>
        </div>
      </div>

      {/* Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØµØ¹ÙŠØ¯ */}
      <div>
        {renderFieldLabel('Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØµØ¹ÙŠØ¯', 'Escalation Rules')}
        <div className="grid grid-cols-3 gap-4">
          {[
            { level: 1, title: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„', days: 3, role: 'Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±', color: 'emerald' },
            { level: 2, title: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ', days: 7, role: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', color: 'amber' },
            { level: 3, title: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø«', days: 14, role: 'Ù†Ø§Ø¦Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³', color: 'red' },
          ].map(esc => (
            <div key={esc.level} className={`p-4 rounded-xl border-2 ${getColorClasses(esc.color, false)}`}>
              <div className="flex items-center justify-between mb-2">
                <span className={`px-2 py-1 rounded text-xs font-bold bg-${esc.color}-100 text-${esc.color}-700`}>L{esc.level}</span>
                <span className="text-xs text-slate-500">Ø¨Ø¹Ø¯ {esc.days} Ø£ÙŠØ§Ù…</span>
              </div>
              <p className="font-bold text-slate-700">{esc.title}</p>
              <p className="text-sm text-slate-500">{esc.role}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 5: Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø· - REQUIREMENTS & CONTROLS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabRequirements = () => (
    <div className="space-y-6">
      {/* Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Linked Regulatory Obligations')}
        <div className="border-2 border-slate-200 rounded-xl overflow-hidden">
          <div className="p-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
            <span className="text-sm text-slate-600">
              {data?.linkedObligations?.length || 0} Ø§Ù„ØªØ²Ø§Ù… Ù…Ø±ØªØ¨Ø·
            </span>
            {!isReadOnly && (
              <button type="button" className="flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-lg text-sm font-bold hover:bg-amber-600">
                <Link2 className="w-4 h-4" />Ø±Ø¨Ø· Ø§Ù„ØªØ²Ø§Ù…Ø§Øª
              </button>
            )}
          </div>
          {(data?.linkedObligations?.length || 0) === 0 ? (
            <div className="p-8 text-center">
              <Link2 className="w-12 h-12 mx-auto text-slate-300 mb-3" />
              <p className="text-slate-500">Ù„Ù… ÙŠØªÙ… Ø±Ø¨Ø· Ø£ÙŠ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø¹Ø¯</p>
              <p className="text-xs text-slate-400 mt-1">ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
            </div>
          ) : (
            <div className="divide-y divide-slate-100">
              {/* Linked items would be rendered here */}
            </div>
          )}
        </div>
      </div>

      {/* Ø±Ø¨Ø· Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Linked Controls')}
        <div className="border-2 border-slate-200 rounded-xl overflow-hidden">
          <div className="p-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
            <span className="text-sm text-slate-600">
              {data?.linkedControls?.length || 0} Ø¶Ø§Ø¨Ø· Ù…Ø±ØªØ¨Ø·
            </span>
            {!isReadOnly && (
              <button type="button" className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg text-sm font-bold hover:bg-purple-600">
                <Shield className="w-4 h-4" />Ø±Ø¨Ø· Ø¶ÙˆØ§Ø¨Ø·
              </button>
            )}
          </div>
          {(data?.linkedControls?.length || 0) === 0 ? (
            <div className="p-8 text-center">
              <Shield className="w-12 h-12 mx-auto text-slate-300 mb-3" />
              <p className="text-slate-500">Ù„Ù… ÙŠØªÙ… Ø±Ø¨Ø· Ø£ÙŠ Ø¶ÙˆØ§Ø¨Ø· Ø¨Ø¹Ø¯</p>
            </div>
          ) : null}
        </div>
      </div>

      {/* Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© */}
      <div>
        {renderFieldLabel('Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'Required Evidence Types')}
        <div className="flex flex-wrap gap-2">
          {EVIDENCE_TYPES.map(type => {
            const isSelected = data?.requiredEvidenceTypes?.includes(type.code);
            const Icon = type.icon;
            return (
              <button
                key={type.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => {
                  const current = data?.requiredEvidenceTypes || [];
                  handleFieldChange('requiredEvidenceTypes',
                    isSelected ? current.filter(c => c !== type.code) : [...current, type.code]
                  );
                }}
                className={`px-4 py-2 rounded-xl border-2 transition-all flex items-center gap-2 ${isSelected ? 'bg-amber-50 border-amber-400 text-amber-700' : 'bg-white border-slate-200 hover:border-slate-300'
                  }`}>
                <Icon className="w-4 h-4" />
                <span className={`text-sm font-bold ${isSelected ? '' : 'text-slate-600'}`}>{type.nameAr}</span>
              </button>
            );
          })}
        </div>
      </div>

      {/* Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„ */}
      <div>
        {renderFieldLabel('Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‚Ø¨ÙˆÙ„', 'Acceptance Criteria')}
        <textarea
          value={data?.acceptanceCriteria || ''}
          onChange={(e) => handleFieldChange('acceptanceCriteria', e.target.value)}
          disabled={isReadOnly}
          rows={3}
          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-amber-500 resize-none"
          placeholder="Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ ØªØ­Ù‚ÙŠÙ‚Ù‡Ø§ Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„..."
        />
      </div>
    </div>
  );


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 6: Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„Ø¯ÙˆØ±ÙŠØ© - SCHEDULING & LIFECYCLE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabSchedule = () => (
    <div className="space-y-6">
      {/* Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */}
      <div className="grid grid-cols-3 gap-6">
        <div>
          {renderFieldLabel('ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†', 'Effective Date', true)}
          <input
            type="date"
            value={data?.effectiveDate || ''}
            onChange={(e) => handleFieldChange('effectiveDate', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500"
          />
        </div>
        <div>
          {renderFieldLabel('Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©', 'Next Review Date')}
          <input
            type="date"
            value={data?.nextReviewDate || ''}
            onChange={(e) => handleFieldChange('nextReviewDate', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500"
          />
        </div>
        <div>
          {renderFieldLabel('ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©', 'Sunset Date', false, 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ')}
          <input
            type="date"
            value={data?.sunsetDate || ''}
            onChange={(e) => handleFieldChange('sunsetDate', e.target.value)}
            disabled={isReadOnly}
            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500"
          />
        </div>
      </div>

      {/* Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© */}
      <div>
        {renderFieldLabel('Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', 'Review Frequency', true)}
        <div className="grid grid-cols-7 gap-2">
          {REVIEW_FREQUENCIES.map(freq => {
            const isSelected = data?.reviewFrequency === freq.code;
            return (
              <button
                key={freq.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => handleFieldChange('reviewFrequency', freq.code)}
                className={`p-3 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-indigo-50 border-indigo-400 shadow-md' : 'bg-white border-slate-200 hover:border-slate-300'
                  }`}>
                <span className="text-xl block mb-1">{freq.icon}</span>
                <div className={`text-xs font-bold ${isSelected ? 'text-indigo-700' : 'text-slate-700'}`}>{freq.nameAr}</div>
                {freq.days && <div className="text-xs text-slate-400 mt-1">{freq.days}d</div>}
              </button>
            );
          })}
        </div>
      </div>

      {/* Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© */}
      <div>
        {renderFieldLabel('Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©', 'Review Triggers')}
        <div className="flex flex-wrap gap-2">
          {REVIEW_TRIGGERS.map(trigger => {
            const isSelected = data?.reviewTriggers?.includes(trigger.code);
            return (
              <button
                key={trigger.code}
                type="button"
                disabled={isReadOnly}
                onClick={() => {
                  const current = data?.reviewTriggers || [];
                  handleFieldChange('reviewTriggers',
                    isSelected ? current.filter(c => c !== trigger.code) : [...current, trigger.code]
                  );
                }}
                className={`px-4 py-2 rounded-xl border-2 transition-all flex items-center gap-2 ${isSelected ? 'bg-indigo-50 border-indigo-400 text-indigo-700' : 'bg-white border-slate-200 hover:border-slate-300'
                  }`}>
                <span>{trigger.icon}</span>
                <span className={`text-sm font-bold ${isSelected ? '' : 'text-slate-600'}`}>{trigger.nameAr}</span>
              </button>
            );
          })}
        </div>
      </div>

      {/* Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª */}
      <div>
        {renderFieldLabel('Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©', 'Automatic Reminders', false, 'Ù‚Ø¨Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©')}
        <div className="flex flex-wrap gap-2">
          {[90, 60, 30, 14, 7, 3, 1].map(days => {
            const isSelected = data?.reminderDays?.includes(days);
            return (
              <button
                key={days}
                type="button"
                disabled={isReadOnly}
                onClick={() => {
                  const current = data?.reminderDays || [];
                  handleFieldChange('reminderDays',
                    isSelected ? current.filter(d => d !== days) : [...current, days].sort((a, b) => b - a)
                  );
                }}
                className={`px-4 py-2 rounded-xl border-2 transition-all ${isSelected ? 'bg-indigo-100 border-indigo-400 text-indigo-700 font-bold' : 'bg-white border-slate-200 text-slate-600'
                  }`}>
                {days} ÙŠÙˆÙ…
              </button>
            );
          })}
        </div>
      </div>

      {/* Lifecycle Timeline */}
      <div className="p-4 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border-2 border-indigo-200">
        <h4 className="font-bold text-indigo-800 mb-4">Ù…Ø±Ø§Ø­Ù„ Ø¯ÙˆØ±Ø© Ø§Ù„Ø­ÙŠØ§Ø©</h4>
        <div className="flex items-center justify-between">
          {LIFECYCLE_STATES.slice(0, 6).map((state, idx) => (
            <div key={state.code} className="flex items-center">
              <div className={`w-10 h-10 rounded-full flex items-center justify-center text-lg ${data?.status === state.code
                  ? `bg-${state.color}-500 text-white`
                  : 'bg-slate-200 text-slate-500'
                }`}>
                {state.icon}
              </div>
              {idx < 5 && <div className="w-8 h-0.5 bg-slate-200"></div>}
            </div>
          ))}
        </div>
        <div className="flex items-center justify-between mt-2">
          {LIFECYCLE_STATES.slice(0, 6).map(state => (
            <span key={state.code} className="text-xs text-slate-600">{state.nameAr}</span>
          ))}
        </div>
      </div>
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 7: Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨ - ATTESTATION & TRAINING
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabAttestation = () => (
    <div className="space-y-6">
      {/* Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ø¥Ù‚Ø±Ø§Ø± */}
      <div>
        {renderFieldLabel('Ù‡Ù„ ØªØªØ·Ù„Ø¨ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø¥Ù‚Ø±Ø§Ø±Ø§Ù‹ØŸ', 'Requires Attestation')}
        <div className="grid grid-cols-2 gap-4">
          <button
            type="button"
            disabled={isReadOnly}
            onClick={() => handleFieldChange('requiresAttestation', true)}
            className={`p-5 rounded-xl border-2 text-center transition-all ${data?.requiresAttestation === true ? 'bg-emerald-50 border-emerald-400 shadow-md' : 'bg-white border-slate-200'
              }`}>
            <CheckCircle2 className={`w-10 h-10 mx-auto mb-2 ${data?.requiresAttestation === true ? 'text-emerald-600' : 'text-slate-400'}`} />
            <span className={`font-bold ${data?.requiresAttestation === true ? 'text-emerald-700' : 'text-slate-600'}`}>Ù†Ø¹Ù…ØŒ ÙŠØªØ·Ù„Ø¨ Ø¥Ù‚Ø±Ø§Ø±</span>
            <p className="text-xs text-slate-500 mt-1">ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø¨Ù‚Ø±Ø§Ø¡Ø© ÙˆÙÙ‡Ù… Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
          </button>
          <button
            type="button"
            disabled={isReadOnly}
            onClick={() => handleFieldChange('requiresAttestation', false)}
            className={`p-5 rounded-xl border-2 text-center transition-all ${data?.requiresAttestation === false ? 'bg-slate-100 border-slate-400 shadow-md' : 'bg-white border-slate-200'
              }`}>
            <XCircle className={`w-10 h-10 mx-auto mb-2 ${data?.requiresAttestation === false ? 'text-slate-600' : 'text-slate-400'}`} />
            <span className={`font-bold ${data?.requiresAttestation === false ? 'text-slate-700' : 'text-slate-600'}`}>Ù„Ø§ØŒ Ù„Ù„Ù…Ø¹Ø±ÙØ© ÙÙ‚Ø·</span>
            <p className="text-xs text-slate-500 mt-1">Ø³ÙŠØ§Ø³Ø© Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ø¥Ù‚Ø±Ø§Ø± Ø±Ø³Ù…ÙŠ</p>
          </button>
        </div>
      </div>

      {data?.requiresAttestation && (
        <>
          {/* Ù†ÙˆØ¹ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± */}
          <div>
            {renderFieldLabel('Ù†ÙˆØ¹ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±', 'Attestation Type')}
            <div className="grid grid-cols-5 gap-3">
              {ATTESTATION_TYPES.map(type => {
                const isSelected = data?.attestationType === type.code;
                const Icon = type.icon;
                return (
                  <button
                    key={type.code}
                    type="button"
                    disabled={isReadOnly}
                    onClick={() => handleFieldChange('attestationType', type.code)}
                    className={`p-4 rounded-xl border-2 transition-all ${isSelected ? 'bg-rose-50 border-rose-400 shadow-md' : 'bg-white border-slate-200 hover:border-slate-300'
                      }`}>
                    <Icon className={`w-6 h-6 mx-auto mb-2 ${isSelected ? 'text-rose-600' : 'text-slate-400'}`} />
                    <span className={`text-xs font-bold block ${isSelected ? 'text-rose-700' : 'text-slate-600'}`}>{type.nameAr}</span>
                  </button>
                );
              })}
            </div>
          </div>

          {/* Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© */}
          <div>
            {renderFieldLabel('Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©', 'Target Audience')}
            <div className="flex flex-wrap gap-2">
              {[
                { code: 'AllEmployees', nameAr: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†' },
                { code: 'NewJoiners', nameAr: 'Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯' },
                { code: 'Managers', nameAr: 'Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡' },
                { code: 'ITStaff', nameAr: 'Ù…ÙˆØ¸ÙÙŠ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' },
                { code: 'FinanceStaff', nameAr: 'Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ù…Ø§Ù„ÙŠØ©' },
                { code: 'Contractors', nameAr: 'Ø§Ù„Ù…ØªØ¹Ø§Ù‚Ø¯ÙŠÙ†' },
                { code: 'ThirdParty', nameAr: 'Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©' },
              ].map(aud => {
                const isSelected = data?.targetAudience?.includes(aud.code);
                return (
                  <button
                    key={aud.code}
                    type="button"
                    disabled={isReadOnly}
                    onClick={() => {
                      const current = data?.targetAudience || [];
                      handleFieldChange('targetAudience',
                        isSelected ? current.filter(c => c !== aud.code) : [...current, aud.code]
                      );
                    }}
                    className={`px-4 py-2 rounded-xl border-2 transition-all ${isSelected ? 'bg-rose-50 border-rose-400 text-rose-700 font-bold' : 'bg-white border-slate-200 text-slate-600'
                      }`}>
                    {aud.nameAr}
                  </button>
                );
              })}
            </div>
          </div>

          {/* Ù…Ù‡Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± */}
          <div className="grid grid-cols-2 gap-6">
            <div>
              {renderFieldLabel('Ù…Ù‡Ù„Ø© Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±', 'Attestation Deadline (Days)')}
              <input
                type="number"
                value={data?.attestationDeadlineDays || 14}
                onChange={(e) => handleFieldChange('attestationDeadlineDays', parseInt(e.target.value))}
                disabled={isReadOnly}
                min={1}
                max={90}
                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-rose-500"
              />
            </div>
            <div>
              {renderFieldLabel('Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ø§Ø®ØªØ¨Ø§Ø±ØŸ', 'Requires Quiz')}
              <div className="flex gap-4">
                <button
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('requiresQuiz', true)}
                  className={`flex-1 p-3 rounded-xl border-2 text-center ${data?.requiresQuiz === true ? 'bg-rose-50 border-rose-400 text-rose-700 font-bold' : 'bg-white border-slate-200'
                    }`}>Ù†Ø¹Ù…</button>
                <button
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('requiresQuiz', false)}
                  className={`flex-1 p-3 rounded-xl border-2 text-center ${data?.requiresQuiz === false ? 'bg-slate-100 border-slate-400 text-slate-700 font-bold' : 'bg-white border-slate-200'
                    }`}>Ù„Ø§</button>
              </div>
            </div>
          </div>

          {/* Ù†Øµ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± */}
          <div>
            {renderFieldLabel('Ù†Øµ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±', 'Attestation Statement')}
            <textarea
              value={data?.attestationText || 'Ø£Ù‚Ø± Ø¨Ø£Ù†Ù†ÙŠ Ù‚Ø¯ Ù‚Ø±Ø£Øª ÙˆÙÙ‡Ù…Øª Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø³Ø©ØŒ ÙˆØ£ØªØ¹Ù‡Ø¯ Ø¨Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù‡Ø§ ÙˆØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ ÙÙŠ Ø¹Ù…Ù„ÙŠ.'}
              onChange={(e) => handleFieldChange('attestationText', e.target.value)}
              disabled={isReadOnly}
              rows={3}
              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-rose-500 resize-none"
            />
          </div>
        </>
      )}
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 8: Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª - EXCEPTIONS & WAIVERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabExceptions = () => (
    <div className="space-y-6">
      {/* Ù‡Ù„ ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª */}
      <div>
        {renderFieldLabel('Ù‡Ù„ ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§ØªØŸ', 'Allow Exceptions')}
        <div className="grid grid-cols-3 gap-4">
          <button
            type="button"
            disabled={isReadOnly}
            onClick={() => handleFieldChange('allowExceptions', 'Yes')}
            className={`p-5 rounded-xl border-2 text-center transition-all ${data?.allowExceptions === 'Yes' ? 'bg-emerald-50 border-emerald-400 shadow-md' : 'bg-white border-slate-200'
              }`}>
            <CheckCircle2 className={`w-8 h-8 mx-auto mb-2 ${data?.allowExceptions === 'Yes' ? 'text-emerald-600' : 'text-slate-400'}`} />
            <span className={`font-bold ${data?.allowExceptions === 'Yes' ? 'text-emerald-700' : 'text-slate-600'}`}>Ù†Ø¹Ù…</span>
            <p className="text-xs text-slate-500 mt-1">ÙŠÙ…ÙƒÙ† Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª</p>
          </button>
          <button
            type="button"
            disabled={isReadOnly}
            onClick={() => handleFieldChange('allowExceptions', 'Limited')}
            className={`p-5 rounded-xl border-2 text-center transition-all ${data?.allowExceptions === 'Limited' ? 'bg-amber-50 border-amber-400 shadow-md' : 'bg-white border-slate-200'
              }`}>
            <AlertTriangle className={`w-8 h-8 mx-auto mb-2 ${data?.allowExceptions === 'Limited' ? 'text-amber-600' : 'text-slate-400'}`} />
            <span className={`font-bold ${data?.allowExceptions === 'Limited' ? 'text-amber-700' : 'text-slate-600'}`}>Ù…Ø­Ø¯ÙˆØ¯</span>
            <p className="text-xs text-slate-500 mt-1">Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ù…Ù‚ÙŠØ¯Ø©</p>
          </button>
          <button
            type="button"
            disabled={isReadOnly}
            onClick={() => handleFieldChange('allowExceptions', 'No')}
            className={`p-5 rounded-xl border-2 text-center transition-all ${data?.allowExceptions === 'No' ? 'bg-red-50 border-red-400 shadow-md' : 'bg-white border-slate-200'
              }`}>
            <XCircle className={`w-8 h-8 mx-auto mb-2 ${data?.allowExceptions === 'No' ? 'text-red-600' : 'text-slate-400'}`} />
            <span className={`font-bold ${data?.allowExceptions === 'No' ? 'text-red-700' : 'text-slate-600'}`}>Ù„Ø§</span>
            <p className="text-xs text-slate-500 mt-1">Ø³ÙŠØ§Ø³Ø© ØµØ§Ø±Ù…Ø©</p>
          </button>
        </div>
      </div>

      {data?.allowExceptions !== 'No' && (
        <>
          {/* Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ */}
          <div>
            {renderFieldLabel('Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨', 'Required Approval Level')}
            <div className="grid grid-cols-5 gap-3">
              {EXCEPTION_APPROVAL_LEVELS.map(level => {
                const isSelected = data?.exceptionApprovalLevel === level.code;
                return (
                  <button
                    key={level.code}
                    type="button"
                    disabled={isReadOnly}
                    onClick={() => handleFieldChange('exceptionApprovalLevel', level.code)}
                    className={`p-4 rounded-xl border-2 text-center transition-all ${isSelected ? 'bg-orange-50 border-orange-400 shadow-md' : 'bg-white border-slate-200 hover:border-slate-300'
                      }`}>
                    <div className={`text-xl font-black mb-1 ${isSelected ? 'text-orange-600' : 'text-slate-400'}`}>L{level.level}</div>
                    <div className={`text-xs font-bold ${isSelected ? 'text-orange-700' : 'text-slate-600'}`}>{level.nameAr}</div>
                    {level.maxDays && <div className="text-xs text-slate-400 mt-1">â‰¤{level.maxDays}d</div>}
                  </button>
                );
              })}
            </div>
          </div>

          {/* Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ */}
          <div className="grid grid-cols-2 gap-6">
            <div>
              {renderFieldLabel('Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ù„Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡', 'Maximum Exception Duration (Days)')}
              <input
                type="number"
                value={data?.maxExceptionDays || 90}
                onChange={(e) => handleFieldChange('maxExceptionDays', parseInt(e.target.value))}
                disabled={isReadOnly}
                min={1}
                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-orange-500"
              />
            </div>
            <div>
              {renderFieldLabel('Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ø¶ÙˆØ§Ø¨Ø· ØªØ¹ÙˆÙŠØ¶ÙŠØ©ØŸ', 'Requires Compensating Controls')}
              <div className="flex gap-4">
                <button
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('requiresCompensatingControls', true)}
                  className={`flex-1 p-3 rounded-xl border-2 text-center ${data?.requiresCompensatingControls === true ? 'bg-orange-50 border-orange-400 text-orange-700 font-bold' : 'bg-white border-slate-200'
                    }`}>Ù†Ø¹Ù…</button>
                <button
                  type="button"
                  disabled={isReadOnly}
                  onClick={() => handleFieldChange('requiresCompensatingControls', false)}
                  className={`flex-1 p-3 rounded-xl border-2 text-center ${data?.requiresCompensatingControls === false ? 'bg-slate-100 border-slate-400 text-slate-700 font-bold' : 'bg-white border-slate-200'
                    }`}>Ù„Ø§</button>
              </div>
            </div>
          </div>

          {/* Ù…Ø¹Ø§ÙŠÙŠØ± Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø± */}
          <div>
            {renderFieldLabel('Ù…Ø¹Ø§ÙŠÙŠØ± Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Risk Acceptance Criteria')}
            <textarea
              value={data?.riskAcceptanceCriteria || ''}
              onChange={(e) => handleFieldChange('riskAcceptanceCriteria', e.target.value)}
              disabled={isReadOnly}
              rows={3}
              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-orange-500 resize-none"
              placeholder="Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ ØªÙˆØ§ÙØ±Ù‡Ø§ Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡..."
            />
          </div>
        </>
      )}
    </div>
  );


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 9: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª - LINKAGES & RELATIONS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabLinkages = () => (
    <div className="space-y-6">
      {/* Ù…Ù„Ø®Øµ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· */}
      <div className="grid grid-cols-4 gap-4">
        {[
          { label: 'Ø³ÙŠØ§Ø³Ø§Øª Ù…Ø±ØªØ¨Ø·Ø©', count: data?.relatedPolicies?.length || 0, icon: FileText, color: 'emerald' },
          { label: 'Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', count: data?.linkedObligations?.length || 0, icon: Scale, color: 'blue' },
          { label: 'Ø¶ÙˆØ§Ø¨Ø·', count: data?.linkedControls?.length || 0, icon: Shield, color: 'purple' },
          { label: 'Ù…Ø®Ø§Ø·Ø±', count: data?.linkedRisks?.length || 0, icon: AlertTriangle, color: 'red' },
        ].map((item, idx) => {
          const Icon = item.icon;
          return (
            <div key={idx} className={`p-4 rounded-xl border-2 ${getColorClasses(item.color, false)}`}>
              <div className="flex items-center justify-between mb-2">
                <Icon className={`w-6 h-6 text-${item.color}-500`} />
                <span className={`text-2xl font-black text-${item.color}-600`}>{item.count}</span>
              </div>
              <p className="text-sm text-slate-600">{item.label}</p>
            </div>
          );
        })}
      </div>

      {/* Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© */}
      <div>
        {renderFieldLabel('Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Related Policies & Standards')}
        <div className="border-2 border-slate-200 rounded-xl overflow-hidden">
          <div className="p-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
            <span className="text-sm text-slate-600">{data?.relatedPolicies?.length || 0} ÙˆØ«ÙŠÙ‚Ø© Ù…Ø±ØªØ¨Ø·Ø©</span>
            {!isReadOnly && (
              <button type="button" className="flex items-center gap-2 px-4 py-2 bg-teal-500 text-white rounded-lg text-sm font-bold hover:bg-teal-600">
                <Link className="w-4 h-4" />Ø±Ø¨Ø· ÙˆØ«Ø§Ø¦Ù‚
              </button>
            )}
          </div>
          <div className="p-8 text-center">
            <Network className="w-12 h-12 mx-auto text-slate-300 mb-3" />
            <p className="text-slate-500">ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø· Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø°Ø§Øª Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
          </div>
        </div>
      </div>

      {/* Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© */}
      <div>
        {renderFieldLabel('Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Linked Risks')}
        <div className="border-2 border-slate-200 rounded-xl overflow-hidden">
          <div className="p-4 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
            <span className="text-sm text-slate-600">{data?.linkedRisks?.length || 0} Ø®Ø·Ø± Ù…Ø±ØªØ¨Ø·</span>
            {!isReadOnly && (
              <button type="button" className="flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-bold hover:bg-red-600">
                <AlertTriangle className="w-4 h-4" />Ø±Ø¨Ø· Ù…Ø®Ø§Ø·Ø±
              </button>
            )}
          </div>
          <div className="p-8 text-center">
            <AlertTriangle className="w-12 h-12 mx-auto text-slate-300 mb-3" />
            <p className="text-slate-500">ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¨Ø· Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø°Ø§Øª Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
          </div>
        </div>
      </div>

      {/* Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ø£ØµÙˆÙ„ */}
      <div className="grid grid-cols-2 gap-6">
        <div>
          {renderFieldLabel('Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Linked Contracts')}
          <div className="p-4 border-2 border-slate-200 rounded-xl text-center">
            <Briefcase className="w-8 h-8 mx-auto text-slate-300 mb-2" />
            <p className="text-sm text-slate-500">{data?.linkedContracts?.length || 0} Ø¹Ù‚Ø¯</p>
          </div>
        </div>
        <div>
          {renderFieldLabel('Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©', 'Linked Assets')}
          <div className="p-4 border-2 border-slate-200 rounded-xl text-center">
            <Package className="w-8 h-8 mx-auto text-slate-300 mb-2" />
            <p className="text-sm text-slate-500">{data?.linkedAssets?.length || 0} Ø£ØµÙ„</p>
          </div>
        </div>
      </div>
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ“ TAB 10: Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ù†Ø´Ø± - REVIEW & PUBLISH
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  const renderTabPublish = () => (
    <div className="space-y-6">
      {/* Ù…Ù„Ø®Øµ Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„ */}
      <div className="p-6 bg-gradient-to-r from-green-50 via-emerald-50 to-teal-50 rounded-2xl border-2 border-green-200">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h3 className="font-bold text-green-800 text-xl">Ù…Ù„Ø®Øµ Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„</h3>
            <p className="text-green-600 text-sm">Completion Summary</p>
          </div>
          <div className="text-center">
            <span className="text-5xl font-black text-green-600">{progressPct}%</span>
            <p className="text-xs text-green-500">Ù…ÙƒØªÙ…Ù„</p>
          </div>
        </div>
        <div className="h-4 bg-green-200 rounded-full overflow-hidden mb-4">
          <div
            className={`h-full rounded-full transition-all ${progressPct >= 80 ? 'bg-green-500' : progressPct >= 50 ? 'bg-amber-500' : 'bg-red-500'}`}
            style={{ width: `${progressPct}%` }}
          />
        </div>
        <div className="grid grid-cols-4 gap-2">
          {completionChecks.map((check, idx) => (
            <div key={idx} className={`p-2 rounded-lg text-xs text-center transition-all ${check.check ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
              }`}>
              <span className="font-bold">{check.check ? 'âœ“' : 'âœ—'}</span> {check.label}
            </div>
          ))}
        </div>
      </div>

      {/* Ø§ÙƒØªÙ…Ø§Ù„ ÙƒÙ„ ØªØ§Ø¨ */}
      <div>
        {renderFieldLabel('Ø§ÙƒØªÙ…Ø§Ù„ ÙƒÙ„ Ù‚Ø³Ù…', 'Section Completion')}
        <div className="grid grid-cols-5 gap-2">
          {tabs.map((tab, idx) => {
            const completion = tabCompletion[tab.id] || 0;
            const Icon = tab.icon;
            return (
              <button
                key={tab.id}
                type="button"
                onClick={() => setActiveTab(idx)}
                className={`p-3 rounded-xl border-2 transition-all ${completion === 100 ? 'bg-green-50 border-green-300' :
                    completion > 0 ? 'bg-amber-50 border-amber-300' : 'bg-slate-50 border-slate-200'
                  }`}>
                <Icon className={`w-5 h-5 mx-auto mb-1 ${completion === 100 ? 'text-green-600' : 'text-slate-400'
                  }`} />
                <p className="text-xs font-bold text-slate-700">{tab.labelAr}</p>
                <p className={`text-xs font-bold mt-1 ${completion === 100 ? 'text-green-600' : completion > 0 ? 'text-amber-600' : 'text-slate-400'
                  }`}>{completion}%</p>
              </button>
            );
          })}
        </div>
      </div>

      {/* SoD Status */}
      <div className={`p-4 rounded-xl border-2 ${sodValidation.isValid ? 'bg-emerald-50 border-emerald-200' : 'bg-red-50 border-red-200'}`}>
        <div className="flex items-center gap-3">
          {sodValidation.isValid
            ? <CheckCircle2 className="w-8 h-8 text-emerald-600" />
            : <AlertTriangle className="w-8 h-8 text-red-600" />
          }
          <div>
            <span className={`font-bold text-lg ${sodValidation.isValid ? 'text-emerald-700' : 'text-red-700'}`}>
              {sodValidation.isValid ? 'âœ“ ÙØµÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (SoD) Ø³Ù„ÙŠÙ…' : 'âš ï¸ Ø§Ù†ØªÙ‡Ø§Ùƒ ÙØµÙ„ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª!'}
            </span>
            {!sodValidation.isValid && (
              <ul className="text-sm text-red-600 mt-1">
                {sodValidation.violations.map((v, i) => <li key={i}>â€¢ {v.msg}</li>)}
              </ul>
            )}
          </div>
        </div>
      </div>

      {/* Workflow Actions */}
      <div className="p-4 bg-slate-50 rounded-xl border-2 border-slate-200">
        <h4 className="font-bold text-slate-800 mb-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³ÙŠØ± Ø§Ù„Ø¹Ù…Ù„</h4>
        <div className="flex items-center gap-3">
          <button type="button" className="flex items-center gap-2 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg font-bold hover:bg-slate-300">
            <Eye className="w-4 h-4" />Ù…Ø¹Ø§ÙŠÙ†Ø©
          </button>
          <button type="button" className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg font-bold hover:bg-blue-600">
            <Send className="w-4 h-4" />Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
          </button>
          <button type="button" className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg font-bold hover:bg-purple-600">
            <CheckSquare className="w-4 h-4" />Ø§Ø¹ØªÙ…Ø§Ø¯
          </button>
          <button type="button" className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg font-bold hover:bg-emerald-600">
            <Globe className="w-4 h-4" />Ù†Ø´Ø±
          </button>
        </div>
      </div>
    </div>
  );

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // ğŸ¨ MAIN RENDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  return (
    <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
      <div className="bg-white rounded-3xl w-full max-w-6xl max-h-[95vh] flex flex-col shadow-2xl overflow-hidden">

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        <div className={`text-white px-8 py-5 bg-gradient-to-l ${isEditMode ? documentTypeInfo.gradientEdit : documentTypeInfo.gradientCreate}`}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-4">
              <div className="w-16 h-16 rounded-2xl bg-white/20 backdrop-blur flex items-center justify-center text-3xl">
                {documentTypeInfo.icon}
              </div>
              <div>
                <h2 className="text-2xl font-black">
                  {isEditMode ? `ØªØ¹Ø¯ÙŠÙ„ ${documentTypeInfo.nameAr}` : `Ø¥Ø¶Ø§ÙØ© ${documentTypeInfo.nameArIndefinite} ${data?.type === 'Policy' ? 'Ø¬Ø¯ÙŠØ¯Ø©' : 'Ø¬Ø¯ÙŠØ¯'}`}
                </h2>
                <p className="text-white/80 text-sm">
                  {data?.code || (data?.type === 'Policy' ? 'POL' : data?.type === 'Standard' ? 'STD' : data?.type === 'Procedure' ? 'PRC' : 'DOC') + '-XXX'} | {progressPct}% Ù…ÙƒØªÙ…Ù„
                </p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <div className="text-center px-4 py-2 bg-white/10 backdrop-blur rounded-xl">
                <p className="text-white/80 text-xs">Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„</p>
                <p className="text-2xl font-black">{progressPct}%</p>
              </div>
              <button onClick={onClose} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                <X className="w-6 h-6" />
              </button>
            </div>
          </div>
          <div className="mt-4 h-2 bg-white/20 rounded-full overflow-hidden">
            <div className={`h-full rounded-full transition-all ${progressPct >= 80 ? 'bg-white' : progressPct >= 50 ? 'bg-amber-300' : 'bg-red-300'}`} style={{ width: `${progressPct}%` }} />
          </div>
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        <div className="flex border-b border-slate-200 px-2 bg-slate-50 overflow-x-auto">
          {tabs.map((tab, idx) => {
            const Icon = tab.icon;
            const isActive = activeTab === idx;
            const isPassed = tabCompletion[tab.id] === 100;
            return (
              <button
                key={tab.id}
                onClick={() => setActiveTab(idx)}
                className={`flex items-center gap-2 px-4 py-3 font-medium border-b-2 whitespace-nowrap transition-all ${isActive
                    ? 'border-emerald-500 text-emerald-700 bg-white -mb-px rounded-t-xl shadow-sm'
                    : isPassed
                      ? 'border-transparent text-emerald-600'
                      : 'border-transparent text-slate-500 hover:text-slate-700'
                  }`}>
                <span className={`w-7 h-7 rounded-lg flex items-center justify-center text-xs font-bold ${isActive ? 'bg-emerald-500 text-white' :
                    isPassed ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-200 text-slate-500'
                  }`}>
                  {isPassed ? 'âœ“' : idx + 1}
                </span>
                {tab.labelAr}
              </button>
            );
          })}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        <div className="flex-1 overflow-y-auto p-8">
          {activeTab === 0 && renderTabBasic()}
          {activeTab === 1 && renderTabRegulatory()}
          {activeTab === 2 && renderTabScope()}
          {activeTab === 3 && renderTabAccountability()}
          {activeTab === 4 && renderTabRequirements()}
          {activeTab === 5 && renderTabSchedule()}
          {activeTab === 6 && renderTabAttestation()}
          {activeTab === 7 && renderTabExceptions()}
          {activeTab === 8 && renderTabLinkages()}
          {activeTab === 9 && renderTabPublish()}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        <div className="border-t-2 border-slate-200 px-8 py-5 bg-gradient-to-t from-slate-100 to-white">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <button
                onClick={() => activeTab > 0 && setActiveTab(activeTab - 1)}
                disabled={activeTab === 0}
                className={`flex items-center gap-2 px-6 py-3 rounded-xl font-bold transition-all ${activeTab === 0 ? 'bg-slate-100 text-slate-400 cursor-not-allowed' : 'bg-slate-200 text-slate-700 hover:bg-slate-300'
                  }`}>
                <ChevronRight className="w-5 h-5" />Ø§Ù„Ø³Ø§Ø¨Ù‚
              </button>
              <button
                onClick={() => activeTab < tabs.length - 1 && setActiveTab(activeTab + 1)}
                disabled={activeTab === tabs.length - 1}
                className={`flex items-center gap-2 px-6 py-3 rounded-xl font-bold transition-all ${activeTab === tabs.length - 1 ? 'bg-slate-100 text-slate-400 cursor-not-allowed' : 'bg-slate-800 text-white hover:bg-slate-900'
                  }`}>
                Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
              </button>
              <span className="text-sm text-slate-500 mr-4 font-medium">{activeTab + 1} / {tabs.length}</span>
            </div>
            <div className="flex items-center gap-3">
              <button onClick={onClose} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <button onClick={() => handleSave(true)} className="flex items-center gap-2 px-6 py-3 bg-slate-700 text-white rounded-xl font-bold hover:bg-slate-800 transition-all">
                <Save className="w-5 h-5" />Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©
              </button>
              <button
                onClick={() => handleSave(false)}
                disabled={progressPct < 50 || !sodValidation.isValid}
                className={`flex items-center gap-2 px-8 py-3 text-white rounded-xl font-bold shadow-lg transition-all ${progressPct >= 50 && sodValidation.isValid
                    ? `bg-gradient-to-r ${documentTypeInfo.gradientCreate} hover:opacity-90 shadow-${documentTypeInfo.color}-500/30`
                    : 'bg-slate-300 cursor-not-allowed'
                  }`}>
                {isEditMode ? <Save className="w-5 h-5" /> : <Send className="w-5 h-5" />}
                {isEditMode ? `Ø­ÙØ¸ ØªØ¹Ø¯ÙŠÙ„Ø§Øª ${documentTypeInfo.nameAr}` : `Ø¥Ù†Ø´Ø§Ø¡ ${documentTypeInfo.nameAr}`}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.3: Ù…ØµÙÙˆÙØ© Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ObligationsMapping = () => {
  const [selectedObligation, setSelectedObligation] = useState(null);
  const [filterAuthority, setFilterAuthority] = useState('');
  const [filterCoverage, setFilterCoverage] = useState('');
  const [viewMode, setViewMode] = useState('matrix');

  // Modal State - Ù…ÙˆØ­Ø¯
  const [showFormModal, setShowFormModal] = useState(false);
  const [formMode, setFormMode] = useState('create'); // 'create' | 'edit'
  const [showViewModal, setShowViewModal] = useState(false);
  const [formData, setFormData] = useState({
    id: null,
    obligationId: null,
    controlId: null,
    riskId: null,
    policyId: null,
    coverageLevel: 'Full',
    notes: ''
  });

  const resetFormData = () => setFormData({
    id: null, obligationId: null, controlId: null, riskId: null, policyId: null, coverageLevel: 'Full', notes: ''
  });

  // Handlers - Ù…ÙˆØ­Ø¯Ø©
  const handleAddMapping = (obl) => {
    setSelectedObligation(obl);
    setFormData({ ...formData, obligationId: obl?.id });
    setFormMode('create');
    setShowFormModal(true);
  };

  const handleEditMapping = (obl, mapping) => {
    setSelectedObligation(obl);
    setFormData({
      id: mapping?.id,
      obligationId: obl?.id,
      controlId: mapping?.controlId || null,
      riskId: mapping?.riskId || null,
      policyId: mapping?.policyId || null,
      coverageLevel: mapping?.coverageLevel || 'Full',
      notes: mapping?.notes || ''
    });
    setFormMode('edit');
    setShowFormModal(true);
  };

  const handleViewDetails = (obl) => {
    setSelectedObligation(obl);
    setShowViewModal(true);
  };

  const handleSaveForm = () => {
    if (formMode === 'create') {
      alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø§Ù„ØªØ²Ø§Ù…: ${selectedObligation?.title}`);
    } else {
      alert(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­`);
    }
    setShowFormModal(false);
    resetFormData();
  };

  const handleCloseForm = () => {
    setShowFormModal(false);
    resetFormData();
  };

  const handleDeleteMapping = (obl) => {
    if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¨Ø·ØŸ')) {
      alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­');
    }
  };

  // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØºØ·ÙŠØ© Ù„ÙƒÙ„ Ø§Ù„ØªØ²Ø§Ù…
  const obligationsWithCoverage = useMemo(() => {
    return INITIAL_OBLIGATIONS.map(obl => {
      const mappings = MAPPINGS.filter(m => m.obligationId === obl.id);
      const controls = mappings.map(m => CONTROLS.find(c => c.id === m.controlId)).filter(Boolean);
      const risks = mappings.map(m => RISKS.find(r => r.id === m.riskId)).filter(Boolean);
      const policies = mappings.map(m => POLICIES.find(p => p.id === m.policyId)).filter(Boolean);

      const coverageStatus = mappings.length === 0 ? 'None' :
        mappings.every(m => m.coverageLevel === 'Full') ? 'Full' : 'Partial';

      return {
        ...obl,
        mappings,
        controls: [...new Set(controls)],
        risks: [...new Set(risks)],
        policies: [...new Set(policies)],
        coverageStatus,
        controlCount: controls.length,
        riskCount: risks.length,
      };
    });
  }, []);

  const stats = useMemo(() => {
    const total = obligationsWithCoverage.length;
    const fullCoverage = obligationsWithCoverage.filter(o => o.coverageStatus === 'Full').length;
    const partialCoverage = obligationsWithCoverage.filter(o => o.coverageStatus === 'Partial').length;
    const noCoverage = obligationsWithCoverage.filter(o => o.coverageStatus === 'None').length;
    const highPriorityGaps = obligationsWithCoverage.filter(o => o.criticality === 'High' && o.coverageStatus === 'None').length;

    return {
      total,
      fullCoverage,
      partialCoverage,
      noCoverage,
      highPriorityGaps,
      coveragePercent: Math.round((fullCoverage / total) * 100),
    };
  }, [obligationsWithCoverage]);

  const filteredObligations = useMemo(() => {
    return obligationsWithCoverage.filter(o => {
      const matchAuthority = !filterAuthority || o.authorityId === parseInt(filterAuthority);
      const matchCoverage = !filterCoverage || o.coverageStatus === filterCoverage;
      return matchAuthority && matchCoverage;
    });
  }, [obligationsWithCoverage, filterAuthority, filterCoverage]);

  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);
  const getFramework = (id) => FRAMEWORKS.find(f => f.id === id);

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-slate-900">Ù…ØµÙÙˆÙØ© Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</h1>
          <p className="text-slate-500">Golden Thread: Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… â†’ Ø§Ù„Ø¶Ø§Ø¨Ø· â†’ Ø§Ù„Ù…Ø®Ø§Ø·Ø± â†’ Ø§Ù„Ø³ÙŠØ§Ø³Ø© - Module 4.3</p>
        </div>
        <div className="flex items-center gap-3">
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50 transition-all">
            <Download className="w-5 h-5" />
            ØªØµØ¯ÙŠØ±
          </button>
          <button onClick={() => handleAddMapping(null)} className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold hover:from-emerald-600 hover:to-teal-600 transition-all shadow-lg shadow-emerald-500/30">
            <Plus className="w-5 h-5" />
            Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø·
          </button>
        </div>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-6 gap-4">
        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
          <p className="text-sm text-slate-500 mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</p>
          <p className="text-3xl font-bold text-slate-900">{stats.total}</p>
        </div>
        <div className="bg-gradient-to-br from-emerald-500 to-teal-500 rounded-2xl p-5 text-white">
          <p className="text-sm text-emerald-100 mb-1">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØºØ·ÙŠØ©</p>
          <p className="text-3xl font-bold">{stats.coveragePercent}%</p>
        </div>
        <div className="bg-white rounded-2xl p-5 border-2 border-emerald-200">
          <div className="flex items-center gap-2 mb-1">
            <span className="w-3 h-3 rounded-full bg-emerald-500" />
            <p className="text-sm text-slate-500">ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø©</p>
          </div>
          <p className="text-3xl font-bold text-emerald-600">{stats.fullCoverage}</p>
        </div>
        <div className="bg-white rounded-2xl p-5 border-2 border-amber-200">
          <div className="flex items-center gap-2 mb-1">
            <span className="w-3 h-3 rounded-full bg-amber-500" />
            <p className="text-sm text-slate-500">ØªØºØ·ÙŠØ© Ø¬Ø²Ø¦ÙŠØ©</p>
          </div>
          <p className="text-3xl font-bold text-amber-600">{stats.partialCoverage}</p>
        </div>
        <div className="bg-white rounded-2xl p-5 border-2 border-red-200">
          <div className="flex items-center gap-2 mb-1">
            <span className="w-3 h-3 rounded-full bg-red-500" />
            <p className="text-sm text-slate-500">Ø¨Ø¯ÙˆÙ† ØªØºØ·ÙŠØ©</p>
          </div>
          <p className="text-3xl font-bold text-red-600">{stats.noCoverage}</p>
        </div>
        <div className="bg-red-50 rounded-2xl p-5 border-2 border-red-200">
          <div className="flex items-center gap-2 mb-1">
            <AlertTriangle className="w-4 h-4 text-red-500" />
            <p className="text-sm text-red-600">ÙØ¬ÙˆØ§Øª Ø­Ø±Ø¬Ø©</p>
          </div>
          <p className="text-3xl font-bold text-red-600">{stats.highPriorityGaps}</p>
        </div>
      </div>

      {/* Coverage Heatmap Bar */}
      <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
        <div className="flex items-center justify-between mb-3">
          <h3 className="font-bold text-slate-800">Ù…Ø¤Ø´Ø± Ø§Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</h3>
          <span className="text-sm text-slate-500">{stats.fullCoverage} Ù…Ù† {stats.total} Ø§Ù„ØªØ²Ø§Ù… Ù…ØºØ·Ù‰ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</span>
        </div>
        <div className="h-4 bg-slate-100 rounded-full overflow-hidden flex">
          <div
            className="h-full bg-emerald-500"
            style={{ width: `${(stats.fullCoverage / stats.total) * 100}%` }}
          />
          <div
            className="h-full bg-amber-500"
            style={{ width: `${(stats.partialCoverage / stats.total) * 100}%` }}
          />
          <div
            className="h-full bg-red-500"
            style={{ width: `${(stats.noCoverage / stats.total) * 100}%` }}
          />
        </div>
        <div className="flex items-center justify-center gap-6 mt-3 text-sm">
          <div className="flex items-center gap-2">
            <span className="w-3 h-3 rounded-full bg-emerald-500" />
            <span className="text-slate-600">ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø©</span>
          </div>
          <div className="flex items-center gap-2">
            <span className="w-3 h-3 rounded-full bg-amber-500" />
            <span className="text-slate-600">ØªØºØ·ÙŠØ© Ø¬Ø²Ø¦ÙŠØ©</span>
          </div>
          <div className="flex items-center gap-2">
            <span className="w-3 h-3 rounded-full bg-red-500" />
            <span className="text-slate-600">Ø¨Ø¯ÙˆÙ† ØªØºØ·ÙŠØ©</span>
          </div>
        </div>
      </div>

      {/* Filters */}
      <div className="flex items-center gap-4">
        <select
          value={filterAuthority}
          onChange={(e) => setFilterAuthority(e.target.value)}
          className="px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 bg-white"
        >
          <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</option>
          {AUTHORITIES.map(a => (
            <option key={a.id} value={a.id}>{a.nameAr}</option>
          ))}
        </select>
        <select
          value={filterCoverage}
          onChange={(e) => setFilterCoverage(e.target.value)}
          className="px-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-emerald-500 bg-white"
        >
          <option value="">Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ØªØºØ·ÙŠØ©</option>
          <option value="Full">ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø©</option>
          <option value="Partial">ØªØºØ·ÙŠØ© Ø¬Ø²Ø¦ÙŠØ©</option>
          <option value="None">Ø¨Ø¯ÙˆÙ† ØªØºØ·ÙŠØ©</option>
        </select>
        <div className="flex-1" />
        <div className="flex items-center gap-1 bg-slate-100 rounded-xl p-1">
          <button
            onClick={() => setViewMode('matrix')}
            className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${viewMode === 'matrix' ? 'bg-white shadow-sm' : ''}`}
          >
            Ù…ØµÙÙˆÙØ©
          </button>
          <button
            onClick={() => setViewMode('list')}
            className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${viewMode === 'list' ? 'bg-white shadow-sm' : ''}`}
          >
            Ù‚Ø§Ø¦Ù…Ø©
          </button>
          <button
            onClick={() => setViewMode('gaps')}
            className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${viewMode === 'gaps' ? 'bg-white shadow-sm text-red-600' : ''}`}
          >
            Ø§Ù„ÙØ¬ÙˆØ§Øª
          </button>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTENT BASED ON VIEW MODE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}

      {/* Matrix View */}
      {viewMode === 'matrix' && (
        <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead>
                <tr className="bg-slate-50 border-b-2 border-slate-200">
                  <th className="text-right px-5 py-4 font-bold text-slate-700 w-64">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">
                    <div className="flex items-center justify-center gap-2">
                      <Shield className="w-4 h-4 text-blue-600" />
                      Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·
                    </div>
                  </th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">
                    <div className="flex items-center justify-center gap-2">
                      <AlertTriangle className="w-4 h-4 text-amber-600" />
                      Ø§Ù„Ù…Ø®Ø§Ø·Ø±
                    </div>
                  </th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">
                    <div className="flex items-center justify-center gap-2">
                      <FileText className="w-4 h-4 text-purple-600" />
                      Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª
                    </div>
                  </th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„ØªØºØ·ÙŠØ©</th>
                  <th className="text-center px-4 py-4 font-bold text-slate-700 w-32">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
              </thead>
              <tbody>
                {filteredObligations.slice(0, 15).map((obl) => {
                  const authority = getAuthority(obl.authorityId);
                  return (
                    <tr key={obl.id} className={`border-b border-slate-100 hover:bg-slate-50 transition-colors ${obl.coverageStatus === 'None' && obl.criticality === 'High' ? 'bg-red-50/50' : ''}`}>
                      <td className="px-5 py-4">
                        <div className="flex items-center gap-2 mb-1">
                          <span className="font-mono text-sm font-bold text-emerald-600">{obl.code}</span>
                        </div>
                        <p className="text-sm text-slate-700 line-clamp-2">{obl.title}</p>
                      </td>
                      <td className="px-4 py-4 text-center">
                        <span className="px-2.5 py-1 bg-slate-100 rounded-lg text-xs font-bold text-slate-600">{authority?.code}</span>
                      </td>
                      <td className="px-4 py-4 text-center">
                        <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${obl.criticality === 'High' ? 'bg-red-100 text-red-700' : obl.criticality === 'Medium' ? 'bg-amber-100 text-amber-700' : 'bg-green-100 text-green-700'}`}>
                          {obl.criticality === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : obl.criticality === 'Medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶'}
                        </span>
                      </td>
                      <td className="px-4 py-4 text-center">
                        {obl.controlCount > 0 ? (
                          <span className="w-8 h-8 bg-blue-100 text-blue-700 rounded-lg flex items-center justify-center font-bold mx-auto">{obl.controlCount}</span>
                        ) : <span className="text-red-500 text-xl">â€”</span>}
                      </td>
                      <td className="px-4 py-4 text-center">
                        {obl.riskCount > 0 ? (
                          <span className="w-8 h-8 bg-amber-100 text-amber-700 rounded-lg flex items-center justify-center font-bold mx-auto">{obl.riskCount}</span>
                        ) : <span className="text-slate-400 text-xl">â€”</span>}
                      </td>
                      <td className="px-4 py-4 text-center">
                        {obl.policies?.length > 0 ? (
                          <span className="w-8 h-8 bg-purple-100 text-purple-700 rounded-lg flex items-center justify-center font-bold mx-auto">{obl.policies.length}</span>
                        ) : <span className="text-slate-400 text-xl">â€”</span>}
                      </td>
                      <td className="px-4 py-4 text-center">
                        <span className={`px-3 py-1.5 rounded-xl text-xs font-bold ${obl.coverageStatus === 'Full' ? 'bg-emerald-100 text-emerald-700' : obl.coverageStatus === 'Partial' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}`}>
                          {obl.coverageStatus === 'Full' ? 'âœ“ ÙƒØ§Ù…Ù„Ø©' : obl.coverageStatus === 'Partial' ? 'â— Ø¬Ø²Ø¦ÙŠØ©' : 'âœ— ÙØ¬ÙˆØ©'}
                        </span>
                      </td>
                      <td className="px-4 py-4 text-center">
                        <div className="flex items-center justify-center gap-1">
                          <button onClick={() => handleViewDetails(obl)} className="p-2 hover:bg-blue-50 rounded-lg" title="Ø¹Ø±Ø¶"><Eye className="w-4 h-4 text-blue-500" /></button>
                          <button onClick={() => handleAddMapping(obl)} className="p-2 hover:bg-emerald-50 rounded-lg" title="Ø¥Ø¶Ø§ÙØ©"><Plus className="w-4 h-4 text-emerald-500" /></button>
                          <button onClick={() => handleEditMapping(obl, obl.mappings?.[0])} className="p-2 hover:bg-amber-50 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„"><Edit className="w-4 h-4 text-amber-500" /></button>
                          <button onClick={() => handleDeleteMapping(obl)} className="p-2 hover:bg-red-50 rounded-lg" title="Ø­Ø°Ù"><Trash2 className="w-4 h-4 text-red-500" /></button>
                        </div>
                      </td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>
        </div>
      )}

      {/* List View */}
      {viewMode === 'list' && (
        <div className="space-y-3">
          {filteredObligations.map((obl) => {
            const authority = getAuthority(obl.authorityId);
            return (
              <div key={obl.id} className={`bg-white rounded-xl border-2 p-4 hover:shadow-lg transition-all cursor-pointer ${obl.coverageStatus === 'None' ? 'border-red-200 bg-red-50/30' : obl.coverageStatus === 'Partial' ? 'border-amber-200' : 'border-slate-200'}`}
                onClick={() => handleViewDetails(obl)}>
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center gap-3 mb-2">
                      <span className="font-mono text-sm font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded">{obl.code}</span>
                      <span className="px-2 py-1 bg-slate-100 rounded text-xs font-bold text-slate-600">{authority?.code}</span>
                      <span className={`px-2 py-1 rounded text-xs font-bold ${obl.criticality === 'High' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}`}>
                        {obl.criticality === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·'}
                      </span>
                    </div>
                    <h3 className="font-bold text-slate-800 mb-1">{obl.title}</h3>
                    <p className="text-sm text-slate-500 line-clamp-2">{obl.statement}</p>
                  </div>
                  <div className="flex items-center gap-4 mr-4">
                    <div className="text-center">
                      <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mb-1">
                        <span className="font-bold text-blue-600">{obl.controlCount}</span>
                      </div>
                      <span className="text-xs text-slate-500">Ø¶ÙˆØ§Ø¨Ø·</span>
                    </div>
                    <div className="text-center">
                      <div className="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center mb-1">
                        <span className="font-bold text-amber-600">{obl.riskCount}</span>
                      </div>
                      <span className="text-xs text-slate-500">Ù…Ø®Ø§Ø·Ø±</span>
                    </div>
                    <span className={`px-4 py-2 rounded-xl text-sm font-bold ${obl.coverageStatus === 'Full' ? 'bg-emerald-100 text-emerald-700' : obl.coverageStatus === 'Partial' ? 'bg-amber-100 text-amber-700' : 'bg-red-100 text-red-700'}`}>
                      {obl.coverageStatus === 'Full' ? 'âœ“ ÙƒØ§Ù…Ù„Ø©' : obl.coverageStatus === 'Partial' ? 'â— Ø¬Ø²Ø¦ÙŠØ©' : 'âœ— ÙØ¬ÙˆØ©'}
                    </span>
                  </div>
                </div>
                <div className="flex items-center gap-2 mt-3 pt-3 border-t border-slate-100">
                  <button onClick={(e) => { e.stopPropagation(); handleAddMapping(obl); }} className="flex items-center gap-1 px-3 py-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg text-sm font-medium">
                    <Plus className="w-4 h-4" /> Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø·
                  </button>
                  <button onClick={(e) => { e.stopPropagation(); handleEditMapping(obl, obl.mappings?.[0]); }} className="flex items-center gap-1 px-3 py-1.5 text-blue-600 hover:bg-blue-50 rounded-lg text-sm font-medium">
                    <Edit className="w-4 h-4" /> ØªØ¹Ø¯ÙŠÙ„
                  </button>
                  <button onClick={(e) => { e.stopPropagation(); handleDeleteMapping(obl); }} className="flex items-center gap-1 px-3 py-1.5 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium">
                    <Trash2 className="w-4 h-4" /> Ø­Ø°Ù
                  </button>
                </div>
              </div>
            );
          })}
        </div>
      )}

      {/* Gaps View - Ø§Ù„ÙØ¬ÙˆØ§Øª ÙÙ‚Ø· */}
      {viewMode === 'gaps' && (
        <div className="space-y-4">
          <div className="bg-red-50 border-2 border-red-200 rounded-2xl p-4">
            <div className="flex items-center gap-3 mb-3">
              <AlertTriangle className="w-6 h-6 text-red-600" />
              <h3 className="font-bold text-red-800">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø¯ÙˆÙ† ØªØºØ·ÙŠØ© ({obligationsWithCoverage.filter(o => o.coverageStatus === 'None').length})</h3>
            </div>
            <p className="text-sm text-red-700">Ù‡Ø°Ù‡ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø±Ø¨Ø· Ø¨Ø¶ÙˆØ§Ø¨Ø· ÙˆÙ…Ø®Ø§Ø·Ø± ÙˆØ³ÙŠØ§Ø³Ø§Øª Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ÙƒØ§Ù…Ù„.</p>
          </div>

          {obligationsWithCoverage.filter(o => o.coverageStatus === 'None').map((obl) => {
            const authority = getAuthority(obl.authorityId);
            return (
              <div key={obl.id} className="bg-white rounded-xl border-2 border-red-300 p-5 hover:shadow-lg transition-all">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center gap-3 mb-2">
                      <span className="font-mono text-sm font-bold text-red-600 bg-red-100 px-2 py-1 rounded">{obl.code}</span>
                      <span className="px-2 py-1 bg-slate-100 rounded text-xs font-bold">{authority?.code}</span>
                      {obl.criticality === 'High' && (
                        <span className="px-2 py-1 bg-red-500 text-white rounded text-xs font-bold flex items-center gap-1">
                          <AlertTriangle className="w-3 h-3" /> Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©
                        </span>
                      )}
                    </div>
                    <h3 className="font-bold text-slate-800 mb-2">{obl.title}</h3>
                    <p className="text-sm text-slate-600">{obl.statement}</p>
                  </div>
                  <button onClick={() => handleAddMapping(obl)} className="flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold hover:from-emerald-600 hover:to-teal-600 shadow-lg mr-4">
                    <Plus className="w-5 h-5" />
                    Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙØ¬ÙˆØ©
                  </button>
                </div>
              </div>
            );
          })}

          {obligationsWithCoverage.filter(o => o.coverageStatus === 'None').length === 0 && (
            <div className="bg-emerald-50 border-2 border-emerald-200 rounded-2xl p-8 text-center">
              <CheckCircle2 className="w-16 h-16 text-emerald-500 mx-auto mb-4" />
              <h3 className="text-xl font-bold text-emerald-800 mb-2">Ù…Ù…ØªØ§Ø²! Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¬ÙˆØ§Øª</h3>
              <p className="text-emerald-700">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ù„Ø¯ÙŠÙ‡Ø§ ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø© Ø£Ùˆ Ø¬Ø²Ø¦ÙŠØ©.</p>
            </div>
          )}
        </div>
      )}
      {/* Legend */}
      <div className="bg-slate-50 rounded-2xl p-5 border border-slate-200">
        <h4 className="font-bold text-slate-700 mb-3">Golden Thread - Ù…ÙØªØ§Ø­ Ø§Ù„Ø±Ø¨Ø·</h4>
        <div className="flex items-center gap-8 text-sm">
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
              <Shield className="w-4 h-4 text-blue-600" />
            </div>
            <span className="text-slate-600">Ø¶ÙˆØ§Ø¨Ø· Ø±Ù‚Ø§Ø¨ÙŠØ© (Controls)</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">
              <AlertTriangle className="w-4 h-4 text-amber-600" />
            </div>
            <span className="text-slate-600">Ù…Ø®Ø§Ø·Ø± (Risks)</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
              <FileText className="w-4 h-4 text-purple-600" />
            </div>
            <span className="text-slate-600">Ø³ÙŠØ§Ø³Ø§Øª (Policies)</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center">
              <CheckCircle2 className="w-4 h-4 text-emerald-600" />
            </div>
            <span className="text-slate-600">ØªØºØ·ÙŠØ© ÙƒØ§Ù…Ù„Ø©</span>
          </div>
          <div className="flex items-center gap-2">
            <div className="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center">
              <XCircle className="w-4 h-4 text-red-600" />
            </div>
            <span className="text-slate-600">ÙØ¬ÙˆØ© ØªØ­ØªØ§Ø¬ Ù…Ø¹Ø§Ù„Ø¬Ø©</span>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WORLD-CLASS GOLDEN THREAD LINKING MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showFormModal && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-5xl max-h-[92vh] overflow-hidden flex flex-col">
            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className={`px-6 py-4 text-white ${formMode === 'edit' ? 'bg-gradient-to-l from-blue-600 via-indigo-600 to-purple-700' : 'bg-gradient-to-l from-emerald-600 via-teal-600 to-cyan-700'}`}>
              <div className="flex items-center justify-between mb-4">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-sm">
                    {formMode === 'edit' ? <Edit className="w-6 h-6" /> : <Link2 className="w-6 h-6" />}
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">{formMode === 'edit' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø·' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø¨Ø· Ø¬Ø¯ÙŠØ¯'}</h2>
                    <p className="text-white/80 text-sm">Golden Thread: Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… â† Ø§Ù„Ø¶Ø§Ø¨Ø· â† Ø§Ù„Ù…Ø®Ø§Ø·Ø± â† Ø§Ù„Ø³ÙŠØ§Ø³Ø©</p>
                  </div>
                </div>
                <button onClick={handleCloseForm} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                  <X className="w-5 h-5" />
                </button>
              </div>

              {/* Visual Golden Thread */}
              <div className="flex items-center justify-center gap-1 py-2 bg-white/10 rounded-xl">
                <div className="flex items-center gap-1.5 px-3 py-1.5 bg-emerald-500/30 rounded-lg">
                  <FileText className="w-4 h-4" />
                  <span className="text-xs font-bold">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</span>
                  {(selectedObligation || formData.obligationId) && <CheckCircle2 className="w-3.5 h-3.5" />}
                </div>
                <ChevronLeft className="w-4 h-4 text-white/50" />
                <div className="flex items-center gap-1.5 px-3 py-1.5 bg-blue-500/30 rounded-lg">
                  <Shield className="w-4 h-4" />
                  <span className="text-xs font-bold">Ø§Ù„Ø¶Ø§Ø¨Ø·</span>
                  {formData.controlId && <CheckCircle2 className="w-3.5 h-3.5" />}
                </div>
                <ChevronLeft className="w-4 h-4 text-white/50" />
                <div className="flex items-center gap-1.5 px-3 py-1.5 bg-amber-500/30 rounded-lg">
                  <AlertTriangle className="w-4 h-4" />
                  <span className="text-xs font-bold">Ø§Ù„Ù…Ø®Ø§Ø·Ø±</span>
                  {formData.riskId && <CheckCircle2 className="w-3.5 h-3.5" />}
                </div>
                <ChevronLeft className="w-4 h-4 text-white/50" />
                <div className="flex items-center gap-1.5 px-3 py-1.5 bg-purple-500/30 rounded-lg">
                  <BookOpen className="w-4 h-4" />
                  <span className="text-xs font-bold">Ø§Ù„Ø³ÙŠØ§Ø³Ø©</span>
                  {formData.policyId && <CheckCircle2 className="w-3.5 h-3.5" />}
                </div>
              </div>
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTENT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className="flex-1 overflow-y-auto p-6">
              {/* Selected Obligation Preview */}
              {(selectedObligation || formData.obligationId) && (
                <div className="mb-5 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border-2 border-emerald-200">
                  <div className="flex items-start justify-between">
                    <div className="flex items-start gap-3">
                      <div className="w-10 h-10 rounded-xl bg-emerald-500 flex items-center justify-center flex-shrink-0">
                        <FileText className="w-5 h-5 text-white" />
                      </div>
                      <div>
                        <div className="flex items-center gap-2 mb-1">
                          <span className="font-mono text-sm font-bold text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded">{selectedObligation?.code}</span>
                          <span className="px-2 py-0.5 bg-slate-200 rounded text-xs font-bold text-slate-600">{getAuthority(selectedObligation?.authorityId)?.code}</span>
                          <span className={`px-2 py-0.5 rounded text-xs font-bold ${selectedObligation?.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'}`}>
                            {selectedObligation?.status === 'Active' ? 'Ù†Ø´Ø·' : selectedObligation?.status}
                          </span>
                        </div>
                        <p className="font-bold text-slate-800 text-sm">{selectedObligation?.title}</p>
                      </div>
                    </div>
                    {formMode === 'create' && (
                      <button onClick={() => { setSelectedObligation(null); setFormData({ ...formData, obligationId: null }); }}
                        className="text-slate-400 hover:text-red-500 p-1.5 hover:bg-red-50 rounded-lg transition-all">
                        <X className="w-4 h-4" />
                      </button>
                    )}
                  </div>
                </div>
              )}

              {/* Obligation Selection - when not selected */}
              {!selectedObligation && formMode === 'create' && (
                <div className="mb-5">
                  <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                    <span className="w-6 h-6 rounded-lg bg-emerald-500 text-white flex items-center justify-center text-xs font-bold">1</span>
                    Ø§Ø®ØªØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ *
                  </label>
                  <div className="relative mb-3">
                    <Search className="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" />
                    <input type="text" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª..."
                      className="w-full pr-10 pl-4 py-2.5 border-2 border-slate-200 rounded-xl text-sm focus:border-emerald-400 focus:outline-none" />
                  </div>
                  <div className="grid grid-cols-1 gap-2 max-h-40 overflow-y-auto">
                    {obligationsWithCoverage.slice(0, 8).map(obl => (
                      <button key={obl.id} type="button" onClick={() => { setSelectedObligation(obl); setFormData({ ...formData, obligationId: obl.id }); }}
                        className={`flex items-center gap-3 p-3 rounded-xl border-2 text-right transition-all hover:shadow-md ${obl.coverageStatus === 'None' ? 'border-red-200 bg-red-50/50 hover:border-red-400' : 'border-slate-200 hover:border-emerald-400 hover:bg-emerald-50/50'
                          }`}>
                        <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${obl.coverageStatus === 'None' ? 'bg-red-100' : 'bg-emerald-100'}`}>
                          <FileText className={`w-4 h-4 ${obl.coverageStatus === 'None' ? 'text-red-600' : 'text-emerald-600'}`} />
                        </div>
                        <div className="flex-1 min-w-0">
                          <div className="flex items-center gap-2">
                            <span className="font-mono text-xs font-bold text-emerald-600">{obl.code}</span>
                            {obl.coverageStatus === 'None' && <span className="px-1.5 py-0.5 bg-red-500 text-white rounded text-xs">ÙØ¬ÙˆØ©</span>}
                          </div>
                          <p className="text-xs text-slate-700 truncate">{obl.title}</p>
                        </div>
                        <ChevronLeft className="w-4 h-4 text-slate-400" />
                      </button>
                    ))}
                  </div>
                </div>
              )}

              {/* Golden Thread Connections - 2x2 Grid */}
              {(selectedObligation || formData.obligationId) && (
                <div className="grid grid-cols-2 gap-4">
                  {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONTROL SELECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                  <div className="bg-blue-50/50 rounded-xl p-4 border border-blue-200">
                    <label className="flex items-center justify-between mb-3">
                      <div className="flex items-center gap-2">
                        <span className="w-6 h-6 rounded-lg bg-blue-500 text-white flex items-center justify-center text-xs font-bold">2</span>
                        <Shield className="w-4 h-4 text-blue-600" />
                        <span className="text-sm font-bold text-slate-700">Ø§Ù„Ø¶Ø§Ø¨Ø· Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠ *</span>
                      </div>
                      {formData.controlId && (
                        <span className="px-2 py-0.5 bg-blue-500 text-white rounded text-xs font-bold">ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</span>
                      )}
                    </label>
                    <div className="relative mb-2">
                      <Search className="absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400" />
                      <input type="text" placeholder="Ø§Ø¨Ø­Ø«..."
                        className="w-full pr-9 pl-3 py-2 border border-slate-200 rounded-lg text-xs focus:border-blue-400 focus:outline-none" />
                    </div>
                    <div className="space-y-1.5 max-h-36 overflow-y-auto">
                      {CONTROLS.slice(0, 10).map(ctrl => (
                        <button key={ctrl.id} type="button" onClick={() => setFormData({ ...formData, controlId: ctrl.id })}
                          className={`w-full flex items-center gap-2 p-2.5 rounded-lg border transition-all text-right ${formData.controlId === ctrl.id ? 'border-blue-500 bg-blue-100' : 'border-slate-200 bg-white hover:border-blue-300'
                            }`}>
                          <div className={`w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0 ${formData.controlId === ctrl.id ? 'bg-blue-500 text-white' : 'bg-blue-100 text-blue-600'}`}>
                            {formData.controlId === ctrl.id ? <CheckCircle2 className="w-4 h-4" /> : <Shield className="w-4 h-4" />}
                          </div>
                          <div className="flex-1 min-w-0">
                            <span className="font-mono text-xs font-bold text-blue-600">{ctrl.code}</span>
                            <p className="text-xs text-slate-600 truncate">{ctrl.title}</p>
                          </div>
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RISK SELECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                  <div className="bg-amber-50/50 rounded-xl p-4 border border-amber-200">
                    <label className="flex items-center justify-between mb-3">
                      <div className="flex items-center gap-2">
                        <span className="w-6 h-6 rounded-lg bg-amber-500 text-white flex items-center justify-center text-xs font-bold">3</span>
                        <AlertTriangle className="w-4 h-4 text-amber-600" />
                        <span className="text-sm font-bold text-slate-700">Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</span>
                      </div>
                      {formData.riskId && (
                        <span className="px-2 py-0.5 bg-amber-500 text-white rounded text-xs font-bold">ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</span>
                      )}
                    </label>
                    <div className="relative mb-2">
                      <Search className="absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400" />
                      <input type="text" placeholder="Ø§Ø¨Ø­Ø«..."
                        className="w-full pr-9 pl-3 py-2 border border-slate-200 rounded-lg text-xs focus:border-amber-400 focus:outline-none" />
                    </div>
                    <div className="space-y-1.5 max-h-36 overflow-y-auto">
                      {RISKS.slice(0, 10).map(risk => (
                        <button key={risk.id} type="button" onClick={() => setFormData({ ...formData, riskId: formData.riskId === risk.id ? null : risk.id })}
                          className={`w-full flex items-center gap-2 p-2.5 rounded-lg border transition-all text-right ${formData.riskId === risk.id ? 'border-amber-500 bg-amber-100' : 'border-slate-200 bg-white hover:border-amber-300'
                            }`}>
                          <div className={`w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0 ${formData.riskId === risk.id ? 'bg-amber-500 text-white' : 'bg-amber-100 text-amber-600'}`}>
                            {formData.riskId === risk.id ? <CheckCircle2 className="w-4 h-4" /> : <AlertTriangle className="w-4 h-4" />}
                          </div>
                          <div className="flex-1 min-w-0">
                            <span className="font-mono text-xs font-bold text-amber-600">{risk.code}</span>
                            <p className="text-xs text-slate-600 truncate">{risk.title}</p>
                          </div>
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• POLICY SELECTION â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                  <div className="bg-purple-50/50 rounded-xl p-4 border border-purple-200">
                    <label className="flex items-center justify-between mb-3">
                      <div className="flex items-center gap-2">
                        <span className="w-6 h-6 rounded-lg bg-purple-500 text-white flex items-center justify-center text-xs font-bold">4</span>
                        <BookOpen className="w-4 h-4 text-purple-600" />
                        <span className="text-sm font-bold text-slate-700">Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</span>
                      </div>
                      {formData.policyId && (
                        <span className="px-2 py-0.5 bg-purple-500 text-white rounded text-xs font-bold">ØªÙ… Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</span>
                      )}
                    </label>
                    <div className="relative mb-2">
                      <Search className="absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400" />
                      <input type="text" placeholder="Ø§Ø¨Ø­Ø«..."
                        className="w-full pr-9 pl-3 py-2 border border-slate-200 rounded-lg text-xs focus:border-purple-400 focus:outline-none" />
                    </div>
                    <div className="space-y-1.5 max-h-36 overflow-y-auto">
                      {POLICIES.slice(0, 10).map(policy => (
                        <button key={policy.id} type="button" onClick={() => setFormData({ ...formData, policyId: formData.policyId === policy.id ? null : policy.id })}
                          className={`w-full flex items-center gap-2 p-2.5 rounded-lg border transition-all text-right ${formData.policyId === policy.id ? 'border-purple-500 bg-purple-100' : 'border-slate-200 bg-white hover:border-purple-300'
                            }`}>
                          <div className={`w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0 ${formData.policyId === policy.id ? 'bg-purple-500 text-white' : 'bg-purple-100 text-purple-600'}`}>
                            {formData.policyId === policy.id ? <CheckCircle2 className="w-4 h-4" /> : <BookOpen className="w-4 h-4" />}
                          </div>
                          <div className="flex-1 min-w-0">
                            <div className="flex items-center gap-1">
                              <span className="font-mono text-xs font-bold text-purple-600">{policy.code}</span>
                              <span className="text-xs px-1 py-0.5 bg-purple-200 text-purple-700 rounded">{policy.type === 'Standard' ? 'Ù…Ø¹ÙŠØ§Ø±' : policy.type === 'Procedure' ? 'Ø¥Ø¬Ø±Ø§Ø¡' : 'Ø³ÙŠØ§Ø³Ø©'}</span>
                            </div>
                            <p className="text-xs text-slate-600 truncate">{policy.title}</p>
                          </div>
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COVERAGE & NOTES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
                  <div className="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-slate-500 text-white flex items-center justify-center text-xs font-bold">5</span>
                      Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØºØ·ÙŠØ© ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
                    </label>

                    {/* Coverage Level */}
                    <div className="grid grid-cols-3 gap-2 mb-3">
                      {[
                        { value: 'Full', label: 'ÙƒØ§Ù…Ù„Ø©', icon: CheckCircle2, color: 'emerald', desc: '100%' },
                        { value: 'Partial', label: 'Ø¬Ø²Ø¦ÙŠØ©', icon: Clock, color: 'amber', desc: '50%' },
                        { value: 'None', label: 'Ø¨Ø¯ÙˆÙ†', icon: XCircle, color: 'red', desc: '0%' }
                      ].map(opt => (
                        <button key={opt.value} type="button" onClick={() => setFormData({ ...formData, coverageLevel: opt.value })}
                          className={`flex flex-col items-center gap-1 p-2.5 rounded-xl border-2 transition-all ${formData.coverageLevel === opt.value
                              ? `border-${opt.color}-500 bg-${opt.color}-100`
                              : 'border-slate-200 bg-white hover:border-slate-300'
                            }`}>
                          <opt.icon className={`w-5 h-5 ${formData.coverageLevel === opt.value ? `text-${opt.color}-600` : 'text-slate-400'}`} />
                          <span className={`text-xs font-bold ${formData.coverageLevel === opt.value ? `text-${opt.color}-700` : 'text-slate-500'}`}>{opt.label}</span>
                          <span className={`text-xs ${formData.coverageLevel === opt.value ? `text-${opt.color}-600` : 'text-slate-400'}`}>{opt.desc}</span>
                        </button>
                      ))}
                    </div>

                    {/* Effectiveness */}
                    <div className="mb-3">
                      <label className="block text-xs font-bold text-slate-600 mb-1.5">ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¶Ø§Ø¨Ø·</label>
                      <div className="flex gap-2">
                        {['Effective', 'PartiallyEffective', 'Ineffective'].map(eff => (
                          <button key={eff} type="button" onClick={() => setFormData({ ...formData, effectiveness: eff })}
                            className={`flex-1 py-2 px-2 rounded-lg text-xs font-bold transition-all ${formData.effectiveness === eff
                                ? eff === 'Effective' ? 'bg-emerald-500 text-white' : eff === 'PartiallyEffective' ? 'bg-amber-500 text-white' : 'bg-red-500 text-white'
                                : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                              }`}>
                            {eff === 'Effective' ? 'ÙØ¹Ø§Ù„' : eff === 'PartiallyEffective' ? 'Ø¬Ø²Ø¦ÙŠ' : 'ØºÙŠØ± ÙØ¹Ø§Ù„'}
                          </button>
                        ))}
                      </div>
                    </div>

                    {/* Notes */}
                    <div>
                      <label className="block text-xs font-bold text-slate-600 mb-1.5">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                      <textarea value={formData.notes || ''} onChange={(e) => setFormData({ ...formData, notes: e.target.value })} rows={2}
                        className="w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:border-emerald-500 resize-none text-xs"
                        placeholder="Ø£Ø¶Ù Ù…Ù„Ø§Ø­Ø¸Ø§Øª..." />
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            <div className="border-t border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between">
              <div className="flex items-center gap-4">
                <button onClick={handleCloseForm} className="px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all text-sm">
                  Ø¥Ù„ØºØ§Ø¡
                </button>
                {/* Quick Stats */}
                <div className="flex items-center gap-2 text-xs text-slate-500">
                  {(selectedObligation || formData.obligationId) && <span className="flex items-center gap-1 px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg"><FileText className="w-3.5 h-3.5" /> Ø§Ù„ØªØ²Ø§Ù…</span>}
                  {formData.controlId && <span className="flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded-lg"><Shield className="w-3.5 h-3.5" /> Ø¶Ø§Ø¨Ø·</span>}
                  {formData.riskId && <span className="flex items-center gap-1 px-2 py-1 bg-amber-100 text-amber-700 rounded-lg"><AlertTriangle className="w-3.5 h-3.5" /> Ø®Ø·Ø±</span>}
                  {formData.policyId && <span className="flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 rounded-lg"><BookOpen className="w-3.5 h-3.5" /> Ø³ÙŠØ§Ø³Ø©</span>}
                </div>
              </div>
              <button
                onClick={handleSaveForm}
                disabled={!formData.controlId || (!selectedObligation && !formData.obligationId)}
                className={`flex items-center gap-2 px-6 py-2.5 text-white rounded-xl font-bold shadow-lg transition-all text-sm ${!formData.controlId || (!selectedObligation && !formData.obligationId)
                    ? 'bg-slate-300 cursor-not-allowed'
                    : formMode === 'edit'
                      ? 'bg-gradient-to-r from-blue-500 to-indigo-600 hover:shadow-xl'
                      : 'bg-gradient-to-r from-emerald-500 to-teal-600 hover:shadow-xl'
                  }`}>
                <Save className="w-4 h-4" />
                {formMode === 'edit' ? 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø¨Ø·'}
                <ChevronLeft className="w-4 h-4" />
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• VIEW DETAILS MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showViewModal && selectedObligation && (
        <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden">
            <div className="bg-gradient-to-l from-slate-600 to-slate-800 px-6 py-5 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                    <Eye className="w-6 h-6" />
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</h2>
                    <p className="text-slate-300 text-sm">{selectedObligation.code}</p>
                  </div>
                </div>
                <button onClick={() => setShowViewModal(false)} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>

            <div className="p-6 space-y-5 max-h-[70vh] overflow-y-auto">
              <div className="bg-slate-50 rounded-xl p-4">
                <h3 className="font-bold text-slate-800 mb-2">{selectedObligation.title}</h3>
                <p className="text-slate-600 text-sm">{selectedObligation.statement}</p>
              </div>

              <div className="grid grid-cols-3 gap-4">
                <div className="bg-blue-50 rounded-xl p-4 text-center">
                  <Shield className="w-8 h-8 text-blue-600 mx-auto mb-2" />
                  <p className="text-2xl font-bold text-blue-600">{selectedObligation.controlCount}</p>
                  <p className="text-sm text-blue-700">Ø¶ÙˆØ§Ø¨Ø· Ù…Ø±ØªØ¨Ø·Ø©</p>
                </div>
                <div className="bg-amber-50 rounded-xl p-4 text-center">
                  <AlertTriangle className="w-8 h-8 text-amber-600 mx-auto mb-2" />
                  <p className="text-2xl font-bold text-amber-600">{selectedObligation.riskCount}</p>
                  <p className="text-sm text-amber-700">Ù…Ø®Ø§Ø·Ø± Ù…Ø±ØªØ¨Ø·Ø©</p>
                </div>
                <div className="bg-purple-50 rounded-xl p-4 text-center">
                  <FileText className="w-8 h-8 text-purple-600 mx-auto mb-2" />
                  <p className="text-2xl font-bold text-purple-600">{selectedObligation.policies?.length || 0}</p>
                  <p className="text-sm text-purple-700">Ø³ÙŠØ§Ø³Ø§Øª Ù…Ø±ØªØ¨Ø·Ø©</p>
                </div>
              </div>

              {selectedObligation.controls?.length > 0 && (
                <div>
                  <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                    <Shield className="w-5 h-5 text-blue-600" />
                    Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
                  </h4>
                  <div className="space-y-2">
                    {selectedObligation.controls.map(ctrl => (
                      <div key={ctrl.id} className="flex items-center justify-between p-3 bg-blue-50 rounded-xl">
                        <div className="flex items-center gap-3">
                          <span className="px-2.5 py-1 bg-blue-500 text-white rounded-lg text-xs font-bold">{ctrl.code}</span>
                          <span className="text-sm text-slate-700">{ctrl.title}</span>
                        </div>
                        <span className={`px-2.5 py-1 rounded-lg text-xs font-bold ${ctrl.effectiveness === 'Effective' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
                          {ctrl.effectiveness === 'Effective' ? 'ÙØ¹Ø§Ù„' : 'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†'}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowViewModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥ØºÙ„Ø§Ù‚</button>
              <div className="flex items-center gap-3">
                <button onClick={() => { setShowViewModal(false); handleEditMapping(selectedObligation, selectedObligation.mappings?.[0]); }} className="flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl font-bold hover:bg-blue-600">
                  <Edit className="w-5 h-5" />
                  ØªØ¹Ø¯ÙŠÙ„
                </button>
                <button onClick={() => { setShowViewModal(false); handleAddMapping(selectedObligation); }} className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold">
                  <Plus className="w-5 h-5" />
                  Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø·
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.4: ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ© (Compliance Calendar)
// Production-Ready Implementation - Beyond SAP GRC, MetricStream, ServiceNow GRC
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATA MODELS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const OBLIGATION_SCHEDULES = [
  { id: 1, obligationId: 1, frequency: 'Monthly', dueRule: { type: 'EndOfMonth', offset: 0 }, gracePeriodDays: 5, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 365, escalationPolicyId: 1, status: 'Active', createdAt: '2024-01-01' },
  { id: 2, obligationId: 2, frequency: 'Monthly', dueRule: { type: 'FixedDay', day: 25 }, gracePeriodDays: 3, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 180, escalationPolicyId: 2, status: 'Active', createdAt: '2024-01-01' },
  { id: 3, obligationId: 5, frequency: 'Quarterly', dueRule: { type: 'EndOfQuarter', offset: 15 }, gracePeriodDays: 10, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 365, escalationPolicyId: 1, status: 'Active', createdAt: '2024-01-01' },
  { id: 4, obligationId: 7, frequency: 'Monthly', dueRule: { type: 'FixedDay', day: 20 }, gracePeriodDays: 5, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 90, escalationPolicyId: 3, status: 'Active', createdAt: '2024-01-01' },
  { id: 5, obligationId: 3, frequency: 'Quarterly', dueRule: { type: 'EndOfQuarter', offset: 0 }, gracePeriodDays: 7, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 365, escalationPolicyId: 1, status: 'Active', createdAt: '2024-01-01' },
  { id: 6, obligationId: 10, frequency: 'Annual', dueRule: { type: 'FixedDate', month: 1, day: 28 }, gracePeriodDays: 14, autoGenerate: true, evidenceRequired: true, evidenceValidityDays: 365, escalationPolicyId: 2, status: 'Active', createdAt: '2024-01-01' },
];

const ESCALATION_POLICIES = [
  {
    id: 1, name: 'Standard', levels: [
      { days: 3, action: 'Reminder', notifyRole: 'Owner' },
      { days: 7, action: 'Escalate', notifyRole: 'Manager' },
      { days: 14, action: 'CreateBreach', notifyRole: 'ComplianceHead' },
    ]
  },
  {
    id: 2, name: 'Critical', levels: [
      { days: 1, action: 'Reminder', notifyRole: 'Owner' },
      { days: 3, action: 'Escalate', notifyRole: 'Manager' },
      { days: 7, action: 'CreateBreach', notifyRole: 'ComplianceHead' },
      { days: 10, action: 'RegulatoryAlert', notifyRole: 'CEO' },
    ]
  },
  {
    id: 3, name: 'Flexible', levels: [
      { days: 5, action: 'Reminder', notifyRole: 'Owner' },
      { days: 14, action: 'Escalate', notifyRole: 'Manager' },
    ]
  },
];

const COMPLIANCE_TASKS = [
  { id: 1, scheduleId: 1, obligationId: 1, obligationCode: 'OBL-001', title: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ', period: '2025-01', periodType: 'Monthly', dueDate: '2025-01-31', graceEndDate: '2025-02-05', breachTriggerDate: '2025-02-05', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', reviewerId: 2, reviewerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', status: 'InProgress', priority: 'High', authority: 'SAMA', evidenceRequired: true, evidenceStatus: 'Uploaded', submittedAt: null, completedAt: null, escalationLevel: 0, extensionRequested: false },
  { id: 2, scheduleId: 2, obligationId: 2, obligationCode: 'OBL-002', title: 'ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', period: '2025-01', periodType: 'Monthly', dueDate: '2025-01-25', graceEndDate: '2025-01-28', breachTriggerDate: '2025-01-28', ownerId: 2, ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', reviewerId: 3, reviewerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', status: 'Overdue', priority: 'Critical', authority: 'SAMA', evidenceRequired: true, evidenceStatus: 'UnderReview', submittedAt: null, completedAt: null, escalationLevel: 2, extensionRequested: true },
  { id: 3, scheduleId: 3, obligationId: 5, obligationCode: 'OBL-005', title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø®Ø·Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', period: '2025-Q1', periodType: 'Quarterly', dueDate: '2025-02-15', graceEndDate: '2025-02-25', breachTriggerDate: '2025-02-25', ownerId: 3, ownerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', status: 'Open', priority: 'Medium', authority: 'NCA', evidenceRequired: true, evidenceStatus: 'PendingUpload', submittedAt: null, completedAt: null, escalationLevel: 0, extensionRequested: false },
  { id: 4, scheduleId: 4, obligationId: 7, obligationCode: 'OBL-007', title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©', period: '2025-01', periodType: 'Monthly', dueDate: '2025-01-20', graceEndDate: '2025-01-25', breachTriggerDate: '2025-01-25', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', reviewerId: 2, reviewerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', status: 'Completed', priority: 'High', authority: 'NCA', evidenceRequired: true, evidenceStatus: 'Accepted', submittedAt: '2025-01-18', completedAt: '2025-01-19', escalationLevel: 0, extensionRequested: false },
  { id: 5, scheduleId: 5, obligationId: 3, obligationCode: 'OBL-003', title: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', period: '2025-Q1', periodType: 'Quarterly', dueDate: '2025-03-31', graceEndDate: '2025-04-07', breachTriggerDate: '2025-04-07', ownerId: 2, ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', reviewerId: 3, reviewerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', status: 'Open', priority: 'High', authority: 'SAMA', evidenceRequired: true, evidenceStatus: 'PendingUpload', submittedAt: null, completedAt: null, escalationLevel: 0, extensionRequested: false },
  { id: 6, scheduleId: 6, obligationId: 10, obligationCode: 'OBL-010', title: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', period: '2025', periodType: 'Annual', dueDate: '2025-01-28', graceEndDate: '2025-02-11', breachTriggerDate: '2025-02-11', ownerId: 3, ownerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', status: 'Submitted', priority: 'Medium', authority: 'NDMO', evidenceRequired: true, evidenceStatus: 'UnderReview', submittedAt: '2025-01-25', completedAt: null, escalationLevel: 0, extensionRequested: false },
  { id: 7, scheduleId: 1, obligationId: 1, obligationCode: 'OBL-001', title: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ - ÙØ¨Ø±Ø§ÙŠØ±', period: '2025-02', periodType: 'Monthly', dueDate: '2025-02-28', graceEndDate: '2025-03-05', breachTriggerDate: '2025-03-05', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', reviewerId: 2, reviewerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', status: 'Open', priority: 'High', authority: 'SAMA', evidenceRequired: true, evidenceStatus: 'PendingUpload', submittedAt: null, completedAt: null, escalationLevel: 0, extensionRequested: false },
  { id: 8, scheduleId: 2, obligationId: 2, obligationCode: 'OBL-002', title: 'ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - ÙØ¨Ø±Ø§ÙŠØ±', period: '2025-02', periodType: 'Monthly', dueDate: '2025-02-25', graceEndDate: '2025-02-28', breachTriggerDate: '2025-02-28', ownerId: 2, ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', reviewerId: 3, reviewerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', status: 'Rejected', priority: 'Critical', authority: 'SAMA', evidenceRequired: true, evidenceStatus: 'Rejected', submittedAt: '2025-02-20', completedAt: null, escalationLevel: 0, extensionRequested: false, rejectReason: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙ‚ ØºÙŠØ± Ù…ÙƒØªÙ…Ù„ - ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' },
  { id: 9, scheduleId: 4, obligationId: 7, obligationCode: 'OBL-007', title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ - ÙØ¨Ø±Ø§ÙŠØ±', period: '2025-02', periodType: 'Monthly', dueDate: '2025-02-20', graceEndDate: '2025-02-25', breachTriggerDate: '2025-02-25', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', reviewerId: 2, reviewerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', status: 'InProgress', priority: 'High', authority: 'NCA', evidenceRequired: true, evidenceStatus: 'Expired', submittedAt: null, completedAt: null, escalationLevel: 1, extensionRequested: false },
];

const TASK_EVIDENCE = [
  { id: 1, taskId: 1, fileName: 'ØªÙ‚Ø±ÙŠØ±_AML_ÙŠÙ†Ø§ÙŠØ±_Ù…Ø³ÙˆØ¯Ø©.docx', fileSize: '1.8 MB', fileType: 'docx', uploaderId: 1, uploaderName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', uploadedAt: '2025-01-25', status: 'Pending', expiresAt: '2026-01-25', reviewerId: null, reviewedAt: null, rejectComment: null },
  { id: 2, taskId: 2, fileName: 'Ù‚Ø§Ø¦Ù…Ø©_Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡_Ø¹Ø§Ù„ÙŠØ©_Ø§Ù„Ù…Ø®Ø§Ø·Ø±.xlsx', fileSize: '2.4 MB', fileType: 'xlsx', uploaderId: 2, uploaderName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', uploadedAt: '2025-01-20', status: 'Pending', expiresAt: '2025-07-20', reviewerId: null, reviewedAt: null, rejectComment: null },
  { id: 3, taskId: 4, fileName: 'Ø³Ø¬Ù„_Ø§Ù„ÙˆØµÙˆÙ„_ÙŠÙ†Ø§ÙŠØ±.pdf', fileSize: '5.1 MB', fileType: 'pdf', uploaderId: 1, uploaderName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', uploadedAt: '2025-01-18', status: 'Approved', expiresAt: '2025-04-18', reviewerId: 2, reviewedAt: '2025-01-19', rejectComment: null },
  { id: 4, taskId: 6, fileName: 'Ø³ÙŠØ§Ø³Ø©_PDPL_v2.pdf', fileSize: '3.2 MB', fileType: 'pdf', uploaderId: 3, uploaderName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', uploadedAt: '2025-01-22', status: 'Rejected', expiresAt: '2026-01-22', reviewerId: 1, reviewedAt: '2025-01-23', rejectComment: 'ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ« Ù‚Ø³Ù… Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©' },
  { id: 5, taskId: 6, fileName: 'Ø³ÙŠØ§Ø³Ø©_PDPL_v3_Ù…Ø¹Ø¯Ù„Ø©.pdf', fileSize: '3.5 MB', fileType: 'pdf', uploaderId: 3, uploaderName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', uploadedAt: '2025-01-24', status: 'Pending', expiresAt: '2026-01-24', reviewerId: null, reviewedAt: null, rejectComment: null },
  { id: 6, taskId: 3, fileName: 'Ø®Ø·Ø©_BCP_2025.pdf', fileSize: '8.2 MB', fileType: 'pdf', uploaderId: 3, uploaderName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', uploadedAt: '2025-01-10', status: 'Approved', expiresAt: '2026-01-10', reviewerId: 1, reviewedAt: '2025-01-11', rejectComment: null },
];

const REGULATORY_EVENTS = [
  { id: 1, title: 'Ø²ÙŠØ§Ø±Ø© ØªÙØªÙŠØ´ÙŠØ© Ù…Ù† SAMA', date: '2025-02-15', authority: 'SAMA', type: 'Inspection', status: 'Upcoming', impactedObligations: [1, 2, 3] },
  { id: 2, title: 'Ù…ÙˆØ¹Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ', date: '2025-03-31', authority: 'SAMA', type: 'Reporting', status: 'Upcoming', impactedObligations: [3, 4] },
  { id: 3, title: 'ØªØ­Ø¯ÙŠØ« Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', date: '2025-02-01', authority: 'NCA', type: 'Update', status: 'Active', impactedObligations: [5, 7, 8] },
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOCK API SIGNATURES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const ComplianceAPI = {
  // GET /compliance/tasks?filter=...
  getTasks: async (filter) => ({ data: COMPLIANCE_TASKS.filter(t => !filter || t.status === filter), total: COMPLIANCE_TASKS.length }),

  // GET /compliance/calendar/summary
  getCalendarSummary: async () => ({
    dueThisMonth: COMPLIANCE_TASKS.filter(t => t.dueDate.startsWith('2025-01') && t.status !== 'Completed').length,
    overdue: COMPLIANCE_TASKS.filter(t => t.status === 'Overdue').length,
    evidencePending: TASK_EVIDENCE.filter(e => e.status === 'Pending').length,
    expiringEvidence: TASK_EVIDENCE.filter(e => { const d = new Date(e.expiresAt); const now = new Date(); return (d - now) / (1000 * 60 * 60 * 24) <= 30; }).length,
    highRiskOverdue: COMPLIANCE_TASKS.filter(t => t.status === 'Overdue' && t.priority === 'Critical').length,
  }),

  // POST /obligations/:id/schedules
  createSchedule: async (obligationId, scheduleData) => ({ success: true, scheduleId: Date.now() }),

  // GET /schedules/:id/tasks
  getScheduleTasks: async (scheduleId) => ({ data: COMPLIANCE_TASKS.filter(t => t.scheduleId === scheduleId) }),

  // POST /tasks/:id/evidence
  uploadEvidence: async (taskId, file) => ({ success: true, evidenceId: Date.now() }),

  // POST /tasks/:id/submit
  submitTask: async (taskId) => ({ success: true }),

  // GET /evidence/review-queue
  getEvidenceReviewQueue: async () => ({ data: TASK_EVIDENCE.filter(e => e.status === 'Pending') }),

  // POST /evidence/:id/approve
  approveEvidence: async (evidenceId, reviewerId) => ({ success: true }),

  // POST /evidence/:id/reject
  rejectEvidence: async (evidenceId, reviewerId, comment) => ({ success: comment.length >= 20 }),

  // POST /tasks/:id/escalate
  escalateTask: async (taskId) => ({ success: true }),
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// VALIDATION HELPERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const buildDueDateFromRule = (rule, period) => {
  const [year, periodPart] = period.split('-');
  let date = new Date();

  switch (rule.type) {
    case 'EndOfMonth': {
      const month = parseInt(periodPart) - 1;
      date = new Date(year, month + 1, 0);
      date.setDate(date.getDate() + (rule.offset || 0));
      break;
    }
    case 'FixedDay': {
      const month = parseInt(periodPart) - 1;
      date = new Date(year, month, rule.day);
      break;
    }
    case 'EndOfQuarter': {
      const quarter = parseInt(periodPart.replace('Q', ''));
      const lastMonth = quarter * 3;
      date = new Date(year, lastMonth, 0);
      date.setDate(date.getDate() + (rule.offset || 0));
      break;
    }
    case 'FixedDate': {
      date = new Date(year, rule.month - 1, rule.day);
      break;
    }
    default:
      break;
  }

  return date.toISOString().split('T')[0];
};

const canSubmitTask = (task, evidenceList) => {
  if (!task.evidenceRequired) return true;
  const taskEvidence = evidenceList.filter(e => e.taskId === task.id);
  const hasApprovedOrPending = taskEvidence.some(e => e.status === 'Approved' || e.status === 'Pending');
  return hasApprovedOrPending;
};

const canApproveEvidence = (evidence, reviewerId) => {
  // SoD: reviewer cannot be the uploader
  if (evidence.uploaderId === reviewerId) return { allowed: false, reason: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø±Ø§ÙØ¹ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¯Ù„ÙŠÙ„Ù‡ - ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (SoD)' };
  return { allowed: true, reason: null };
};

const getDaysUntilDue = (dueDate) => {
  const due = new Date(dueDate);
  const now = new Date();
  return Math.ceil((due - now) / (1000 * 60 * 60 * 24));
};

const getTasksByTab = (tasks, tab, currentUserId = 1) => {
  const now = new Date();
  switch (tab) {
    case 'myTasks': return tasks.filter(t => t.ownerId === currentUserId && !['Completed', 'Submitted'].includes(t.status));
    case 'dueSoon': return tasks.filter(t => getDaysUntilDue(t.dueDate) <= 7 && getDaysUntilDue(t.dueDate) > 0 && t.status !== 'Completed');
    case 'overdue': return tasks.filter(t => t.status === 'Overdue' || getDaysUntilDue(t.dueDate) < 0);
    case 'submitted': return tasks.filter(t => t.status === 'Submitted');
    case 'rejected': return tasks.filter(t => t.status === 'Rejected');
    default: return tasks;
  }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// COMPLIANCE CALENDAR COMPONENT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.4: ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ© - World-Class Edition
// Compliance Calendar & Regulatory Obligations Scheduler
// Features: Task Inbox, Calendar Views, Gantt Chart, Evidence Review, 
//           Escalation Engine, Inspection Readiness Dashboard
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ComplianceCalendar = () => {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // STATE MANAGEMENT
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [activeTab, setActiveTab] = useState('inbox');
  const [calendarView, setCalendarView] = useState('month');
  const [currentDate, setCurrentDate] = useState(new Date());
  const [selectedTask, setSelectedTask] = useState(null);
  const [showTaskModal, setShowTaskModal] = useState(false);
  const [showEvidenceModal, setShowEvidenceModal] = useState(false);
  const [showEscalationModal, setShowEscalationModal] = useState(false);
  const [showDelegationModal, setShowDelegationModal] = useState(false);
  const [showBulkModal, setShowBulkModal] = useState(false);
  const [showScheduleSetup, setShowScheduleSetup] = useState(false);
  const [scheduleForm, setScheduleForm] = useState({
    obligationId: '', frequency: 'Monthly', startDate: '', endDate: '',
    ownerId: '', reviewerId: '', reminderDays: 7, autoGenerate: true,
    graceperiodDays: 3, escalationEnabled: true, escalationDays: 2
  });
  const [selectedTasks, setSelectedTasks] = useState([]);
  const [filterAuthority, setFilterAuthority] = useState('');
  const [filterPriority, setFilterPriority] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterOwner, setFilterOwner] = useState('');
  const [searchQuery, setSearchQuery] = useState('');
  const [ganttZoom, setGanttZoom] = useState('month');

  // Current User
  const CURRENT_USER = { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // SAMPLE DATA - TASKS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [tasks, setTasks] = useState([
    {
      id: 1, code: 'OBL-001', title: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ',
      description: 'Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨',
      authorityId: 1, authorityCode: 'SAMA', frameworkCode: 'SAMA-AML',
      obligationRef: 'SAMA-AML-3.1', controlRef: 'CTRL-001',
      ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯',
      priority: 'High', frequency: 'Monthly',
      period: 'ÙŠÙ†Ø§ÙŠØ± 2025', periodKey: '2025-01',
      dueDate: '2025-01-31', gracePeriodEnd: '2025-02-05', violationDate: '2025-02-05',
      status: 'InProgress', evidenceStatus: 'Uploaded',
      evidenceId: 1, evidenceFileName: 'aml_report_jan.pdf',
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['AML', 'Monthly', 'Critical'],
      createdAt: '2025-01-01', updatedAt: '2025-01-28'
    },
    {
      id: 2, code: 'OBL-002', title: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ - ÙØ¨Ø±Ø§ÙŠØ±',
      description: 'Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù…ÙƒØ§ÙØ­Ø© ØºØ³ÙŠÙ„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
      authorityId: 1, authorityCode: 'SAMA', frameworkCode: 'SAMA-AML',
      obligationRef: 'SAMA-AML-3.1', controlRef: 'CTRL-001',
      ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯',
      priority: 'High', frequency: 'Monthly',
      period: 'ÙØ¨Ø±Ø§ÙŠØ± 2025', periodKey: '2025-02',
      dueDate: '2025-02-28', gracePeriodEnd: '2025-03-05', violationDate: '2025-03-05',
      status: 'Open', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [1], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['AML', 'Monthly', 'Critical'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
    {
      id: 3, code: 'OBL-007', title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ - ÙØ¨Ø±Ø§ÙŠØ±',
      description: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©',
      authorityId: 3, authorityCode: 'NCA', frameworkCode: 'NCA-ECC',
      obligationRef: 'NCA-ECC-3.1', controlRef: 'CTRL-005',
      ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      reviewerId: 3, reviewerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ',
      priority: 'High', frequency: 'Monthly',
      period: 'ÙØ¨Ø±Ø§ÙŠØ± 2025', periodKey: '2025-02',
      dueDate: '2025-02-20', gracePeriodEnd: '2025-02-25', violationDate: '2025-02-25',
      status: 'InProgress', evidenceStatus: 'Expired',
      evidenceId: 3, evidenceFileName: 'access_logs_feb.xlsx',
      escalationLevel: 1, escalationHistory: [{ level: 1, date: '2025-02-21', to: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' }],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['NCA', 'Security', 'Monthly'],
      createdAt: '2025-02-01', updatedAt: '2025-02-21'
    },
    {
      id: 4, code: 'OBL-010', title: 'ØªÙ‚Ø±ÙŠØ± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ',
      description: 'Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ Ø¹Ù† Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
      authorityId: 4, authorityCode: 'SDAIA', frameworkCode: 'SDAIA-PDPL',
      obligationRef: 'PDPL-2.1', controlRef: 'CTRL-008',
      ownerId: 4, ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ',
      reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      priority: 'Medium', frequency: 'Quarterly',
      period: 'Q1-2025', periodKey: 'Q1-2025',
      dueDate: '2025-03-31', gracePeriodEnd: '2025-04-07', violationDate: '2025-04-07',
      status: 'Open', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['PDPL', 'Quarterly', 'Privacy'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
    {
      id: 5, code: 'OBL-015', title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø³Ù†ÙˆÙŠ',
      description: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø®ØªØ±Ø§Ù‚ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©',
      authorityId: 3, authorityCode: 'NCA', frameworkCode: 'NCA-ECC',
      obligationRef: 'NCA-ECC-4.1', controlRef: 'CTRL-010',
      ownerId: 3, ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ',
      reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      priority: 'Critical', frequency: 'Yearly',
      period: '2025', periodKey: '2025',
      dueDate: '2025-06-30', gracePeriodEnd: '2025-07-15', violationDate: '2025-07-15',
      status: 'NotStarted', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: 'ÙŠØªØ·Ù„Ø¨ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ù…Ø²ÙˆØ¯ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ', tags: ['NCA', 'PenTest', 'Annual', 'Critical'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
    {
      id: 6, code: 'OBL-003', title: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ',
      description: 'Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª',
      authorityId: 2, authorityCode: 'CMA', frameworkCode: 'CMA-CGR',
      obligationRef: 'CMA-CGR-1.1', controlRef: 'CTRL-003',
      ownerId: 5, ownerName: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ',
      reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      priority: 'High', frequency: 'Quarterly',
      period: 'Q1-2025', periodKey: 'Q1-2025',
      dueDate: '2025-03-15', gracePeriodEnd: '2025-03-20', violationDate: '2025-03-20',
      status: 'InProgress', evidenceStatus: 'Uploaded',
      evidenceId: 5, evidenceFileName: 'governance_q1.pdf',
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['CMA', 'Governance', 'Quarterly'],
      createdAt: '2025-01-01', updatedAt: '2025-02-28'
    },
    {
      id: 7, code: 'OBL-020', title: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      description: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© ÙˆØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      authorityId: 3, authorityCode: 'NCA', frameworkCode: 'NCA-ECC',
      obligationRef: 'NCA-ECC-1.1', controlRef: 'CTRL-001',
      ownerId: 3, ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ',
      reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      priority: 'High', frequency: 'Yearly',
      period: '2025', periodKey: '2025',
      dueDate: '2025-04-30', gracePeriodEnd: '2025-05-15', violationDate: '2025-05-15',
      status: 'InProgress', evidenceStatus: 'UnderReview',
      evidenceId: 7, evidenceFileName: 'cyber_policy_v2.pdf',
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['NCA', 'Policy', 'Annual'],
      createdAt: '2025-01-01', updatedAt: '2025-03-01'
    },
    {
      id: 8, code: 'OBL-025', title: 'ØªØ¯Ø±ÙŠØ¨ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ø³Ù†ÙˆÙŠ',
      description: 'ØªÙ†ÙÙŠØ° Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
      authorityId: 1, authorityCode: 'SAMA', frameworkCode: 'SAMA-AML',
      obligationRef: 'SAMA-AML-4.1', controlRef: 'CTRL-012',
      ownerId: 2, ownerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯',
      reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      priority: 'Medium', frequency: 'Yearly',
      period: '2025', periodKey: '2025',
      dueDate: '2025-12-31', gracePeriodEnd: '2026-01-15', violationDate: '2026-01-15',
      status: 'NotStarted', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['SAMA', 'Training', 'Annual'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
    {
      id: 9, code: 'OBL-030', title: 'Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ø§Ù„Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ',
      description: 'Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø¥Ù‚Ø±Ø§Ø± Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©',
      authorityId: 5, authorityCode: 'ZATCA', frameworkCode: 'ZATCA-VAT',
      obligationRef: 'VAT-1.1', controlRef: 'CTRL-015',
      ownerId: 6, ownerName: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ',
      reviewerId: 5, reviewerName: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ',
      priority: 'Critical', frequency: 'Quarterly',
      period: 'Q1-2025', periodKey: 'Q1-2025',
      dueDate: '2025-04-30', gracePeriodEnd: '2025-05-05', violationDate: '2025-05-05',
      status: 'Open', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: '', tags: ['ZATCA', 'VAT', 'Quarterly', 'Critical'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
    {
      id: 10, code: 'OBL-035', title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®Ø·Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„',
      description: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© Ù„Ø®Ø·Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ§Ù„ØªØ¹Ø§ÙÙŠ Ù…Ù† Ø§Ù„ÙƒÙˆØ§Ø±Ø«',
      authorityId: 1, authorityCode: 'SAMA', frameworkCode: 'SAMA-BCM',
      obligationRef: 'BCM-2.1', controlRef: 'CTRL-020',
      ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',
      reviewerId: 3, reviewerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ',
      priority: 'High', frequency: 'Yearly',
      period: '2025', periodKey: '2025',
      dueDate: '2025-09-30', gracePeriodEnd: '2025-10-15', violationDate: '2025-10-15',
      status: 'NotStarted', evidenceStatus: 'PendingUpload',
      evidenceId: null, evidenceFileName: null,
      escalationLevel: 0, escalationHistory: [],
      dependencies: [5], blockedBy: [],
      completedDate: null, submittedDate: null,
      notes: 'ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', tags: ['SAMA', 'BCM', 'Annual'],
      createdAt: '2025-01-01', updatedAt: '2025-01-01'
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ESCALATION RULES
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const ESCALATION_RULES = [
    { level: 1, name: 'ØªÙ†Ø¨ÙŠÙ‡ Ø£ÙˆÙ„', daysBeforeDue: 7, notifyTo: 'Owner', action: 'Email' },
    { level: 2, name: 'ØªØµØ¹ÙŠØ¯ Ù„Ù„Ù…Ø¯ÙŠØ±', daysBeforeDue: 3, notifyTo: 'Manager', action: 'Email+SMS' },
    { level: 3, name: 'ØªØµØ¹ÙŠØ¯ Ù„Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ', daysAfterDue: 1, notifyTo: 'Executive', action: 'Email+SMS+Call' },
    { level: 4, name: 'ØªØµØ¹ÙŠØ¯ Ù„Ù„Ø¬Ù†Ø©', daysAfterDue: 3, notifyTo: 'Committee', action: 'Meeting' },
  ];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // INSPECTION CHECKLIST
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [inspectionChecklist, setInspectionChecklist] = useState([
    { id: 1, category: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', item: 'Ø³ÙŠØ§Ø³Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ù…Ø­Ø¯Ø«Ø©', completed: true, evidenceId: 1 },
    { id: 2, category: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', item: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ù…Ø¹ØªÙ…Ø¯Ø©', completed: true, evidenceId: 2 },
    { id: 3, category: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', item: 'Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø©', completed: false, evidenceId: null },
    { id: 4, category: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', item: 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù…ÙƒØªÙ…Ù„Ø©', completed: true, evidenceId: 3 },
    { id: 5, category: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', item: 'ØªÙ‚Ø§Ø±ÙŠØ± STR Ù…Ø±Ø³Ù„Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª', completed: true, evidenceId: 4 },
    { id: 6, category: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', item: 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ù…ÙˆØ«Ù‚Ø©', completed: false, evidenceId: null },
    { id: 7, category: 'Ø§Ù„ØªØ¯Ø±ÙŠØ¨', item: 'ØªØ¯Ø±ÙŠØ¨ AML Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯', completed: true, evidenceId: 5 },
    { id: 8, category: 'Ø§Ù„ØªØ¯Ø±ÙŠØ¨', item: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø§Ù„Ø³Ù†ÙˆÙŠ', completed: false, evidenceId: null },
    { id: 9, category: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø©', item: 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù…Ø­ÙÙˆØ¸Ø©', completed: true, evidenceId: 6 },
    { id: 10, category: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø©', item: 'Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ø®ØªØ¨Ø±Ø©', completed: true, evidenceId: 7 },
    { id: 11, category: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø©', item: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø®ØªØ±Ø§Ù‚ Ù…Ø­Ø¯Ø«', completed: false, evidenceId: null },
    { id: 12, category: 'Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', item: 'Ù…Ø­Ø§Ø¶Ø± Ù„Ø¬Ù†Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', completed: true, evidenceId: 8 },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // COMPUTED VALUES
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const today = new Date();
  const todayStr = today.toISOString().split('T')[0];

  const getDaysUntilDue = (dueDate) => {
    if (!dueDate) return null;
    const due = new Date(dueDate);
    return Math.ceil((due - today) / (1000 * 60 * 60 * 24));
  };

  const getTaskUrgency = (task) => {
    const days = getDaysUntilDue(task.dueDate);
    if (days === null) return 'normal';
    if (days < 0) return 'overdue';
    if (days <= 3) return 'critical';
    if (days <= 7) return 'urgent';
    if (days <= 14) return 'warning';
    return 'normal';
  };

  const stats = useMemo(() => {
    const overdue = tasks.filter(t => getDaysUntilDue(t.dueDate) < 0 && t.status !== 'Completed').length;
    const dueSoon = tasks.filter(t => {
      const days = getDaysUntilDue(t.dueDate);
      return days >= 0 && days <= 7 && t.status !== 'Completed';
    }).length;
    const inProgress = tasks.filter(t => t.status === 'InProgress').length;
    const pendingReview = tasks.filter(t => t.evidenceStatus === 'UnderReview').length;
    const completed = tasks.filter(t => t.status === 'Completed').length;
    const escalated = tasks.filter(t => t.escalationLevel > 0).length;
    const total = tasks.length;
    const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;

    return { overdue, dueSoon, inProgress, pendingReview, completed, escalated, total, completionRate };
  }, [tasks]);

  const filteredTasks = useMemo(() => {
    return tasks.filter(t => {
      const matchSearch = !searchQuery ||
        t.title?.toLowerCase().includes(searchQuery.toLowerCase()) ||
        t.code?.toLowerCase().includes(searchQuery.toLowerCase());
      const matchAuthority = !filterAuthority || t.authorityCode === filterAuthority;
      const matchPriority = !filterPriority || t.priority === filterPriority;
      const matchStatus = !filterStatus || t.status === filterStatus;
      const matchOwner = !filterOwner || t.ownerId === parseInt(filterOwner);
      return matchSearch && matchAuthority && matchPriority && matchStatus && matchOwner;
    });
  }, [tasks, searchQuery, filterAuthority, filterPriority, filterStatus, filterOwner]);

  const inspectionReadiness = useMemo(() => {
    const total = inspectionChecklist.length;
    const completed = inspectionChecklist.filter(i => i.completed).length;
    const percentage = Math.round((completed / total) * 100);
    const byCategory = {};
    inspectionChecklist.forEach(item => {
      if (!byCategory[item.category]) {
        byCategory[item.category] = { total: 0, completed: 0 };
      }
      byCategory[item.category].total++;
      if (item.completed) byCategory[item.category].completed++;
    });
    return { total, completed, percentage, byCategory };
  }, [inspectionChecklist]);


  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CONFIGURATIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const PRIORITY_CONFIG = {
    Critical: { label: 'Ø­Ø±Ø¬', color: 'red', bg: 'bg-red-100', text: 'text-red-700', border: 'border-red-300' },
    High: { label: 'Ø¹Ø§Ù„ÙŠ', color: 'orange', bg: 'bg-orange-100', text: 'text-orange-700', border: 'border-orange-300' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', color: 'amber', bg: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-300' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', color: 'green', bg: 'bg-green-100', text: 'text-green-700', border: 'border-green-300' },
  };

  const STATUS_CONFIG = {
    NotStarted: { label: 'Ù„Ù… ÙŠØ¨Ø¯Ø£', icon: Clock, bg: 'bg-slate-100', text: 'text-slate-600' },
    Open: { label: 'Ù…ÙØªÙˆØ­', icon: FolderOpen, bg: 'bg-blue-100', text: 'text-blue-700' },
    InProgress: { label: 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°', icon: Play, bg: 'bg-indigo-100', text: 'text-indigo-700' },
    UnderReview: { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: Eye, bg: 'bg-purple-100', text: 'text-purple-700' },
    Completed: { label: 'Ù…ÙƒØªÙ…Ù„', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
    Overdue: { label: 'Ù…ØªØ£Ø®Ø±', icon: AlertTriangle, bg: 'bg-red-100', text: 'text-red-700' },
  };

  const EVIDENCE_STATUS_CONFIG = {
    PendingUpload: { label: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ÙØ¹', icon: Upload, bg: 'bg-slate-100', text: 'text-slate-600' },
    Uploaded: { label: 'ØªÙ… Ø§Ù„Ø±ÙØ¹', icon: FileCheck, bg: 'bg-blue-100', text: 'text-blue-700' },
    UnderReview: { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: Eye, bg: 'bg-amber-100', text: 'text-amber-700' },
    Accepted: { label: 'Ù…Ù‚Ø¨ÙˆÙ„', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
    Rejected: { label: 'Ù…Ø±ÙÙˆØ¶', icon: XCircle, bg: 'bg-red-100', text: 'text-red-700' },
    Expired: { label: 'Ù…Ù†ØªÙ‡ÙŠ', icon: AlertTriangle, bg: 'bg-orange-100', text: 'text-orange-700' },
  };

  const AUTHORITY_COLORS = {
    SAMA: { bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700' },
    CMA: { bg: 'bg-blue-500', light: 'bg-blue-100', text: 'text-blue-700' },
    NCA: { bg: 'bg-purple-500', light: 'bg-purple-100', text: 'text-purple-700' },
    SDAIA: { bg: 'bg-indigo-500', light: 'bg-indigo-100', text: 'text-indigo-700' },
    ZATCA: { bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700' },
  };

  const FREQUENCY_CONFIG = {
    Daily: { label: 'ÙŠÙˆÙ…ÙŠ', days: 1 },
    Weekly: { label: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ', days: 7 },
    Monthly: { label: 'Ø´Ù‡Ø±ÙŠ', days: 30 },
    Quarterly: { label: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', days: 90 },
    Yearly: { label: 'Ø³Ù†ÙˆÙŠ', days: 365 },
  };

  const TEAM_MEMBERS = [
    { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer', avatar: 'Ø£' },
    { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', role: 'Evidence Reviewer', avatar: 'Ù' },
    { id: 3, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', role: 'IT Security', avatar: 'Ø®' },
    { id: 4, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'Data Protection', avatar: 'Ù†' },
    { id: 5, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'Governance', avatar: 'Ø³' },
    { id: 6, name: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ', role: 'Tax Compliance', avatar: 'Ù…' },
  ];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // HANDLERS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const handleUploadEvidence = (taskId) => {
    setTasks(tasks.map(t => t.id === taskId ? {
      ...t,
      evidenceStatus: 'Uploaded',
      evidenceFileName: 'evidence_' + Date.now() + '.pdf',
      updatedAt: todayStr
    } : t));
    alert('ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
  };

  const handleSubmitTask = (taskId) => {
    const task = tasks.find(t => t.id === taskId);
    if (!task) return;
    if (task.evidenceStatus !== 'Uploaded' && task.evidenceStatus !== 'Accepted') {
      alert('ÙŠØ¬Ø¨ Ø±ÙØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„');
      return;
    }
    setTasks(tasks.map(t => t.id === taskId ? {
      ...t,
      status: 'UnderReview',
      evidenceStatus: 'UnderReview',
      submittedDate: todayStr,
      updatedAt: todayStr
    } : t));
    alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  };

  const handleRequestExtension = (taskId) => {
    alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙ…Ø¯ÙŠØ¯. Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¯ÙŠØ±.');
  };

  const handleEscalate = (taskId, level) => {
    setTasks(tasks.map(t => {
      if (t.id === taskId) {
        const newHistory = [...t.escalationHistory, {
          level: level,
          date: todayStr,
          to: ESCALATION_RULES.find(r => r.level === level)?.notifyTo || 'Unknown'
        }];
        return { ...t, escalationLevel: level, escalationHistory: newHistory, updatedAt: todayStr };
      }
      return t;
    }));
    alert(`ØªÙ… Ø§Ù„ØªØµØ¹ÙŠØ¯ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ ${level}`);
  };

  const handleApproveEvidence = (taskId) => {
    setTasks(tasks.map(t => t.id === taskId ? {
      ...t,
      evidenceStatus: 'Accepted',
      status: 'Completed',
      completedDate: todayStr,
      updatedAt: todayStr
    } : t));
    setShowEvidenceModal(false);
    alert('ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø¯Ù„ÙŠÙ„ ÙˆØ¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©');
  };

  const handleRejectEvidence = (taskId, reason) => {
    if (!reason || reason.length < 20) {
      alert('ÙŠØ¬Ø¨ ÙƒØªØ§Ø¨Ø© Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (20 Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)');
      return;
    }
    setTasks(tasks.map(t => t.id === taskId ? {
      ...t,
      evidenceStatus: 'Rejected',
      status: 'InProgress',
      updatedAt: todayStr
    } : t));
    setShowEvidenceModal(false);
    alert('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„');
  };

  const handleDelegate = (taskId, newOwnerId) => {
    const newOwner = TEAM_MEMBERS.find(m => m.id === newOwnerId);
    if (!newOwner) return;
    setTasks(tasks.map(t => t.id === taskId ? {
      ...t,
      ownerId: newOwnerId,
      ownerName: newOwner.name,
      updatedAt: todayStr
    } : t));
    setShowDelegationModal(false);
    alert(`ØªÙ… ØªÙÙˆÙŠØ¶ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¥Ù„Ù‰ ${newOwner.name}`);
  };

  const handleBulkAction = (action) => {
    if (selectedTasks.length === 0) {
      alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù‡Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹');
      return;
    }

    switch (action) {
      case 'submit':
        setTasks(tasks.map(t => selectedTasks.includes(t.id) && t.evidenceStatus === 'Uploaded' ?
          { ...t, status: 'UnderReview', evidenceStatus: 'UnderReview', submittedDate: todayStr, updatedAt: todayStr } : t
        ));
        alert(`ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ${selectedTasks.length} Ù…Ù‡Ù…Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©`);
        break;
      case 'escalate':
        setTasks(tasks.map(t => selectedTasks.includes(t.id) ?
          { ...t, escalationLevel: Math.min(t.escalationLevel + 1, 4), updatedAt: todayStr } : t
        ));
        alert(`ØªÙ… ØªØµØ¹ÙŠØ¯ ${selectedTasks.length} Ù…Ù‡Ù…Ø©`);
        break;
      case 'delegate':
        setShowDelegationModal(true);
        return;
      default:
        break;
    }
    setSelectedTasks([]);
    setShowBulkModal(false);
  };

  const toggleTaskSelection = (taskId) => {
    setSelectedTasks(prev =>
      prev.includes(taskId) ? prev.filter(id => id !== taskId) : [...prev, taskId]
    );
  };

  const toggleAllTasks = () => {
    if (selectedTasks.length === filteredTasks.length) {
      setSelectedTasks([]);
    } else {
      setSelectedTasks(filteredTasks.map(t => t.id));
    }
  };

  const toggleChecklistItem = (itemId) => {
    setInspectionChecklist(prev => prev.map(item =>
      item.id === itemId ? { ...item, completed: !item.completed } : item
    ));
  };

  // Calendar Navigation
  const navigateMonth = (direction) => {
    const newDate = new Date(currentDate);
    newDate.setMonth(newDate.getMonth() + direction);
    setCurrentDate(newDate);
  };

  const getMonthDays = () => {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDay = firstDay.getDay();

    const days = [];
    // Previous month days
    const prevMonthLastDay = new Date(year, month, 0).getDate();
    for (let i = startingDay - 1; i >= 0; i--) {
      days.push({ day: prevMonthLastDay - i, currentMonth: false, date: new Date(year, month - 1, prevMonthLastDay - i) });
    }
    // Current month days
    for (let i = 1; i <= daysInMonth; i++) {
      days.push({ day: i, currentMonth: true, date: new Date(year, month, i) });
    }
    // Next month days
    const remainingDays = 42 - days.length;
    for (let i = 1; i <= remainingDays; i++) {
      days.push({ day: i, currentMonth: false, date: new Date(year, month + 1, i) });
    }
    return days;
  };

  const getTasksForDate = (date) => {
    const dateStr = date.toISOString().split('T')[0];
    return tasks.filter(t => t.dueDate === dateStr);
  };

  const months = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
  const weekDays = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TABS CONFIGURATION
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const tabs = [
    { id: 'inbox', label: 'ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ù‡Ø§Ù…', icon: Inbox, count: stats.total - stats.completed },
    { id: 'calendar', label: 'Ø§Ù„ØªÙ‚ÙˆÙŠÙ…', icon: Calendar, count: null },
    { id: 'gantt', label: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ', icon: BarChart3, count: null },
    { id: 'evidence', label: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø©', icon: FileCheck, count: stats.pendingReview },
    { id: 'escalation', label: 'Ø§Ù„ØªØµØ¹ÙŠØ¯ ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª', icon: AlertTriangle, count: stats.escalated },
    { id: 'readiness', label: 'Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„Ù„ØªÙØªÙŠØ´', icon: ClipboardCheck, count: null },
  ];


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          HEADER
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
            <Calendar className="w-7 h-7 text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-slate-900">ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</h1>
            <p className="text-slate-500">Compliance Calendar & Regulatory Obligations Scheduler - Module 4.4</p>
          </div>
        </div>
        <div className="flex items-center gap-3">
          {selectedTasks.length > 0 && (
            <button onClick={() => setShowBulkModal(true)}
              className="flex items-center gap-2 px-4 py-2.5 bg-indigo-100 text-indigo-700 rounded-xl font-bold">
              <CheckSquare className="w-5 h-5" />
              Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ© ({selectedTasks.length})
            </button>
          )}
          <button onClick={() => setShowScheduleSetup(true)} className="flex items-center gap-2 px-4 py-2.5 border-2 border-indigo-200 bg-indigo-50 rounded-xl text-indigo-700 hover:bg-indigo-100 font-bold transition-all">
            <Settings className="w-5 h-5" />Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©
          </button>
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
          </button>
        </div>
      </div>

      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          STATS CARDS
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}
      <div className="grid grid-cols-8 gap-3">
        <div className="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-4 text-white">
          <div className="flex items-center justify-between mb-2">
            <Target className="w-6 h-6 text-white/80" />
            <span className="text-3xl font-bold">{stats.completionRate}%</span>
          </div>
          <p className="text-indigo-100 text-sm">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</p>
          <div className="mt-2 h-2 bg-white/20 rounded-full overflow-hidden">
            <div className="h-full bg-white rounded-full" style={{ width: `${stats.completionRate}%` }}></div>
          </div>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.overdue > 0 ? 'bg-red-50 border-red-300 animate-pulse' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <AlertTriangle className={`w-5 h-5 ${stats.overdue > 0 ? 'text-red-500' : 'text-slate-400'}`} />
            <p className="text-xs text-slate-500">Ù…ØªØ£Ø®Ø±Ø©</p>
          </div>
          <p className={`text-2xl font-bold ${stats.overdue > 0 ? 'text-red-600' : 'text-slate-400'}`}>{stats.overdue}</p>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.dueSoon > 0 ? 'bg-amber-50 border-amber-300' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <Clock className="w-5 h-5 text-amber-500" />
            <p className="text-xs text-slate-500">ØªØ³ØªØ­Ù‚ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
          </div>
          <p className="text-2xl font-bold text-amber-600">{stats.dueSoon}</p>
          <p className="text-[10px] text-amber-500">Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù…</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-indigo-200">
          <div className="flex items-center gap-2 mb-1">
            <Play className="w-5 h-5 text-indigo-500" />
            <p className="text-xs text-slate-500">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
          </div>
          <p className="text-2xl font-bold text-indigo-600">{stats.inProgress}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-purple-200">
          <div className="flex items-center gap-2 mb-1">
            <Eye className="w-5 h-5 text-purple-500" />
            <p className="text-xs text-slate-500">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
          </div>
          <p className="text-2xl font-bold text-purple-600">{stats.pendingReview}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-emerald-200">
          <div className="flex items-center gap-2 mb-1">
            <CheckCircle2 className="w-5 h-5 text-emerald-500" />
            <p className="text-xs text-slate-500">Ù…ÙƒØªÙ…Ù„Ø©</p>
          </div>
          <p className="text-2xl font-bold text-emerald-600">{stats.completed}</p>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.escalated > 0 ? 'bg-orange-50 border-orange-300' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <TrendingUp className="w-5 h-5 text-orange-500" />
            <p className="text-xs text-slate-500">Ù…ÙØµØ¹Ù‘Ø¯Ø©</p>
          </div>
          <p className="text-2xl font-bold text-orange-600">{stats.escalated}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-slate-200">
          <div className="flex items-center gap-2 mb-1">
            <FolderOpen className="w-5 h-5 text-slate-500" />
            <p className="text-xs text-slate-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
          </div>
          <p className="text-2xl font-bold text-slate-700">{stats.total}</p>
        </div>
      </div>

      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
          MAIN CONTENT
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
        {/* Tabs */}
        <div className="flex border-b border-slate-200 overflow-x-auto">
          {tabs.map(tab => (
            <button key={tab.id} onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-5 py-4 font-bold transition-all border-b-2 whitespace-nowrap ${activeTab === tab.id
                  ? 'text-indigo-600 border-indigo-500 bg-indigo-50'
                  : 'text-slate-500 border-transparent hover:bg-slate-50'
                }`}>
              <tab.icon className="w-5 h-5" />
              {tab.label}
              {tab.count !== null && tab.count > 0 && (
                <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-indigo-500 text-white' : 'bg-slate-200 text-slate-600'
                  }`}>{tab.count}</span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: INBOX (ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ù‡Ø§Ù…)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'inbox' && (
          <div className="p-6">
            {/* Filters */}
            <div className="flex flex-wrap items-center gap-3 mb-6">
              <div className="flex-1 min-w-[250px] relative">
                <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500" />
              </div>
              <select value={filterAuthority} onChange={(e) => setFilterAuthority(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl min-w-[150px]">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
                <option value="SAMA">SAMA</option>
                <option value="CMA">CMA</option>
                <option value="NCA">NCA</option>
                <option value="SDAIA">SDAIA</option>
                <option value="ZATCA">ZATCA</option>
              </select>
              <select value={filterPriority} onChange={(e) => setFilterPriority(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl min-w-[150px]">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</option>
                {Object.entries(PRIORITY_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
              </select>
              <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl min-w-[150px]">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                {Object.entries(STATUS_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
              </select>
              <select value={filterOwner} onChange={(e) => setFilterOwner(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl min-w-[150px]">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</option>
                {TEAM_MEMBERS.map(m => <option key={m.id} value={m.id}>{m.name}</option>)}
              </select>
            </div>

            {/* Task Table */}
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead>
                  <tr className="bg-slate-50 border-b-2 border-slate-200">
                    <th className="px-3 py-3 text-center w-10">
                      <input type="checkbox" checked={selectedTasks.length === filteredTasks.length && filteredTasks.length > 0}
                        onChange={toggleAllTasks} className="w-4 h-4 rounded" />
                    </th>
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„Ù…Ù‡Ù…Ø©</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„ÙØªØ±Ø©/Ø§Ù„Ø¯ÙˆØ±Ø©</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700 w-48">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredTasks.map(task => {
                    const priorityCfg = PRIORITY_CONFIG[task.priority] || PRIORITY_CONFIG.Medium;
                    const statusCfg = STATUS_CONFIG[task.status] || STATUS_CONFIG.Open;
                    const evidenceCfg = EVIDENCE_STATUS_CONFIG[task.evidenceStatus] || EVIDENCE_STATUS_CONFIG.PendingUpload;
                    const authColor = AUTHORITY_COLORS[task.authorityCode] || { bg: 'bg-slate-500', light: 'bg-slate-100', text: 'text-slate-700' };
                    const daysUntil = getDaysUntilDue(task.dueDate);
                    const urgency = getTaskUrgency(task);
                    const StatusIcon = statusCfg.icon;
                    const EvidenceIcon = evidenceCfg.icon;

                    return (
                      <tr key={task.id} className={`border-b border-slate-100 hover:bg-slate-50 ${urgency === 'overdue' ? 'bg-red-50' : ''}`}>
                        <td className="px-3 py-4 text-center">
                          <input type="checkbox" checked={selectedTasks.includes(task.id)}
                            onChange={() => toggleTaskSelection(task.id)} className="w-4 h-4 rounded" />
                        </td>
                        <td className="px-4 py-4">
                          <div className="flex items-start gap-3">
                            <div className={`w-10 h-10 rounded-xl ${authColor.bg} flex items-center justify-center text-white font-bold text-xs shrink-0`}>
                              {task.authorityCode?.substring(0, 2)}
                            </div>
                            <div className="min-w-0">
                              <div className="flex items-center gap-2 mb-1">
                                <span className="font-mono text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded">{task.code}</span>
                                {task.escalationLevel > 0 && (
                                  <span className="flex items-center gap-1 px-2 py-0.5 bg-orange-100 text-orange-700 rounded text-xs font-bold">
                                    <TrendingUp className="w-3 h-3" />ØªØµØ¹ÙŠØ¯ {task.escalationLevel}
                                  </span>
                                )}
                              </div>
                              <h4 className="font-bold text-slate-800 text-sm">{task.title}</h4>
                              <p className="text-xs text-slate-500 mt-0.5">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: {task.ownerName}</p>
                            </div>
                          </div>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <div className="inline-flex flex-col items-center">
                            <span className={`px-3 py-1.5 rounded-xl text-xs font-bold ${authColor.light} ${authColor.text}`}>
                              {task.period}
                            </span>
                            <span className="text-[10px] text-slate-400 mt-1">{FREQUENCY_CONFIG[task.frequency]?.label}</span>
                          </div>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className={`px-3 py-1.5 rounded-lg text-xs font-bold ${authColor.light} ${authColor.text}`}>
                            {task.authorityCode}
                          </span>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className={`px-3 py-1.5 rounded-xl text-xs font-bold ${priorityCfg.bg} ${priorityCfg.text}`}>
                            {priorityCfg.label}
                          </span>
                        </td>
                        <td className="px-4 py-4 text-center">
                          <div className="space-y-1">
                            <div className="flex items-center justify-center gap-1 text-xs">
                              <span className="text-slate-500">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</span>
                              <span className="font-bold text-slate-700">{task.dueDate}</span>
                            </div>
                            <div className="flex items-center justify-center gap-1 text-xs">
                              <span className="text-slate-500">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ù…Ø§Ø­:</span>
                              <span className="text-slate-600">{task.gracePeriodEnd}</span>
                            </div>
                            <div className="flex items-center justify-center gap-1 text-xs">
                              <span className="text-slate-500">Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©:</span>
                              <span className="text-red-600">{task.violationDate}</span>
                            </div>
                            {daysUntil !== null && task.status !== 'Completed' && (
                              <span className={`inline-block px-2 py-1 rounded-lg text-xs font-bold mt-1 ${urgency === 'overdue' ? 'bg-red-500 text-white' :
                                  urgency === 'critical' ? 'bg-red-100 text-red-700' :
                                    urgency === 'urgent' ? 'bg-orange-100 text-orange-700' :
                                      urgency === 'warning' ? 'bg-amber-100 text-amber-700' :
                                        'bg-emerald-100 text-emerald-700'
                                }`}>
                                {daysUntil < 0 ? `Ù…ØªØ£Ø®Ø± ${Math.abs(daysUntil)} ÙŠÙˆÙ…` : daysUntil === 0 ? 'Ø§Ù„ÙŠÙˆÙ…!' : `${daysUntil} ÙŠÙˆÙ… Ù…ØªØ¨Ù‚ÙŠ`}
                              </span>
                            )}
                          </div>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className={`inline-flex items-center gap-1 px-3 py-1.5 rounded-xl text-xs font-bold ${statusCfg.bg} ${statusCfg.text}`}>
                            <StatusIcon className="w-3.5 h-3.5" />
                            {statusCfg.label}
                          </span>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className={`inline-flex items-center gap-1 px-3 py-1.5 rounded-xl text-xs font-bold ${evidenceCfg.bg} ${evidenceCfg.text}`}>
                            <EvidenceIcon className="w-3.5 h-3.5" />
                            {evidenceCfg.label}
                          </span>
                        </td>
                        <td className="px-4 py-4">
                          <div className="flex flex-wrap items-center justify-center gap-1">
                            <button onClick={() => handleUploadEvidence(task.id)}
                              className="flex items-center gap-1 px-2 py-1.5 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold hover:bg-blue-200">
                              <Upload className="w-3.5 h-3.5" />Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„
                            </button>
                            <button onClick={() => handleSubmitTask(task.id)}
                              disabled={task.evidenceStatus !== 'Uploaded'}
                              className={`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-bold ${task.evidenceStatus === 'Uploaded' ? 'bg-emerald-100 text-emerald-700 hover:bg-emerald-200' : 'bg-slate-100 text-slate-400 cursor-not-allowed'
                                }`}>
                              <Send className="w-3.5 h-3.5" />Ø¥Ø±Ø³Ø§Ù„
                            </button>
                            <button onClick={() => handleRequestExtension(task.id)}
                              className="flex items-center gap-1 px-2 py-1.5 bg-amber-100 text-amber-700 rounded-lg text-xs font-bold hover:bg-amber-200">
                              <Clock className="w-3.5 h-3.5" />Ø·Ù„Ø¨ ØªÙ…Ø¯ÙŠØ¯
                            </button>
                            <button onClick={() => handleEscalate(task.id, task.escalationLevel + 1)}
                              className="flex items-center gap-1 px-2 py-1.5 bg-orange-100 text-orange-700 rounded-lg text-xs font-bold hover:bg-orange-200">
                              <TrendingUp className="w-3.5 h-3.5" />ØªØµØ¹ÙŠØ¯ ÙÙˆØ±ÙŠ
                            </button>
                            <button onClick={() => { setSelectedTask(task); setShowTaskModal(true); }}
                              className="flex items-center gap-1 px-2 py-1.5 bg-slate-100 text-slate-600 rounded-lg text-xs font-bold hover:bg-slate-200">
                              <Eye className="w-3.5 h-3.5" />Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                            </button>
                          </div>
                        </td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          </div>
        )}


        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: CALENDAR (Ø§Ù„ØªÙ‚ÙˆÙŠÙ…)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'calendar' && (
          <div className="p-6">
            {/* Calendar Header */}
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-4">
                <button onClick={() => navigateMonth(-1)} className="p-2 hover:bg-slate-100 rounded-xl">
                  <ChevronRight className="w-6 h-6 text-slate-600" />
                </button>
                <h2 className="text-xl font-bold text-slate-800">
                  {months[currentDate.getMonth()]} {currentDate.getFullYear()}
                </h2>
                <button onClick={() => navigateMonth(1)} className="p-2 hover:bg-slate-100 rounded-xl">
                  <ChevronLeft className="w-6 h-6 text-slate-600" />
                </button>
              </div>
              <div className="flex items-center gap-2">
                <button onClick={() => setCurrentDate(new Date())} className="px-4 py-2 bg-indigo-100 text-indigo-700 rounded-xl font-bold text-sm">
                  Ø§Ù„ÙŠÙˆÙ…
                </button>
                <div className="flex items-center border-2 border-slate-200 rounded-xl overflow-hidden">
                  {['month', 'week', 'day'].map(view => (
                    <button key={view} onClick={() => setCalendarView(view)}
                      className={`px-4 py-2 text-sm font-bold ${calendarView === view ? 'bg-indigo-500 text-white' : 'text-slate-600 hover:bg-slate-50'}`}>
                      {view === 'month' ? 'Ø´Ù‡Ø±' : view === 'week' ? 'Ø£Ø³Ø¨ÙˆØ¹' : 'ÙŠÙˆÙ…'}
                    </button>
                  ))}
                </div>
              </div>
            </div>

            {/* Calendar Grid - Month View */}
            {calendarView === 'month' && (
              <div className="border-2 border-slate-200 rounded-2xl overflow-hidden">
                {/* Week Days Header */}
                <div className="grid grid-cols-7 bg-slate-50 border-b-2 border-slate-200">
                  {weekDays.map(day => (
                    <div key={day} className="px-2 py-3 text-center font-bold text-slate-600 text-sm">{day}</div>
                  ))}
                </div>
                {/* Days Grid */}
                <div className="grid grid-cols-7">
                  {getMonthDays().map((dayObj, idx) => {
                    const dayTasks = getTasksForDate(dayObj.date);
                    const isToday = dayObj.date.toDateString() === today.toDateString();
                    return (
                      <div key={idx}
                        className={`min-h-[120px] border-b border-r border-slate-100 p-2 ${!dayObj.currentMonth ? 'bg-slate-50 text-slate-400' : 'bg-white'
                          } ${isToday ? 'bg-indigo-50' : ''}`}>
                        <div className={`text-sm font-bold mb-1 ${isToday ? 'w-7 h-7 rounded-full bg-indigo-500 text-white flex items-center justify-center' : ''}`}>
                          {dayObj.day}
                        </div>
                        <div className="space-y-1">
                          {dayTasks.slice(0, 3).map(task => {
                            const authColor = AUTHORITY_COLORS[task.authorityCode] || { bg: 'bg-slate-500' };
                            const urgency = getTaskUrgency(task);
                            return (
                              <div key={task.id} onClick={() => { setSelectedTask(task); setShowTaskModal(true); }}
                                className={`text-[10px] px-1.5 py-1 rounded cursor-pointer truncate ${urgency === 'overdue' ? 'bg-red-500 text-white' : `${authColor.bg} text-white`
                                  }`}>
                                {task.code}: {task.title.substring(0, 20)}...
                              </div>
                            );
                          })}
                          {dayTasks.length > 3 && (
                            <div className="text-[10px] text-slate-500 font-bold">+{dayTasks.length - 3} Ø§Ù„Ù…Ø²ÙŠØ¯</div>
                          )}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* Week/Day View Placeholder */}
            {(calendarView === 'week' || calendarView === 'day') && (
              <div className="border-2 border-slate-200 rounded-2xl p-8 text-center bg-slate-50">
                <Calendar className="w-16 h-16 text-slate-300 mx-auto mb-4" />
                <h3 className="text-xl font-bold text-slate-600">Ø¹Ø±Ø¶ {calendarView === 'week' ? 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹' : 'Ø§Ù„ÙŠÙˆÙ…'}</h3>
                <p className="text-slate-500 mt-2">Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
              </div>
            )}

            {/* Legend */}
            <div className="mt-6 flex items-center gap-6 justify-center">
              {Object.entries(AUTHORITY_COLORS).map(([code, colors]) => (
                <div key={code} className="flex items-center gap-2">
                  <div className={`w-4 h-4 rounded ${colors.bg}`}></div>
                  <span className="text-sm text-slate-600">{code}</span>
                </div>
              ))}
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 rounded bg-red-500"></div>
                <span className="text-sm text-slate-600">Ù…ØªØ£Ø®Ø±</span>
              </div>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: GANTT (Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'gantt' && (
          <div className="p-6">
            {/* Gantt Header */}
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-4">
                <h2 className="text-lg font-bold text-slate-800">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù„Ù…Ù‡Ø§Ù…</h2>
                <span className="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-xl text-sm font-bold">
                  {filteredTasks.length} Ù…Ù‡Ù…Ø©
                </span>
              </div>
              <div className="flex items-center gap-2">
                <span className="text-sm text-slate-500">Ø§Ù„ØªÙƒØ¨ÙŠØ±:</span>
                <div className="flex items-center border-2 border-slate-200 rounded-xl overflow-hidden">
                  {['day', 'week', 'month', 'quarter'].map(zoom => (
                    <button key={zoom} onClick={() => setGanttZoom(zoom)}
                      className={`px-3 py-1.5 text-xs font-bold ${ganttZoom === zoom ? 'bg-indigo-500 text-white' : 'text-slate-600 hover:bg-slate-50'}`}>
                      {zoom === 'day' ? 'ÙŠÙˆÙ…' : zoom === 'week' ? 'Ø£Ø³Ø¨ÙˆØ¹' : zoom === 'month' ? 'Ø´Ù‡Ø±' : 'Ø±Ø¨Ø¹'}
                    </button>
                  ))}
                </div>
              </div>
            </div>

            {/* Gantt Chart */}
            <div className="border-2 border-slate-200 rounded-2xl overflow-hidden">
              {/* Timeline Header */}
              <div className="flex bg-slate-50 border-b-2 border-slate-200">
                <div className="w-80 shrink-0 px-4 py-3 font-bold text-slate-700 border-l-2 border-slate-200">Ø§Ù„Ù…Ù‡Ù…Ø©</div>
                <div className="flex-1 flex">
                  {Array.from({ length: 12 }, (_, i) => (
                    <div key={i} className="flex-1 px-2 py-3 text-center text-xs font-bold text-slate-600 border-l border-slate-200">
                      {months[i].substring(0, 3)}
                    </div>
                  ))}
                </div>
              </div>

              {/* Tasks */}
              <div className="max-h-[500px] overflow-y-auto">
                {filteredTasks.map(task => {
                  const authColor = AUTHORITY_COLORS[task.authorityCode] || { bg: 'bg-slate-500' };
                  const dueDate = new Date(task.dueDate);
                  const startMonth = 0; // Assuming start from January for demo
                  const dueMonth = dueDate.getMonth();
                  const progressWidth = ((dueMonth - startMonth + 1) / 12) * 100;
                  const urgency = getTaskUrgency(task);

                  return (
                    <div key={task.id} className="flex border-b border-slate-100 hover:bg-slate-50">
                      <div className="w-80 shrink-0 px-4 py-3 border-l-2 border-slate-200">
                        <div className="flex items-center gap-2">
                          <span className={`w-8 h-8 rounded-lg ${authColor.bg} flex items-center justify-center text-white text-xs font-bold`}>
                            {task.authorityCode?.substring(0, 2)}
                          </span>
                          <div className="min-w-0">
                            <div className="font-mono text-[10px] text-indigo-600">{task.code}</div>
                            <div className="text-sm font-medium text-slate-800 truncate">{task.title}</div>
                          </div>
                        </div>
                      </div>
                      <div className="flex-1 relative py-3 px-2">
                        <div className="absolute inset-y-3 flex items-center" style={{ right: '0', width: `${progressWidth}%` }}>
                          <div className={`h-6 rounded-lg w-full flex items-center justify-end px-2 ${urgency === 'overdue' ? 'bg-red-500' :
                              task.status === 'Completed' ? 'bg-emerald-500' : authColor.bg
                            }`}>
                            <span className="text-[10px] text-white font-bold">{task.dueDate}</span>
                          </div>
                        </div>
                        {/* Month grid lines */}
                        <div className="absolute inset-0 flex pointer-events-none">
                          {Array.from({ length: 12 }, (_, i) => (
                            <div key={i} className="flex-1 border-l border-slate-100"></div>
                          ))}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>

            {/* Gantt Legend */}
            <div className="mt-6 flex items-center gap-6 justify-center">
              <div className="flex items-center gap-2">
                <div className="w-6 h-3 rounded bg-emerald-500"></div>
                <span className="text-sm text-slate-600">Ù…ÙƒØªÙ…Ù„</span>
              </div>
              {Object.entries(AUTHORITY_COLORS).map(([code, colors]) => (
                <div key={code} className="flex items-center gap-2">
                  <div className={`w-6 h-3 rounded ${colors.bg}`}></div>
                  <span className="text-sm text-slate-600">{code}</span>
                </div>
              ))}
              <div className="flex items-center gap-2">
                <div className="w-6 h-3 rounded bg-red-500"></div>
                <span className="text-sm text-slate-600">Ù…ØªØ£Ø®Ø±</span>
              </div>
            </div>
          </div>
        )}


        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: EVIDENCE REVIEW (Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø©)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'evidence' && (
          <div className="p-6">
            {/* Stats */}
            <div className="grid grid-cols-4 gap-4 mb-6">
              <div className="bg-amber-50 rounded-xl p-4 border-2 border-amber-200">
                <div className="flex items-center justify-between">
                  <Eye className="w-6 h-6 text-amber-500" />
                  <span className="text-2xl font-bold text-amber-600">
                    {tasks.filter(t => t.evidenceStatus === 'UnderReview').length}
                  </span>
                </div>
                <p className="text-sm text-amber-700 mt-1">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
              </div>
              <div className="bg-emerald-50 rounded-xl p-4 border-2 border-emerald-200">
                <div className="flex items-center justify-between">
                  <CheckCircle2 className="w-6 h-6 text-emerald-500" />
                  <span className="text-2xl font-bold text-emerald-600">
                    {tasks.filter(t => t.evidenceStatus === 'Accepted').length}
                  </span>
                </div>
                <p className="text-sm text-emerald-700 mt-1">ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§</p>
              </div>
              <div className="bg-red-50 rounded-xl p-4 border-2 border-red-200">
                <div className="flex items-center justify-between">
                  <XCircle className="w-6 h-6 text-red-500" />
                  <span className="text-2xl font-bold text-red-600">
                    {tasks.filter(t => t.evidenceStatus === 'Rejected').length}
                  </span>
                </div>
                <p className="text-sm text-red-700 mt-1">Ù…Ø±ÙÙˆØ¶Ø©</p>
              </div>
              <div className="bg-indigo-50 rounded-xl p-4 border-2 border-indigo-200">
                <div className="flex items-center justify-between">
                  <User className="w-6 h-6 text-indigo-500" />
                  <span className="text-lg font-bold text-indigo-600">{CURRENT_USER.name}</span>
                </div>
                <p className="text-sm text-indigo-700 mt-1">{CURRENT_USER.role}</p>
              </div>
            </div>

            {/* SoD Notice */}
            <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4 mb-6">
              <div className="flex items-center gap-3">
                <Info className="w-5 h-5 text-blue-600 shrink-0" />
                <div>
                  <p className="font-bold text-blue-800">ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (Segregation of Duties)</p>
                  <p className="text-sm text-blue-700">Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø±ÙØ¹Ù‡Ø§ Ø¨Ù†ÙØ³Ùƒ. Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙŠ Ø£Ù†Øª Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù†Ù‡Ø§ Ø³ØªØ¸Ù‡Ø± Ù…Ø¹Ø·Ù„Ø©.</p>
                </div>
              </div>
            </div>

            {/* Evidence Queue */}
            <div className="space-y-3">
              {tasks.filter(t => t.evidenceStatus === 'UnderReview' || t.evidenceStatus === 'Uploaded').map(task => {
                const canReview = task.ownerId !== CURRENT_USER.id;
                const authColor = AUTHORITY_COLORS[task.authorityCode] || { bg: 'bg-slate-500', light: 'bg-slate-100', text: 'text-slate-700' };
                const evidenceCfg = EVIDENCE_STATUS_CONFIG[task.evidenceStatus];
                const EvidenceIcon = evidenceCfg?.icon || Upload;

                return (
                  <div key={task.id} className={`bg-white rounded-xl border-2 p-4 ${canReview ? 'border-amber-300 hover:shadow-lg' : 'border-slate-200 opacity-60'}`}>
                    <div className="flex items-start justify-between">
                      <div className="flex items-start gap-4">
                        <div className={`w-12 h-12 rounded-xl ${authColor.bg} flex items-center justify-center text-white font-bold shrink-0`}>
                          {task.authorityCode?.substring(0, 2)}
                        </div>
                        <div>
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded">{task.code}</span>
                            <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-lg text-xs font-bold ${evidenceCfg?.bg} ${evidenceCfg?.text}`}>
                              <EvidenceIcon className="w-3 h-3" />{evidenceCfg?.label}
                            </span>
                          </div>
                          <h4 className="font-bold text-slate-800">{task.title}</h4>
                          {task.evidenceFileName && (
                            <p className="text-sm text-slate-500 mt-1 flex items-center gap-2">
                              <FileText className="w-4 h-4" />
                              {task.evidenceFileName}
                            </p>
                          )}
                          <div className="flex items-center gap-4 mt-2 text-xs text-slate-500">
                            <span>Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©: <strong className="text-slate-700">{task.ownerName}</strong></span>
                            <span>Ø§Ù„ÙØªØ±Ø©: <strong className="text-slate-700">{task.period}</strong></span>
                            <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <strong className="text-slate-700">{task.dueDate}</strong></span>
                          </div>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        {canReview ? (
                          <>
                            <button onClick={() => handleApproveEvidence(task.id)}
                              className="flex items-center gap-2 px-4 py-2 bg-emerald-100 text-emerald-700 rounded-xl font-bold hover:bg-emerald-200">
                              <CheckCircle2 className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯
                            </button>
                            <button onClick={() => { setSelectedTask(task); setShowEvidenceModal(true); }}
                              className="flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-xl font-bold hover:bg-red-200">
                              <XCircle className="w-5 h-5" />Ø±ÙØ¶
                            </button>
                          </>
                        ) : (
                          <span className="px-4 py-2 bg-slate-100 text-slate-500 rounded-xl text-sm">
                            SoD - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                          </span>
                        )}
                        <button onClick={() => { setSelectedTask(task); setShowTaskModal(true); }}
                          className="p-2 hover:bg-blue-50 rounded-lg">
                          <Eye className="w-5 h-5 text-blue-500" />
                        </button>
                      </div>
                    </div>
                  </div>
                );
              })}

              {tasks.filter(t => t.evidenceStatus === 'UnderReview' || t.evidenceStatus === 'Uploaded').length === 0 && (
                <div className="text-center py-16 bg-slate-50 rounded-xl">
                  <CheckCircle2 className="w-16 h-16 text-emerald-400 mx-auto mb-4" />
                  <h3 className="text-xl font-bold text-slate-700">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯Ù„Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
                  <p className="text-slate-500 mt-2">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø© ØªÙ…Øª Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§</p>
                </div>
              )}
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: ESCALATION (Ø§Ù„ØªØµØ¹ÙŠØ¯ ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'escalation' && (
          <div className="p-6">
            {/* Escalation Rules */}
            <div className="bg-gradient-to-l from-orange-500 to-red-500 rounded-2xl p-6 mb-6 text-white">
              <div className="flex items-center gap-4 mb-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <AlertTriangle className="w-6 h-6" />
                </div>
                <div>
                  <h3 className="text-xl font-bold">Ù…Ø­Ø±Ùƒ Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„Ø¢Ù„ÙŠ</h3>
                  <p className="text-orange-100">Auto-Escalation Engine</p>
                </div>
              </div>
              <div className="grid grid-cols-4 gap-4">
                {ESCALATION_RULES.map(rule => (
                  <div key={rule.level} className="bg-white/20 rounded-xl p-3">
                    <div className="flex items-center gap-2 mb-2">
                      <span className="w-6 h-6 rounded-full bg-white/30 flex items-center justify-center text-sm font-bold">{rule.level}</span>
                      <span className="font-bold text-sm">{rule.name}</span>
                    </div>
                    <p className="text-xs text-orange-100">
                      {rule.daysBeforeDue ? `${rule.daysBeforeDue} Ø£ÙŠØ§Ù… Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯` : `${rule.daysAfterDue} Ø£ÙŠØ§Ù… Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØ¹Ø¯`}
                    </p>
                    <p className="text-xs text-orange-100 mt-1">Ø¥Ø¨Ù„Ø§Øº: {rule.notifyTo}</p>
                  </div>
                ))}
              </div>
            </div>

            {/* Escalated Tasks */}
            <div className="space-y-3">
              <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙØµØ¹Ù‘Ø¯Ø© ({tasks.filter(t => t.escalationLevel > 0).length})</h3>

              {tasks.filter(t => t.escalationLevel > 0).map(task => {
                const authColor = AUTHORITY_COLORS[task.authorityCode] || { bg: 'bg-slate-500' };
                const daysUntil = getDaysUntilDue(task.dueDate);

                return (
                  <div key={task.id} className="bg-white rounded-xl border-2 border-orange-300 p-4 hover:shadow-lg">
                    <div className="flex items-start justify-between">
                      <div className="flex items-start gap-4">
                        <div className="relative">
                          <div className={`w-12 h-12 rounded-xl ${authColor.bg} flex items-center justify-center text-white font-bold`}>
                            {task.authorityCode?.substring(0, 2)}
                          </div>
                          <div className="absolute -top-1 -right-1 w-6 h-6 rounded-full bg-orange-500 text-white text-xs font-bold flex items-center justify-center">
                            {task.escalationLevel}
                          </div>
                        </div>
                        <div>
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded">{task.code}</span>
                            <span className="px-2 py-0.5 bg-orange-100 text-orange-700 rounded text-xs font-bold">
                              Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØµØ¹ÙŠØ¯: {task.escalationLevel}
                            </span>
                          </div>
                          <h4 className="font-bold text-slate-800">{task.title}</h4>
                          <div className="flex items-center gap-4 mt-2 text-xs text-slate-500">
                            <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: <strong className="text-slate-700">{task.ownerName}</strong></span>
                            <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <strong className={daysUntil < 0 ? 'text-red-600' : 'text-slate-700'}>{task.dueDate}</strong></span>
                            {daysUntil < 0 && (
                              <span className="px-2 py-0.5 bg-red-500 text-white rounded-lg text-xs font-bold">
                                Ù…ØªØ£Ø®Ø± {Math.abs(daysUntil)} ÙŠÙˆÙ…
                              </span>
                            )}
                          </div>
                          {/* Escalation History */}
                          {task.escalationHistory?.length > 0 && (
                            <div className="mt-3 pt-3 border-t border-slate-100">
                              <p className="text-xs font-bold text-slate-600 mb-2">Ø³Ø¬Ù„ Ø§Ù„ØªØµØ¹ÙŠØ¯:</p>
                              <div className="flex items-center gap-2 flex-wrap">
                                {task.escalationHistory.map((esc, idx) => (
                                  <span key={idx} className="text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded">
                                    Ø§Ù„Ù…Ø³ØªÙˆÙ‰ {esc.level} â†’ {esc.to} ({esc.date})
                                  </span>
                                ))}
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        {task.escalationLevel < 4 && (
                          <button onClick={() => handleEscalate(task.id, task.escalationLevel + 1)}
                            className="flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-xl font-bold hover:bg-red-200">
                            <TrendingUp className="w-5 h-5" />ØªØµØ¹ÙŠØ¯ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ {task.escalationLevel + 1}
                          </button>
                        )}
                        <button onClick={() => { setSelectedTask(task); setShowTaskModal(true); }}
                          className="p-2 hover:bg-blue-50 rounded-lg">
                          <Eye className="w-5 h-5 text-blue-500" />
                        </button>
                      </div>
                    </div>
                  </div>
                );
              })}

              {tasks.filter(t => t.escalationLevel > 0).length === 0 && (
                <div className="text-center py-16 bg-slate-50 rounded-xl">
                  <CheckCircle2 className="w-16 h-16 text-emerald-400 mx-auto mb-4" />
                  <h3 className="text-xl font-bold text-slate-700">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…ÙØµØ¹Ù‘Ø¯Ø©</h3>
                  <p className="text-slate-500 mt-2">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø¶Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</p>
                </div>
              )}
            </div>

            {/* Overdue Tasks */}
            <div className="mt-8">
              <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                <AlertTriangle className="w-5 h-5 text-red-500" />
                Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ£Ø®Ø±Ø© ({tasks.filter(t => getDaysUntilDue(t.dueDate) < 0 && t.status !== 'Completed').length})
              </h3>

              {tasks.filter(t => getDaysUntilDue(t.dueDate) < 0 && t.status !== 'Completed').map(task => (
                <div key={task.id} className="bg-red-50 rounded-xl border-2 border-red-300 p-4 mb-3">
                  <div className="flex items-center justify-between">
                    <div>
                      <div className="flex items-center gap-2 mb-1">
                        <span className="font-mono text-sm font-bold text-indigo-600">{task.code}</span>
                        <span className="px-2 py-0.5 bg-red-500 text-white rounded text-xs font-bold">
                          Ù…ØªØ£Ø®Ø± {Math.abs(getDaysUntilDue(task.dueDate))} ÙŠÙˆÙ…
                        </span>
                      </div>
                      <h4 className="font-bold text-slate-800">{task.title}</h4>
                    </div>
                    <button onClick={() => handleEscalate(task.id, Math.min(task.escalationLevel + 1, 4))}
                      className="flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">
                      <TrendingUp className="w-5 h-5" />ØªØµØ¹ÙŠØ¯ ÙÙˆØ±ÙŠ
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: READINESS (Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„Ù„ØªÙØªÙŠØ´)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'readiness' && (
          <div className="p-6">
            {/* Readiness Score */}
            <div className="bg-gradient-to-l from-emerald-500 to-teal-600 rounded-2xl p-6 mb-6 text-white">
              <div className="flex items-center justify-between">
                <div>
                  <h3 className="text-xl font-bold mb-2">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© Ù„Ù„ØªÙØªÙŠØ´</h3>
                  <p className="text-emerald-100">Inspection Readiness Score</p>
                </div>
                <div className="text-center">
                  <div className="relative w-32 h-32">
                    <svg className="w-32 h-32 transform -rotate-90">
                      <circle cx="64" cy="64" r="56" stroke="rgba(255,255,255,0.2)" strokeWidth="12" fill="none" />
                      <circle cx="64" cy="64" r="56" stroke="white" strokeWidth="12" fill="none"
                        strokeDasharray={`${(inspectionReadiness.percentage / 100) * 352} 352`}
                        strokeLinecap="round" />
                    </svg>
                    <div className="absolute inset-0 flex items-center justify-center">
                      <span className="text-3xl font-bold">{inspectionReadiness.percentage}%</span>
                    </div>
                  </div>
                  <p className="mt-2 text-sm">{inspectionReadiness.completed}/{inspectionReadiness.total} Ù…ØªØ·Ù„Ø¨</p>
                </div>
              </div>

              {/* Category Progress */}
              <div className="grid grid-cols-4 gap-4 mt-6">
                {Object.entries(inspectionReadiness.byCategory).map(([category, data]) => (
                  <div key={category} className="bg-white/20 rounded-xl p-3">
                    <div className="flex items-center justify-between mb-2">
                      <span className="font-bold text-sm">{category}</span>
                      <span className="text-sm">{data.completed}/{data.total}</span>
                    </div>
                    <div className="h-2 bg-white/30 rounded-full overflow-hidden">
                      <div className="h-full bg-white rounded-full" style={{ width: `${(data.completed / data.total) * 100}%` }}></div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Checklist */}
            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <div className="px-6 py-4 bg-slate-50 border-b-2 border-slate-200">
                <h3 className="font-bold text-slate-800">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚</h3>
              </div>
              <div className="divide-y divide-slate-100">
                {Object.entries(inspectionReadiness.byCategory).map(([category, _]) => (
                  <div key={category}>
                    <div className="px-6 py-3 bg-slate-50 font-bold text-slate-700 text-sm">{category}</div>
                    {inspectionChecklist.filter(item => item.category === category).map(item => (
                      <div key={item.id} className="px-6 py-4 flex items-center justify-between hover:bg-slate-50">
                        <div className="flex items-center gap-4">
                          <button onClick={() => toggleChecklistItem(item.id)}
                            className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all ${item.completed ? 'bg-emerald-500 border-emerald-500' : 'border-slate-300 hover:border-emerald-400'
                              }`}>
                            {item.completed && <Check className="w-4 h-4 text-white" />}
                          </button>
                          <span className={`${item.completed ? 'text-slate-500 line-through' : 'text-slate-800'}`}>
                            {item.item}
                          </span>
                        </div>
                        {item.evidenceId ? (
                          <span className="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-bold">
                            Ø¯Ù„ÙŠÙ„ Ù…Ø±ÙÙ‚
                          </span>
                        ) : (
                          <span className="px-3 py-1 bg-amber-100 text-amber-700 rounded-lg text-xs font-bold">
                            ÙŠØ­ØªØ§Ø¬ Ø¯Ù„ÙŠÙ„
                          </span>
                        )}
                      </div>
                    ))}
                  </div>
                ))}
              </div>
            </div>

            {/* Gap Analysis */}
            <div className="mt-6 bg-amber-50 rounded-2xl border-2 border-amber-200 p-6">
              <div className="flex items-center gap-3 mb-4">
                <AlertTriangle className="w-6 h-6 text-amber-600" />
                <h3 className="font-bold text-amber-800">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙØ¬ÙˆØ§Øª</h3>
              </div>
              <div className="grid grid-cols-2 gap-4">
                {inspectionChecklist.filter(item => !item.completed).map(item => (
                  <div key={item.id} className="bg-white rounded-xl p-4 border border-amber-200">
                    <p className="font-medium text-slate-800">{item.item}</p>
                    <p className="text-sm text-amber-600 mt-1">Ø§Ù„ÙØ¦Ø©: {item.category}</p>
                    <button className="mt-2 text-sm text-indigo-600 font-bold hover:underline">
                      Ø¥Ø¶Ø§ÙØ© Ø¯Ù„ÙŠÙ„ â†’
                    </button>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}
      </div>


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          MODALS
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}

      {/* Task Detail Modal */}
      {showTaskModal && selectedTask && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden">
            <div className={`px-6 py-5 text-white ${getTaskUrgency(selectedTask) === 'overdue' ? 'bg-gradient-to-l from-red-500 to-rose-600' :
                selectedTask.status === 'Completed' ? 'bg-gradient-to-l from-emerald-500 to-teal-600' :
                  'bg-gradient-to-l from-indigo-500 to-purple-600'
              }`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                    <ClipboardCheck className="w-6 h-6" />
                  </div>
                  <div>
                    <div className="flex items-center gap-2">
                      <span className="font-mono text-sm bg-white/20 px-2 py-0.5 rounded">{selectedTask.code}</span>
                      {selectedTask.escalationLevel > 0 && (
                        <span className="px-2 py-0.5 bg-orange-500 rounded text-xs font-bold">ØªØµØ¹ÙŠØ¯ {selectedTask.escalationLevel}</span>
                      )}
                    </div>
                    <h2 className="text-xl font-bold mt-1">{selectedTask.title}</h2>
                  </div>
                </div>
                <button onClick={() => { setShowTaskModal(false); setSelectedTask(null); }}
                  className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>

            <div className="p-6 max-h-[60vh] overflow-y-auto space-y-5">
              {/* Status Banner */}
              <div className={`rounded-xl p-4 ${STATUS_CONFIG[selectedTask.status]?.bg}`}>
                <div className="flex items-center gap-3">
                  {(() => { const Icon = STATUS_CONFIG[selectedTask.status]?.icon || Clock; return <Icon className={`w-6 h-6 ${STATUS_CONFIG[selectedTask.status]?.text}`} />; })()}
                  <div>
                    <p className={`font-bold ${STATUS_CONFIG[selectedTask.status]?.text}`}>{STATUS_CONFIG[selectedTask.status]?.label}</p>
                    {getDaysUntilDue(selectedTask.dueDate) < 0 && selectedTask.status !== 'Completed' && (
                      <p className="text-sm text-red-600 font-bold">Ù…ØªØ£Ø®Ø± {Math.abs(getDaysUntilDue(selectedTask.dueDate))} ÙŠÙˆÙ…</p>
                    )}
                  </div>
                </div>
              </div>

              {/* Info Grid */}
              <div className="grid grid-cols-3 gap-4">
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</p>
                  <p className="font-bold text-slate-800">{selectedTask.authorityCode}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¥Ø·Ø§Ø±</p>
                  <p className="font-bold text-slate-800">{selectedTask.frameworkCode}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</p>
                  <span className={`px-3 py-1 rounded-xl text-xs font-bold ${PRIORITY_CONFIG[selectedTask.priority]?.bg} ${PRIORITY_CONFIG[selectedTask.priority]?.text}`}>
                    {PRIORITY_CONFIG[selectedTask.priority]?.label}
                  </span>
                </div>
              </div>

              {/* Dates */}
              <div className="bg-blue-50 rounded-xl p-4 border border-blue-200">
                <h4 className="font-bold text-blue-800 mb-3">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</h4>
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <p className="text-xs text-blue-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</p>
                    <p className="font-bold text-slate-800">{selectedTask.dueDate}</p>
                  </div>
                  <div>
                    <p className="text-xs text-blue-600">Ù†Ù‡Ø§ÙŠØ© ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­</p>
                    <p className="font-bold text-slate-800">{selectedTask.gracePeriodEnd}</p>
                  </div>
                  <div>
                    <p className="text-xs text-blue-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©</p>
                    <p className="font-bold text-red-600">{selectedTask.violationDate}</p>
                  </div>
                </div>
              </div>

              {/* Stakeholders */}
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                  <p className="text-xs text-indigo-600 mb-1">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ (Owner)</p>
                  <div className="flex items-center gap-2">
                    <div className="w-8 h-8 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-sm">
                      {selectedTask.ownerName?.charAt(0)}
                    </div>
                    <span className="font-bold text-slate-800">{selectedTask.ownerName}</span>
                  </div>
                </div>
                <div className="bg-purple-50 rounded-xl p-4 border border-purple-200">
                  <p className="text-xs text-purple-600 mb-1">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ (Reviewer)</p>
                  <div className="flex items-center gap-2">
                    <div className="w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold text-sm">
                      {selectedTask.reviewerName?.charAt(0)}
                    </div>
                    <span className="font-bold text-slate-800">{selectedTask.reviewerName}</span>
                  </div>
                </div>
              </div>

              {/* Evidence */}
              <div className={`rounded-xl p-4 border ${EVIDENCE_STATUS_CONFIG[selectedTask.evidenceStatus]?.bg
                } ${EVIDENCE_STATUS_CONFIG[selectedTask.evidenceStatus]?.text?.replace('text-', 'border-')}`}>
                <h4 className="font-bold mb-3 flex items-center gap-2">
                  <FileText className="w-5 h-5" />Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„
                </h4>
                <div className="flex items-center justify-between">
                  <div>
                    <span className={`inline-flex items-center gap-1 px-3 py-1.5 rounded-xl text-xs font-bold ${EVIDENCE_STATUS_CONFIG[selectedTask.evidenceStatus]?.bg} ${EVIDENCE_STATUS_CONFIG[selectedTask.evidenceStatus]?.text}`}>
                      {EVIDENCE_STATUS_CONFIG[selectedTask.evidenceStatus]?.label}
                    </span>
                    {selectedTask.evidenceFileName && (
                      <p className="text-sm mt-2">{selectedTask.evidenceFileName}</p>
                    )}
                  </div>
                  {!selectedTask.evidenceFileName && (
                    <button onClick={() => handleUploadEvidence(selectedTask.id)}
                      className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                      <Upload className="w-5 h-5" />Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„
                    </button>
                  )}
                </div>
              </div>

              {/* Description */}
              {selectedTask.description && (
                <div className="bg-slate-50 rounded-xl p-4">
                  <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ</h4>
                  <p className="text-slate-600">{selectedTask.description}</p>
                </div>
              )}

              {/* Tags */}
              {selectedTask.tags?.length > 0 && (
                <div className="flex items-center gap-2 flex-wrap">
                  {selectedTask.tags.map((tag, idx) => (
                    <span key={idx} className="px-3 py-1 bg-slate-100 text-slate-600 rounded-lg text-sm">{tag}</span>
                  ))}
                </div>
              )}
            </div>

            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowTaskModal(false); setSelectedTask(null); }}
                className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                Ø¥ØºÙ„Ø§Ù‚
              </button>
              <div className="flex items-center gap-3">
                <button onClick={() => { setShowDelegationModal(true); }}
                  className="flex items-center gap-2 px-5 py-3 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200">
                  <Users className="w-5 h-5" />ØªÙÙˆÙŠØ¶
                </button>
                {selectedTask.evidenceStatus === 'Uploaded' && (
                  <button onClick={() => handleSubmitTask(selectedTask.id)}
                    className="flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold">
                    <Send className="w-5 h-5" />Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Delegation Modal */}
      {showDelegationModal && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-indigo-500 to-purple-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <Users className="w-6 h-6" />
                </div>
                <div>
                  <h2 className="text-xl font-bold">ØªÙÙˆÙŠØ¶ Ø§Ù„Ù…Ù‡Ù…Ø©</h2>
                  <p className="text-indigo-200">Delegate Task</p>
                </div>
              </div>
            </div>
            <div className="p-6">
              <p className="text-slate-600 mb-4">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªÙÙˆÙŠØ¶ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¥Ù„ÙŠÙ‡:</p>
              <div className="space-y-2">
                {TEAM_MEMBERS.filter(m => m.id !== selectedTask?.ownerId).map(member => (
                  <button key={member.id}
                    onClick={() => handleDelegate(selectedTask?.id, member.id)}
                    className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all">
                    <div className="w-10 h-10 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold">
                      {member.avatar}
                    </div>
                    <div className="text-right">
                      <p className="font-bold text-slate-800">{member.name}</p>
                      <p className="text-sm text-slate-500">{member.role}</p>
                    </div>
                  </button>
                ))}
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50">
              <button onClick={() => setShowDelegationModal(false)}
                className="w-full px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                Ø¥Ù„ØºØ§Ø¡
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Bulk Actions Modal */}
      {showBulkModal && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-indigo-500 to-purple-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <CheckSquare className="w-6 h-6" />
                </div>
                <div>
                  <h2 className="text-xl font-bold">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¬Ù…Ø§Ø¹ÙŠØ©</h2>
                  <p className="text-indigo-200">{selectedTasks.length} Ù…Ù‡Ù…Ø© Ù…Ø­Ø¯Ø¯Ø©</p>
                </div>
              </div>
            </div>
            <div className="p-6 space-y-3">
              <button onClick={() => handleBulkAction('submit')}
                className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-emerald-500 hover:bg-emerald-50">
                <Send className="w-6 h-6 text-emerald-500" />
                <div className="text-right">
                  <p className="font-bold text-slate-800">Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                  <p className="text-sm text-slate-500">Ø¥Ø±Ø³Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                </div>
              </button>
              <button onClick={() => handleBulkAction('escalate')}
                className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-orange-500 hover:bg-orange-50">
                <TrendingUp className="w-6 h-6 text-orange-500" />
                <div className="text-right">
                  <p className="font-bold text-slate-800">ØªØµØ¹ÙŠØ¯ Ø¬Ù…Ø§Ø¹ÙŠ</p>
                  <p className="text-sm text-slate-500">Ø±ÙØ¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØµØ¹ÙŠØ¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                </div>
              </button>
              <button onClick={() => handleBulkAction('delegate')}
                className="w-full flex items-center gap-4 p-4 rounded-xl border-2 border-slate-200 hover:border-indigo-500 hover:bg-indigo-50">
                <Users className="w-6 h-6 text-indigo-500" />
                <div className="text-right">
                  <p className="font-bold text-slate-800">ØªÙÙˆÙŠØ¶ Ø¬Ù…Ø§Ø¹ÙŠ</p>
                  <p className="text-sm text-slate-500">ØªÙÙˆÙŠØ¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ù„Ø´Ø®Øµ Ø¢Ø®Ø±</p>
                </div>
              </button>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50">
              <button onClick={() => { setShowBulkModal(false); setSelectedTasks([]); }}
                className="w-full px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                Ø¥Ù„ØºØ§Ø¡
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Evidence Rejection Modal */}
      {showEvidenceModal && selectedTask && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-lg overflow-hidden">
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <XCircle className="w-6 h-6" />
                </div>
                <div>
                  <h2 className="text-xl font-bold">Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„</h2>
                  <p className="text-red-200">{selectedTask.code}</p>
                </div>
              </div>
            </div>
            <div className="p-6 space-y-4">
              <div className="bg-slate-50 rounded-xl p-4">
                <h4 className="font-bold text-slate-800">{selectedTask.title}</h4>
                <p className="text-sm text-slate-500 mt-1">{selectedTask.evidenceFileName}</p>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (Ù…Ø·Ù„ÙˆØ¨ 20 Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„):</label>
                <textarea rows={4} placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨Ø§Ù„ØªÙØµÙŠÙ„..."
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl resize-none focus:outline-none focus:border-red-500"
                  id="rejectReason" />
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowEvidenceModal(false); setSelectedTask(null); }}
                className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <button onClick={() => {
                const reason = document.getElementById('rejectReason')?.value;
                handleRejectEvidence(selectedTask.id, reason);
              }}
                className="flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">
                <XCircle className="w-5 h-5" />ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±ÙØ¶
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCHEDULE SETUP MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showScheduleSetup && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
            {/* Header */}
            <div className="bg-gradient-to-l from-indigo-600 via-purple-600 to-violet-700 px-6 py-4 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                    <Settings className="w-6 h-6" />
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</h2>
                    <p className="text-white/80 text-sm">Schedule Setup - Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯Ø§ÙˆÙ„ Ù…ØªÙƒØ±Ø±Ø© Ù„Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</p>
                  </div>
                </div>
                <button onClick={() => setShowScheduleSetup(false)} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>

            {/* Content */}
            <div className="flex-1 overflow-y-auto p-6">
              <div className="grid grid-cols-2 gap-6">
                {/* Left Column - Obligation & Schedule */}
                <div className="space-y-5">
                  {/* Select Obligation */}
                  <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-indigo-800 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-indigo-500 text-white flex items-center justify-center text-xs">1</span>
                      Ø§Ø®ØªØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ *
                    </label>
                    <select value={scheduleForm.obligationId} onChange={(e) => setScheduleForm({ ...scheduleForm, obligationId: e.target.value })}
                      className="w-full px-4 py-3 border-2 border-indigo-200 rounded-xl focus:border-indigo-400 focus:outline-none bg-white">
                      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…...</option>
                      {INITIAL_OBLIGATIONS.filter(o => o.status === 'Active').map(obl => (
                        <option key={obl.id} value={obl.id}>{obl.code} - {obl.title}</option>
                      ))}
                    </select>
                  </div>

                  {/* Frequency */}
                  <div className="bg-white rounded-xl p-4 border border-slate-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-purple-500 text-white flex items-center justify-center text-xs">2</span>
                      <RefreshCw className="w-4 h-4 text-purple-500" />
                      Ø¯ÙˆØ±ÙŠØ© Ø§Ù„ØªÙƒØ±Ø§Ø± *
                    </label>
                    <div className="grid grid-cols-4 gap-2">
                      {[
                        { value: 'Daily', label: 'ÙŠÙˆÙ…ÙŠ' },
                        { value: 'Weekly', label: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ' },
                        { value: 'Monthly', label: 'Ø´Ù‡Ø±ÙŠ' },
                        { value: 'Quarterly', label: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ' },
                        { value: 'SemiAnnual', label: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ' },
                        { value: 'Annual', label: 'Ø³Ù†ÙˆÙŠ' },
                        { value: 'AdHoc', label: 'Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨' },
                        { value: 'EventBased', label: 'Ø­Ø³Ø¨ Ø§Ù„Ø­Ø¯Ø«' },
                      ].map(freq => (
                        <button key={freq.value} type="button" onClick={() => setScheduleForm({ ...scheduleForm, frequency: freq.value })}
                          className={`p-2.5 rounded-xl text-xs font-bold transition-all ${scheduleForm.frequency === freq.value
                              ? 'bg-purple-500 text-white'
                              : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                            }`}>
                          {freq.label}
                        </button>
                      ))}
                    </div>
                  </div>

                  {/* Date Range */}
                  <div className="bg-white rounded-xl p-4 border border-slate-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-amber-500 text-white flex items-center justify-center text-xs">3</span>
                      <Calendar className="w-4 h-4 text-amber-500" />
                      Ù†Ø·Ø§Ù‚ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
                    </label>
                    <div className="grid grid-cols-2 gap-3">
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label>
                        <input type="date" value={scheduleForm.startDate} onChange={(e) => setScheduleForm({ ...scheduleForm, startDate: e.target.value })}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm" />
                      </div>
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label>
                        <input type="date" value={scheduleForm.endDate} onChange={(e) => setScheduleForm({ ...scheduleForm, endDate: e.target.value })}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm" />
                      </div>
                    </div>
                  </div>

                  {/* Responsibilities */}
                  <div className="bg-white rounded-xl p-4 border border-slate-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-blue-500 text-white flex items-center justify-center text-xs">4</span>
                      <Users className="w-4 h-4 text-blue-500" />
                      Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
                    </label>
                    <div className="grid grid-cols-2 gap-3">
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">Ø§Ù„Ù…Ø§Ù„Ùƒ</label>
                        <select value={scheduleForm.ownerId} onChange={(e) => setScheduleForm({ ...scheduleForm, ownerId: e.target.value })}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm">
                          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ù„Ùƒ...</option>
                          {USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                        </select>
                      </div>
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</label>
                        <select value={scheduleForm.reviewerId} onChange={(e) => setScheduleForm({ ...scheduleForm, reviewerId: e.target.value })}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-xl text-sm">
                          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹...</option>
                          {USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                        </select>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Right Column - Settings & Options */}
                <div className="space-y-5">
                  {/* Reminder Settings */}
                  <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                    <label className="flex items-center gap-2 text-sm font-bold text-emerald-800 mb-3">
                      <span className="w-6 h-6 rounded-lg bg-emerald-500 text-white flex items-center justify-center text-xs">5</span>
                      <Bell className="w-4 h-4 text-emerald-500" />
                      Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ°ÙƒÙŠØ±
                    </label>
                    <div className="space-y-3">
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">Ø§Ù„ØªØ°ÙƒÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ (Ø£ÙŠØ§Ù…)</label>
                        <input type="number" value={scheduleForm.reminderDays} onChange={(e) => setScheduleForm({ ...scheduleForm, reminderDays: parseInt(e.target.value) })}
                          className="w-full px-3 py-2.5 border-2 border-emerald-200 rounded-xl text-sm" min="1" max="30" />
                      </div>
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (Ø£ÙŠØ§Ù…)</label>
                        <input type="number" value={scheduleForm.graceperiodDays} onChange={(e) => setScheduleForm({ ...scheduleForm, graceperiodDays: parseInt(e.target.value) })}
                          className="w-full px-3 py-2.5 border-2 border-emerald-200 rounded-xl text-sm" min="0" max="14" />
                      </div>
                    </div>
                  </div>

                  {/* Escalation Settings */}
                  <div className="bg-red-50 rounded-xl p-4 border border-red-200">
                    <label className="flex items-center justify-between text-sm font-bold text-red-800 mb-3">
                      <div className="flex items-center gap-2">
                        <span className="w-6 h-6 rounded-lg bg-red-500 text-white flex items-center justify-center text-xs">6</span>
                        <TrendingUp className="w-4 h-4 text-red-500" />
                        Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                      </div>
                      <label className="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" checked={scheduleForm.escalationEnabled}
                          onChange={(e) => setScheduleForm({ ...scheduleForm, escalationEnabled: e.target.checked })}
                          className="w-5 h-5 rounded text-red-500" />
                        <span className="text-xs">Ù…ÙØ¹Ù‘Ù„</span>
                      </label>
                    </label>
                    {scheduleForm.escalationEnabled && (
                      <div>
                        <label className="block text-xs text-slate-500 mb-1">Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (Ø£ÙŠØ§Ù…)</label>
                        <input type="number" value={scheduleForm.escalationDays} onChange={(e) => setScheduleForm({ ...scheduleForm, escalationDays: parseInt(e.target.value) })}
                          className="w-full px-3 py-2.5 border-2 border-red-200 rounded-xl text-sm" min="1" max="14" />
                      </div>
                    )}
                  </div>

                  {/* Auto Generate Toggle */}
                  <div className="bg-white rounded-xl p-4 border border-slate-200">
                    <label className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-xl bg-violet-100 flex items-center justify-center">
                          <Zap className="w-5 h-5 text-violet-600" />
                        </div>
                        <div>
                          <span className="font-bold text-slate-800 block">Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                          <span className="text-xs text-slate-500">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù‡Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</span>
                        </div>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={scheduleForm.autoGenerate}
                          onChange={(e) => setScheduleForm({ ...scheduleForm, autoGenerate: e.target.checked })}
                          className="sr-only peer" />
                        <div className="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-violet-500"></div>
                      </label>
                    </label>
                  </div>

                  {/* Preview */}
                  <div className="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                      <Eye className="w-4 h-4 text-slate-500" />
                      Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„
                    </h4>
                    <div className="space-y-2 text-sm">
                      {scheduleForm.obligationId && scheduleForm.frequency && (
                        <>
                          <div className="flex justify-between p-2 bg-white rounded-lg">
                            <span className="text-slate-500">Ø§Ù„Ø¯ÙˆØ±ÙŠØ©:</span>
                            <span className="font-bold text-slate-700">
                              {scheduleForm.frequency === 'Daily' ? 'ÙŠÙˆÙ…ÙŠ' :
                                scheduleForm.frequency === 'Weekly' ? 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ' :
                                  scheduleForm.frequency === 'Monthly' ? 'Ø´Ù‡Ø±ÙŠ' :
                                    scheduleForm.frequency === 'Quarterly' ? 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ' :
                                      scheduleForm.frequency === 'SemiAnnual' ? 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ' :
                                        scheduleForm.frequency === 'Annual' ? 'Ø³Ù†ÙˆÙŠ' : scheduleForm.frequency}
                            </span>
                          </div>
                          <div className="flex justify-between p-2 bg-white rounded-lg">
                            <span className="text-slate-500">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:</span>
                            <span className="font-bold text-indigo-600">
                              {scheduleForm.frequency === 'Daily' ? '365' :
                                scheduleForm.frequency === 'Weekly' ? '52' :
                                  scheduleForm.frequency === 'Monthly' ? '12' :
                                    scheduleForm.frequency === 'Quarterly' ? '4' :
                                      scheduleForm.frequency === 'SemiAnnual' ? '2' :
                                        scheduleForm.frequency === 'Annual' ? '1' : '-'} Ù…Ù‡Ù…Ø©/Ø³Ù†Ø©
                            </span>
                          </div>
                          <div className="flex justify-between p-2 bg-white rounded-lg">
                            <span className="text-slate-500">Ø§Ù„ØªØ°ÙƒÙŠØ±:</span>
                            <span className="font-bold text-emerald-600">Ù‚Ø¨Ù„ {scheduleForm.reminderDays} Ø£ÙŠØ§Ù…</span>
                          </div>
                        </>
                      )}
                      {!scheduleForm.obligationId && (
                        <p className="text-center text-slate-400 py-4">Ø§Ø®ØªØ± Ø§Ù„ØªØ²Ø§Ù… Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„</p>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Footer */}
            <div className="border-t border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between">
              <button onClick={() => setShowScheduleSetup(false)} className="px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white text-sm">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <div className="flex items-center gap-3">
                <button onClick={() => {
                  setScheduleForm({
                    obligationId: '', frequency: 'Monthly', startDate: '', endDate: '',
                    ownerId: '', reviewerId: '', reminderDays: 7, autoGenerate: true,
                    graceperiodDays: 3, escalationEnabled: true, escalationDays: 2
                  });
                }} className="px-4 py-2.5 text-slate-500 hover:text-slate-700 font-bold text-sm">
                  <RotateCcw className="w-4 h-4" />
                </button>
                <button onClick={() => {
                  if (!scheduleForm.obligationId) {
                    alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…');
                    return;
                  }
                  alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­!');
                  setShowScheduleSetup(false);
                }} disabled={!scheduleForm.obligationId}
                  className="flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all text-sm disabled:opacity-50">
                  <Save className="w-4 h-4" />Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©
                  <ChevronLeft className="w-4 h-4" />
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const EvidenceRepository = () => {
  const [activeTab, setActiveTab] = useState('repository');
  const [searchQuery, setSearchQuery] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterType, setFilterType] = useState('');
  const [viewMode, setViewMode] = useState('table');
  const [showUploadModal, setShowUploadModal] = useState(false);
  const [showReviewModal, setShowReviewModal] = useState(false);
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [showPackModal, setShowPackModal] = useState(false);
  const [selectedEvidence, setSelectedEvidence] = useState(null);
  const [rejectComment, setRejectComment] = useState('');
  const [selectedItems, setSelectedItems] = useState([]);
  const [sortField, setSortField] = useState('code');
  const [sortDirection, setSortDirection] = useState('desc');
  const [dragOver, setDragOver] = useState(false);
  const [showDocModal, setShowDocModal] = useState(false);
  const [docModalMode, setDocModalMode] = useState('create'); // create | edit | view
  const [selectedDoc, setSelectedDoc] = useState(null);
  const [showDocDeleteConfirm, setShowDocDeleteConfirm] = useState(false);
  const [docForm, setDocForm] = useState({
    titleAr: '', titleEn: '', docType: 'Policy', classification: 'Internal',
    version: 'v1.0', description: '', ownerId: 2
  });

  // Evidence Data - Enhanced
  const [evidence, setEvidence] = useState([
    { id: 1, code: 'EVD-000001', evidenceType: 'Report', title: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ - ÙŠÙ†Ø§ÙŠØ± 2025', fileName: 'compliance_jan_2025.pdf', fileSize: '1.2 MB', checksumSha256: 'f6g7h8i9...', validityStart: '2025-01-01', validityEnd: '2025-01-31', status: 'Accepted', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', reviewerComment: null, acceptedAt: '2025-01-28', period: '2025-01', linkedObligations: ['OBL-001', 'OBL-002'], linkedControls: ['CTR-001'], tags: ['Ø´Ù‡Ø±ÙŠ', 'SAMA'], priority: 'High', confidentiality: 'Confidential' },
    { id: 2, code: 'EVD-000002', evidenceType: 'Screenshot', title: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù†Ø¸Ø§Ù… KYC', fileName: 'kyc_screenshot.png', fileSize: '856 KB', checksumSha256: 'g7h8i9j0...', validityStart: '2025-01-01', validityEnd: '2025-03-31', status: 'Accepted', ownerId: 2, ownerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', reviewerId: 3, reviewerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerComment: null, acceptedAt: '2025-01-20', period: 'Q1-2025', linkedObligations: ['OBL-003'], linkedControls: ['CTR-002'], tags: ['KYC', 'AML'], priority: 'Medium', confidentiality: 'Internal' },
    { id: 3, code: 'EVD-000003', evidenceType: 'Certificate', title: 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', fileName: 'pentest_cert.pdf', fileSize: '520 KB', checksumSha256: 'h8i9j0k1...', validityStart: '2025-01-15', validityEnd: '2026-01-15', status: 'Accepted', ownerId: 3, ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerComment: null, acceptedAt: '2025-01-22', period: '2025', linkedObligations: ['OBL-010'], linkedControls: ['CTR-005'], tags: ['Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', 'Pentest'], priority: 'Critical', confidentiality: 'Confidential' },
    { id: 4, code: 'EVD-000004', evidenceType: 'Log', title: 'Ø³Ø¬Ù„ ØªØ¯Ø±ÙŠØ¨ AML - ÙŠÙ†Ø§ÙŠØ±', fileName: 'aml_training.xlsx', fileSize: '245 KB', checksumSha256: 'i9j0k1l2...', validityStart: '2025-01-01', validityEnd: '2025-12-31', status: 'UnderReview', ownerId: 4, ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', reviewerComment: null, acceptedAt: null, period: '2025-01', linkedObligations: ['OBL-002'], linkedControls: [], tags: ['ØªØ¯Ø±ÙŠØ¨'], priority: 'Medium', confidentiality: 'Internal' },
    { id: 5, code: 'EVD-000005', evidenceType: 'Config', title: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firewall', fileName: 'firewall_config.xml', fileSize: '128 KB', checksumSha256: 'j0k1l2m3...', validityStart: '2025-01-01', validityEnd: '2025-06-30', status: 'UnderReview', ownerId: 3, ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerId: 5, reviewerName: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', reviewerComment: null, acceptedAt: null, period: 'Q1-2025', linkedObligations: ['OBL-011'], linkedControls: ['CTR-004'], tags: ['Ø£Ù…Ù† Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', 'Firewall'], priority: 'High', confidentiality: 'Confidential' },
    { id: 6, code: 'EVD-000006', evidenceType: 'Report', title: 'ØªÙ‚Ø±ÙŠØ± STR - Ø¯ÙŠØ³Ù…Ø¨Ø± 2024', fileName: 'str_dec2024.pdf', fileSize: '890 KB', checksumSha256: 'k1l2m3n4...', validityStart: '2024-12-01', validityEnd: '2024-12-31', status: 'Expired', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', reviewerComment: null, acceptedAt: '2024-12-28', period: '2024-12', linkedObligations: ['OBL-003'], linkedControls: [], tags: ['STR', 'Ø´Ù‡Ø±ÙŠ'], priority: 'Critical', confidentiality: 'Confidential' },
    { id: 7, code: 'EVD-000007', evidenceType: 'Screenshot', title: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©', fileName: 'monitoring.png', fileSize: '1.1 MB', checksumSha256: 'm3n4o5p6...', validityStart: '2025-01-01', validityEnd: '2025-02-28', status: 'Rejected', ownerId: 6, ownerName: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ', reviewerId: 3, reviewerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerComment: 'Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± ÙˆØ§Ø¶Ø­Ø© ÙˆÙ„Ø§ ØªØ¸Ù‡Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®', acceptedAt: null, period: '2025-01', linkedObligations: [], linkedControls: ['CTR-005'], tags: ['Ù…Ø±Ø§Ù‚Ø¨Ø©'], priority: 'Medium', confidentiality: 'Internal' },
    { id: 8, code: 'EVD-000008', evidenceType: 'Report', title: 'ØªÙ‚Ø±ÙŠØ± ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø³Ù†ÙˆÙŠ', fileName: 'risk_2025.pdf', fileSize: '4.5 MB', checksumSha256: 'n4o5p6q7...', validityStart: '2025-01-01', validityEnd: '2025-12-31', status: 'Uploaded', ownerId: 5, ownerName: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', reviewerId: null, reviewerName: null, reviewerComment: null, acceptedAt: null, period: '2025', linkedObligations: ['OBL-008'], linkedControls: [], tags: ['Ù…Ø®Ø§Ø·Ø±', 'Ø³Ù†ÙˆÙŠ'], priority: 'High', confidentiality: 'Confidential' },
    { id: 9, code: 'EVD-000009', evidenceType: 'Report', title: 'ØªÙ‚Ø±ÙŠØ± ÙØ¨Ø±Ø§ÙŠØ± - Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯', fileName: null, fileSize: null, checksumSha256: null, validityStart: '2025-02-01', validityEnd: '2025-02-28', status: 'PendingUpload', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerId: 2, reviewerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', reviewerComment: null, acceptedAt: null, period: '2025-02', linkedObligations: ['OBL-001'], linkedControls: [], tags: ['Ø´Ù‡Ø±ÙŠ'], priority: 'High', confidentiality: 'Internal' },
    { id: 10, code: 'EVD-000010', evidenceType: 'Certificate', title: 'Ø´Ù‡Ø§Ø¯Ø© ISO 27001', fileName: 'iso27001.pdf', fileSize: '680 KB', checksumSha256: 'o5p6q7r8...', validityStart: '2024-06-01', validityEnd: '2027-06-01', status: 'Accepted', ownerId: 3, ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerComment: null, acceptedAt: '2024-06-15', period: '2024-2027', linkedObligations: ['OBL-009', 'OBL-010'], linkedControls: ['CTR-004', 'CTR-005'], tags: ['ISO', 'Ø´Ù‡Ø§Ø¯Ø©'], priority: 'Critical', confidentiality: 'Public' },
    { id: 11, code: 'EVD-000011', evidenceType: 'Attestation', title: 'Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', fileName: 'mgmt_attestation.pdf', fileSize: '156 KB', checksumSha256: 'p6q7r8s9...', validityStart: '2025-01-01', validityEnd: '2025-12-31', status: 'Accepted', ownerId: 7, ownerName: 'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerComment: null, acceptedAt: '2025-01-05', period: '2025', linkedObligations: ['OBL-001'], linkedControls: [], tags: ['Ø¥Ù‚Ø±Ø§Ø±', 'Ø¥Ø¯Ø§Ø±Ø©'], priority: 'Critical', confidentiality: 'Confidential' },
    { id: 12, code: 'EVD-000012', evidenceType: 'Procedure', title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ø§Ù„Ù…Ø­Ø¯Ø«', fileName: 'cdd_procedure_v3.pdf', fileSize: '2.3 MB', checksumSha256: 'q7r8s9t0...', validityStart: '2025-01-15', validityEnd: '2026-01-15', status: 'Accepted', ownerId: 1, ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', reviewerId: 3, reviewerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', reviewerComment: null, acceptedAt: '2025-01-18', period: '2025', linkedObligations: ['OBL-001', 'OBL-002'], linkedControls: ['CTR-001', 'CTR-002'], tags: ['CDD', 'Ø¥Ø¬Ø±Ø§Ø¡'], priority: 'High', confidentiality: 'Internal' },
  ]);

  // Documents Data - Enhanced
  const [documents, setDocuments] = useState([
    { id: 1, code: 'DOC-0001', titleAr: 'Ø³ÙŠØ§Ø³Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', titleEn: 'AML Policy', docType: 'Policy', classification: 'Confidential', ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', ownerId: 1, version: 'v2.1', status: 'Active', lastUpdated: '2025-01-15', expiryDate: '2026-01-15', downloads: 45, linkedEvidence: 3, description: 'Ø³ÙŠØ§Ø³Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„' },
    { id: 2, code: 'DOC-0002', titleAr: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø©', titleEn: 'CDD Procedures', docType: 'Procedure', classification: 'Internal', ownerName: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', ownerId: 2, version: 'v1.3', status: 'Active', lastUpdated: '2025-01-10', expiryDate: '2025-07-10', downloads: 78, linkedEvidence: 5, description: 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø© Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡' },
    { id: 3, code: 'DOC-0003', titleAr: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', titleEn: 'Cybersecurity Policy', docType: 'Policy', classification: 'Confidential', ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', ownerId: 3, version: 'v1.0', status: 'Active', lastUpdated: '2024-12-01', expiryDate: '2025-12-01', downloads: 32, linkedEvidence: 4, description: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠØ©' },
    { id: 4, code: 'DOC-0004', titleAr: 'Ø¯Ù„ÙŠÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', titleEn: 'PDPL Guide', docType: 'Guide', classification: 'Internal', ownerName: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', ownerId: 4, version: 'v1.2', status: 'Active', lastUpdated: '2025-01-20', expiryDate: '2026-01-20', downloads: 56, linkedEvidence: 2, description: 'Ø¯Ù„ÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©' },
    { id: 5, code: 'DOC-0005', titleAr: 'Ø¥Ø·Ø§Ø± Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', titleEn: 'BCM Framework', docType: 'Framework', classification: 'Confidential', ownerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', ownerId: 1, version: 'v1.1', status: 'Active', lastUpdated: '2024-11-15', expiryDate: '2025-11-15', downloads: 23, linkedEvidence: 1, description: 'Ø¥Ø·Ø§Ø± Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„' },
    { id: 6, code: 'DOC-0006', titleAr: 'Ù…Ø¹ÙŠØ§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ©', titleEn: 'IAM Standard', docType: 'Standard', classification: 'Internal', ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', ownerId: 3, version: 'v2.0', status: 'Active', lastUpdated: '2025-01-25', expiryDate: '2026-01-25', downloads: 41, linkedEvidence: 3, description: 'Ù…Ø¹ÙŠØ§Ø± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„' },
    { id: 7, code: 'DOC-0007', titleAr: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø«', titleEn: 'Incident Response Policy', docType: 'Policy', classification: 'Confidential', ownerName: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', ownerId: 3, version: 'v1.5', status: 'UnderReview', lastUpdated: '2025-01-28', expiryDate: null, downloads: 18, linkedEvidence: 0, description: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©' },
  ]);

  // Audit Packs Data
  const [auditPacks] = useState([
    { id: 1, code: 'PACK-001', name: 'Ø­Ø²Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚ SAMA Q1-2025', authority: 'SAMA', createdAt: '2025-01-15', createdBy: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', evidenceCount: 8, documentsCount: 3, status: 'Ready', size: '45.2 MB' },
    { id: 2, code: 'PACK-002', name: 'Ø­Ø²Ù…Ø© NCA ECC', authority: 'NCA', createdAt: '2025-01-20', createdBy: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', evidenceCount: 12, documentsCount: 5, status: 'Ready', size: '78.5 MB' },
  ]);

  // Upload Form
  const [uploadForm, setUploadForm] = useState({
    evidenceType: '', title: '', validityEnd: '', period: '',
    linkedObligations: [], linkedControls: [], tags: '',
    priority: 'Medium', confidentiality: 'Internal', description: ''
  });

  // Current User (for SoD)
  const CURRENT_USER = { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯' };

  // Status Config
  const STATUS_CONFIG = {
    PendingUpload: { label: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ÙØ¹', bg: 'bg-slate-100', text: 'text-slate-600', icon: Upload },
    Uploaded: { label: 'ØªÙ… Ø§Ù„Ø±ÙØ¹', bg: 'bg-blue-100', text: 'text-blue-700', icon: FileCheck },
    UnderReview: { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', bg: 'bg-amber-100', text: 'text-amber-700', icon: Clock },
    Accepted: { label: 'Ù…Ù‚Ø¨ÙˆÙ„', bg: 'bg-emerald-100', text: 'text-emerald-700', icon: CheckCircle2 },
    Rejected: { label: 'Ù…Ø±ÙÙˆØ¶', bg: 'bg-red-100', text: 'text-red-700', icon: XCircle },
    Expired: { label: 'Ù…Ù†ØªÙ‡ÙŠ', bg: 'bg-orange-100', text: 'text-orange-700', icon: AlertTriangle },
  };

  // Type Config
  const TYPE_CONFIG = {
    Report: { label: 'ØªÙ‚Ø±ÙŠØ±', icon: FileText, color: 'blue' },
    Screenshot: { label: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', icon: Eye, color: 'cyan' },
    Certificate: { label: 'Ø´Ù‡Ø§Ø¯Ø©', icon: CheckCircle2, color: 'emerald' },
    Log: { label: 'Ø³Ø¬Ù„', icon: Table, color: 'purple' },
    Config: { label: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', icon: Settings, color: 'slate' },
    Attestation: { label: 'Ø¥Ù‚Ø±Ø§Ø±', icon: ClipboardCheck, color: 'indigo' },
    Procedure: { label: 'Ø¥Ø¬Ø±Ø§Ø¡', icon: FileCheck, color: 'amber' },
  };

  // Priority Config
  const PRIORITY_CONFIG = {
    Critical: { label: 'Ø­Ø±Ø¬', color: 'red' },
    High: { label: 'Ø¹Ø§Ù„ÙŠ', color: 'orange' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', color: 'amber' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', color: 'slate' },
  };

  // Confidentiality Config  
  const CONFIDENTIALITY_CONFIG = {
    Public: { label: 'Ø¹Ø§Ù…', color: 'emerald' },
    Internal: { label: 'Ø¯Ø§Ø®Ù„ÙŠ', color: 'blue' },
    Confidential: { label: 'Ø³Ø±ÙŠ', color: 'amber' },
    Restricted: { label: 'Ù…Ù‚ÙŠØ¯', color: 'red' },
  };

  // Stats
  const stats = useMemo(() => ({
    total: evidence.length,
    accepted: evidence.filter(e => e.status === 'Accepted').length,
    underReview: evidence.filter(e => e.status === 'UnderReview').length,
    rejected: evidence.filter(e => e.status === 'Rejected').length,
    expired: evidence.filter(e => e.status === 'Expired').length,
    pending: evidence.filter(e => e.status === 'PendingUpload').length,
    uploaded: evidence.filter(e => e.status === 'Uploaded').length,
  }), [evidence]);

  // Filtered Evidence
  const filteredEvidence = useMemo(() => {
    return evidence.filter(e => {
      const matchSearch = !searchQuery || e.title?.toLowerCase().includes(searchQuery.toLowerCase()) || e.code?.toLowerCase().includes(searchQuery.toLowerCase());
      const matchStatus = !filterStatus || e.status === filterStatus;
      const matchType = !filterType || e.evidenceType === filterType;
      return matchSearch && matchStatus && matchType;
    });
  }, [evidence, searchQuery, filterStatus, filterType]);

  // Pending Review
  const pendingReview = useMemo(() => evidence.filter(e => e.status === 'UnderReview'), [evidence]);

  // SoD Check
  const canReview = (evd) => evd.ownerId !== CURRENT_USER.id && evd.status === 'UnderReview';

  // Handlers
  const handleUpload = () => {
    if (!uploadForm.evidenceType || !uploadForm.title || !uploadForm.validityEnd) {
      alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
      return;
    }
    const newEvd = {
      id: evidence.length + 1,
      code: `EVD-${String(evidence.length + 1).padStart(6, '0')}`,
      evidenceType: uploadForm.evidenceType,
      title: uploadForm.title,
      fileName: 'uploaded_file.pdf',
      fileSize: '1.0 MB',
      checksumSha256: 'new_' + Date.now(),
      validityStart: new Date().toISOString().split('T')[0],
      validityEnd: uploadForm.validityEnd,
      status: 'Uploaded',
      ownerId: CURRENT_USER.id,
      ownerName: CURRENT_USER.name,
      reviewerId: null,
      reviewerName: null,
      reviewerComment: null,
      acceptedAt: null,
      period: uploadForm.period,
    };
    setEvidence([...evidence, newEvd]);
    setShowUploadModal(false);
    setUploadForm({ evidenceType: '', title: '', validityEnd: '', period: '' });
    alert('ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„: ' + newEvd.code);
  };

  const handleSubmitForReview = (evd) => {
    if (evd.status !== 'Uploaded') return;
    setEvidence(evidence.map(e => e.id === evd.id ? { ...e, status: 'UnderReview', reviewerId: 1, reviewerName: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯' } : e));
    alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  };

  const handleAccept = () => {
    if (!selectedEvidence) return;
    setEvidence(evidence.map(e => e.id === selectedEvidence.id ? { ...e, status: 'Accepted', acceptedAt: new Date().toISOString().split('T')[0] } : e));
    setShowReviewModal(false);
    setSelectedEvidence(null);
    alert('ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø¯Ù„ÙŠÙ„');
  };

  const handleReject = () => {
    if (!selectedEvidence || rejectComment.length < 20) {
      alert('ÙŠØ¬Ø¨ ÙƒØªØ§Ø¨Ø© Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (20 Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)');
      return;
    }
    setEvidence(evidence.map(e => e.id === selectedEvidence.id ? { ...e, status: 'Rejected', reviewerComment: rejectComment } : e));
    setShowReviewModal(false);
    setSelectedEvidence(null);
    setRejectComment('');
    alert('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„');
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• Document Handlers â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const openCreateDocModal = () => {
    setDocForm({ titleAr: '', titleEn: '', docType: 'Policy', classification: 'Internal', version: 'v1.0', description: '', ownerId: CURRENT_USER.id });
    setDocModalMode('create');
    setSelectedDoc(null);
    setShowDocModal(true);
  };

  const openEditDocModal = (doc) => {
    setDocForm({
      titleAr: doc.titleAr, titleEn: doc.titleEn, docType: doc.docType,
      classification: doc.classification, version: doc.version,
      description: doc.description || '', ownerId: doc.ownerId
    });
    setDocModalMode('edit');
    setSelectedDoc(doc);
    setShowDocModal(true);
  };

  const openViewDocModal = (doc) => {
    setSelectedDoc(doc);
    setDocModalMode('view');
    setShowDocModal(true);
  };

  const handleSaveDoc = () => {
    if (!docForm.titleAr || !docForm.titleEn) {
      alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
      return;
    }

    if (docModalMode === 'create') {
      const newDoc = {
        id: documents.length + 1,
        code: `DOC-${String(documents.length + 1).padStart(4, '0')}`,
        titleAr: docForm.titleAr,
        titleEn: docForm.titleEn,
        docType: docForm.docType,
        classification: docForm.classification,
        version: docForm.version,
        description: docForm.description,
        ownerId: docForm.ownerId,
        ownerName: USERS.find(u => u.id === docForm.ownerId)?.name || CURRENT_USER.name,
        status: 'Active',
        lastUpdated: new Date().toISOString().split('T')[0],
        expiryDate: null,
        downloads: 0,
        linkedEvidence: 0
      };
      setDocuments([...documents, newDoc]);
      alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©: ' + newDoc.code);
    } else if (docModalMode === 'edit' && selectedDoc) {
      setDocuments(documents.map(d => d.id === selectedDoc.id ? {
        ...d,
        titleAr: docForm.titleAr,
        titleEn: docForm.titleEn,
        docType: docForm.docType,
        classification: docForm.classification,
        version: docForm.version,
        description: docForm.description,
        ownerId: docForm.ownerId,
        ownerName: USERS.find(u => u.id === docForm.ownerId)?.name || d.ownerName,
        lastUpdated: new Date().toISOString().split('T')[0]
      } : d));
      alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©: ' + selectedDoc.code);
    }
    setShowDocModal(false);
  };

  const handleDeleteDoc = () => {
    if (!selectedDoc) return;
    setDocuments(documents.filter(d => d.id !== selectedDoc.id));
    setShowDocDeleteConfirm(false);
    setSelectedDoc(null);
    alert('ØªÙ… Ø­Ø°Ù Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©');
  };

  // Document Type Config
  const DOC_TYPE_CONFIG = {
    Policy: { label: 'Ø³ÙŠØ§Ø³Ø©', color: 'purple' },
    Procedure: { label: 'Ø¥Ø¬Ø±Ø§Ø¡', color: 'blue' },
    Standard: { label: 'Ù…Ø¹ÙŠØ§Ø±', color: 'emerald' },
    Guide: { label: 'Ø¯Ù„ÙŠÙ„', color: 'amber' },
    Framework: { label: 'Ø¥Ø·Ø§Ø±', color: 'indigo' },
  };

  const getDaysUntilExpiry = (date) => {
    if (!date) return null;
    return Math.ceil((new Date(date) - new Date()) / (1000 * 60 * 60 * 24));
  };

  // Tabs
  const tabs = [
    { id: 'repository', label: 'Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©', icon: FolderOpen, count: stats.total },
    { id: 'documents', label: 'Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚', icon: FileText, count: documents.length },
    { id: 'review', label: 'Ø·Ø§Ø¨ÙˆØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: ClipboardCheck, count: stats.underReview },
    { id: 'pack', label: 'Ø­Ø²Ù… Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', icon: Download, count: null },
  ];

  return (
    <div className="space-y-6">
      {/* Header - Enhanced */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold text-slate-900 flex items-center gap-3">
            <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white">
              <FolderOpen className="w-5 h-5" />
            </div>
            Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚
          </h1>
          <p className="text-slate-500 mt-1">Evidence & Document Management - Module 4.5</p>
        </div>
        <div className="flex items-center gap-3">
          <button onClick={() => setShowPackModal(true)} className="flex items-center gap-2 px-4 py-2.5 border-2 border-indigo-200 bg-indigo-50 rounded-xl text-indigo-700 hover:bg-indigo-100 font-bold transition-all">
            <Package className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚
          </button>
          <button onClick={() => setShowUploadModal(true)} className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all">
            <Upload className="w-5 h-5" />Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
          </button>
        </div>
      </div>

      {/* Stats - Enhanced with Animation */}
      <div className="grid grid-cols-7 gap-3">
        <div className="bg-gradient-to-br from-indigo-500 via-purple-500 to-violet-600 rounded-2xl p-4 text-white relative overflow-hidden">
          <div className="absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2" />
          <div className="flex items-center gap-2 mb-2">
            <FolderOpen className="w-5 h-5 text-indigo-200" />
            <p className="text-indigo-100 text-xs">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯Ù„Ø©</p>
          </div>
          <p className="text-3xl font-bold">{stats.total}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-emerald-200 hover:shadow-lg hover:border-emerald-400 transition-all cursor-pointer" onClick={() => setFilterStatus('Accepted')}>
          <div className="flex items-center gap-2 mb-2"><CheckCircle2 className="w-5 h-5 text-emerald-500" /><p className="text-xs text-slate-500">Ù…Ù‚Ø¨ÙˆÙ„Ø©</p></div>
          <p className="text-2xl font-bold text-emerald-600">{stats.accepted}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-amber-200 hover:shadow-lg hover:border-amber-400 transition-all cursor-pointer" onClick={() => setFilterStatus('UnderReview')}>
          <div className="flex items-center gap-2 mb-2"><Clock className="w-5 h-5 text-amber-500" /><p className="text-xs text-slate-500">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p></div>
          <p className="text-2xl font-bold text-amber-600">{stats.underReview}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-blue-200">
          <div className="flex items-center gap-2 mb-1"><FileCheck className="w-4 h-4 text-blue-500" /><p className="text-xs text-slate-500">ØªÙ… Ø§Ù„Ø±ÙØ¹</p></div>
          <p className="text-2xl font-bold text-blue-600">{stats.uploaded}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-slate-200">
          <div className="flex items-center gap-2 mb-1"><Upload className="w-4 h-4 text-slate-500" /><p className="text-xs text-slate-500">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±ÙØ¹</p></div>
          <p className="text-2xl font-bold text-slate-600">{stats.pending}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-red-200 hover:shadow-lg hover:border-red-400 transition-all cursor-pointer" onClick={() => setFilterStatus('Rejected')}>
          <div className="flex items-center gap-2 mb-2"><XCircle className="w-5 h-5 text-red-500" /><p className="text-xs text-slate-500">Ù…Ø±ÙÙˆØ¶Ø©</p></div>
          <p className="text-2xl font-bold text-red-600">{stats.rejected}</p>
        </div>
        <div className="bg-white rounded-2xl p-4 border-2 border-orange-200 hover:shadow-lg hover:border-orange-400 transition-all cursor-pointer" onClick={() => setFilterStatus('Expired')}>
          <div className="flex items-center gap-2 mb-2"><AlertTriangle className="w-5 h-5 text-orange-500" /><p className="text-xs text-slate-500">Ù…Ù†ØªÙ‡ÙŠØ©</p></div>
          <p className="text-2xl font-bold text-orange-600">{stats.expired}</p>
        </div>
      </div>

      {/* Tabs - Enhanced */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden shadow-sm">
        <div className="flex border-b border-slate-200 bg-gradient-to-r from-slate-50 to-slate-100">
          {tabs.map(tab => (
            <button key={tab.id} onClick={() => { setActiveTab(tab.id); setFilterStatus(''); }}
              className={`flex items-center gap-2 px-6 py-4 font-bold transition-all border-b-2 ${activeTab === tab.id ? 'text-indigo-600 border-indigo-500 bg-white -mb-px rounded-t-xl shadow-sm' : 'text-slate-500 border-transparent hover:text-indigo-500 hover:bg-white/50'}`}>
              <tab.icon className="w-5 h-5" />{tab.label}
              {tab.count !== null && <span className={`px-2.5 py-1 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-indigo-500 text-white' : 'bg-slate-200 text-slate-600'}`}>{tab.count}</span>}
            </button>
          ))}
        </div>

        {/* Repository Tab - World-Class */}
        {activeTab === 'repository' && (
          <div className="p-6">
            {/* Advanced Filters & Actions Bar */}
            <div className="flex items-center gap-4 mb-6">
              <div className="flex-1 relative">
                <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                <input type="text" placeholder="Ø¨Ø­Ø« Ù…ØªÙ‚Ø¯Ù…... (Ø§Ù„ÙƒÙˆØ¯ØŒ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†ØŒ Ø§Ù„ÙØªØ±Ø©ØŒ Ø§Ù„ÙˆØ³ÙˆÙ…)" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl focus:outline-none focus:border-indigo-500 transition-all" />
              </div>
              <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)} className="px-4 py-3 border-2 border-slate-200 rounded-xl bg-white font-medium">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                {Object.entries(STATUS_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
              </select>
              <select value={filterType} onChange={(e) => setFilterType(e.target.value)} className="px-4 py-3 border-2 border-slate-200 rounded-xl bg-white font-medium">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                {Object.entries(TYPE_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
              </select>
              {filterStatus && (
                <button onClick={() => setFilterStatus('')} className="px-3 py-2 bg-slate-100 text-slate-600 rounded-lg text-sm flex items-center gap-1 hover:bg-slate-200">
                  <X className="w-4 h-4" />Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
                </button>
              )}
              <div className="flex items-center border-2 border-slate-200 rounded-xl overflow-hidden">
                <button onClick={() => setViewMode('table')} className={`p-3 transition-all ${viewMode === 'table' ? 'bg-indigo-500 text-white' : 'text-slate-500 hover:bg-slate-100'}`}><Table className="w-5 h-5" /></button>
                <button onClick={() => setViewMode('grid')} className={`p-3 transition-all ${viewMode === 'grid' ? 'bg-indigo-500 text-white' : 'text-slate-500 hover:bg-slate-100'}`}><LayoutGrid className="w-5 h-5" /></button>
              </div>
            </div>

            {/* Bulk Actions Bar */}
            {selectedItems.length > 0 && (
              <div className="mb-4 p-3 bg-indigo-50 border-2 border-indigo-200 rounded-xl flex items-center justify-between">
                <span className="text-indigo-700 font-bold">{selectedItems.length} Ø¹Ù†ØµØ± Ù…Ø­Ø¯Ø¯</span>
                <div className="flex items-center gap-2">
                  <button className="px-3 py-1.5 bg-white text-indigo-600 rounded-lg text-sm font-bold hover:bg-indigo-100 flex items-center gap-1"><Download className="w-4 h-4" />ØªØ­Ù…ÙŠÙ„</button>
                  <button className="px-3 py-1.5 bg-white text-emerald-600 rounded-lg text-sm font-bold hover:bg-emerald-100 flex items-center gap-1"><Package className="w-4 h-4" />Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø©</button>
                  <button onClick={() => setSelectedItems([])} className="px-3 py-1.5 bg-white text-slate-600 rounded-lg text-sm font-bold hover:bg-slate-100"><X className="w-4 h-4" /></button>
                </div>
              </div>
            )}

            {/* Table View */}
            {viewMode === 'table' && (
              <div className="overflow-hidden rounded-xl border-2 border-slate-200">
                <table className="w-full">
                  <thead>
                    <tr className="bg-gradient-to-r from-slate-50 to-slate-100">
                      <th className="w-10 px-3 py-4">
                        <input type="checkbox" className="w-4 h-4 rounded"
                          checked={selectedItems.length === filteredEvidence.length && filteredEvidence.length > 0}
                          onChange={(e) => setSelectedItems(e.target.checked ? filteredEvidence.map(e => e.id) : [])} />
                      </th>
                      <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                      <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù†ÙˆØ¹</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙØªØ±Ø©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700 w-36">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredEvidence.map((evd, idx) => {
                      const statusCfg = STATUS_CONFIG[evd.status] || STATUS_CONFIG.PendingUpload;
                      const typeCfg = TYPE_CONFIG[evd.evidenceType] || { label: evd.evidenceType, icon: File, color: 'slate' };
                      const daysUntil = getDaysUntilExpiry(evd.validityEnd);
                      const StatusIcon = statusCfg.icon;
                      const TypeIcon = typeCfg.icon;
                      const isSelected = selectedItems.includes(evd.id);
                      return (
                        <tr key={evd.id} className={`border-b border-slate-100 transition-all ${isSelected ? 'bg-indigo-50' : idx % 2 === 0 ? 'bg-white' : 'bg-slate-50/50'} hover:bg-indigo-50/50`}>
                          <td className="px-3 py-4 text-center">
                            <input type="checkbox" className="w-4 h-4 rounded" checked={isSelected}
                              onChange={(e) => setSelectedItems(e.target.checked ? [...selectedItems, evd.id] : selectedItems.filter(id => id !== evd.id))} />
                          </td>
                          <td className="px-4 py-4">
                            <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-100 px-2.5 py-1 rounded-lg">{evd.code}</span>
                          </td>
                          <td className="px-4 py-4">
                            <div>
                              <p className="font-bold text-slate-800 mb-1">{evd.title}</p>
                              {evd.fileName && <p className="text-xs text-slate-500 flex items-center gap-1"><Paperclip className="w-3 h-3" />{evd.fileName} â€¢ {evd.fileSize}</p>}
                              {evd.tags && evd.tags.length > 0 && (
                                <div className="flex items-center gap-1 mt-1.5">
                                  {evd.tags.slice(0, 2).map((tag, i) => (
                                    <span key={i} className="px-1.5 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">{tag}</span>
                                  ))}
                                  {evd.tags.length > 2 && <span className="text-xs text-slate-400">+{evd.tags.length - 2}</span>}
                                </div>
                              )}
                            </div>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <span className={`inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-bold bg-${typeCfg.color}-100 text-${typeCfg.color}-700`}>
                              <TypeIcon className="w-3.5 h-3.5" />{typeCfg.label}
                            </span>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <span className={`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-xl text-xs font-bold ${statusCfg.bg} ${statusCfg.text}`}>
                              <StatusIcon className="w-3.5 h-3.5" />{statusCfg.label}
                            </span>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <span className="text-sm font-medium text-slate-700 bg-slate-100 px-2 py-1 rounded">{evd.period || 'â€”'}</span>
                          </td>
                          <td className="px-4 py-4 text-center">
                            {evd.validityEnd ? (
                              <div className="flex flex-col items-center">
                                <p className="text-sm text-slate-600">{evd.validityEnd}</p>
                                {daysUntil !== null && (
                                  <span className={`text-xs font-bold mt-1 px-2 py-0.5 rounded ${daysUntil <= 0 ? 'bg-red-100 text-red-600' : daysUntil <= 30 ? 'bg-amber-100 text-amber-600' : 'bg-emerald-100 text-emerald-600'}`}>
                                    {daysUntil <= 0 ? 'Ù…Ù†ØªÙ‡ÙŠ' : `${daysUntil} ÙŠÙˆÙ…`}
                                  </span>
                                )}
                              </div>
                            ) : <span className="text-slate-400">â€”</span>}
                          </td>
                          <td className="px-4 py-4">
                            <div className="flex items-center justify-center gap-2">
                              <div className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${evd.ownerId === 1 ? 'bg-blue-100 text-blue-600' : evd.ownerId === 2 ? 'bg-purple-100 text-purple-600' : 'bg-emerald-100 text-emerald-600'}`}>
                                {evd.ownerName?.charAt(0)}
                              </div>
                              <span className="text-sm text-slate-600 hidden xl:inline">{evd.ownerName}</span>
                            </div>
                          </td>
                          <td className="px-4 py-4">
                            <div className="flex items-center justify-center gap-1">
                              <button onClick={() => { setSelectedEvidence(evd); setShowDetailModal(true); }} className="p-2 hover:bg-blue-100 rounded-lg transition-all group" title="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„">
                                <Eye className="w-4 h-4 text-blue-500 group-hover:text-blue-700" />
                              </button>
                              {evd.status === 'Uploaded' && (
                                <button onClick={() => handleSubmitForReview(evd)} className="p-2 hover:bg-emerald-100 rounded-lg transition-all group" title="Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©">
                                  <Send className="w-4 h-4 text-emerald-500 group-hover:text-emerald-700" />
                                </button>
                              )}
                              {canReview(evd) && (
                                <button onClick={() => { setSelectedEvidence(evd); setRejectComment(''); setShowReviewModal(true); }} className="p-2 hover:bg-amber-100 rounded-lg transition-all group" title="Ù…Ø±Ø§Ø¬Ø¹Ø©">
                                  <ClipboardCheck className="w-4 h-4 text-amber-500 group-hover:text-amber-700" />
                                </button>
                              )}
                              <button className="p-2 hover:bg-slate-100 rounded-lg transition-all group" title="ØªØ­Ù…ÙŠÙ„">
                                <Download className="w-4 h-4 text-slate-500 group-hover:text-slate-700" />
                              </button>
                            </div>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
                {filteredEvidence.length === 0 && (
                  <div className="text-center py-12 bg-slate-50">
                    <FolderOpen className="w-12 h-12 text-slate-300 mx-auto mb-3" />
                    <p className="text-slate-500 font-medium">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>
                  </div>
                )}
              </div>
            )}

            {/* Grid View */}
            {viewMode === 'grid' && (
              <div className="grid grid-cols-4 gap-4">
                {filteredEvidence.map(evd => {
                  const statusCfg = STATUS_CONFIG[evd.status] || STATUS_CONFIG.PendingUpload;
                  const typeCfg = TYPE_CONFIG[evd.evidenceType] || { label: evd.evidenceType, icon: File, color: 'slate' };
                  const daysUntil = getDaysUntilExpiry(evd.validityEnd);
                  const StatusIcon = statusCfg.icon;
                  const TypeIcon = typeCfg.icon;
                  return (
                    <div key={evd.id} onClick={() => { setSelectedEvidence(evd); setShowDetailModal(true); }}
                      className="bg-white rounded-xl border-2 border-slate-200 p-4 hover:shadow-xl hover:border-indigo-300 cursor-pointer transition-all group">
                      <div className="flex items-start justify-between mb-3">
                        <div className={`w-12 h-12 rounded-xl flex items-center justify-center bg-${typeCfg.color}-100`}>
                          <TypeIcon className={`w-6 h-6 text-${typeCfg.color}-600`} />
                        </div>
                        <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold ${statusCfg.bg} ${statusCfg.text}`}>
                          <StatusIcon className="w-3 h-3" />{statusCfg.label}
                        </span>
                      </div>
                      <span className="font-mono text-xs text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded">{evd.code}</span>
                      <h4 className="font-bold text-slate-800 mt-2 line-clamp-2 group-hover:text-indigo-600 transition-colors">{evd.title}</h4>
                      {evd.fileName && <p className="text-xs text-slate-500 mt-1 flex items-center gap-1"><Paperclip className="w-3 h-3" />{evd.fileName}</p>}

                      {daysUntil !== null && evd.status === 'Accepted' && (
                        <div className={`mt-2 px-2 py-1 rounded-lg text-xs font-bold inline-flex items-center gap-1 ${daysUntil <= 0 ? 'bg-red-100 text-red-600' : daysUntil <= 30 ? 'bg-amber-100 text-amber-600' : 'bg-emerald-100 text-emerald-600'}`}>
                          <Clock className="w-3 h-3" />{daysUntil <= 0 ? 'Ù…Ù†ØªÙ‡ÙŠ' : `ØµØ§Ù„Ø­ Ù„Ù€ ${daysUntil} ÙŠÙˆÙ…`}
                        </div>
                      )}

                      <div className="flex items-center justify-between mt-4 pt-3 border-t border-slate-100">
                        <div className="flex items-center gap-2">
                          <div className="w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold">{evd.ownerName?.charAt(0)}</div>
                          <span className="text-xs text-slate-500">{evd.ownerName}</span>
                        </div>
                        <span className="text-xs text-slate-400">{evd.period}</span>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        )}

        {/* Documents Tab - Enhanced */}
        {activeTab === 'documents' && (
          <div className="p-6">
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-4">
                <div className="relative flex-1">
                  <Search className="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" />
                  <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚..." className="w-72 pr-10 pl-4 py-2.5 border-2 border-slate-200 rounded-xl text-sm" />
                </div>
              </div>
              <button onClick={openCreateDocModal} className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold hover:shadow-lg transition-all">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© ÙˆØ«ÙŠÙ‚Ø©
              </button>
            </div>

            <div className="grid grid-cols-3 gap-4">
              {documents.map(doc => (
                <div key={doc.id} className="bg-white rounded-xl border-2 border-slate-200 p-5 hover:shadow-xl hover:border-purple-300 transition-all group relative">
                  {/* Action Buttons */}
                  <div className="absolute top-3 left-3 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                    <button onClick={() => openViewDocModal(doc)} className="p-1.5 bg-blue-100 hover:bg-blue-200 rounded-lg transition-all" title="Ø¹Ø±Ø¶">
                      <Eye className="w-4 h-4 text-blue-600" />
                    </button>
                    <button onClick={() => openEditDocModal(doc)} className="p-1.5 bg-amber-100 hover:bg-amber-200 rounded-lg transition-all" title="ØªØ¹Ø¯ÙŠÙ„">
                      <Edit className="w-4 h-4 text-amber-600" />
                    </button>
                    <button onClick={() => { setSelectedDoc(doc); setShowDocDeleteConfirm(true); }} className="p-1.5 bg-red-100 hover:bg-red-200 rounded-lg transition-all" title="Ø­Ø°Ù">
                      <Trash2 className="w-4 h-4 text-red-600" />
                    </button>
                  </div>

                  <div className="flex items-start justify-between mb-4">
                    <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${doc.docType === 'Policy' ? 'bg-purple-100' : doc.docType === 'Procedure' ? 'bg-blue-100' : doc.docType === 'Standard' ? 'bg-emerald-100' : doc.docType === 'Framework' ? 'bg-indigo-100' : 'bg-amber-100'}`}>
                      <FileText className={`w-6 h-6 ${doc.docType === 'Policy' ? 'text-purple-600' : doc.docType === 'Procedure' ? 'text-blue-600' : doc.docType === 'Standard' ? 'text-emerald-600' : doc.docType === 'Framework' ? 'text-indigo-600' : 'text-amber-600'}`} />
                    </div>
                    <div className="flex items-center gap-2">
                      <span className="px-2 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold">{doc.version}</span>
                      <span className={`px-2 py-1 rounded-lg text-xs font-bold ${doc.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
                        {doc.status === 'Active' ? 'Ù†Ø´Ø·' : 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'}
                      </span>
                    </div>
                  </div>

                  <span className="font-mono text-xs text-purple-600 bg-purple-50 px-1.5 py-0.5 rounded">{doc.code}</span>
                  <h4 className="font-bold text-slate-800 mt-2 group-hover:text-purple-600 transition-colors cursor-pointer" onClick={() => openViewDocModal(doc)}>{doc.titleAr}</h4>
                  <p className="text-xs text-slate-500 mt-1">{doc.titleEn}</p>

                  <div className="mt-3 flex flex-wrap gap-2">
                    <span className={`px-2 py-1 rounded text-xs font-bold ${doc.classification === 'Confidential' ? 'bg-amber-100 text-amber-700' : doc.classification === 'Internal' ? 'bg-blue-100 text-blue-700' : 'bg-emerald-100 text-emerald-700'}`}>
                      {doc.classification === 'Confidential' ? 'Ø³Ø±ÙŠ' : doc.classification === 'Internal' ? 'Ø¯Ø§Ø®Ù„ÙŠ' : 'Ø¹Ø§Ù…'}
                    </span>
                    <span className={`px-2 py-1 rounded text-xs font-bold ${DOC_TYPE_CONFIG[doc.docType]?.color ? `bg-${DOC_TYPE_CONFIG[doc.docType].color}-100 text-${DOC_TYPE_CONFIG[doc.docType].color}-700` : 'bg-slate-100 text-slate-600'}`}>
                      {DOC_TYPE_CONFIG[doc.docType]?.label || doc.docType}
                    </span>
                  </div>

                  <div className="mt-4 pt-3 border-t border-slate-100 flex items-center justify-between">
                    <div className="flex items-center gap-2">
                      <div className="w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-bold">{doc.ownerName?.charAt(0)}</div>
                      <span className="text-xs text-slate-500">{doc.ownerName}</span>
                    </div>
                    <div className="flex items-center gap-1 text-xs text-slate-400">
                      <Download className="w-3 h-3" />{doc.downloads}
                    </div>
                  </div>

                  <div className="mt-3 flex items-center justify-between text-xs text-slate-500">
                    <span>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: {doc.lastUpdated}</span>
                    {doc.linkedEvidence > 0 && <span className="text-indigo-600 font-bold">{doc.linkedEvidence} Ø£Ø¯Ù„Ø© Ù…Ø±ØªØ¨Ø·Ø©</span>}
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Review Queue Tab - Enhanced */}
        {activeTab === 'review' && (
          <div className="p-6">
            {/* Stats Bar */}
            <div className="grid grid-cols-4 gap-4 mb-6">
              <div className="bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl p-4 text-white">
                <div className="flex items-center justify-between">
                  <Clock className="w-8 h-8 text-white/80" />
                  <span className="text-3xl font-bold">{pendingReview.length}</span>
                </div>
                <p className="text-amber-100 mt-2 font-medium">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
              </div>
              <div className="bg-white rounded-xl p-4 border-2 border-emerald-200">
                <div className="flex items-center justify-between">
                  <CheckCircle2 className="w-6 h-6 text-emerald-500" />
                  <span className="text-2xl font-bold text-emerald-600">{stats.accepted}</span>
                </div>
                <p className="text-slate-500 mt-2 text-sm">ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</p>
              </div>
              <div className="bg-white rounded-xl p-4 border-2 border-red-200">
                <div className="flex items-center justify-between">
                  <XCircle className="w-6 h-6 text-red-500" />
                  <span className="text-2xl font-bold text-red-600">{stats.rejected}</span>
                </div>
                <p className="text-slate-500 mt-2 text-sm">ØªÙ… Ø±ÙØ¶Ù‡Ø§</p>
              </div>
              <div className="bg-white rounded-xl p-4 border-2 border-indigo-200">
                <div className="flex items-center justify-between">
                  <User className="w-6 h-6 text-indigo-500" />
                  <span className="text-lg font-bold text-indigo-600">{CURRENT_USER.name}</span>
                </div>
                <p className="text-slate-500 mt-2 text-sm">Evidence Reviewer</p>
              </div>
            </div>

            {/* SoD Notice */}
            <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-4 mb-6">
              <div className="flex items-center gap-3">
                <div className="w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center">
                  <Shield className="w-5 h-5 text-white" />
                </div>
                <div>
                  <p className="font-bold text-blue-800">ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (Segregation of Duties)</p>
                  <p className="text-sm text-blue-700">Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø±ÙØ¹Ù‡Ø§ Ø¨Ù†ÙØ³Ùƒ - ÙŠØªÙ… ØªÙ…ÙŠÙŠØ²Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</p>
                </div>
              </div>
            </div>

            {/* Review Queue */}
            {pendingReview.length > 0 ? (
              <div className="space-y-4">
                {pendingReview.map(evd => {
                  const canReviewThis = canReview(evd);
                  const typeCfg = TYPE_CONFIG[evd.evidenceType] || { label: evd.evidenceType, icon: File, color: 'slate' };
                  const TypeIcon = typeCfg.icon;
                  return (
                    <div key={evd.id} className={`bg-white rounded-xl border-2 p-5 transition-all ${canReviewThis ? 'border-amber-300 hover:shadow-xl hover:border-amber-400' : 'border-slate-200 opacity-60'}`}>
                      <div className="flex items-start justify-between">
                        <div className="flex items-start gap-4">
                          <div className={`w-14 h-14 rounded-xl flex items-center justify-center bg-${typeCfg.color}-100`}>
                            <TypeIcon className={`w-7 h-7 text-${typeCfg.color}-600`} />
                          </div>
                          <div>
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded">{evd.code}</span>
                              <span className={`px-2 py-0.5 rounded text-xs font-bold bg-${typeCfg.color}-100 text-${typeCfg.color}-700`}>{typeCfg.label}</span>
                              {evd.priority && <span className={`px-2 py-0.5 rounded text-xs font-bold bg-${PRIORITY_CONFIG[evd.priority]?.color || 'slate'}-100 text-${PRIORITY_CONFIG[evd.priority]?.color || 'slate'}-700`}>{PRIORITY_CONFIG[evd.priority]?.label}</span>}
                            </div>
                            <h4 className="font-bold text-slate-800 text-lg">{evd.title}</h4>
                            <p className="text-sm text-slate-500 mt-1 flex items-center gap-2">
                              <Paperclip className="w-4 h-4" />{evd.fileName} â€¢ {evd.fileSize}
                            </p>
                            <div className="flex items-center gap-6 mt-3 text-sm">
                              <span className="text-slate-600">Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©: <strong className="text-slate-800">{evd.ownerName}</strong></span>
                              <span className="text-slate-600">Ø§Ù„ÙØªØ±Ø©: <strong className="text-indigo-600">{evd.period}</strong></span>
                              <span className="text-slate-600">Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: <strong className="text-slate-800">{evd.validityEnd}</strong></span>
                            </div>
                            {evd.linkedObligations && evd.linkedObligations.length > 0 && (
                              <div className="flex items-center gap-2 mt-2">
                                <Link2 className="w-4 h-4 text-indigo-500" />
                                <span className="text-xs text-indigo-600">Ù…Ø±ØªØ¨Ø· Ø¨Ù€: {evd.linkedObligations.join(', ')}</span>
                              </div>
                            )}
                          </div>
                        </div>
                        <div className="flex items-center gap-3">
                          {canReviewThis ? (
                            <>
                              <button onClick={() => { setSelectedEvidence(evd); setShowDetailModal(true); }} className="flex items-center gap-2 px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-all">
                                <Eye className="w-5 h-5" />Ø¹Ø±Ø¶
                              </button>
                              <button onClick={() => { setSelectedEvidence(evd); setRejectComment(''); setShowReviewModal(true); }} className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold hover:shadow-lg transition-all">
                                <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø©
                              </button>
                            </>
                          ) : (
                            <div className="flex items-center gap-2 px-4 py-2.5 bg-slate-100 text-slate-500 rounded-xl">
                              <Lock className="w-4 h-4" />
                              <span className="text-sm font-medium">SoD - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            ) : (
              <div className="text-center py-16 bg-gradient-to-b from-slate-50 to-white rounded-xl border-2 border-dashed border-slate-200">
                <div className="w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4">
                  <CheckCircle2 className="w-10 h-10 text-emerald-500" />
                </div>
                <h3 className="text-xl font-bold text-slate-700">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯Ù„Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
                <p className="text-slate-500 mt-2">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø© ØªÙ…Øª Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§</p>
              </div>
            )}
          </div>
        )}

        {/* Audit Packs Tab */}
        {activeTab === 'pack' && (
          <div className="p-6">
            {/* Hero Section */}
            <div className="bg-gradient-to-br from-indigo-500 via-purple-500 to-violet-600 rounded-2xl p-6 text-white mb-6 relative overflow-hidden">
              <div className="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2" />
              <div className="absolute bottom-0 left-0 w-40 h-40 bg-white/10 rounded-full translate-y-1/2 -translate-x-1/2" />
              <div className="relative">
                <div className="flex items-center gap-4 mb-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center backdrop-blur-sm">
                    <Package className="w-7 h-7" />
                  </div>
                  <div>
                    <h3 className="text-2xl font-bold">Ù…ÙˆÙ„Ù‘Ø¯ Ø­Ø²Ù… Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚</h3>
                    <p className="text-indigo-200">Evidence Pack Generator - Audit Ready</p>
                  </div>
                </div>
                <p className="text-indigo-100 mb-6 max-w-2xl">Ø£Ù†Ø´Ø¦ Ø­Ø²Ù…Ø© Ø£Ø¯Ù„Ø© Ø´Ø§Ù…Ù„Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ù‚Ø¨ÙˆÙ„Ø© Ù…Ø¹ Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙØ¬ÙˆØ§Øª.</p>
                <div className="grid grid-cols-4 gap-4 mb-6">
                  <div className="bg-white/20 backdrop-blur-sm rounded-xl p-4">
                    <p className="text-indigo-200 text-sm">Ø£Ø¯Ù„Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø©</p>
                    <p className="text-2xl font-bold">{stats.accepted}</p>
                  </div>
                  <div className="bg-white/20 backdrop-blur-sm rounded-xl p-4">
                    <p className="text-indigo-200 text-sm">ÙˆØ«Ø§Ø¦Ù‚ Ù†Ø´Ø·Ø©</p>
                    <p className="text-2xl font-bold">{documents.filter(d => d.status === 'Active').length}</p>
                  </div>
                  <div className="bg-white/20 backdrop-blur-sm rounded-xl p-4">
                    <p className="text-indigo-200 text-sm">Ø­Ø²Ù… Ø¬Ø§Ù‡Ø²Ø©</p>
                    <p className="text-2xl font-bold">{auditPacks.length}</p>
                  </div>
                  <div className="bg-white/20 backdrop-blur-sm rounded-xl p-4">
                    <p className="text-indigo-200 text-sm">Ù…Ù†ØªÙ‡ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</p>
                    <p className="text-2xl font-bold text-amber-300">{stats.expired}</p>
                  </div>
                </div>
                <button onClick={() => setShowPackModal(true)} className="flex items-center gap-2 px-6 py-3 bg-white text-indigo-600 rounded-xl font-bold hover:bg-indigo-50 shadow-lg hover:shadow-xl transition-all">
                  <Zap className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </button>
              </div>
            </div>

            {/* Existing Packs */}
            <h4 className="font-bold text-slate-800 mb-4 flex items-center gap-2"><History className="w-5 h-5 text-slate-500" />Ø§Ù„Ø­Ø²Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h4>
            <div className="grid grid-cols-2 gap-4">
              {auditPacks.map(pack => (
                <div key={pack.id} className="bg-white rounded-xl border-2 border-slate-200 p-5 hover:shadow-lg hover:border-indigo-300 transition-all">
                  <div className="flex items-start justify-between mb-3">
                    <div className="flex items-center gap-3">
                      <div className="w-12 h-12 rounded-xl bg-indigo-100 flex items-center justify-center">
                        <Package className="w-6 h-6 text-indigo-600" />
                      </div>
                      <div>
                        <span className="font-mono text-xs text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded">{pack.code}</span>
                        <h5 className="font-bold text-slate-800 mt-1">{pack.name}</h5>
                      </div>
                    </div>
                    <span className="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-bold">{pack.status}</span>
                  </div>
                  <div className="grid grid-cols-3 gap-3 mt-4">
                    <div className="text-center p-2 bg-slate-50 rounded-lg">
                      <p className="text-lg font-bold text-indigo-600">{pack.evidenceCount}</p>
                      <p className="text-xs text-slate-500">Ø£Ø¯Ù„Ø©</p>
                    </div>
                    <div className="text-center p-2 bg-slate-50 rounded-lg">
                      <p className="text-lg font-bold text-purple-600">{pack.documentsCount}</p>
                      <p className="text-xs text-slate-500">ÙˆØ«Ø§Ø¦Ù‚</p>
                    </div>
                    <div className="text-center p-2 bg-slate-50 rounded-lg">
                      <p className="text-lg font-bold text-slate-700">{pack.size}</p>
                      <p className="text-xs text-slate-500">Ø§Ù„Ø­Ø¬Ù…</p>
                    </div>
                  </div>
                  <div className="flex items-center justify-between mt-4 pt-3 border-t border-slate-100">
                    <div className="text-xs text-slate-500">
                      <span>Ø¨ÙˆØ§Ø³Ø·Ø© {pack.createdBy}</span> â€¢ <span>{pack.createdAt}</span>
                    </div>
                    <button className="flex items-center gap-1 px-3 py-1.5 bg-indigo-100 text-indigo-600 rounded-lg text-sm font-bold hover:bg-indigo-200">
                      <Download className="w-4 h-4" />ØªØ­Ù…ÙŠÙ„
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UPLOAD MODAL - WORLD CLASS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showUploadModal && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col">
            <div className="bg-gradient-to-l from-indigo-500 via-purple-500 to-violet-600 px-6 py-5 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center backdrop-blur-sm">
                    <Upload className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h2>
                    <p className="text-indigo-200">Evidence Upload - Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©</p>
                  </div>
                </div>
                <button onClick={() => setShowUploadModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="flex-1 overflow-y-auto p-6 space-y-5">
              {/* Drag & Drop Zone */}
              <div className={`border-3 border-dashed rounded-2xl p-8 text-center transition-all ${dragOver ? 'border-indigo-500 bg-indigo-50' : 'border-slate-300 hover:border-indigo-400'}`}
                onDragOver={(e) => { e.preventDefault(); setDragOver(true); }}
                onDragLeave={() => setDragOver(false)}
                onDrop={(e) => { e.preventDefault(); setDragOver(false); }}>
                <div className="w-16 h-16 rounded-2xl bg-indigo-100 flex items-center justify-center mx-auto mb-4">
                  <Upload className="w-8 h-8 text-indigo-600" />
                </div>
                <p className="text-slate-700 font-bold text-lg mb-2">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                <p className="text-sm text-slate-500">PDF, XLSX, PNG, DOC (Ø­ØªÙ‰ 50 MB)</p>
                <button className="mt-4 px-6 py-2.5 bg-indigo-100 text-indigo-600 rounded-xl font-bold hover:bg-indigo-200">
                  Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù
                </button>
              </div>

              <div className="grid grid-cols-2 gap-5">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„ *</label>
                  <select value={uploadForm.evidenceType} onChange={(e) => setUploadForm({ ...uploadForm, evidenceType: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-500 focus:outline-none">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹...</option>
                    {Object.entries(TYPE_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
                  <select value={uploadForm.priority} onChange={(e) => setUploadForm({ ...uploadForm, priority: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-500 focus:outline-none">
                    {Object.entries(PRIORITY_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
                  </select>
                </div>
              </div>

              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ù„ÙŠÙ„ *</label>
                <input type="text" value={uploadForm.title} onChange={(e) => setUploadForm({ ...uploadForm, title: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-500 focus:outline-none" placeholder="Ù…Ø«Ø§Ù„: ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ - ÙŠÙ†Ø§ÙŠØ± 2025" />
              </div>

              <div className="grid grid-cols-3 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© *</label>
                  <input type="date" value={uploadForm.validityEnd} onChange={(e) => setUploadForm({ ...uploadForm, validityEnd: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©</label>
                  <input type="text" value={uploadForm.period} onChange={(e) => setUploadForm({ ...uploadForm, period: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="Ù…Ø«Ø§Ù„: 2025-01" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
                  <select value={uploadForm.confidentiality} onChange={(e) => setUploadForm({ ...uploadForm, confidentiality: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    {Object.entries(CONFIDENTIALITY_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
                  </select>
                </div>
              </div>

              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØ³ÙˆÙ… (Tags)</label>
                <input type="text" value={uploadForm.tags} onChange={(e) => setUploadForm({ ...uploadForm, tags: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙˆØ³ÙˆÙ… Ù…ÙØµÙˆÙ„Ø© Ø¨ÙØ§ØµÙ„Ø©" />
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between">
              <button onClick={() => setShowUploadModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleUpload} className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
                <Upload className="w-5 h-5" />Ø±ÙØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• REVIEW MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showReviewModal && selectedEvidence && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-amber-500 via-orange-500 to-red-500 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                  <ClipboardCheck className="w-7 h-7" />
                </div>
                <div>
                  <h2 className="text-xl font-bold">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„</h2>
                  <p className="text-amber-100">{selectedEvidence.code} - {TYPE_CONFIG[selectedEvidence.evidenceType]?.label}</p>
                </div>
              </div>
            </div>
            <div className="p-6 space-y-5">
              <div className="bg-slate-50 rounded-xl p-4">
                <h4 className="font-bold text-slate-800 text-lg mb-2">{selectedEvidence.title}</h4>
                <div className="grid grid-cols-2 gap-4 text-sm">
                  <div><span className="text-slate-500">Ø§Ù„Ø­Ø¬Ù…:</span> <span className="font-medium">{selectedEvidence.fileSize}</span></div>
                  <div><span className="text-slate-500">Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø©:</span> <span className="font-medium">{selectedEvidence.ownerName}</span></div>
                  <div><span className="text-slate-500">Ø§Ù„ÙØªØ±Ø©:</span> <span className="font-medium">{selectedEvidence.period}</span></div>
                  <div><span className="text-slate-500">Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©:</span> <span className="font-medium">{selectedEvidence.validityEnd}</span></div>
                </div>
              </div>

              <div className="bg-blue-50 rounded-xl p-4 border border-blue-200">
                <div className="flex items-center gap-2 mb-2">
                  <Shield className="w-5 h-5 text-blue-600" />
                  <span className="font-bold text-blue-800">Checksum SHA-256</span>
                </div>
                <code className="text-xs text-blue-700 break-all bg-blue-100 px-2 py-1 rounded block">{selectedEvidence.checksumSha256}</code>
              </div>

              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ (Ù…Ø·Ù„ÙˆØ¨ 20 Ø­Ø±Ù Ù„Ù„Ø±ÙØ¶):</label>
                <textarea value={rejectComment} onChange={(e) => setRejectComment(e.target.value)} rows={3}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl resize-none focus:border-amber-500 focus:outline-none" placeholder="Ø£Ø¯Ø®Ù„ Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ Ø¥Ù† ÙˆØ¬Ø¯..." />
                <div className={`text-xs mt-1 ${rejectComment.length >= 20 ? 'text-emerald-600' : 'text-slate-400'}`}>{rejectComment.length}/20 Ø­Ø±Ù</div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowReviewModal(false); setRejectComment(''); }} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <div className="flex items-center gap-3">
                <button onClick={handleReject} disabled={rejectComment.length < 20}
                  className={`flex items-center gap-2 px-6 py-3 rounded-xl font-bold transition-all ${rejectComment.length >= 20 ? 'bg-red-500 text-white hover:bg-red-600' : 'bg-slate-200 text-slate-400 cursor-not-allowed'}`}>
                  <XCircle className="w-5 h-5" />Ø±ÙØ¶
                </button>
                <button onClick={handleAccept} className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
                  <CheckCircle2 className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DETAIL MODAL - WORLD CLASS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDetailModal && selectedEvidence && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col">
            <div className={`px-6 py-5 text-white ${selectedEvidence.status === 'Accepted' ? 'bg-gradient-to-l from-emerald-500 to-teal-600' : selectedEvidence.status === 'Rejected' ? 'bg-gradient-to-l from-red-500 to-rose-600' : selectedEvidence.status === 'Expired' ? 'bg-gradient-to-l from-orange-500 to-amber-600' : 'bg-gradient-to-l from-indigo-500 to-purple-600'}`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    {(() => { const TypeIcon = TYPE_CONFIG[selectedEvidence.evidenceType]?.icon || FileText; return <TypeIcon className="w-7 h-7" />; })()}
                  </div>
                  <div>
                    <div className="flex items-center gap-2 mb-1">
                      <span className="font-mono text-sm bg-white/20 px-2 py-0.5 rounded">{selectedEvidence.code}</span>
                      <span className="px-2 py-0.5 bg-white/20 rounded text-xs">{TYPE_CONFIG[selectedEvidence.evidenceType]?.label}</span>
                    </div>
                    <h2 className="text-xl font-bold">{selectedEvidence.title}</h2>
                  </div>
                </div>
                <button onClick={() => setShowDetailModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="flex-1 overflow-y-auto p-6 space-y-5">
              {/* Status Banner */}
              <div className={`rounded-xl p-4 ${STATUS_CONFIG[selectedEvidence.status]?.bg} border-2`}>
                <div className="flex items-center gap-3">
                  {(() => { const Icon = STATUS_CONFIG[selectedEvidence.status]?.icon || Clock; return <Icon className={`w-6 h-6 ${STATUS_CONFIG[selectedEvidence.status]?.text}`} />; })()}
                  <p className={`font-bold text-lg ${STATUS_CONFIG[selectedEvidence.status]?.text}`}>{STATUS_CONFIG[selectedEvidence.status]?.label}</p>
                </div>
                {selectedEvidence.status === 'Rejected' && selectedEvidence.reviewerComment && (
                  <div className="mt-3 p-3 bg-white rounded-lg">
                    <p className="text-sm text-red-700"><strong>Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:</strong> {selectedEvidence.reviewerComment}</p>
                  </div>
                )}
              </div>

              {/* File Info */}
              {selectedEvidence.fileName && (
                <div className="bg-slate-50 rounded-xl p-4 flex items-center justify-between">
                  <div className="flex items-center gap-3">
                    <div className="w-12 h-12 rounded-xl bg-slate-200 flex items-center justify-center">
                      <Paperclip className="w-6 h-6 text-slate-600" />
                    </div>
                    <div>
                      <p className="font-bold text-slate-800">{selectedEvidence.fileName}</p>
                      <p className="text-sm text-slate-500">{selectedEvidence.fileSize}</p>
                    </div>
                  </div>
                  <button className="flex items-center gap-2 px-4 py-2 bg-indigo-100 text-indigo-600 rounded-xl font-bold hover:bg-indigo-200">
                    <Download className="w-5 h-5" />ØªØ­Ù…ÙŠÙ„
                  </button>
                </div>
              )}

              {/* Details Grid */}
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©</p>
                  <p className="font-bold text-slate-800">{selectedEvidence.period || 'â€”'}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</p>
                  <p className="font-bold text-slate-800">{selectedEvidence.validityEnd}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</p>
                  <span className={`px-2 py-1 rounded text-sm font-bold bg-${PRIORITY_CONFIG[selectedEvidence.priority]?.color || 'slate'}-100 text-${PRIORITY_CONFIG[selectedEvidence.priority]?.color || 'slate'}-700`}>
                    {PRIORITY_CONFIG[selectedEvidence.priority]?.label || selectedEvidence.priority}
                  </span>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„ØªØµÙ†ÙŠÙ</p>
                  <span className={`px-2 py-1 rounded text-sm font-bold bg-${CONFIDENTIALITY_CONFIG[selectedEvidence.confidentiality]?.color || 'slate'}-100 text-${CONFIDENTIALITY_CONFIG[selectedEvidence.confidentiality]?.color || 'slate'}-700`}>
                    {CONFIDENTIALITY_CONFIG[selectedEvidence.confidentiality]?.label || selectedEvidence.confidentiality}
                  </span>
                </div>
              </div>

              {/* Checksum */}
              {selectedEvidence.checksumSha256 && (
                <div className="bg-blue-50 rounded-xl p-4 border border-blue-200">
                  <h4 className="font-bold text-blue-800 mb-2 flex items-center gap-2"><Shield className="w-5 h-5" />Checksum SHA-256</h4>
                  <code className="text-xs text-blue-700 break-all">{selectedEvidence.checksumSha256}</code>
                </div>
              )}

              {/* Linked Items */}
              {(selectedEvidence.linkedObligations?.length > 0 || selectedEvidence.linkedControls?.length > 0) && (
                <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                  <h4 className="font-bold text-indigo-800 mb-3 flex items-center gap-2"><Link2 className="w-5 h-5" />Ø§Ù„Ø±Ø¨Ø· (Golden Thread)</h4>
                  <div className="flex flex-wrap gap-2">
                    {selectedEvidence.linkedObligations?.map((obl, i) => (
                      <span key={i} className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-bold">{obl}</span>
                    ))}
                    {selectedEvidence.linkedControls?.map((ctrl, i) => (
                      <span key={i} className="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-bold">{ctrl}</span>
                    ))}
                  </div>
                </div>
              )}

              {/* Tags */}
              {selectedEvidence.tags && selectedEvidence.tags.length > 0 && (
                <div className="flex items-center gap-2">
                  <Tag className="w-4 h-4 text-slate-400" />
                  {selectedEvidence.tags.map((tag, i) => (
                    <span key={i} className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs">{tag}</span>
                  ))}
                </div>
              )}

              {/* Owner & Reviewer */}
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                  <p className="text-xs text-indigo-600 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ (Owner)</p>
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold">{selectedEvidence.ownerName?.charAt(0)}</div>
                    <span className="font-bold text-slate-800">{selectedEvidence.ownerName}</span>
                  </div>
                </div>
                <div className="bg-purple-50 rounded-xl p-4 border border-purple-200">
                  <p className="text-xs text-purple-600 mb-2">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ (Reviewer)</p>
                  <div className="flex items-center gap-3">
                    {selectedEvidence.reviewerName ? (
                      <>
                        <div className="w-10 h-10 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold">{selectedEvidence.reviewerName?.charAt(0)}</div>
                        <span className="font-bold text-slate-800">{selectedEvidence.reviewerName}</span>
                      </>
                    ) : <span className="text-slate-400">Ù„Ù… ÙŠÙØ¹ÙŠÙ‘Ù† Ø¨Ø¹Ø¯</span>}
                  </div>
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowDetailModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥ØºÙ„Ø§Ù‚</button>
              <div className="flex items-center gap-2">
                {canReview(selectedEvidence) && (
                  <button onClick={() => { setShowDetailModal(false); setRejectComment(''); setShowReviewModal(true); }} className="flex items-center gap-2 px-5 py-3 bg-amber-100 text-amber-700 rounded-xl font-bold hover:bg-amber-200">
                    <ClipboardCheck className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø©
                  </button>
                )}
                <button className="flex items-center gap-2 px-5 py-3 bg-indigo-100 text-indigo-700 rounded-xl font-bold hover:bg-indigo-200">
                  <Download className="w-5 h-5" />ØªØ­Ù…ÙŠÙ„
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DOCUMENT MODAL - CREATE/EDIT/VIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDocModal && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col">
            <div className={`px-6 py-5 text-white ${docModalMode === 'create' ? 'bg-gradient-to-l from-purple-500 to-indigo-600' : docModalMode === 'edit' ? 'bg-gradient-to-l from-amber-500 to-orange-600' : 'bg-gradient-to-l from-blue-500 to-indigo-600'}`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    {docModalMode === 'create' ? <Plus className="w-7 h-7" /> : docModalMode === 'edit' ? <Edit className="w-7 h-7" /> : <FileText className="w-7 h-7" />}
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">
                      {docModalMode === 'create' ? 'Ø¥Ø¶Ø§ÙØ© ÙˆØ«ÙŠÙ‚Ø© Ø¬Ø¯ÙŠØ¯Ø©' : docModalMode === 'edit' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©' : 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©'}
                    </h2>
                    <p className="text-white/80 text-sm">
                      {docModalMode === 'view' && selectedDoc ? selectedDoc.code : 'Document Management'}
                    </p>
                  </div>
                </div>
                <button onClick={() => setShowDocModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>

            <div className="flex-1 overflow-y-auto p-6 space-y-5">
              {docModalMode === 'view' && selectedDoc ? (
                <>
                  <div className="bg-slate-50 rounded-xl p-4">
                    <h3 className="font-bold text-slate-800 text-lg">{selectedDoc.titleAr}</h3>
                    <p className="text-slate-500">{selectedDoc.titleEn}</p>
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-slate-50 rounded-xl p-4">
                      <p className="text-xs text-slate-500 mb-1">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</p>
                      <p className="font-bold text-slate-800">{DOC_TYPE_CONFIG[selectedDoc.docType]?.label || selectedDoc.docType}</p>
                    </div>
                    <div className="bg-slate-50 rounded-xl p-4">
                      <p className="text-xs text-slate-500 mb-1">Ø§Ù„ØªØµÙ†ÙŠÙ</p>
                      <p className="font-bold text-slate-800">{selectedDoc.classification === 'Confidential' ? 'Ø³Ø±ÙŠ' : selectedDoc.classification === 'Internal' ? 'Ø¯Ø§Ø®Ù„ÙŠ' : 'Ø¹Ø§Ù…'}</p>
                    </div>
                    <div className="bg-slate-50 rounded-xl p-4">
                      <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</p>
                      <p className="font-bold text-slate-800">{selectedDoc.version}</p>
                    </div>
                    <div className="bg-slate-50 rounded-xl p-4">
                      <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø­Ø§Ù„Ø©</p>
                      <span className={`px-2 py-1 rounded text-xs font-bold ${selectedDoc.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
                        {selectedDoc.status === 'Active' ? 'Ù†Ø´Ø·' : 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'}
                      </span>
                    </div>
                  </div>
                  {selectedDoc.description && (
                    <div className="bg-slate-50 rounded-xl p-4">
                      <p className="text-xs text-slate-500 mb-1">Ø§Ù„ÙˆØµÙ</p>
                      <p className="text-slate-700">{selectedDoc.description}</p>
                    </div>
                  )}
                  <div className="grid grid-cols-2 gap-4">
                    <div className="bg-purple-50 rounded-xl p-4 border border-purple-200">
                      <p className="text-xs text-purple-600 mb-2">Ø§Ù„Ù…Ø§Ù„Ùƒ</p>
                      <div className="flex items-center gap-2">
                        <div className="w-8 h-8 rounded-full bg-purple-500 text-white flex items-center justify-center font-bold text-sm">{selectedDoc.ownerName?.charAt(0)}</div>
                        <span className="font-bold text-slate-800">{selectedDoc.ownerName}</span>
                      </div>
                    </div>
                    <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                      <p className="text-xs text-indigo-600 mb-2">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</p>
                      <div className="flex items-center gap-4">
                        <span className="text-sm"><Download className="w-4 h-4 inline ml-1" />{selectedDoc.downloads} ØªØ­Ù…ÙŠÙ„</span>
                        <span className="text-sm"><Link2 className="w-4 h-4 inline ml-1" />{selectedDoc.linkedEvidence} Ø£Ø¯Ù„Ø©</span>
                      </div>
                    </div>
                  </div>
                  <div className="text-xs text-slate-500">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: {selectedDoc.lastUpdated}</div>
                </>
              ) : (
                <>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© *</label>
                      <input type="text" value={docForm.titleAr} onChange={(e) => setDocForm({ ...docForm, titleAr: e.target.value })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-500 focus:outline-none" placeholder="Ø³ÙŠØ§Ø³Ø©..." />
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© *</label>
                      <input type="text" value={docForm.titleEn} onChange={(e) => setDocForm({ ...docForm, titleEn: e.target.value })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-500 focus:outline-none" placeholder="Policy..." />
                    </div>
                  </div>
                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</label>
                      <select value={docForm.docType} onChange={(e) => setDocForm({ ...docForm, docType: e.target.value })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                        {Object.entries(DOC_TYPE_CONFIG).map(([key, val]) => <option key={key} value={key}>{val.label}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
                      <select value={docForm.classification} onChange={(e) => setDocForm({ ...docForm, classification: e.target.value })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                        <option value="Public">Ø¹Ø§Ù…</option>
                        <option value="Internal">Ø¯Ø§Ø®Ù„ÙŠ</option>
                        <option value="Confidential">Ø³Ø±ÙŠ</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</label>
                      <input type="text" value={docForm.version} onChange={(e) => setDocForm({ ...docForm, version: e.target.value })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="v1.0" />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø§Ù„Ùƒ</label>
                    <select value={docForm.ownerId} onChange={(e) => setDocForm({ ...docForm, ownerId: parseInt(e.target.value) })}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                      {USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ</label>
                    <textarea value={docForm.description} onChange={(e) => setDocForm({ ...docForm, description: e.target.value })}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl resize-none" rows={3} placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„ÙˆØ«ÙŠÙ‚Ø©..." />
                  </div>
                  <div className="border-2 border-dashed border-slate-300 rounded-xl p-6 text-center">
                    <Upload className="w-10 h-10 text-slate-400 mx-auto mb-2" />
                    <p className="text-slate-600 font-medium">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                    <p className="text-xs text-slate-400 mt-1">PDF, DOCX (Ø­ØªÙ‰ 20 MB)</p>
                  </div>
                </>
              )}
            </div>

            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowDocModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                {docModalMode === 'view' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Ø¥Ù„ØºØ§Ø¡'}
              </button>
              <div className="flex items-center gap-2">
                {docModalMode === 'view' && selectedDoc && (
                  <>
                    <button onClick={() => { setShowDocModal(false); openEditDocModal(selectedDoc); }} className="flex items-center gap-2 px-5 py-3 bg-amber-100 text-amber-700 rounded-xl font-bold hover:bg-amber-200">
                      <Edit className="w-5 h-5" />ØªØ¹Ø¯ÙŠÙ„
                    </button>
                    <button className="flex items-center gap-2 px-5 py-3 bg-indigo-100 text-indigo-700 rounded-xl font-bold hover:bg-indigo-200">
                      <Download className="w-5 h-5" />ØªØ­Ù…ÙŠÙ„
                    </button>
                  </>
                )}
                {docModalMode !== 'view' && (
                  <button onClick={handleSaveDoc} className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
                    <Save className="w-5 h-5" />{docModalMode === 'create' ? 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©' : 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª'}
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DELETE DOCUMENT CONFIRM â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDocDeleteConfirm && selectedDoc && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-4 text-white">
              <div className="flex items-center gap-3">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <Trash2 className="w-6 h-6" />
                </div>
                <div>
                  <h2 className="text-lg font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h2>
                  <p className="text-red-100 text-sm">{selectedDoc.code}</p>
                </div>
              </div>
            </div>
            <div className="p-6">
              <p className="text-slate-700 mb-4">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©ØŸ</p>
              <div className="bg-red-50 rounded-xl p-4 border border-red-200">
                <p className="font-bold text-slate-800">{selectedDoc.titleAr}</p>
                <p className="text-sm text-slate-500">{selectedDoc.titleEn}</p>
              </div>
              <p className="text-xs text-red-600 mt-3">âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡</p>
            </div>
            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowDocDeleteConfirm(false); setSelectedDoc(null); }} className="px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleDeleteDoc} className="flex items-center gap-2 px-5 py-2.5 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">
                <Trash2 className="w-4 h-4" />ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUDIT PACK MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showPackModal && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-indigo-600 via-purple-600 to-violet-700 px-6 py-5 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Package className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚</h2>
                    <p className="text-indigo-200">Audit Pack Generator</p>
                  </div>
                </div>
                <button onClick={() => setShowPackModal(false)} className="w-10 h-10 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>
            <div className="p-6 space-y-5">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø­Ø²Ù…Ø© *</label>
                <input type="text" className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="Ù…Ø«Ø§Ù„: Ø­Ø²Ù…Ø© ØªØ¯Ù‚ÙŠÙ‚ SAMA Q1-2025" />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</label>
                  <select className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    <option>SAMA</option>
                    <option>NCA</option>
                    <option>PDPL</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙØªØ±Ø©</label>
                  <input type="text" className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="Q1-2025" />
                </div>
              </div>
              <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
                <h4 className="font-bold text-indigo-800 mb-3">Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø­Ø²Ù…Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</h4>
                <div className="grid grid-cols-3 gap-3">
                  <div className="bg-white rounded-lg p-3 text-center">
                    <p className="text-2xl font-bold text-emerald-600">{stats.accepted}</p>
                    <p className="text-xs text-slate-500">Ø£Ø¯Ù„Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø©</p>
                  </div>
                  <div className="bg-white rounded-lg p-3 text-center">
                    <p className="text-2xl font-bold text-purple-600">{documents.filter(d => d.status === 'Active').length}</p>
                    <p className="text-xs text-slate-500">ÙˆØ«Ø§Ø¦Ù‚ Ù†Ø´Ø·Ø©</p>
                  </div>
                  <div className="bg-white rounded-lg p-3 text-center">
                    <p className="text-2xl font-bold text-slate-600">~25 MB</p>
                    <p className="text-xs text-slate-500">Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</p>
                  </div>
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowPackModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={() => { alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø²Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!'); setShowPackModal(false); }} className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg">
                <Zap className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø²Ù…Ø©
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.6: Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
// Compliance Testing Studio - World-Class Edition
// Features: Test Plans, Test Cases, Execution, Findings, Evidence Linking
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ComplianceTests = () => {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // STATE MANAGEMENT
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [activeTab, setActiveTab] = useState('command');
  const [showModal, setShowModal] = useState(false);
  const [modalMode, setModalMode] = useState('view');
  const [modalType, setModalType] = useState('plan'); // plan | case | template | finding
  const [selectedItem, setSelectedItem] = useState(null);
  const [formData, setFormData] = useState(null);
  const [notification, setNotification] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [filterAuthority, setFilterAuthority] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterPeriod, setFilterPeriod] = useState('');
  const [filterTester, setFilterTester] = useState('');
  const [executionStep, setExecutionStep] = useState(0);
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [deleteTarget, setDeleteTarget] = useState(null);

  // Current User (Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† SoD)
  const CURRENT_USER = { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Tester' };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TEST TEMPLATES
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [testTemplates, setTestTemplates] = useState([
    {
      id: 1, code: 'TST-TPL-001', title: 'Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¶Ø§Ø¨Ø·',
      testType: 'Design', objective: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¶Ø§Ø¨Ø· ÙˆÙ…ÙˆØ§Ø¡Ù…ØªÙ‡ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª',
      sampleMethod: 'Judgmental', defaultSampleSize: 5, stepCount: 4, status: 'Active',
      steps: [
        { id: 1, stepNo: 1, instruction: 'Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø¶Ø§Ø¨Ø·', expectedEvidence: 'Document', passFailCriteria: 'Ø§Ù„Ø¶Ø§Ø¨Ø· Ù…ÙˆØ«Ù‚ ÙˆÙ…Ø¹ØªÙ…Ø¯', isMandatory: true },
        { id: 2, stepNo: 2, instruction: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºØ·ÙŠØ© Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', expectedEvidence: 'Report', passFailCriteria: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù…ØºØ·Ø§Ø©', isMandatory: true },
        { id: 3, stepNo: 3, instruction: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª', expectedEvidence: 'Document', passFailCriteria: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ù…Ø­Ø¯Ø¯Ø©', isMandatory: true },
        { id: 4, stepNo: 4, instruction: 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©', expectedEvidence: 'Report', passFailCriteria: 'Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ù…Ù‚Ø¨ÙˆÙ„Ø©', isMandatory: false },
      ],
    },
    {
      id: 2, code: 'TST-TPL-002', title: 'Ø§Ø®ØªØ¨Ø§Ø± ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ´ØºÙŠÙ„',
      testType: 'Operating', objective: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¶Ø§Ø¨Ø· ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ',
      sampleMethod: 'Random', defaultSampleSize: 25, stepCount: 5, status: 'Active',
      steps: [
        { id: 1, stepNo: 1, instruction: 'Ø§Ø®ØªÙŠØ§Ø± Ø¹ÙŠÙ†Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©', expectedEvidence: 'Log', passFailCriteria: 'Ø§Ù„Ø¹ÙŠÙ†Ø© Ù…Ù…Ø«Ù„Ø©', isMandatory: true },
        { id: 2, stepNo: 2, instruction: 'ÙØ­Øµ Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ÙØ¹Ù„ÙŠ', expectedEvidence: 'Screenshot', passFailCriteria: 'ØªÙ†ÙÙŠØ° ØµØ­ÙŠØ­', isMandatory: true },
        { id: 3, stepNo: 3, instruction: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', expectedEvidence: 'Report', passFailCriteria: 'Ù„Ø§ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø¬ÙˆÙ‡Ø±ÙŠØ©', isMandatory: true },
        { id: 4, stepNo: 4, instruction: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙˆØ«ÙŠÙ‚', expectedEvidence: 'Document', passFailCriteria: 'ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„', isMandatory: true },
        { id: 5, stepNo: 5, instruction: 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†ØªØ§Ø¦Ø¬', expectedEvidence: 'Report', passFailCriteria: 'Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­ â‰¥ 95%', isMandatory: true },
      ],
    },
    {
      id: 3, code: 'TST-TPL-003', title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø¯ÙˆØ±ÙŠ',
      testType: 'Compliance', objective: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©',
      sampleMethod: 'Systematic', defaultSampleSize: 10, stepCount: 6, status: 'Active',
      steps: [
        { id: 1, stepNo: 1, instruction: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ØªØ·Ù„Ø¨ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', expectedEvidence: 'Document', passFailCriteria: 'Ø§Ù„Ù…ØªØ·Ù„Ø¨ Ù…Ø­Ø¯Ø¯', isMandatory: true },
        { id: 2, stepNo: 2, instruction: 'Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', expectedEvidence: 'Multiple', passFailCriteria: 'Ø£Ø¯Ù„Ø© ÙƒØ§ÙÙŠØ©', isMandatory: true },
        { id: 3, stepNo: 3, instruction: 'Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø¯Ù„Ø© Ø¨Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', expectedEvidence: 'Report', passFailCriteria: 'ØªØ·Ø§Ø¨Ù‚ ÙƒØ§Ù…Ù„', isMandatory: true },
        { id: 4, stepNo: 4, instruction: 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ¬ÙˆØ§Øª', expectedEvidence: 'Report', passFailCriteria: 'Ù„Ø§ ÙØ¬ÙˆØ§Øª', isMandatory: true },
        { id: 5, stepNo: 5, instruction: 'Ù…Ø±Ø§Ø¬Ø¹Ø© CAPA Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©', expectedEvidence: 'Document', passFailCriteria: 'CAPA Ù…ØºÙ„Ù‚Ø©', isMandatory: false },
        { id: 6, stepNo: 6, instruction: 'Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ', expectedEvidence: 'Report', passFailCriteria: 'ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØªÙ…Ù„', isMandatory: true },
      ],
    },
    {
      id: 4, code: 'TST-TPL-004', title: 'Ø§Ø®ØªØ¨Ø§Ø± Walkthrough',
      testType: 'Walkthrough', objective: 'ÙÙ‡Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©',
      sampleMethod: 'Judgmental', defaultSampleSize: 1, stepCount: 3, status: 'Active',
      steps: [
        { id: 1, stepNo: 1, instruction: 'Ù…Ù‚Ø§Ø¨Ù„Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„', expectedEvidence: 'Document', passFailCriteria: 'ÙÙ‡Ù… ÙˆØ§Ø¶Ø­', isMandatory: true },
        { id: 2, stepNo: 2, instruction: 'Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', expectedEvidence: 'Screenshot', passFailCriteria: 'Ø¹Ù…Ù„ÙŠØ© Ù…ÙˆØ«Ù‚Ø©', isMandatory: true },
        { id: 3, stepNo: 3, instruction: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª', expectedEvidence: 'Report', passFailCriteria: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©', isMandatory: true },
      ],
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TEST PLANS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [testPlans, setTestPlans] = useState([
    {
      id: 1, code: 'PLAN-2025-Q1-001', title: 'Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ - Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„ 2025',
      authorityId: 1, periodKey: 'Q1-2025', scope: { bu: 'All', process: 'All', system: 'All' },
      status: 'Active', ownerId: 1, approverId: 2, testCaseCount: 5,
      startDate: '2025-01-01', endDate: '2025-03-31',
      createdAt: '2025-01-01', approvedAt: '2025-01-05',
    },
    {
      id: 2, code: 'PLAN-2025-Q1-002', title: 'Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ - Q1',
      authorityId: 3, periodKey: 'Q1-2025', scope: { bu: 'IT', process: 'Security', system: 'All' },
      status: 'Active', ownerId: 3, approverId: 1, testCaseCount: 3,
      startDate: '2025-01-15', endDate: '2025-03-15',
      createdAt: '2025-01-10', approvedAt: '2025-01-12',
    },
    {
      id: 3, code: 'PLAN-2025-Q2-001', title: 'Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ',
      authorityId: 4, periodKey: 'Q2-2025', scope: { bu: 'All', process: 'Data', system: 'All' },
      status: 'Draft', ownerId: 4, approverId: 1, testCaseCount: 0,
      startDate: '2025-04-01', endDate: '2025-06-30',
      createdAt: '2025-02-01', approvedAt: null,
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TEST CASES
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [testCases, setTestCases] = useState([
    {
      id: 1, code: 'TC-2025-001', planId: 1, obligationId: 1, controlId: 1, templateId: 3,
      title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
      testerId: 2, reviewerId: 1, dueDate: '2025-02-15',
      status: 'Submitted', overallResult: 'Pass',
      sampleSize: 10, populationRef: 'ØªÙ‚Ø§Ø±ÙŠØ± ÙŠÙ†Ø§ÙŠØ± 2025',
      startedAt: '2025-02-01', submittedAt: '2025-02-10',
      stepResults: [
        { stepId: 1, result: 'Pass', comment: 'Ø§Ù„Ù…ØªØ·Ù„Ø¨ Ù…Ø­Ø¯Ø¯ ÙˆÙˆØ§Ø¶Ø­', evidenceIds: [1] },
        { stepId: 2, result: 'Pass', comment: 'ØªÙ… Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø©', evidenceIds: [1, 2] },
        { stepId: 3, result: 'Pass', comment: 'ØªØ·Ø§Ø¨Ù‚ ÙƒØ§Ù…Ù„', evidenceIds: [3] },
        { stepId: 4, result: 'Pass', comment: 'Ù„Ø§ ÙØ¬ÙˆØ§Øª', evidenceIds: [] },
        { stepId: 5, result: 'N/A', comment: 'Ù„Ø§ CAPA Ø³Ø§Ø¨Ù‚Ø©', evidenceIds: [] },
        { stepId: 6, result: 'Pass', comment: 'ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØªÙ…Ù„', evidenceIds: [4] },
      ],
      notes: 'Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¬Ø­ - Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙƒØ§Ù…Ù„',
    },
    {
      id: 2, code: 'TC-2025-002', planId: 1, obligationId: 2, controlId: 2, templateId: 2,
      title: 'Ø§Ø®ØªØ¨Ø§Ø± ÙØ¹Ø§Ù„ÙŠØ© Ø¶Ø§Ø¨Ø· Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª',
      testerId: 2, reviewerId: 1, dueDate: '2025-02-20',
      status: 'InProgress', overallResult: null,
      sampleSize: 25, populationRef: 'Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙŠÙ†Ø§ÙŠØ± 2025',
      startedAt: '2025-02-05', submittedAt: null,
      stepResults: [
        { stepId: 1, result: 'Pass', comment: 'Ø¹ÙŠÙ†Ø© 25 Ù…Ø¹Ø§Ù…Ù„Ø©', evidenceIds: [5] },
        { stepId: 2, result: 'Pass', comment: 'ØªÙ†ÙÙŠØ° ØµØ­ÙŠØ­', evidenceIds: [6] },
        { stepId: 3, result: 'Fail', comment: 'ÙˆØ¬ÙˆØ¯ 3 Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', evidenceIds: [7] },
        { stepId: 4, result: null, comment: '', evidenceIds: [] },
        { stepId: 5, result: null, comment: '', evidenceIds: [] },
      ],
      notes: '',
    },
    {
      id: 3, code: 'TC-2025-003', planId: 1, obligationId: 3, controlId: 5, templateId: 1,
      title: 'Ø§Ø®ØªØ¨Ø§Ø± ØªØµÙ…ÙŠÙ… Ø¶Ø§Ø¨Ø· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØµÙˆÙ„',
      testerId: 3, reviewerId: 1, dueDate: '2025-02-25',
      status: 'NotStarted', overallResult: null,
      sampleSize: 5, populationRef: null,
      startedAt: null, submittedAt: null,
      stepResults: [],
      notes: '',
    },
    {
      id: 4, code: 'TC-2025-004', planId: 2, obligationId: 5, controlId: 6, templateId: 2,
      title: 'Ø§Ø®ØªØ¨Ø§Ø± ÙØ¹Ø§Ù„ÙŠØ© Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      testerId: 3, reviewerId: 2, dueDate: '2025-03-01',
      status: 'Reviewed', overallResult: 'Partial',
      sampleSize: 20, populationRef: 'Ø£Ø­Ø¯Ø§Ø« Ø£Ù…Ù†ÙŠØ© Q4-2024',
      startedAt: '2025-02-10', submittedAt: '2025-02-20',
      stepResults: [
        { stepId: 1, result: 'Pass', comment: 'Ø¹ÙŠÙ†Ø© Ù…Ù…Ø«Ù„Ø©', evidenceIds: [8] },
        { stepId: 2, result: 'Pass', comment: 'ØªÙ†ÙÙŠØ° ØµØ­ÙŠØ­', evidenceIds: [9] },
        { stepId: 3, result: 'Fail', comment: '2 Ø­ÙˆØ§Ø¯Ø« ØºÙŠØ± Ù…ÙˆØ«Ù‚Ø©', evidenceIds: [10] },
        { stepId: 4, result: 'Pass', comment: 'ØªÙˆØ«ÙŠÙ‚ Ø¬ÙŠØ¯', evidenceIds: [11] },
        { stepId: 5, result: 'Partial', comment: 'Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­ 90%', evidenceIds: [12] },
      ],
      notes: 'ÙŠØªØ·Ù„Ø¨ ØªØ­Ø³ÙŠÙ† ÙÙŠ ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø­ÙˆØ§Ø¯Ø«',
    },
    {
      id: 5, code: 'TC-2025-005', planId: 1, obligationId: 4, controlId: 3, templateId: 3,
      title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„ Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡',
      testerId: 4, reviewerId: 1, dueDate: '2025-03-10',
      status: 'NotStarted', overallResult: null,
      sampleSize: 15, populationRef: null,
      startedAt: null, submittedAt: null,
      stepResults: [],
      notes: '',
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // FINDINGS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [findings, setFindings] = useState([
    {
      id: 1, code: 'FND-2025-001', testCaseId: 2, severity: 'Medium',
      findingType: 'ControlFailure', title: 'Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª ÙÙŠ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª',
      description: 'ØªÙ… Ø±ØµØ¯ 3 Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ù… ØªØ®Ø¶Ø¹ Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©',
      rootCause: 'Ø®Ù„Ù„ ÙÙŠ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ÙÙ„ØªØ±Ø©',
      recommendation: 'ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯ÙˆÙ„ÙŠ',
      status: 'Open', capaId: null, responsibleId: 2, dueDate: '2025-03-15',
      createdAt: '2025-02-10', createdBy: 2,
    },
    {
      id: 2, code: 'FND-2025-002', testCaseId: 4, severity: 'High',
      findingType: 'ProcessGap', title: 'Ù†Ù‚Øµ ÙÙŠ ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
      description: 'Ø­Ø§Ø¯Ø«ØªØ§Ù† Ø£Ù…Ù†ÙŠØªØ§Ù† Ù„Ù… ÙŠØªÙ… ØªÙˆØ«ÙŠÙ‚Ù‡Ù…Ø§ ÙˆÙÙ‚ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯',
      rootCause: 'Ø¹Ø¯Ù… ÙˆØ¶ÙˆØ­ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ù„Ù„ÙØ±ÙŠÙ‚',
      recommendation: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù…ÙˆØ°Ø¬',
      status: 'ConvertedToCAPA', capaId: 1, responsibleId: 3, dueDate: '2025-03-01',
      createdAt: '2025-02-20', createdBy: 3,
    },
    {
      id: 3, code: 'FND-2025-003', testCaseId: 4, severity: 'Low',
      findingType: 'EvidenceInsufficient', title: 'Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©',
      description: 'Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø© ØºÙŠØ± Ù…Ø¤Ø±Ø®Ø©',
      rootCause: 'Ø¹Ø¯Ù… Ø§Ù„ØªÙ‚ÙŠØ¯ Ø¨Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙˆØ«ÙŠÙ‚',
      recommendation: 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ø¨Ø¹ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù„Ø©',
      status: 'Closed', capaId: null, responsibleId: 3, dueDate: '2025-02-25',
      createdAt: '2025-02-20', createdBy: 3, closedAt: '2025-02-24',
    },
  ]);


  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CONFIGURATIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const TEST_TYPE_CONFIG = {
    Design: { label: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØµÙ…ÙŠÙ…', icon: FileText, color: 'blue' },
    Operating: { label: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´ØºÙŠÙ„', icon: Play, color: 'emerald' },
    Compliance: { label: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', icon: Shield, color: 'purple' },
    Walkthrough: { label: 'Walkthrough', icon: Eye, color: 'amber' },
  };

  const PLAN_STATUS_CONFIG = {
    Draft: { label: 'Ù…Ø³ÙˆØ¯Ø©', bg: 'bg-slate-100', text: 'text-slate-600' },
    Approved: { label: 'Ù…Ø¹ØªÙ…Ø¯', bg: 'bg-blue-100', text: 'text-blue-700' },
    Active: { label: 'Ù†Ø´Ø·', bg: 'bg-emerald-100', text: 'text-emerald-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', bg: 'bg-slate-100', text: 'text-slate-500' },
  };

  const CASE_STATUS_CONFIG = {
    NotStarted: { label: 'Ù„Ù… ÙŠØ¨Ø¯Ø£', icon: Clock, bg: 'bg-slate-100', text: 'text-slate-600' },
    InProgress: { label: 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°', icon: Play, bg: 'bg-blue-100', text: 'text-blue-700' },
    Submitted: { label: 'Ù…Ø±Ø³Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: Send, bg: 'bg-amber-100', text: 'text-amber-700' },
    Reviewed: { label: 'ØªÙ…Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', icon: Lock, bg: 'bg-slate-100', text: 'text-slate-500' },
  };

  const RESULT_CONFIG = {
    Pass: { label: 'Ù†Ø§Ø¬Ø­', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700', border: 'border-emerald-300' },
    Fail: { label: 'ÙØ§Ø´Ù„', icon: XCircle, bg: 'bg-red-100', text: 'text-red-700', border: 'border-red-300' },
    Partial: { label: 'Ø¬Ø²Ø¦ÙŠ', icon: AlertCircle, bg: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-300' },
    'N/A': { label: 'ØºÙŠØ± Ù…Ù†Ø·Ø¨Ù‚', icon: MinusCircle, bg: 'bg-slate-100', text: 'text-slate-600', border: 'border-slate-300' },
  };

  const SEVERITY_CONFIG = {
    High: { label: 'Ø¹Ø§Ù„ÙŠ', bg: 'bg-red-100', text: 'text-red-700', border: 'border-red-300' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', bg: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-300' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', bg: 'bg-emerald-100', text: 'text-emerald-700', border: 'border-emerald-300' },
  };

  const FINDING_TYPE_CONFIG = {
    ControlFailure: { label: 'ÙØ´Ù„ Ø§Ù„Ø¶Ø§Ø¨Ø·', icon: Shield },
    PolicyGap: { label: 'ÙØ¬ÙˆØ© Ø³ÙŠØ§Ø³Ø©', icon: FileText },
    EvidenceInsufficient: { label: 'Ø£Ø¯Ù„Ø© ØºÙŠØ± ÙƒØ§ÙÙŠØ©', icon: FileQuestion },
    ProcessGap: { label: 'ÙØ¬ÙˆØ© Ø¥Ø¬Ø±Ø§Ø¦ÙŠØ©', icon: GitBranch },
  };

  const FINDING_STATUS_CONFIG = {
    Open: { label: 'Ù…ÙØªÙˆØ­', bg: 'bg-amber-100', text: 'text-amber-700' },
    ConvertedToCAPA: { label: 'ØªØ­ÙˆÙŠÙ„ Ù„Ù€ CAPA', bg: 'bg-purple-100', text: 'text-purple-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', bg: 'bg-emerald-100', text: 'text-emerald-700' },
  };

  const TESTERS = [
    { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' },
    { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', role: 'Compliance Tester' },
    { id: 3, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', role: 'IT Auditor' },
    { id: 4, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'Data Protection' },
    { id: 5, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'Governance Analyst' },
  ];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // COMPUTED STATISTICS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const stats = useMemo(() => {
    const totalCases = testCases.length;
    const notStarted = testCases.filter(tc => tc.status === 'NotStarted').length;
    const inProgress = testCases.filter(tc => tc.status === 'InProgress').length;
    const submitted = testCases.filter(tc => tc.status === 'Submitted').length;
    const reviewed = testCases.filter(tc => tc.status === 'Reviewed' || tc.status === 'Closed').length;

    const passed = testCases.filter(tc => tc.overallResult === 'Pass').length;
    const failed = testCases.filter(tc => tc.overallResult === 'Fail').length;
    const partial = testCases.filter(tc => tc.overallResult === 'Partial').length;

    const openFindings = findings.filter(f => f.status === 'Open').length;
    const highFindings = findings.filter(f => f.severity === 'High' && f.status !== 'Closed').length;

    const totalObligations = INITIAL_OBLIGATIONS.length;
    const testedObligations = [...new Set(testCases.map(tc => tc.obligationId))].length;
    const coveragePercent = Math.round((testedObligations / totalObligations) * 100);

    const dueSoon = testCases.filter(tc => {
      if (!tc.dueDate || tc.status === 'Reviewed' || tc.status === 'Closed') return false;
      const days = Math.ceil((new Date(tc.dueDate) - new Date()) / (1000 * 60 * 60 * 24));
      return days >= 0 && days <= 7;
    }).length;

    const overdue = testCases.filter(tc => {
      if (!tc.dueDate || tc.status === 'Reviewed' || tc.status === 'Closed') return false;
      return new Date(tc.dueDate) < new Date();
    }).length;

    return {
      totalCases, notStarted, inProgress, submitted, reviewed,
      passed, failed, partial, openFindings, highFindings,
      coveragePercent, testedObligations, totalObligations,
      dueSoon, overdue, totalPlans: testPlans.length,
      activePlans: testPlans.filter(p => p.status === 'Active').length,
    };
  }, [testCases, findings, testPlans]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // HELPER FUNCTIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  const getUser = (id) => TESTERS.find(u => u.id === id);
  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);
  const getObligation = (id) => INITIAL_OBLIGATIONS.find(o => o.id === id);
  const getControl = (id) => CONTROLS.find(c => c.id === id);
  const getTemplate = (id) => testTemplates.find(t => t.id === id);
  const getPlan = (id) => testPlans.find(p => p.id === id);

  const canReview = (testCase) => {
    // SoD: Ø§Ù„Ù…Ø®ØªØ¨Ø± Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù‡ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ø®ØªØ¨Ø§Ø±Ù‡
    return testCase.testerId !== CURRENT_USER.id && testCase.reviewerId === CURRENT_USER.id;
  };

  const getDaysUntilDue = (dueDate) => {
    if (!dueDate) return null;
    return Math.ceil((new Date(dueDate) - new Date()) / (1000 * 60 * 60 * 24));
  };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CRUD HANDLERS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const handleCreatePlan = () => {
    setFormData({
      id: null, code: `PLAN-2025-Q${Math.ceil((new Date().getMonth() + 1) / 3)}-${String(testPlans.length + 1).padStart(3, '0')}`,
      title: '', authorityId: '', periodKey: '', scope: { bu: 'All', process: 'All', system: 'All' },
      status: 'Draft', ownerId: CURRENT_USER.id, approverId: '', testCaseCount: 0,
      startDate: '', endDate: '', createdAt: new Date().toISOString().split('T')[0],
    });
    setModalType('plan');
    setModalMode('create');
    setShowModal(true);
  };

  const handleCreateCase = (planId = null) => {
    setFormData({
      id: null, code: `TC-2025-${String(testCases.length + 1).padStart(3, '0')}`,
      planId: planId || '', obligationId: '', controlId: '', templateId: '',
      title: '', testerId: '', reviewerId: '', dueDate: '',
      status: 'NotStarted', overallResult: null,
      sampleSize: 10, populationRef: '', startedAt: null, submittedAt: null,
      stepResults: [], notes: '',
    });
    setModalType('case');
    setModalMode('create');
    setShowModal(true);
  };

  const handleCreateFinding = (testCaseId = null) => {
    setFormData({
      id: null, code: `FND-2025-${String(findings.length + 1).padStart(3, '0')}`,
      testCaseId: testCaseId || '', severity: 'Medium', findingType: 'ControlFailure',
      title: '', description: '', rootCause: '', recommendation: '',
      status: 'Open', capaId: null, responsibleId: '', dueDate: '',
      createdAt: new Date().toISOString().split('T')[0], createdBy: CURRENT_USER.id,
    });
    setModalType('finding');
    setModalMode('create');
    setShowModal(true);
  };

  const handleSave = () => {
    const now = new Date().toISOString().split('T')[0];

    if (modalType === 'plan') {
      if (!formData.title || !formData.periodKey) {
        showNotification('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙØªØ±Ø© Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
        return;
      }
      if (modalMode === 'create') {
        setTestPlans([...testPlans, { ...formData, id: testPlans.length + 1 }]);
        showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        setTestPlans(testPlans.map(p => p.id === formData.id ? formData : p));
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±');
      }
    } else if (modalType === 'case') {
      if (!formData.obligationId || !formData.templateId || !formData.testerId || !formData.reviewerId) {
        showNotification('Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆØ§Ù„Ù‚Ø§Ù„Ø¨ ÙˆØ§Ù„Ù…Ø®ØªØ¨Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      if (formData.testerId === formData.reviewerId) {
        showNotification('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø®ØªØ¨Ø± Ù‡Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ (SoD)', 'error');
        return;
      }
      if (modalMode === 'create') {
        const template = getTemplate(parseInt(formData.templateId));
        const newCase = {
          ...formData,
          id: testCases.length + 1,
          stepResults: template?.steps.map(s => ({ stepId: s.id, result: null, comment: '', evidenceIds: [] })) || [],
        };
        setTestCases([...testCases, newCase]);
        showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        setTestCases(testCases.map(tc => tc.id === formData.id ? formData : tc));
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±');
      }
    } else if (modalType === 'finding') {
      if (!formData.testCaseId || !formData.title || !formData.description) {
        showNotification('Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙˆØµÙ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      if (modalMode === 'create') {
        setFindings([...findings, { ...formData, id: findings.length + 1 }]);
        showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        setFindings(findings.map(f => f.id === formData.id ? formData : f));
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©');
      }
    }

    setShowModal(false);
    setFormData(null);
  };

  const handleDelete = () => {
    if (modalType === 'plan') {
      setTestPlans(testPlans.filter(p => p.id !== deleteTarget.id));
    } else if (modalType === 'case') {
      setTestCases(testCases.filter(tc => tc.id !== deleteTarget.id));
    } else if (modalType === 'finding') {
      setFindings(findings.filter(f => f.id !== deleteTarget.id));
    }
    showNotification('ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­');
    setShowDeleteConfirm(false);
    setDeleteTarget(null);
  };

  const handleStartExecution = (testCase) => {
    setTestCases(testCases.map(tc => tc.id === testCase.id ? {
      ...tc, status: 'InProgress', startedAt: new Date().toISOString().split('T')[0]
    } : tc));
    showNotification('ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°');
  };

  const handleSubmitForReview = (testCase) => {
    const template = getTemplate(testCase.templateId);
    const mandatorySteps = template?.steps.filter(s => s.isMandatory) || [];
    const completedMandatory = mandatorySteps.every(s => {
      const result = testCase.stepResults.find(sr => sr.stepId === s.id);
      return result && result.result !== null;
    });

    if (!completedMandatory) {
      showNotification('ÙŠØ¬Ø¨ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©', 'error');
      return;
    }

    // Check if any Fail result needs a finding
    const failedSteps = testCase.stepResults.filter(sr => sr.result === 'Fail');
    const existingFindings = findings.filter(f => f.testCaseId === testCase.id);

    if (failedSteps.length > 0 && existingFindings.length === 0) {
      showNotification('ÙŠØ¬Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©', 'error');
      return;
    }

    // Calculate overall result
    const results = testCase.stepResults.filter(sr => sr.result && sr.result !== 'N/A').map(sr => sr.result);
    let overallResult = 'Pass';
    if (results.includes('Fail')) {
      overallResult = results.every(r => r === 'Fail') ? 'Fail' : 'Partial';
    }

    setTestCases(testCases.map(tc => tc.id === testCase.id ? {
      ...tc, status: 'Submitted', overallResult, submittedAt: new Date().toISOString().split('T')[0]
    } : tc));
    showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  };

  const handleApproveReview = (testCase) => {
    setTestCases(testCases.map(tc => tc.id === testCase.id ? {
      ...tc, status: 'Reviewed'
    } : tc));
    showNotification('ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±');
  };

  const handleReturnForRevision = (testCase) => {
    setTestCases(testCases.map(tc => tc.id === testCase.id ? {
      ...tc, status: 'InProgress', submittedAt: null
    } : tc));
    showNotification('ØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©');
  };

  const handleConvertToCAPA = (finding) => {
    setFindings(findings.map(f => f.id === finding.id ? {
      ...f, status: 'ConvertedToCAPA', capaId: finding.id
    } : f));
    showNotification('ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ù„Ù‰ CAPA');
  };

  const handleUpdateStepResult = (testCaseId, stepId, result, comment) => {
    setTestCases(testCases.map(tc => {
      if (tc.id !== testCaseId) return tc;
      const newStepResults = tc.stepResults.map(sr =>
        sr.stepId === stepId ? { ...sr, result, comment } : sr
      );
      return { ...tc, stepResults: newStepResults };
    }));
  };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TABS CONFIGURATION
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const tabs = [
    { id: 'command', label: 'Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…', icon: LayoutDashboard, count: null },
    { id: 'plans', label: 'Ø®Ø·Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: ClipboardList, count: testPlans.length },
    { id: 'cases', label: 'Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: FileCheck, count: stats.inProgress + stats.notStarted },
    { id: 'execution', label: 'Ø§Ù„ØªÙ†ÙÙŠØ°', icon: Play, count: stats.inProgress },
    { id: 'findings', label: 'Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª', icon: AlertTriangle, count: stats.openFindings },
    { id: 'templates', label: 'Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: FileText, count: testTemplates.length },
  ];


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* Notification */}
      {notification && (
        <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold ${notification.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}`}>
          {notification.message}
        </div>
      )}

      {/* Header */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center shadow-lg">
            <ClipboardCheck className="w-7 h-7 text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-slate-900">Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</h1>
            <p className="text-slate-500">Compliance Testing Studio - Module 4.6</p>
          </div>
        </div>
        <div className="flex items-center gap-3">
          <button onClick={handleCreatePlan}
            className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <FolderPlus className="w-5 h-5" />Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©
          </button>
          <button onClick={() => handleCreateCase()}
            className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold shadow-lg">
            <Plus className="w-5 h-5" />Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯
          </button>
        </div>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-8 gap-3">
        <div className="bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl p-4 text-white">
          <div className="flex items-center justify-between mb-2">
            <Target className="w-6 h-6 text-white/80" />
            <span className="text-3xl font-bold">{stats.coveragePercent}%</span>
          </div>
          <p className="text-purple-100 text-sm">ØªØºØ·ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
          <p className="text-xs text-purple-200">{stats.testedObligations}/{stats.totalObligations} Ø§Ù„ØªØ²Ø§Ù…</p>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.overdue > 0 ? 'bg-red-50 border-red-300 animate-pulse' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <AlertTriangle className={`w-5 h-5 ${stats.overdue > 0 ? 'text-red-500' : 'text-slate-400'}`} />
            <p className="text-xs text-slate-500">Ù…ØªØ£Ø®Ø±</p>
          </div>
          <p className={`text-2xl font-bold ${stats.overdue > 0 ? 'text-red-600' : 'text-slate-400'}`}>{stats.overdue}</p>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.dueSoon > 0 ? 'bg-amber-50 border-amber-300' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <Clock className="w-5 h-5 text-amber-500" />
            <p className="text-xs text-slate-500">ÙŠØ³ØªØ­Ù‚ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
          </div>
          <p className="text-2xl font-bold text-amber-600">{stats.dueSoon}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-blue-200">
          <div className="flex items-center gap-2 mb-1">
            <Play className="w-5 h-5 text-blue-500" />
            <p className="text-xs text-slate-500">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
          </div>
          <p className="text-2xl font-bold text-blue-600">{stats.inProgress}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-emerald-200">
          <div className="flex items-center gap-2 mb-1">
            <CheckCircle2 className="w-5 h-5 text-emerald-500" />
            <p className="text-xs text-slate-500">Ù†Ø§Ø¬Ø­</p>
          </div>
          <p className="text-2xl font-bold text-emerald-600">{stats.passed}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-red-200">
          <div className="flex items-center gap-2 mb-1">
            <XCircle className="w-5 h-5 text-red-500" />
            <p className="text-xs text-slate-500">ÙØ§Ø´Ù„</p>
          </div>
          <p className="text-2xl font-bold text-red-600">{stats.failed}</p>
        </div>

        <div className={`rounded-2xl p-4 border-2 ${stats.highFindings > 0 ? 'bg-orange-50 border-orange-300' : 'bg-white border-slate-200'}`}>
          <div className="flex items-center gap-2 mb-1">
            <AlertCircle className="w-5 h-5 text-orange-500" />
            <p className="text-xs text-slate-500">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…ÙØªÙˆØ­Ø©</p>
          </div>
          <p className="text-2xl font-bold text-orange-600">{stats.openFindings}</p>
        </div>

        <div className="bg-white rounded-2xl p-4 border-2 border-slate-200">
          <div className="flex items-center gap-2 mb-1">
            <FileCheck className="w-5 h-5 text-slate-500" />
            <p className="text-xs text-slate-500">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
          </div>
          <p className="text-2xl font-bold text-slate-700">{stats.totalCases}</p>
        </div>
      </div>

      {/* Main Content */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
        {/* Tabs */}
        <div className="flex border-b border-slate-200 overflow-x-auto">
          {tabs.map(tab => (
            <button key={tab.id} onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-5 py-4 font-bold transition-all border-b-2 whitespace-nowrap ${activeTab === tab.id ? 'text-purple-600 border-purple-500 bg-purple-50' : 'text-slate-500 border-transparent hover:bg-slate-50'
                }`}>
              <tab.icon className="w-5 h-5" />
              {tab.label}
              {tab.count !== null && tab.count > 0 && (
                <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-purple-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                  {tab.count}
                </span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: COMMAND CENTER
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'command' && (
          <div className="p-6">
            <div className="grid grid-cols-3 gap-6">
              {/* Coverage Heatmap */}
              <div className="col-span-2 bg-slate-50 rounded-2xl p-5 border border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <BarChart3 className="w-5 h-5 text-purple-500" />
                  ØªØºØ·ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©
                </h3>
                <div className="space-y-3">
                  {AUTHORITIES.slice(0, 5).map(auth => {
                    const authObligations = INITIAL_OBLIGATIONS.filter(o => o.authorityId === auth.id);
                    const testedObl = testCases.filter(tc => authObligations.some(o => o.id === tc.obligationId)).length;
                    const coverage = authObligations.length > 0 ? Math.round((testedObl / authObligations.length) * 100) : 0;
                    return (
                      <div key={auth.id}>
                        <div className="flex items-center justify-between mb-1">
                          <span className="text-sm font-medium text-slate-700">{auth.code}</span>
                          <span className="text-sm font-bold text-slate-800">{coverage}%</span>
                        </div>
                        <div className="h-3 bg-slate-200 rounded-full overflow-hidden">
                          <div className={`h-full rounded-full ${coverage >= 80 ? 'bg-emerald-500' : coverage >= 50 ? 'bg-amber-500' : 'bg-red-500'}`}
                            style={{ width: `${coverage}%` }}></div>
                        </div>
                      </div>
                    );
                  })}
                </div>
                {stats.coveragePercent < 100 && (
                  <div className="mt-4 p-3 bg-amber-50 border border-amber-200 rounded-xl">
                    <p className="text-sm text-amber-800 font-medium">
                      <AlertTriangle className="w-4 h-4 inline ml-1" />
                      ÙØ¬ÙˆØ© Ø¶Ù…Ø§Ù†: {stats.totalObligations - stats.testedObligations} Ø§Ù„ØªØ²Ø§Ù… Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªØ¨Ø§Ø±Ù‡
                    </p>
                  </div>
                )}
              </div>

              {/* Quick Actions */}
              <div className="space-y-4">
                <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                  <h3 className="font-bold mb-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                  <div className="space-y-2">
                    <button onClick={handleCreatePlan} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <FolderPlus className="w-5 h-5" /><span>Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </button>
                    <button onClick={() => handleCreateCase()} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <Plus className="w-5 h-5" /><span>Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </button>
                    <button onClick={() => handleCreateFinding()} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <AlertCircle className="w-5 h-5" /><span>ØªØ³Ø¬ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø©</span>
                    </button>
                  </div>
                </div>

                {/* Pending Reviews */}
                <div className="bg-amber-50 rounded-2xl p-5 border border-amber-200">
                  <h3 className="font-bold text-amber-800 mb-3 flex items-center gap-2">
                    <Eye className="w-5 h-5" />Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                  </h3>
                  {testCases.filter(tc => tc.status === 'Submitted').slice(0, 3).map(tc => (
                    <div key={tc.id} className="flex items-center justify-between py-2 border-b border-amber-200 last:border-0">
                      <div>
                        <p className="text-sm font-bold text-slate-800">{tc.code}</p>
                        <p className="text-xs text-slate-500">{tc.title?.substring(0, 30)}...</p>
                      </div>
                      {canReview(tc) && (
                        <button onClick={() => { setSelectedItem(tc); setActiveTab('execution'); }}
                          className="px-3 py-1 bg-amber-500 text-white rounded-lg text-xs font-bold">
                          Ù…Ø±Ø§Ø¬Ø¹Ø©
                        </button>
                      )}
                    </div>
                  ))}
                  {testCases.filter(tc => tc.status === 'Submitted').length === 0 && (
                    <p className="text-sm text-amber-700">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
                  )}
                </div>
              </div>
            </div>

            {/* Recent Test Cases */}
            <div className="mt-6">
              <h3 className="font-bold text-slate-800 mb-4">Ø£Ø­Ø¯Ø« Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
              <div className="grid grid-cols-4 gap-4">
                {testCases.slice(0, 4).map(tc => {
                  const plan = getPlan(tc.planId);
                  const template = getTemplate(tc.templateId);
                  const statusCfg = CASE_STATUS_CONFIG[tc.status];
                  const resultCfg = tc.overallResult ? RESULT_CONFIG[tc.overallResult] : null;
                  const StatusIcon = statusCfg?.icon || Clock;

                  return (
                    <div key={tc.id} className="bg-white rounded-xl border-2 border-slate-200 p-4 hover:shadow-lg cursor-pointer"
                      onClick={() => { setSelectedItem(tc); setActiveTab('execution'); }}>
                      <div className="flex items-start justify-between mb-3">
                        <span className="font-mono text-xs font-bold text-purple-600 bg-purple-50 px-2 py-0.5 rounded">{tc.code}</span>
                        <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                          <StatusIcon className="w-3 h-3" />{statusCfg?.label}
                        </span>
                      </div>
                      <h4 className="font-bold text-slate-800 text-sm line-clamp-2 mb-2">{tc.title}</h4>
                      <div className="flex items-center gap-2 text-xs text-slate-500">
                        <span className="px-2 py-0.5 bg-slate-100 rounded">{template?.testType}</span>
                        <span>{plan?.periodKey}</span>
                      </div>
                      {resultCfg && (
                        <div className={`mt-3 px-3 py-1.5 rounded-lg text-xs font-bold text-center ${resultCfg.bg} ${resultCfg.text}`}>
                          {resultCfg.label}
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: TEST PLANS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'plans' && (
          <div className="p-6">
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-3">
                <div className="relative">
                  <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                  <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø®Ø·Ø·..." value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    className="pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl w-64" />
                </div>
                <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                  className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                  {Object.entries(PLAN_STATUS_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                </select>
              </div>
              <button onClick={handleCreatePlan}
                className="flex items-center gap-2 px-4 py-2.5 bg-purple-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ø®Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø©
              </button>
            </div>

            <div className="grid grid-cols-3 gap-4">
              {testPlans.filter(p => {
                if (searchQuery && !p.title.toLowerCase().includes(searchQuery.toLowerCase()) && !p.code.toLowerCase().includes(searchQuery.toLowerCase())) return false;
                if (filterStatus && p.status !== filterStatus) return false;
                return true;
              }).map(plan => {
                const auth = getAuthority(plan.authorityId);
                const statusCfg = PLAN_STATUS_CONFIG[plan.status];
                const planCases = testCases.filter(tc => tc.planId === plan.id);
                const completedCases = planCases.filter(tc => tc.status === 'Reviewed' || tc.status === 'Closed').length;

                return (
                  <div key={plan.id} className="bg-white rounded-xl border-2 border-slate-200 p-5 hover:shadow-lg">
                    <div className="flex items-start justify-between mb-3">
                      <div>
                        <span className="font-mono text-xs font-bold text-purple-600 bg-purple-50 px-2 py-0.5 rounded">{plan.code}</span>
                        {auth && (
                          <span className="mr-2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-bold">{auth.code}</span>
                        )}
                      </div>
                      <span className={`px-2 py-0.5 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                        {statusCfg?.label}
                      </span>
                    </div>
                    <h4 className="font-bold text-slate-800 mb-2">{plan.title}</h4>
                    <div className="flex items-center gap-4 text-xs text-slate-500 mb-3">
                      <span className="flex items-center gap-1"><Calendar className="w-3.5 h-3.5" />{plan.periodKey}</span>
                      <span className="flex items-center gap-1"><FileCheck className="w-3.5 h-3.5" />{planCases.length} Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </div>
                    <div className="mb-3">
                      <div className="flex items-center justify-between text-xs mb-1">
                        <span className="text-slate-500">Ø§Ù„ØªÙ‚Ø¯Ù…</span>
                        <span className="font-bold">{planCases.length > 0 ? Math.round((completedCases / planCases.length) * 100) : 0}%</span>
                      </div>
                      <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                        <div className="h-full bg-purple-500 rounded-full" style={{ width: `${planCases.length > 0 ? (completedCases / planCases.length) * 100 : 0}%` }}></div>
                      </div>
                    </div>
                    <div className="flex items-center gap-2">
                      <button onClick={() => { setFormData(plan); setModalType('plan'); setModalMode('edit'); setShowModal(true); }}
                        className="flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-slate-100 text-slate-700 rounded-lg text-sm font-bold hover:bg-slate-200">
                        <Edit className="w-4 h-4" />ØªØ¹Ø¯ÙŠÙ„
                      </button>
                      <button onClick={() => handleCreateCase(plan.id)}
                        className="flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm font-bold hover:bg-purple-200">
                        <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø±
                      </button>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}


        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: TEST CASES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'cases' && (
          <div className="p-6">
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-3">
                <div className="relative">
                  <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                  <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    className="pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl w-64" />
                </div>
                <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                  className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                  {Object.entries(CASE_STATUS_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                </select>
                <select value={filterTester} onChange={(e) => setFilterTester(e.target.value)}
                  className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø®ØªØ¨Ø±ÙŠÙ†</option>
                  {TESTERS.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}
                </select>
              </div>
              <button onClick={() => handleCreateCase()}
                className="flex items-center gap-2 px-4 py-2.5 bg-purple-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ø­Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
              </button>
            </div>

            <div className="overflow-x-auto">
              <table className="w-full">
                <thead>
                  <tr className="bg-slate-50 border-b-2 border-slate-200">
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ù‚Ø§Ù„Ø¨</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ù…Ø®ØªØ¨Ø±</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th className="text-center px-3 py-3 font-bold text-slate-700">Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700 w-40">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                  </tr>
                </thead>
                <tbody>
                  {testCases.filter(tc => {
                    if (searchQuery && !tc.title?.toLowerCase().includes(searchQuery.toLowerCase()) && !tc.code?.toLowerCase().includes(searchQuery.toLowerCase())) return false;
                    if (filterStatus && tc.status !== filterStatus) return false;
                    if (filterTester && tc.testerId !== parseInt(filterTester)) return false;
                    return true;
                  }).map(tc => {
                    const template = getTemplate(tc.templateId);
                    const tester = getUser(tc.testerId);
                    const statusCfg = CASE_STATUS_CONFIG[tc.status];
                    const resultCfg = tc.overallResult ? RESULT_CONFIG[tc.overallResult] : null;
                    const StatusIcon = statusCfg?.icon || Clock;
                    const daysUntil = getDaysUntilDue(tc.dueDate);

                    return (
                      <tr key={tc.id} className="border-b border-slate-100 hover:bg-slate-50">
                        <td className="px-4 py-4">
                          <span className="font-mono text-sm font-bold text-purple-600 bg-purple-50 px-2 py-1 rounded">{tc.code}</span>
                        </td>
                        <td className="px-4 py-4">
                          <p className="font-medium text-slate-800 line-clamp-1">{tc.title}</p>
                          <p className="text-xs text-slate-500">{getPlan(tc.planId)?.periodKey}</p>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className="px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs font-bold">{template?.testType}</span>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <div className="flex items-center justify-center gap-2">
                            <div className="w-7 h-7 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-bold">
                              {tester?.name?.charAt(0)}
                            </div>
                            <span className="text-sm">{tester?.name?.split(' ')[0]}</span>
                          </div>
                        </td>
                        <td className="px-3 py-4 text-center">
                          <div className="text-sm text-slate-700">{tc.dueDate}</div>
                          {daysUntil !== null && tc.status !== 'Reviewed' && tc.status !== 'Closed' && (
                            <span className={`text-xs font-bold ${daysUntil < 0 ? 'text-red-600' : daysUntil <= 7 ? 'text-amber-600' : 'text-emerald-600'}`}>
                              {daysUntil < 0 ? `Ù…ØªØ£Ø®Ø± ${Math.abs(daysUntil)} ÙŠÙˆÙ…` : `${daysUntil} ÙŠÙˆÙ…`}
                            </span>
                          )}
                        </td>
                        <td className="px-3 py-4 text-center">
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                            <StatusIcon className="w-3.5 h-3.5" />{statusCfg?.label}
                          </span>
                        </td>
                        <td className="px-3 py-4 text-center">
                          {resultCfg ? (
                            <span className={`px-2 py-1 rounded-lg text-xs font-bold ${resultCfg.bg} ${resultCfg.text}`}>
                              {resultCfg.label}
                            </span>
                          ) : (
                            <span className="text-slate-400">-</span>
                          )}
                        </td>
                        <td className="px-4 py-4">
                          <div className="flex items-center justify-center gap-1">
                            <button onClick={() => { setSelectedItem(tc); setActiveTab('execution'); }}
                              className="p-2 hover:bg-blue-50 rounded-lg" title="ØªÙ†ÙÙŠØ°">
                              <Play className="w-4 h-4 text-blue-500" />
                            </button>
                            <button onClick={() => { setFormData(tc); setModalType('case'); setModalMode('edit'); setShowModal(true); }}
                              className="p-2 hover:bg-amber-50 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                              <Edit className="w-4 h-4 text-amber-500" />
                            </button>
                            <button onClick={() => { setDeleteTarget(tc); setModalType('case'); setShowDeleteConfirm(true); }}
                              className="p-2 hover:bg-red-50 rounded-lg" title="Ø­Ø°Ù">
                              <Trash2 className="w-4 h-4 text-red-500" />
                            </button>
                          </div>
                        </td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: EXECUTION WORKSPACE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'execution' && (
          <div className="p-6">
            {selectedItem ? (
              <div className="space-y-6">
                {/* Test Case Header */}
                <div className={`rounded-2xl p-5 ${selectedItem.overallResult === 'Pass' ? 'bg-emerald-50 border-2 border-emerald-200' :
                    selectedItem.overallResult === 'Fail' ? 'bg-red-50 border-2 border-red-200' :
                      selectedItem.overallResult === 'Partial' ? 'bg-amber-50 border-2 border-amber-200' :
                        'bg-slate-50 border-2 border-slate-200'
                  }`}>
                  <div className="flex items-start justify-between">
                    <div>
                      <div className="flex items-center gap-3 mb-2">
                        <span className="font-mono text-lg font-bold text-purple-600 bg-purple-100 px-3 py-1 rounded-lg">{selectedItem.code}</span>
                        <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-sm font-bold ${CASE_STATUS_CONFIG[selectedItem.status]?.bg} ${CASE_STATUS_CONFIG[selectedItem.status]?.text}`}>
                          {CASE_STATUS_CONFIG[selectedItem.status]?.label}
                        </span>
                        {selectedItem.overallResult && (
                          <span className={`px-3 py-1 rounded-lg text-sm font-bold ${RESULT_CONFIG[selectedItem.overallResult]?.bg} ${RESULT_CONFIG[selectedItem.overallResult]?.text}`}>
                            {RESULT_CONFIG[selectedItem.overallResult]?.label}
                          </span>
                        )}
                      </div>
                      <h2 className="text-xl font-bold text-slate-800">{selectedItem.title}</h2>
                      <div className="flex items-center gap-4 mt-2 text-sm text-slate-600">
                        <span>Ø§Ù„Ù…Ø®ØªØ¨Ø±: <strong>{getUser(selectedItem.testerId)?.name}</strong></span>
                        <span>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹: <strong>{getUser(selectedItem.reviewerId)?.name}</strong></span>
                        <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <strong>{selectedItem.dueDate}</strong></span>
                      </div>
                    </div>
                    <div className="flex items-center gap-2">
                      {selectedItem.status === 'NotStarted' && selectedItem.testerId === CURRENT_USER.id && (
                        <button onClick={() => handleStartExecution(selectedItem)}
                          className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                          <Play className="w-5 h-5" />Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°
                        </button>
                      )}
                      {selectedItem.status === 'InProgress' && selectedItem.testerId === CURRENT_USER.id && (
                        <button onClick={() => handleSubmitForReview(selectedItem)}
                          className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold">
                          <Send className="w-5 h-5" />Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                        </button>
                      )}
                      {selectedItem.status === 'Submitted' && canReview(selectedItem) && (
                        <>
                          <button onClick={() => handleReturnForRevision(selectedItem)}
                            className="flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-xl font-bold">
                            <RotateCcw className="w-5 h-5" />Ø¥Ø±Ø¬Ø§Ø¹
                          </button>
                          <button onClick={() => handleApproveReview(selectedItem)}
                            className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold">
                            <CheckCircle2 className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯
                          </button>
                        </>
                      )}
                      <button onClick={() => setSelectedItem(null)}
                        className="p-2 hover:bg-slate-200 rounded-xl">
                        <X className="w-5 h-5 text-slate-500" />
                      </button>
                    </div>
                  </div>
                </div>

                {/* Steps Execution */}
                <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                  <div className="px-5 py-4 bg-slate-50 border-b-2 border-slate-200">
                    <h3 className="font-bold text-slate-800">Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                  </div>
                  <div className="divide-y divide-slate-100">
                    {getTemplate(selectedItem.templateId)?.steps.map((step, idx) => {
                      const stepResult = selectedItem.stepResults?.find(sr => sr.stepId === step.id);
                      const canEdit = selectedItem.status === 'InProgress' && selectedItem.testerId === CURRENT_USER.id;

                      return (
                        <div key={step.id} className={`p-5 ${stepResult?.result === 'Fail' ? 'bg-red-50' : stepResult?.result === 'Pass' ? 'bg-emerald-50' : ''}`}>
                          <div className="flex items-start gap-4">
                            <div className={`w-10 h-10 rounded-xl flex items-center justify-center font-bold text-lg shrink-0 ${stepResult?.result === 'Pass' ? 'bg-emerald-500 text-white' :
                                stepResult?.result === 'Fail' ? 'bg-red-500 text-white' :
                                  stepResult?.result === 'Partial' ? 'bg-amber-500 text-white' :
                                    stepResult?.result === 'N/A' ? 'bg-slate-400 text-white' :
                                      'bg-slate-200 text-slate-600'
                              }`}>
                              {stepResult?.result === 'Pass' ? <CheckCircle2 className="w-6 h-6" /> :
                                stepResult?.result === 'Fail' ? <XCircle className="w-6 h-6" /> :
                                  stepResult?.result === 'N/A' ? <MinusCircle className="w-6 h-6" /> :
                                    step.stepNo}
                            </div>
                            <div className="flex-1">
                              <div className="flex items-start justify-between">
                                <div>
                                  <h4 className="font-bold text-slate-800 flex items-center gap-2">
                                    {step.instruction}
                                    {step.isMandatory && <span className="px-1.5 py-0.5 bg-red-100 text-red-600 text-xs rounded">Ø¥Ù„Ø²Ø§Ù…ÙŠ</span>}
                                  </h4>
                                  <p className="text-sm text-slate-500 mt-1">Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: {step.expectedEvidence}</p>
                                  <p className="text-sm text-slate-500">Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­: {step.passFailCriteria}</p>
                                </div>
                                {canEdit && (
                                  <div className="flex items-center gap-2">
                                    {['Pass', 'Fail', 'Partial', 'N/A'].map(result => {
                                      const cfg = RESULT_CONFIG[result];
                                      return (
                                        <button key={result}
                                          onClick={() => handleUpdateStepResult(selectedItem.id, step.id, result, stepResult?.comment || '')}
                                          className={`px-3 py-1.5 rounded-lg text-xs font-bold border-2 transition-all ${stepResult?.result === result ? `${cfg.bg} ${cfg.text} ${cfg.border}` : 'bg-white border-slate-200 text-slate-600 hover:border-slate-400'
                                            }`}>
                                          {cfg.label}
                                        </button>
                                      );
                                    })}
                                  </div>
                                )}
                              </div>
                              {(stepResult?.comment || canEdit) && (
                                <div className="mt-3">
                                  {canEdit ? (
                                    <textarea
                                      placeholder="Ø£Ø¶Ù Ù…Ù„Ø§Ø­Ø¸Ø©..."
                                      value={stepResult?.comment || ''}
                                      onChange={(e) => handleUpdateStepResult(selectedItem.id, step.id, stepResult?.result, e.target.value)}
                                      className="w-full px-4 py-2 border-2 border-slate-200 rounded-xl text-sm resize-none focus:border-purple-400"
                                      rows={2}
                                    />
                                  ) : stepResult?.comment && (
                                    <p className="text-sm text-slate-600 bg-slate-100 rounded-lg p-3">{stepResult.comment}</p>
                                  )}
                                </div>
                              )}
                            </div>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>

                {/* Findings for this test case */}
                <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                  <div className="px-5 py-4 bg-slate-50 border-b-2 border-slate-200 flex items-center justify-between">
                    <h3 className="font-bold text-slate-800">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h3>
                    <button onClick={() => handleCreateFinding(selectedItem.id)}
                      className="flex items-center gap-1 px-3 py-1.5 bg-orange-100 text-orange-700 rounded-lg text-sm font-bold">
                      <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©
                    </button>
                  </div>
                  <div className="p-5">
                    {findings.filter(f => f.testCaseId === selectedItem.id).length > 0 ? (
                      <div className="space-y-3">
                        {findings.filter(f => f.testCaseId === selectedItem.id).map(finding => {
                          const severityCfg = SEVERITY_CONFIG[finding.severity];
                          const statusCfg = FINDING_STATUS_CONFIG[finding.status];
                          return (
                            <div key={finding.id} className={`rounded-xl border-2 p-4 ${severityCfg?.border}`}>
                              <div className="flex items-start justify-between">
                                <div>
                                  <div className="flex items-center gap-2 mb-1">
                                    <span className="font-mono text-xs font-bold text-orange-600">{finding.code}</span>
                                    <span className={`px-2 py-0.5 rounded text-xs font-bold ${severityCfg?.bg} ${severityCfg?.text}`}>{severityCfg?.label}</span>
                                    <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>{statusCfg?.label}</span>
                                  </div>
                                  <h4 className="font-bold text-slate-800">{finding.title}</h4>
                                  <p className="text-sm text-slate-600 mt-1">{finding.description}</p>
                                </div>
                                {finding.status === 'Open' && (
                                  <button onClick={() => handleConvertToCAPA(finding)}
                                    className="px-3 py-1.5 bg-purple-100 text-purple-700 rounded-lg text-xs font-bold">
                                    ØªØ­ÙˆÙŠÙ„ Ù„Ù€ CAPA
                                  </button>
                                )}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    ) : (
                      <p className="text-center text-slate-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</p>
                    )}
                  </div>
                </div>
              </div>
            ) : (
              <div className="text-center py-16">
                <Play className="w-16 h-16 text-slate-300 mx-auto mb-4" />
                <h3 className="text-xl font-bold text-slate-600">Ø§Ø®ØªØ± Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <p className="text-slate-500 mt-2">Ø§Ø®ØªØ± Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
              </div>
            )}
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: FINDINGS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'findings' && (
          <div className="p-6">
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-3">
                <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                  className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                  {Object.entries(FINDING_STATUS_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                </select>
              </div>
              <button onClick={() => handleCreateFinding()}
                className="flex items-center gap-2 px-4 py-2.5 bg-orange-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©
              </button>
            </div>

            <div className="space-y-4">
              {findings.filter(f => !filterStatus || f.status === filterStatus).map(finding => {
                const tc = testCases.find(t => t.id === finding.testCaseId);
                const severityCfg = SEVERITY_CONFIG[finding.severity];
                const statusCfg = FINDING_STATUS_CONFIG[finding.status];
                const typeCfg = FINDING_TYPE_CONFIG[finding.findingType];
                const TypeIcon = typeCfg?.icon || AlertCircle;

                return (
                  <div key={finding.id} className={`bg-white rounded-xl border-2 p-5 hover:shadow-lg ${severityCfg?.border}`}>
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <div className="flex items-center gap-2 mb-2">
                          <span className="font-mono text-sm font-bold text-orange-600 bg-orange-50 px-2 py-0.5 rounded">{finding.code}</span>
                          <span className={`px-2 py-0.5 rounded text-xs font-bold ${severityCfg?.bg} ${severityCfg?.text}`}>{severityCfg?.label}</span>
                          <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>{statusCfg?.label}</span>
                          <span className="flex items-center gap-1 px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">
                            <TypeIcon className="w-3 h-3" />{typeCfg?.label}
                          </span>
                        </div>
                        <h4 className="font-bold text-slate-800 text-lg">{finding.title}</h4>
                        <p className="text-slate-600 mt-1">{finding.description}</p>
                        <div className="mt-3 grid grid-cols-2 gap-4 text-sm">
                          <div>
                            <p className="text-slate-500">Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:</p>
                            <p className="text-slate-700">{finding.rootCause || '-'}</p>
                          </div>
                          <div>
                            <p className="text-slate-500">Ø§Ù„ØªÙˆØµÙŠØ©:</p>
                            <p className="text-slate-700">{finding.recommendation || '-'}</p>
                          </div>
                        </div>
                        <div className="mt-3 flex items-center gap-4 text-xs text-slate-500">
                          <span>Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: <strong className="text-purple-600">{tc?.code}</strong></span>
                          <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: <strong>{getUser(finding.responsibleId)?.name}</strong></span>
                          <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <strong>{finding.dueDate}</strong></span>
                        </div>
                      </div>
                      <div className="flex flex-col gap-2">
                        {finding.status === 'Open' && (
                          <button onClick={() => handleConvertToCAPA(finding)}
                            className="flex items-center gap-1 px-3 py-2 bg-purple-100 text-purple-700 rounded-lg text-sm font-bold">
                            <GitBranch className="w-4 h-4" />ØªØ­ÙˆÙŠÙ„ Ù„Ù€ CAPA
                          </button>
                        )}
                        <button onClick={() => { setFormData(finding); setModalType('finding'); setModalMode('edit'); setShowModal(true); }}
                          className="flex items-center gap-1 px-3 py-2 bg-slate-100 text-slate-700 rounded-lg text-sm font-bold">
                          <Edit className="w-4 h-4" />ØªØ¹Ø¯ÙŠÙ„
                        </button>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: TEMPLATES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'templates' && (
          <div className="p-6">
            <div className="grid grid-cols-2 gap-4">
              {testTemplates.map(template => {
                const typeCfg = TEST_TYPE_CONFIG[template.testType];
                const TypeIcon = typeCfg?.icon || FileText;
                return (
                  <div key={template.id} className="bg-white rounded-xl border-2 border-slate-200 p-5">
                    <div className="flex items-start justify-between mb-3">
                      <div className="flex items-center gap-3">
                        <div className={`w-10 h-10 rounded-xl bg-${typeCfg?.color}-100 flex items-center justify-center`}>
                          <TypeIcon className={`w-5 h-5 text-${typeCfg?.color}-600`} />
                        </div>
                        <div>
                          <span className="font-mono text-xs font-bold text-purple-600">{template.code}</span>
                          <h4 className="font-bold text-slate-800">{template.title}</h4>
                        </div>
                      </div>
                      <span className={`px-2 py-0.5 rounded text-xs font-bold bg-${typeCfg?.color}-100 text-${typeCfg?.color}-700`}>
                        {typeCfg?.label}
                      </span>
                    </div>
                    <p className="text-sm text-slate-600 mb-3">{template.objective}</p>
                    <div className="flex items-center gap-4 text-xs text-slate-500">
                      <span>Ø§Ù„Ø¹ÙŠÙ†Ø©: {template.sampleMethod}</span>
                      <span>Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: {template.defaultSampleSize}</span>
                      <span>{template.stepCount} Ø®Ø·ÙˆØ§Øª</span>
                    </div>
                    <div className="mt-4 pt-4 border-t border-slate-100">
                      <p className="text-xs font-bold text-slate-700 mb-2">Ø§Ù„Ø®Ø·ÙˆØ§Øª:</p>
                      <div className="space-y-1">
                        {template.steps.slice(0, 3).map(step => (
                          <div key={step.id} className="flex items-center gap-2 text-xs">
                            <span className="w-5 h-5 rounded bg-slate-100 flex items-center justify-center font-bold">{step.stepNo}</span>
                            <span className="text-slate-600 truncate">{step.instruction}</span>
                            {step.isMandatory && <span className="px-1 py-0.5 bg-red-100 text-red-600 rounded text-[10px]">Ø¥Ù„Ø²Ø§Ù…ÙŠ</span>}
                          </div>
                        ))}
                        {template.steps.length > 3 && (
                          <p className="text-xs text-slate-400">+{template.steps.length - 3} Ø®Ø·ÙˆØ§Øª Ø£Ø®Ø±Ù‰</p>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}
      </div>


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          MODALS
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          WORLD-CLASS MODALS WITH WIZARD
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden">

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                PLAN WIZARD MODAL - Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± - WORLD CLASS EDITION
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {modalType === 'plan' && (
              <>
                {/* World-Class Header */}
                <div className="bg-gradient-to-l from-purple-600 via-indigo-600 to-blue-600 px-6 py-5 text-white relative overflow-hidden">
                  <div className="absolute top-0 right-0 w-96 h-96 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/2" />
                  <div className="absolute bottom-0 left-0 w-64 h-64 bg-white/5 rounded-full translate-y-1/2 -translate-x-1/2" />
                  <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-gradient-radial from-white/10 to-transparent rounded-full opacity-50" />

                  <div className="relative">
                    <div className="flex items-center justify-between mb-5">
                      <div className="flex items-center gap-4">
                        <div className="w-16 h-16 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-xl border border-white/20">
                          <FolderPlus className="w-8 h-8" />
                        </div>
                        <div>
                          <h2 className="text-2xl font-bold">{modalMode === 'create' ? 'Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø±' : 'ØªØ¹Ø¯ÙŠÙ„ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±'}</h2>
                          <div className="flex items-center gap-3 mt-1">
                            <span className="px-3 py-1 bg-white/20 backdrop-blur-sm rounded-lg text-sm font-mono border border-white/20">{formData.code}</span>
                            <span className="text-purple-200 text-sm">Test Plan Wizard â€¢ {executionStep + 1}/5</span>
                          </div>
                        </div>
                      </div>
                      <button onClick={() => { setShowModal(false); setExecutionStep(0); }} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all backdrop-blur-sm border border-white/10">
                        <X className="w-6 h-6" />
                      </button>
                    </div>

                    {/* Enhanced Progress Steps */}
                    <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-2 border border-white/10">
                      <div className="flex items-center">
                        {[
                          { step: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText, desc: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙØªØ±Ø©' },
                          { step: 1, label: 'Ø§Ù„Ù†Ø·Ø§Ù‚ ÙˆØ§Ù„Ø¬Ù‡Ø§Øª', icon: Building2, desc: 'Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©' },
                          { step: 2, label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', icon: Target, desc: 'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª' },
                          { step: 3, label: 'Ø§Ù„ÙØ±ÙŠÙ‚', icon: Users, desc: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†' },
                          { step: 4, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: CheckCircle2, desc: 'Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ' },
                        ].map((s, idx) => (
                          <div key={s.step} className="flex items-center flex-1">
                            <button onClick={() => setExecutionStep(s.step)}
                              className={`flex items-center gap-2 px-3 py-2.5 rounded-xl transition-all w-full ${executionStep === s.step ? 'bg-white text-purple-600 shadow-lg' :
                                  executionStep > s.step ? 'bg-emerald-400/30 text-white' : 'text-white/60 hover:bg-white/10'
                                }`}>
                              <div className={`w-9 h-9 rounded-lg flex items-center justify-center shrink-0 ${executionStep === s.step ? 'bg-purple-100' :
                                  executionStep > s.step ? 'bg-emerald-500 text-white' : 'bg-white/10'
                                }`}>
                                {executionStep > s.step ? <Check className="w-5 h-5" /> : <s.icon className="w-4 h-4" />}
                              </div>
                              <div className="text-right hidden lg:block">
                                <p className={`font-bold text-xs ${executionStep === s.step ? 'text-purple-700' : ''}`}>{s.label}</p>
                                <p className={`text-[10px] ${executionStep === s.step ? 'text-purple-500' : 'opacity-70'}`}>{s.desc}</p>
                              </div>
                            </button>
                            {idx < 4 && <ChevronLeft className="w-4 h-4 mx-1 text-white/30 shrink-0" />}
                          </div>
                        ))}
                      </div>
                    </div>

                    {/* Animated Progress Bar */}
                    <div className="mt-3 h-1.5 bg-white/20 rounded-full overflow-hidden">
                      <div className="h-full bg-gradient-to-r from-emerald-400 via-teal-400 to-cyan-400 rounded-full transition-all duration-700 ease-out"
                        style={{ width: `${(executionStep / 4) * 100}%` }} />
                    </div>
                  </div>
                </div>

                {/* Content Area with Optional Sidebar */}
                <div className="flex">
                  {/* Main Content */}
                  <div className="flex-1 p-6 max-h-[55vh] overflow-y-auto">

                    {/* Step 0: Basic Info - World Class */}
                    {executionStep === 0 && (
                      <div className="space-y-5">
                        {/* Quick Templates Section */}
                        <div className="bg-gradient-to-r from-violet-50 via-purple-50 to-fuchsia-50 rounded-2xl p-5 border border-violet-200">
                          <h4 className="font-bold text-violet-800 mb-3 flex items-center gap-2">
                            <Zap className="w-5 h-5" />Ù‚ÙˆØ§Ù„Ø¨ Ø¬Ø§Ù‡Ø²Ø© - Quick Templates
                          </h4>
                          <div className="grid grid-cols-4 gap-3">
                            {[
                              { id: 'aml', name: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', icon: 'ğŸ›¡ï¸', auth: 'SAMA', color: 'emerald' },
                              { id: 'cyber', name: 'Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', icon: 'ğŸ”’', auth: 'NCA', color: 'blue' },
                              { id: 'pdpl', name: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', icon: 'ğŸ“Š', auth: 'SDAIA', color: 'purple' },
                              { id: 'full', name: 'Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„', icon: 'ğŸ¯', auth: 'All', color: 'amber' },
                            ].map(t => (
                              <button key={t.id} onClick={() => setFormData({ ...formData, title: `Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± ${t.name} - ${formData.periodKey || 'Q1-2025'}`, template: t.id })}
                                className={`p-4 rounded-xl border-2 transition-all text-center hover:shadow-lg group ${formData.template === t.id ? 'border-violet-500 bg-violet-100 shadow-lg' : 'border-slate-200 bg-white hover:border-violet-300'
                                  }`}>
                                <div className="text-3xl mb-2 group-hover:scale-110 transition-transform">{t.icon}</div>
                                <p className="text-sm font-bold text-slate-700">{t.name}</p>
                                <p className="text-xs text-violet-600 mt-1">{t.auth}</p>
                              </button>
                            ))}
                          </div>
                        </div>

                        {/* Main Form */}
                        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200 shadow-sm">
                          <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <FileText className="w-5 h-5 text-purple-500" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø®Ø·Ø©
                          </h3>

                          <div className="space-y-4">
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·Ø© *</label>
                              <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                                className="w-full px-4 py-3.5 border-2 border-slate-200 rounded-xl text-lg focus:border-purple-400 focus:outline-none focus:ring-4 focus:ring-purple-100 transition-all"
                                placeholder="Ù…Ø«Ø§Ù„: Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„ 2025" />
                              <div className="flex items-center justify-between mt-2">
                                {formData.title && formData.title.length < 10 && (
                                  <p className="text-xs text-amber-600 flex items-center gap-1"><AlertTriangle className="w-3 h-3" />Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‚ØµÙŠØ± - ÙŠÙÙØ¶Ù„ 10 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</p>
                                )}
                                {formData.title && formData.title.length >= 10 && (
                                  <p className="text-xs text-emerald-600 flex items-center gap-1"><CheckCircle2 className="w-3 h-3" />Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ù†Ø§Ø³Ø¨</p>
                                )}
                                <span className="text-xs text-slate-400">{formData.title?.length || 0} Ø­Ø±Ù</span>
                              </div>
                            </div>

                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-3">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© *</label>
                              <div className="grid grid-cols-5 gap-3">
                                {[
                                  { key: 'Q1-2025', label: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø£ÙˆÙ„', sub: 'Q1 2025', icon: 'ğŸŒ¸', months: 'ÙŠÙ†Ø§ÙŠØ± - Ù…Ø§Ø±Ø³', color: 'pink' },
                                  { key: 'Q2-2025', label: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ', sub: 'Q2 2025', icon: 'â˜€ï¸', months: 'Ø£Ø¨Ø±ÙŠÙ„ - ÙŠÙˆÙ†ÙŠÙˆ', color: 'amber' },
                                  { key: 'Q3-2025', label: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø«Ø§Ù„Ø«', sub: 'Q3 2025', icon: 'ğŸ‚', months: 'ÙŠÙˆÙ„ÙŠÙˆ - Ø³Ø¨ØªÙ…Ø¨Ø±', color: 'orange' },
                                  { key: 'Q4-2025', label: 'Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹', sub: 'Q4 2025', icon: 'â„ï¸', months: 'Ø£ÙƒØªÙˆØ¨Ø± - Ø¯ÙŠØ³Ù…Ø¨Ø±', color: 'blue' },
                                  { key: '2025', label: 'Ø³Ù†ÙˆÙŠ ÙƒØ§Ù…Ù„', sub: '2025', icon: 'ğŸ“…', months: 'Ø§Ù„Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø©', color: 'purple' },
                                ].map(period => (
                                  <button key={period.key} onClick={() => setFormData({ ...formData, periodKey: period.key })}
                                    className={`p-4 rounded-xl border-2 transition-all text-center group ${formData.periodKey === period.key
                                        ? 'border-purple-500 bg-purple-50 shadow-lg ring-4 ring-purple-100'
                                        : 'border-slate-200 hover:border-purple-300 bg-white hover:shadow-md'
                                      }`}>
                                    <div className="text-3xl mb-2 group-hover:scale-125 transition-transform">{period.icon}</div>
                                    <p className="font-bold text-slate-800 text-sm">{period.label}</p>
                                    <p className="text-xs text-slate-500">{period.sub}</p>
                                    <p className="text-[10px] text-purple-600 mt-1 font-medium">{period.months}</p>
                                  </button>
                                ))}
                              </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                              <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label>
                                <input type="date" value={formData.startDate || ''} onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}
                                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none focus:ring-4 focus:ring-purple-100" />
                              </div>
                              <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label>
                                <input type="date" value={formData.endDate || ''} onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}
                                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none focus:ring-4 focus:ring-purple-100" />
                              </div>
                            </div>

                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØµÙ Ø§Ù„Ø®Ø·Ø©</label>
                              <textarea rows={3} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none focus:ring-4 focus:ring-purple-100 resize-none"
                                placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆÙ†Ø·Ø§Ù‚ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±..." />
                            </div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Step 1: Scope & Authorities */}
                    {executionStep === 1 && (
                      <div className="space-y-6">
                        <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                          <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                            <Building2 className="w-5 h-5" />Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©
                          </h3>
                          <p className="text-sm text-emerald-600 mb-4">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† Ø¬Ù‡Ø©)</p>

                          <div className="grid grid-cols-3 gap-4">
                            {AUTHORITIES.map(auth => {
                              const isSelected = formData.authorityId === auth.id || (formData.selectedAuthorities && formData.selectedAuthorities.includes(auth.id));
                              const authColors = {
                                SAMA: { bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700' },
                                CMA: { bg: 'bg-blue-500', light: 'bg-blue-100', text: 'text-blue-700' },
                                NCA: { bg: 'bg-purple-500', light: 'bg-purple-100', text: 'text-purple-700' },
                                SDAIA: { bg: 'bg-indigo-500', light: 'bg-indigo-100', text: 'text-indigo-700' },
                                ZATCA: { bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700' },
                              };
                              const colors = authColors[auth.code] || { bg: 'bg-slate-500', light: 'bg-slate-100', text: 'text-slate-700' };
                              const oblCount = INITIAL_OBLIGATIONS.filter(o => o.authorityId === auth.id).length;

                              return (
                                <div key={auth.id} onClick={() => setFormData({ ...formData, authorityId: isSelected ? '' : auth.id })}
                                  className={`rounded-2xl border-2 p-5 cursor-pointer transition-all ${isSelected ? `border-emerald-500 ${colors.light} shadow-lg` : 'border-slate-200 hover:border-emerald-300 bg-white'
                                    }`}>
                                  <div className="flex items-start justify-between mb-3">
                                    <div className={`w-12 h-12 rounded-xl ${colors.bg} flex items-center justify-center text-white font-bold`}>
                                      {auth.code.substring(0, 2)}
                                    </div>
                                    {isSelected && <CheckCircle2 className="w-6 h-6 text-emerald-500" />}
                                  </div>
                                  <h4 className="font-bold text-slate-800">{auth.code}</h4>
                                  <p className="text-sm text-slate-600 mt-1">{auth.nameAr}</p>
                                  <div className="mt-3 flex items-center gap-2">
                                    <span className={`px-2 py-1 rounded-lg text-xs font-bold ${colors.light} ${colors.text}`}>
                                      {oblCount} Ø§Ù„ØªØ²Ø§Ù…
                                    </span>
                                  </div>
                                </div>
                              );
                            })}

                            {/* All Authorities Option */}
                            <div onClick={() => setFormData({ ...formData, authorityId: '' })}
                              className={`rounded-2xl border-2 p-5 cursor-pointer transition-all ${!formData.authorityId ? 'border-purple-500 bg-purple-50 shadow-lg' : 'border-slate-200 hover:border-purple-300 bg-white'
                                }`}>
                              <div className="flex items-start justify-between mb-3">
                                <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-indigo-500 flex items-center justify-center text-white">
                                  <Globe className="w-6 h-6" />
                                </div>
                                {!formData.authorityId && <CheckCircle2 className="w-6 h-6 text-purple-500" />}
                              </div>
                              <h4 className="font-bold text-slate-800">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</h4>
                              <p className="text-sm text-slate-600 mt-1">Ø´Ø§Ù…Ù„ Ù„ÙƒÙ„ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</p>
                              <div className="mt-3 flex items-center gap-2">
                                <span className="px-2 py-1 rounded-lg text-xs font-bold bg-purple-100 text-purple-700">
                                  {INITIAL_OBLIGATIONS.length} Ø§Ù„ØªØ²Ø§Ù…
                                </span>
                              </div>
                            </div>
                          </div>
                        </div>

                        {/* Scope Details */}
                        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-200">
                          <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                            <Layers className="w-5 h-5" />Ù†Ø·Ø§Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                          </h3>
                          <div className="grid grid-cols-3 gap-4">
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØ­Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„</label>
                              <select value={formData.scope?.bu || 'All'} onChange={(e) => setFormData({ ...formData, scope: { ...formData.scope, bu: e.target.value } })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                                <option value="All">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª</option>
                                <option value="IT">ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</option>
                                <option value="Finance">Ø§Ù„Ù…Ø§Ù„ÙŠØ©</option>
                                <option value="Operations">Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
                                <option value="HR">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
                              </select>
                            </div>
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</label>
                              <select value={formData.scope?.process || 'All'} onChange={(e) => setFormData({ ...formData, scope: { ...formData.scope, process: e.target.value } })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                                <option value="All">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</option>
                                <option value="Security">Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ</option>
                                <option value="Data">Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</option>
                                <option value="AML">Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„</option>
                                <option value="Reporting">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</option>
                              </select>
                            </div>
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù†Ø¸Ø§Ù…</label>
                              <select value={formData.scope?.system || 'All'} onChange={(e) => setFormData({ ...formData, scope: { ...formData.scope, system: e.target.value } })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                                <option value="All">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©</option>
                                <option value="Core">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</option>
                                <option value="ERP">Ù†Ø¸Ø§Ù… ERP</option>
                                <option value="CRM">Ù†Ø¸Ø§Ù… CRM</option>
                              </select>
                            </div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Step 2: Target Obligations */}
                    {executionStep === 2 && (
                      <div className="space-y-6">
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200">
                          <h3 className="text-lg font-bold text-amber-800 mb-4 flex items-center gap-2">
                            <Target className="w-5 h-5" />Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
                          </h3>

                          <div className="flex items-center justify-between mb-4">
                            <div className="relative flex-1 max-w-md">
                              <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                              <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª..."
                                className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl bg-white" />
                            </div>
                            <div className="flex items-center gap-2">
                              <button onClick={() => {
                                const filtered = INITIAL_OBLIGATIONS.filter(o => !formData.authorityId || o.authorityId === parseInt(formData.authorityId));
                                setFormData({ ...formData, targetObligations: filtered.map(o => o.id) });
                              }} className="px-4 py-2 bg-amber-500 text-white rounded-lg text-sm font-bold">
                                ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
                              </button>
                              <button onClick={() => setFormData({ ...formData, targetObligations: [] })} className="px-4 py-2 bg-slate-200 text-slate-700 rounded-lg text-sm font-bold">
                                Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ¯
                              </button>
                            </div>
                          </div>

                          <div className="max-h-64 overflow-y-auto space-y-2">
                            {INITIAL_OBLIGATIONS.filter(o => !formData.authorityId || o.authorityId === parseInt(formData.authorityId)).map(obl => {
                              const auth = AUTHORITIES.find(a => a.id === obl.authorityId);
                              const isSelected = formData.targetObligations?.includes(obl.id);
                              return (
                                <div key={obl.id} onClick={() => {
                                  const current = formData.targetObligations || [];
                                  setFormData({
                                    ...formData,
                                    targetObligations: isSelected ? current.filter(id => id !== obl.id) : [...current, obl.id]
                                  });
                                }}
                                  className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${isSelected ? 'border-amber-500 bg-amber-100' : 'border-slate-200 hover:border-amber-300 bg-white'
                                    }`}>
                                  <div className="flex items-center gap-4">
                                    <div className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center ${isSelected ? 'bg-amber-500 border-amber-500' : 'border-slate-300'
                                      }`}>
                                      {isSelected && <Check className="w-4 h-4 text-white" />}
                                    </div>
                                    <div className="flex-1">
                                      <div className="flex items-center gap-2 mb-1">
                                        <span className="font-mono text-xs font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded">{obl.code}</span>
                                        {auth && <span className="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">{auth.code}</span>}
                                        <span className={`px-2 py-0.5 rounded text-xs font-bold ${obl.criticality === 'High' ? 'bg-red-100 text-red-600' :
                                            obl.criticality === 'Critical' ? 'bg-red-200 text-red-700' : 'bg-amber-100 text-amber-600'
                                          }`}>{obl.criticality}</span>
                                      </div>
                                      <p className="font-medium text-slate-800 text-sm">{obl.title}</p>
                                    </div>
                                  </div>
                                </div>
                              );
                            })}
                          </div>

                          <div className="mt-4 p-4 bg-white rounded-xl border border-slate-200">
                            <div className="flex items-center justify-between">
                              <span className="text-slate-600">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©:</span>
                              <span className="font-bold text-amber-600 text-lg">{formData.targetObligations?.length || 0} Ù…Ù† {INITIAL_OBLIGATIONS.filter(o => !formData.authorityId || o.authorityId === parseInt(formData.authorityId)).length}</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Step 3: Team & Resources - NEW */}
                    {executionStep === 3 && (
                      <div className="space-y-5">
                        {/* Team Assignment */}
                        <div className="bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-2xl p-5 border border-blue-200">
                          <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                            <Users className="w-5 h-5" />ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª
                          </h3>

                          <div className="grid grid-cols-2 gap-5 mb-5">
                            <div className="bg-white rounded-xl p-4 border-2 border-slate-200">
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø§Ù„Ùƒ Ø§Ù„Ø®Ø·Ø© (Owner) *</label>
                              <select value={formData.ownerId || CURRENT_USER.id} onChange={(e) => setFormData({ ...formData, ownerId: parseInt(e.target.value) })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none">
                                {TESTERS.map(t => <option key={t.id} value={t.id}>{t.name} - {t.role}</option>)}
                              </select>
                            </div>
                            <div className="bg-white rounded-xl p-4 border-2 border-slate-200">
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ (Approver)</label>
                              <select value={formData.approverId || ''} onChange={(e) => setFormData({ ...formData, approverId: parseInt(e.target.value) || '' })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</option>
                                {TESTERS.map(t => <option key={t.id} value={t.id}>{t.name}</option>)}
                              </select>
                            </div>
                          </div>

                          {/* Testers Selection */}
                          <div className="mb-5">
                            <label className="block text-sm font-bold text-slate-700 mb-3">Ø§Ù„Ù…Ø®ØªØ¨Ø±ÙŠÙ† (Testers)</label>
                            <div className="grid grid-cols-3 gap-3">
                              {TESTERS.map(tester => {
                                const isSelected = formData.testers?.includes(tester.id);
                                return (
                                  <div key={tester.id} onClick={() => {
                                    const current = formData.testers || [];
                                    setFormData({
                                      ...formData,
                                      testers: isSelected ? current.filter(id => id !== tester.id) : [...current, tester.id]
                                    });
                                  }}
                                    className={`p-3 rounded-xl border-2 cursor-pointer transition-all flex items-center gap-3 ${isSelected ? 'border-blue-500 bg-blue-50 shadow-md' : 'border-slate-200 hover:border-blue-300 bg-white'
                                      }`}>
                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${isSelected ? 'bg-blue-500' : 'bg-slate-300'
                                      }`}>
                                      {tester.name.charAt(0)}
                                    </div>
                                    <div className="flex-1">
                                      <p className="font-bold text-slate-800 text-sm">{tester.name}</p>
                                      <p className="text-xs text-slate-500">{tester.role}</p>
                                    </div>
                                    {isSelected && <Check className="w-5 h-5 text-blue-500" />}
                                  </div>
                                );
                              })}
                            </div>
                          </div>
                        </div>

                        {/* Resource Estimation */}
                        <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
                          <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                            <Activity className="w-5 h-5 text-purple-500" />ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„Ø¬Ù‡Ø¯
                          </h3>
                          <div className="grid grid-cols-4 gap-4">
                            <div className="bg-gradient-to-br from-purple-100 to-indigo-100 rounded-xl p-4 text-center border border-purple-200">
                              <Target className="w-8 h-8 text-purple-600 mx-auto mb-2" />
                              <p className="text-3xl font-bold text-purple-700">{formData.targetObligations?.length || 0}</p>
                              <p className="text-sm text-purple-600">Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                            </div>
                            <div className="bg-gradient-to-br from-blue-100 to-cyan-100 rounded-xl p-4 text-center border border-blue-200">
                              <Clock className="w-8 h-8 text-blue-600 mx-auto mb-2" />
                              <p className="text-3xl font-bold text-blue-700">{Math.ceil((formData.targetObligations?.length || 0) * 0.5)}</p>
                              <p className="text-sm text-blue-600">Ø³Ø§Ø¹Ø§Øª ØªÙ‚Ø¯ÙŠØ±ÙŠØ©</p>
                            </div>
                            <div className="bg-gradient-to-br from-emerald-100 to-teal-100 rounded-xl p-4 text-center border border-emerald-200">
                              <Users className="w-8 h-8 text-emerald-600 mx-auto mb-2" />
                              <p className="text-3xl font-bold text-emerald-700">{formData.testers?.length || 1}</p>
                              <p className="text-sm text-emerald-600">Ù…Ø®ØªØ¨Ø±ÙŠÙ†</p>
                            </div>
                            <div className="bg-gradient-to-br from-amber-100 to-orange-100 rounded-xl p-4 text-center border border-amber-200">
                              <Calendar className="w-8 h-8 text-amber-600 mx-auto mb-2" />
                              <p className="text-3xl font-bold text-amber-700">{Math.ceil((formData.targetObligations?.length || 0) / (formData.testers?.length || 1) * 0.5)}</p>
                              <p className="text-sm text-amber-600">Ø£ÙŠØ§Ù… Ù…ØªÙˆÙ‚Ø¹Ø©</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Step 4: Review & Confirm - ENHANCED */}
                    {executionStep === 4 && (
                      <div className="space-y-5">
                        <div className="bg-gradient-to-r from-emerald-50 via-teal-50 to-cyan-50 rounded-2xl p-5 border border-emerald-200">
                          <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                            <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                          </h3>

                          {/* Summary Cards */}
                          <div className="grid grid-cols-4 gap-3 mb-5">
                            <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                              <FileText className="w-7 h-7 text-purple-500 mx-auto mb-2" />
                              <p className="font-bold text-slate-800 text-sm truncate">{formData.title?.substring(0, 20) || 'â€”'}...</p>
                              <p className="text-xs text-slate-500">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·Ø©</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                              <Calendar className="w-7 h-7 text-blue-500 mx-auto mb-2" />
                              <p className="font-bold text-slate-800">{formData.periodKey || 'â€”'}</p>
                              <p className="text-xs text-slate-500">Ø§Ù„ÙØªØ±Ø©</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                              <Target className="w-7 h-7 text-amber-500 mx-auto mb-2" />
                              <p className="font-bold text-slate-800 text-2xl">{formData.targetObligations?.length || 0}</p>
                              <p className="text-xs text-slate-500">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 border border-slate-200 text-center">
                              <Users className="w-7 h-7 text-emerald-500 mx-auto mb-2" />
                              <p className="font-bold text-slate-800">{formData.testers?.length || 1}</p>
                              <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø®ØªØ¨Ø±ÙŠÙ†</p>
                            </div>
                          </div>

                          {/* Details Grid */}
                          <div className="grid grid-cols-2 gap-4 mb-5">
                            <div className="bg-white rounded-xl p-4 border border-slate-200">
                              <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                <FileText className="w-4 h-4 text-purple-500" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                              </h4>
                              <div className="space-y-2 text-sm">
                                <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯:</span><span className="font-mono font-bold text-purple-600">{formData.code}</span></div>
                                <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</span><span className="font-bold">{formData.startDate || 'â€”'}</span></div>
                                <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:</span><span className="font-bold">{formData.endDate || 'â€”'}</span></div>
                              </div>
                            </div>
                            <div className="bg-white rounded-xl p-4 border border-slate-200">
                              <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                <Building2 className="w-4 h-4 text-emerald-500" />Ø§Ù„Ù†Ø·Ø§Ù‚
                              </h4>
                              <div className="space-y-2 text-sm">
                                <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¬Ù‡Ø©:</span><span className="font-bold">{formData.authorityId ? getAuthority(parseInt(formData.authorityId))?.code : 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª'}</span></div>
                                <div className="flex justify-between"><span className="text-slate-500">ÙˆØ­Ø¯Ø© Ø§Ù„Ø¹Ù…Ù„:</span><span className="font-bold">{formData.scope?.bu || 'All'}</span></div>
                                <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:</span><span className="font-bold">{formData.scope?.process || 'All'}</span></div>
                              </div>
                            </div>
                          </div>

                          {/* Validation Checklist */}
                          <div className="bg-white rounded-xl p-4 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3">âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                            <div className="grid grid-cols-4 gap-3">
                              {[
                                { label: 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø·Ø©', valid: formData.title?.length >= 10, icon: FileText },
                                { label: 'Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©', valid: !!formData.periodKey, icon: Calendar },
                                { label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', valid: formData.targetObligations?.length > 0, icon: Target },
                                { label: 'Ù…Ø§Ù„Ùƒ Ø§Ù„Ø®Ø·Ø©', valid: !!formData.ownerId || true, icon: User },
                              ].map((check, idx) => (
                                <div key={idx} className={`flex items-center gap-2 p-3 rounded-xl border ${check.valid ? 'bg-emerald-50 border-emerald-200' : 'bg-red-50 border-red-200'}`}>
                                  <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${check.valid ? 'bg-emerald-500' : 'bg-red-500'}`}>
                                    {check.valid ? <Check className="w-5 h-5 text-white" /> : <X className="w-5 h-5 text-white" />}
                                  </div>
                                  <div>
                                    <p className={`font-bold text-xs ${check.valid ? 'text-emerald-700' : 'text-red-700'}`}>{check.label}</p>
                                    <p className={`text-[10px] ${check.valid ? 'text-emerald-600' : 'text-red-600'}`}>{check.valid ? 'âœ“ ØªÙ…' : 'âœ— Ù…Ø·Ù„ÙˆØ¨'}</p>
                                  </div>
                                </div>
                              ))}
                            </div>
                          </div>
                        </div>
                      </div>
                    )}
                  </div>

                  {/* Side Panel - Quick Summary */}
                  <div className="w-64 border-r-2 border-slate-200 bg-gradient-to-b from-slate-50 to-white p-4 hidden xl:block">
                    <h4 className="font-bold text-slate-700 mb-4 flex items-center gap-2">
                      <Info className="w-4 h-4 text-purple-500" />Ù…Ù„Ø®Øµ Ø§Ù„Ø®Ø·Ø©
                    </h4>

                    <div className="space-y-3">
                      <div className="bg-white rounded-xl p-3 border border-slate-200 shadow-sm">
                        <p className="text-xs text-slate-500 mb-1">Ø§Ù„ÙƒÙˆØ¯</p>
                        <p className="font-mono font-bold text-purple-600 text-sm">{formData.code}</p>
                      </div>

                      <div className="bg-white rounded-xl p-3 border border-slate-200 shadow-sm">
                        <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</p>
                        <p className="font-bold text-slate-800 text-xs truncate">{formData.title || 'â€”'}</p>
                      </div>

                      <div className="bg-white rounded-xl p-3 border border-slate-200 shadow-sm">
                        <p className="text-xs text-slate-500 mb-1">Ø§Ù„ÙØªØ±Ø©</p>
                        <p className="font-bold text-slate-800 text-sm">{formData.periodKey || 'â€”'}</p>
                      </div>

                      <div className="bg-white rounded-xl p-3 border border-slate-200 shadow-sm">
                        <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</p>
                        <p className="font-bold text-slate-800 text-sm">{formData.authorityId ? AUTHORITIES.find(a => a.id === parseInt(formData.authorityId))?.code : 'Ø§Ù„ÙƒÙ„'}</p>
                      </div>

                      <div className="bg-gradient-to-br from-purple-100 to-indigo-100 rounded-xl p-3 border border-purple-200">
                        <p className="text-xs text-purple-600 mb-1">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</p>
                        <p className="font-bold text-purple-700 text-2xl">{formData.targetObligations?.length || 0}</p>
                      </div>

                      <div className="bg-gradient-to-br from-blue-100 to-cyan-100 rounded-xl p-3 border border-blue-200">
                        <p className="text-xs text-blue-600 mb-1">Ø§Ù„Ø¬Ù‡Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</p>
                        <p className="font-bold text-blue-700 text-lg">{Math.ceil((formData.targetObligations?.length || 0) * 0.5)} Ø³Ø§Ø¹Ø©</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Enhanced Footer */}
                <div className="border-t-2 border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between">
                  <button onClick={() => executionStep > 0 ? setExecutionStep(executionStep - 1) : setShowModal(false)}
                    className="flex items-center gap-2 px-5 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all">
                    <ChevronRight className="w-5 h-5" />
                    {executionStep === 0 ? 'Ø¥Ù„ØºØ§Ø¡' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
                  </button>

                  <div className="flex items-center gap-1.5">
                    {[0, 1, 2, 3, 4].map(step => (
                      <div key={step} className={`h-2 rounded-full transition-all duration-500 ${executionStep === step ? 'bg-purple-500 w-8' :
                          executionStep > step ? 'bg-emerald-500 w-2' : 'bg-slate-300 w-2'
                        }`} />
                    ))}
                  </div>

                  {executionStep < 4 ? (
                    <button onClick={() => setExecutionStep(executionStep + 1)}
                      className="flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl transition-all">
                      Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                    </button>
                  ) : (
                    <button onClick={handleSave}
                      disabled={!formData.title || !formData.periodKey}
                      className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                      <CheckCircle2 className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    </button>
                  )}
                </div>
              </>
            )}

            {/* â•â•â•â•â•â•â•â•â•â•â• Test Case Wizard Modal â•â•â•â•â•â•â•â•â•â•â• */}
            {modalType === 'case' && (
              <>
                {/* Header with Progress */}
                <div className="bg-gradient-to-l from-purple-600 via-indigo-600 to-blue-600 px-8 py-6 text-white">
                  <div className="flex items-center justify-between mb-6">
                    <div className="flex items-center gap-4">
                      <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                        <ClipboardCheck className="w-7 h-7" />
                      </div>
                      <div>
                        <h2 className="text-2xl font-bold">{modalMode === 'create' ? 'Ù…Ø¹Ø§Ù„Ø¬ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø±' : 'ØªØ¹Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±'}</h2>
                        <p className="text-purple-200">{formData.code}</p>
                      </div>
                    </div>
                    <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <X className="w-6 h-6" />
                    </button>
                  </div>

                  {/* Wizard Steps */}
                  <div className="flex items-center justify-between">
                    {[
                      { step: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText },
                      { step: 1, label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø·', icon: Link2 },
                      { step: 2, label: 'Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: ClipboardList },
                      { step: 3, label: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„', icon: Users },
                      { step: 4, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯', icon: CheckCircle2 },
                    ].map((s, idx) => (
                      <div key={s.step} className="flex items-center">
                        <button onClick={() => setExecutionStep(s.step)}
                          className={`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${executionStep === s.step ? 'bg-white text-purple-600 font-bold shadow-lg' :
                              executionStep > s.step ? 'bg-white/30 text-white' : 'bg-white/10 text-white/60'
                            }`}>
                          <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${executionStep === s.step ? 'bg-purple-100' :
                              executionStep > s.step ? 'bg-emerald-400 text-white' : 'bg-white/10'
                            }`}>
                            {executionStep > s.step ? <Check className="w-5 h-5" /> : <s.icon className="w-4 h-4" />}
                          </div>
                          <span className="hidden xl:inline">{s.label}</span>
                        </button>
                        {idx < 4 && <ChevronLeft className="w-5 h-5 mx-2 text-white/40" />}
                      </div>
                    ))}
                  </div>
                </div>

                {/* Content Area */}
                <div className="p-8 max-h-[55vh] overflow-y-auto">

                  {/* Step 0: Basic Info */}
                  {executionStep === 0 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 border border-purple-200">
                        <h3 className="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                          <FileText className="w-5 h-5" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                        </h3>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± *</label>
                            <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl text-lg focus:border-purple-400 focus:outline-none bg-white"
                              placeholder="Ù…Ø«Ø§Ù„: Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ" />
                          </div>
                          <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                              <select value={formData.planId || ''} onChange={(e) => setFormData({ ...formData, planId: parseInt(e.target.value) || '' })}
                                className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-purple-400 focus:outline-none bg-white">
                                <option value="">Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø© (Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø³ØªÙ‚Ù„)</option>
                                {testPlans.filter(p => p.status === 'Active').map(p => (
                                  <option key={p.id} value={p.id}>{p.code} - {p.title}</option>
                                ))}
                              </select>
                            </div>
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ *</label>
                              <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                                className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-purple-400 focus:outline-none bg-white" />
                            </div>
                          </div>
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØµÙ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                            <textarea rows={3} value={formData.notes || ''} onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-purple-400 focus:outline-none bg-white resize-none"
                              placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù‡Ø¯Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ù†Ø·Ø§Ù‚..." />
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 1: Obligations & Controls */}
                  {executionStep === 1 && (
                    <div className="space-y-6">
                      <div className="grid grid-cols-2 gap-6">
                        {/* Obligations Selection */}
                        <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                          <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                            <ClipboardCheck className="w-5 h-5" />Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… *
                          </h3>
                          <div className="relative mb-4">
                            <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                            <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª..."
                              className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl bg-white" />
                          </div>
                          <div className="max-h-64 overflow-y-auto space-y-2">
                            {INITIAL_OBLIGATIONS.map(obl => {
                              const auth = AUTHORITIES.find(a => a.id === obl.authorityId);
                              const isSelected = formData.obligationId === obl.id;
                              return (
                                <div key={obl.id} onClick={() => setFormData({ ...formData, obligationId: obl.id, controlId: '' })}
                                  className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${isSelected ? 'border-emerald-500 bg-emerald-100' : 'border-slate-200 hover:border-emerald-300 bg-white'
                                    }`}>
                                  <div className="flex items-start justify-between">
                                    <div>
                                      <div className="flex items-center gap-2 mb-1">
                                        <span className="font-mono text-xs font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded">{obl.code}</span>
                                        {auth && <span className="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">{auth.code}</span>}
                                      </div>
                                      <p className="font-medium text-slate-800 text-sm">{obl.title}</p>
                                    </div>
                                    {isSelected && <CheckCircle2 className="w-6 h-6 text-emerald-500 shrink-0" />}
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                        </div>

                        {/* Controls Selection */}
                        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-200">
                          <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                            <Shield className="w-5 h-5" />Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¶Ø§Ø¨Ø· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                          </h3>
                          {formData.obligationId ? (
                            <div className="max-h-72 overflow-y-auto space-y-2">
                              {CONTROLS.map(ctrl => {
                                const isSelected = formData.controlId === ctrl.id;
                                return (
                                  <div key={ctrl.id} onClick={() => setFormData({ ...formData, controlId: ctrl.id })}
                                    className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${isSelected ? 'border-blue-500 bg-blue-100' : 'border-slate-200 hover:border-blue-300 bg-white'
                                      }`}>
                                    <div className="flex items-start justify-between">
                                      <div>
                                        <span className="font-mono text-xs font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded">{ctrl.code}</span>
                                        <p className="font-medium text-slate-800 text-sm mt-1">{ctrl.title}</p>
                                        <p className="text-xs text-slate-500 mt-1">{ctrl.description?.substring(0, 80)}...</p>
                                      </div>
                                      {isSelected && <CheckCircle2 className="w-6 h-6 text-blue-500 shrink-0" />}
                                    </div>
                                  </div>
                                );
                              })}
                            </div>
                          ) : (
                            <div className="text-center py-12 text-slate-400">
                              <Shield className="w-12 h-12 mx-auto mb-2 opacity-50" />
                              <p>Ø§Ø®ØªØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø£ÙˆÙ„Ø§Ù‹</p>
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Selected Summary */}
                      {formData.obligationId && (
                        <div className="bg-slate-50 rounded-2xl p-4 border border-slate-200">
                          <p className="text-sm text-slate-600">
                            <strong>Ø§Ù„Ù…Ø­Ø¯Ø¯:</strong> {INITIAL_OBLIGATIONS.find(o => o.id === formData.obligationId)?.code}
                            {formData.controlId && ` â†’ ${CONTROLS.find(c => c.id === formData.controlId)?.code}`}
                          </p>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Step 2: Test Template */}
                  {executionStep === 2 && (
                    <div className="space-y-6">
                      <h3 className="text-lg font-bold text-slate-800 flex items-center gap-2">
                        <ClipboardList className="w-5 h-5 text-purple-500" />Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± *
                      </h3>
                      <div className="grid grid-cols-2 gap-4">
                        {testTemplates.map(template => {
                          const isSelected = formData.templateId === template.id;
                          const typeCfg = TEST_TYPE_CONFIG[template.testType];
                          const TypeIcon = typeCfg?.icon || FileText;
                          return (
                            <div key={template.id} onClick={() => setFormData({ ...formData, templateId: template.id, sampleSize: template.defaultSampleSize })}
                              className={`rounded-2xl border-2 p-5 cursor-pointer transition-all ${isSelected ? 'border-purple-500 bg-purple-50 shadow-lg' : 'border-slate-200 hover:border-purple-300'
                                }`}>
                              <div className="flex items-start justify-between mb-3">
                                <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${isSelected ? 'bg-purple-500 text-white' : 'bg-slate-100 text-slate-600'}`}>
                                  <TypeIcon className="w-6 h-6" />
                                </div>
                                {isSelected && <CheckCircle2 className="w-6 h-6 text-purple-500" />}
                              </div>
                              <span className="font-mono text-xs font-bold text-purple-600">{template.code}</span>
                              <h4 className="font-bold text-slate-800 mt-1">{template.title}</h4>
                              <p className="text-sm text-slate-600 mt-2">{template.objective}</p>
                              <div className="flex items-center gap-3 mt-4 text-xs text-slate-500">
                                <span className="px-2 py-1 bg-slate-100 rounded">{typeCfg?.label}</span>
                                <span>{template.stepCount} Ø®Ø·ÙˆØ§Øª</span>
                                <span>Ø¹ÙŠÙ†Ø©: {template.defaultSampleSize}</span>
                              </div>
                            </div>
                          );
                        })}
                      </div>

                      {/* Template Preview */}
                      {formData.templateId && (
                        <div className="bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl p-6 border border-slate-200">
                          <h4 className="font-bold text-slate-800 mb-4">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h4>
                          <div className="space-y-2">
                            {getTemplate(formData.templateId)?.steps.map((step, idx) => (
                              <div key={step.id} className="flex items-center gap-3 p-3 bg-white rounded-xl border border-slate-200">
                                <div className="w-8 h-8 rounded-lg bg-purple-100 text-purple-600 flex items-center justify-center font-bold">
                                  {step.stepNo}
                                </div>
                                <div className="flex-1">
                                  <p className="text-sm font-medium text-slate-800">{step.instruction}</p>
                                  <p className="text-xs text-slate-500">Ø§Ù„Ø¯Ù„ÙŠÙ„: {step.expectedEvidence}</p>
                                </div>
                                {step.isMandatory && <span className="px-2 py-0.5 bg-red-100 text-red-600 text-xs rounded">Ø¥Ù„Ø²Ø§Ù…ÙŠ</span>}
                              </div>
                            ))}
                          </div>
                          <div className="mt-4 grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø­Ø¬Ù… Ø§Ù„Ø¹ÙŠÙ†Ø©</label>
                              <input type="number" value={formData.sampleSize || 10} onChange={(e) => setFormData({ ...formData, sampleSize: parseInt(e.target.value) })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" />
                            </div>
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</label>
                              <input type="text" value={formData.populationRef || ''} onChange={(e) => setFormData({ ...formData, populationRef: e.target.value })}
                                className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¹Ø§Ù…Ù„Ø§Øª ÙŠÙ†Ø§ÙŠØ± 2025" />
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Step 3: Team Assignment */}
                  {executionStep === 3 && (
                    <div className="space-y-6">
                      <div className="grid grid-cols-2 gap-6">
                        {/* Tester Selection */}
                        <div className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl p-6 border border-blue-200">
                          <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                            <User className="w-5 h-5" />Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø®ØªØ¨Ø± *
                          </h3>
                          <div className="space-y-3">
                            {TESTERS.map(tester => {
                              const isSelected = formData.testerId === tester.id;
                              const isDisabled = formData.reviewerId === tester.id;
                              return (
                                <div key={tester.id} onClick={() => !isDisabled && setFormData({ ...formData, testerId: tester.id })}
                                  className={`flex items-center gap-4 p-4 rounded-xl border-2 transition-all ${isDisabled ? 'border-slate-200 bg-slate-100 cursor-not-allowed opacity-50' :
                                      isSelected ? 'border-blue-500 bg-blue-100 cursor-pointer' : 'border-slate-200 hover:border-blue-300 cursor-pointer'
                                    }`}>
                                  <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-xl font-bold ${isSelected ? 'bg-blue-500 text-white' : 'bg-slate-200 text-slate-600'
                                    }`}>
                                    {tester.name.charAt(0)}
                                  </div>
                                  <div className="flex-1">
                                    <p className="font-bold text-slate-800">{tester.name}</p>
                                    <p className="text-sm text-slate-500">{tester.role}</p>
                                  </div>
                                  {isSelected && <CheckCircle2 className="w-6 h-6 text-blue-500" />}
                                  {isDisabled && <span className="text-xs text-red-500">Ù…Ø®ØªØ§Ø± ÙƒÙ…Ø±Ø§Ø¬Ø¹</span>}
                                </div>
                              );
                            })}
                          </div>
                        </div>

                        {/* Reviewer Selection */}
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200">
                          <h3 className="text-lg font-bold text-amber-800 mb-4 flex items-center gap-2">
                            <UserCheck className="w-5 h-5" />Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ * (SoD)
                          </h3>
                          <div className="space-y-3">
                            {TESTERS.map(reviewer => {
                              const isSelected = formData.reviewerId === reviewer.id;
                              const isDisabled = formData.testerId === reviewer.id;
                              return (
                                <div key={reviewer.id} onClick={() => !isDisabled && setFormData({ ...formData, reviewerId: reviewer.id })}
                                  className={`flex items-center gap-4 p-4 rounded-xl border-2 transition-all ${isDisabled ? 'border-red-200 bg-red-50 cursor-not-allowed' :
                                      isSelected ? 'border-amber-500 bg-amber-100 cursor-pointer' : 'border-slate-200 hover:border-amber-300 cursor-pointer'
                                    }`}>
                                  <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-xl font-bold ${isDisabled ? 'bg-red-200 text-red-600' :
                                      isSelected ? 'bg-amber-500 text-white' : 'bg-slate-200 text-slate-600'
                                    }`}>
                                    {reviewer.name.charAt(0)}
                                  </div>
                                  <div className="flex-1">
                                    <p className="font-bold text-slate-800">{reviewer.name}</p>
                                    <p className="text-sm text-slate-500">{reviewer.role}</p>
                                  </div>
                                  {isSelected && <CheckCircle2 className="w-6 h-6 text-amber-500" />}
                                  {isDisabled && (
                                    <span className="flex items-center gap-1 text-xs text-red-600 bg-red-100 px-2 py-1 rounded">
                                      <AlertTriangle className="w-3 h-3" />SoD
                                    </span>
                                  )}
                                </div>
                              );
                            })}
                          </div>
                        </div>
                      </div>

                      {/* SoD Warning */}
                      <div className={`rounded-2xl p-4 border-2 ${formData.testerId && formData.reviewerId && formData.testerId !== formData.reviewerId
                          ? 'bg-emerald-50 border-emerald-300'
                          : formData.testerId && formData.reviewerId
                            ? 'bg-red-50 border-red-300'
                            : 'bg-slate-50 border-slate-200'
                        }`}>
                        <div className="flex items-center gap-3">
                          {formData.testerId && formData.reviewerId && formData.testerId !== formData.reviewerId ? (
                            <>
                              <CheckCircle2 className="w-6 h-6 text-emerald-500" />
                              <div>
                                <p className="font-bold text-emerald-800">âœ“ ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (SoD) Ù…Ø­Ù‚Ù‚</p>
                                <p className="text-sm text-emerald-600">Ø§Ù„Ù…Ø®ØªØ¨Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ù…Ø®ØªÙ„ÙØ§Ù† - ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
                              </div>
                            </>
                          ) : formData.testerId && formData.reviewerId ? (
                            <>
                              <XCircle className="w-6 h-6 text-red-500" />
                              <div>
                                <p className="font-bold text-red-800">âœ— Ø§Ù†ØªÙ‡Ø§Ùƒ ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (SoD)</p>
                                <p className="text-sm text-red-600">Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø®ØªØ¨Ø± Ù‡Ùˆ Ù†ÙØ³Ù‡ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</p>
                              </div>
                            </>
                          ) : (
                            <>
                              <Info className="w-6 h-6 text-slate-400" />
                              <div>
                                <p className="font-bold text-slate-600">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø®ØªØ¨Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹</p>
                                <p className="text-sm text-slate-500">ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ†Ø§ Ù…Ø®ØªÙ„ÙÙŠÙ† Ù„ØªØ­Ù‚ÙŠÙ‚ ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                              </div>
                            </>
                          )}
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 4: Review & Confirm */}
                  {executionStep === 4 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 border border-purple-200">
                        <h3 className="text-lg font-bold text-purple-800 mb-6 flex items-center gap-2">
                          <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
                        </h3>

                        <div className="grid grid-cols-2 gap-6">
                          {/* Basic Info */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <FileText className="w-4 h-4 text-blue-500" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯:</span><span className="font-bold">{formData.code}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span><span className="font-bold text-left max-w-xs truncate">{formData.title || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</span><span className="font-bold">{formData.dueDate || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø®Ø·Ø©:</span><span className="font-bold">{getPlan(formData.planId)?.code || 'Ù…Ø³ØªÙ‚Ù„'}</span></div>
                            </div>
                          </div>

                          {/* Scope */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <Link2 className="w-4 h-4 text-emerald-500" />Ø§Ù„Ù†Ø·Ø§Ù‚
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…:</span><span className="font-bold">{getObligation(formData.obligationId)?.code || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¶Ø§Ø¨Ø·:</span><span className="font-bold">{getControl(formData.controlId)?.code || 'Ø¨Ø¯ÙˆÙ†'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø­Ø¬Ù… Ø§Ù„Ø¹ÙŠÙ†Ø©:</span><span className="font-bold">{formData.sampleSize}</span></div>
                            </div>
                          </div>

                          {/* Template */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <ClipboardList className="w-4 h-4 text-purple-500" />Ø§Ù„Ù‚Ø§Ù„Ø¨
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù‚Ø§Ù„Ø¨:</span><span className="font-bold">{getTemplate(formData.templateId)?.code || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù†ÙˆØ¹:</span><span className="font-bold">{getTemplate(formData.templateId)?.testType || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø®Ø·ÙˆØ§Øª:</span><span className="font-bold">{getTemplate(formData.templateId)?.stepCount || 0}</span></div>
                            </div>
                          </div>

                          {/* Team */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <Users className="w-4 h-4 text-amber-500" />ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹Ù…Ù„
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø®ØªØ¨Ø±:</span><span className="font-bold">{getUser(formData.testerId)?.name || '-'}</span></div>
                              <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹:</span><span className="font-bold">{getUser(formData.reviewerId)?.name || '-'}</span></div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">SoD:</span>
                                {formData.testerId !== formData.reviewerId ? (
                                  <span className="font-bold text-emerald-600 flex items-center gap-1"><CheckCircle2 className="w-4 h-4" />Ù…Ø­Ù‚Ù‚</span>
                                ) : (
                                  <span className="font-bold text-red-600 flex items-center gap-1"><XCircle className="w-4 h-4" />ØºÙŠØ± Ù…Ø­Ù‚Ù‚</span>
                                )}
                              </div>
                            </div>
                          </div>
                        </div>

                        {/* Validation Summary */}
                        <div className="mt-6 p-4 bg-white rounded-xl border border-slate-200">
                          <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                          <div className="grid grid-cols-2 gap-4">
                            {[
                              { label: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', valid: formData.title?.length >= 3 },
                              { label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…', valid: !!formData.obligationId },
                              { label: 'Ø§Ù„Ù‚Ø§Ù„Ø¨', valid: !!formData.templateId },
                              { label: 'Ø§Ù„Ù…Ø®ØªØ¨Ø±', valid: !!formData.testerId },
                              { label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹', valid: !!formData.reviewerId },
                              { label: 'ÙØµÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…', valid: formData.testerId !== formData.reviewerId },
                            ].map((check, idx) => (
                              <div key={idx} className={`flex items-center gap-2 p-2 rounded-lg ${check.valid ? 'bg-emerald-50' : 'bg-red-50'}`}>
                                {check.valid ? <CheckCircle2 className="w-5 h-5 text-emerald-500" /> : <XCircle className="w-5 h-5 text-red-500" />}
                                <span className={`text-sm font-medium ${check.valid ? 'text-emerald-700' : 'text-red-700'}`}>{check.label}</span>
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {/* Footer with Navigation */}
                <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex items-center justify-between">
                  <button onClick={() => executionStep > 0 ? setExecutionStep(executionStep - 1) : setShowModal(false)}
                    className="flex items-center gap-2 px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all">
                    <ChevronRight className="w-5 h-5" />
                    {executionStep === 0 ? 'Ø¥Ù„ØºØ§Ø¡' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
                  </button>

                  <div className="flex items-center gap-2">
                    {[0, 1, 2, 3, 4].map(step => (
                      <div key={step} className={`w-3 h-3 rounded-full transition-all ${executionStep === step ? 'bg-purple-500 w-8' : executionStep > step ? 'bg-emerald-500' : 'bg-slate-300'}`} />
                    ))}
                  </div>

                  {executionStep < 4 ? (
                    <button onClick={() => setExecutionStep(executionStep + 1)}
                      className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold shadow-lg">
                      Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                    </button>
                  ) : (
                    <button onClick={handleSave}
                      disabled={!formData.title || !formData.obligationId || !formData.templateId || !formData.testerId || !formData.reviewerId || formData.testerId === formData.reviewerId}
                      className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                      <CheckCircle2 className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    </button>
                  )}
                </div>
              </>
            )}


            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                FINDING WIZARD MODAL - Ù…Ø¹Ø§Ù„Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {modalType === 'finding' && (
              <>
                {/* Header with Progress */}
                <div className="bg-gradient-to-l from-red-500 via-orange-500 to-amber-500 px-8 py-6 text-white">
                  <div className="flex items-center justify-between mb-6">
                    <div className="flex items-center gap-4">
                      <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                        <AlertTriangle className="w-7 h-7" />
                      </div>
                      <div>
                        <h2 className="text-2xl font-bold">{modalMode === 'create' ? 'Ù…Ø¹Ø§Ù„Ø¬ ØªØ³Ø¬ÙŠÙ„ Ù…Ù„Ø§Ø­Ø¸Ø©' : 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©'}</h2>
                        <p className="text-orange-200">{formData.code}</p>
                      </div>
                    </div>
                    <button onClick={() => { setShowModal(false); setExecutionStep(0); }} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <X className="w-6 h-6" />
                    </button>
                  </div>

                  {/* Wizard Steps */}
                  <div className="flex items-center justify-between">
                    {[
                      { step: 0, label: 'Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ø®Ø·ÙˆØ±Ø©', icon: AlertCircle },
                      { step: 1, label: 'Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„ØªÙØ§ØµÙŠÙ„', icon: FileText },
                      { step: 2, label: 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ø£Ø³Ø¨Ø§Ø¨', icon: Search },
                      { step: 3, label: 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: Zap },
                      { step: 4, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯', icon: CheckCircle2 },
                    ].map((s, idx) => (
                      <div key={s.step} className="flex items-center">
                        <button onClick={() => setExecutionStep(s.step)}
                          className={`flex items-center gap-2 px-3 py-2 rounded-xl transition-all ${executionStep === s.step ? 'bg-white text-orange-600 font-bold shadow-lg' :
                              executionStep > s.step ? 'bg-white/30 text-white' : 'bg-white/10 text-white/60'
                            }`}>
                          <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${executionStep === s.step ? 'bg-orange-100' :
                              executionStep > s.step ? 'bg-emerald-400 text-white' : 'bg-white/10'
                            }`}>
                            {executionStep > s.step ? <Check className="w-5 h-5" /> : <s.icon className="w-4 h-4" />}
                          </div>
                          <span className="hidden xl:inline text-sm">{s.label}</span>
                        </button>
                        {idx < 4 && <ChevronLeft className="w-4 h-4 mx-1 text-white/40" />}
                      </div>
                    ))}
                  </div>
                </div>

                {/* Content Area */}
                <div className="p-8 max-h-[55vh] overflow-y-auto">

                  {/* Step 0: Classification & Severity */}
                  {executionStep === 0 && (
                    <div className="space-y-6">
                      {/* Test Case Selection */}
                      <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-200">
                        <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                          <ClipboardCheck className="w-5 h-5" />Ø±Ø¨Ø· Ø¨Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± *
                        </h3>
                        <div className="grid grid-cols-2 gap-3 max-h-48 overflow-y-auto">
                          {testCases.map(tc => {
                            const isSelected = formData.testCaseId === tc.id;
                            const statusCfg = CASE_STATUS_CONFIG[tc.status];
                            return (
                              <div key={tc.id} onClick={() => setFormData({ ...formData, testCaseId: tc.id })}
                                className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${isSelected ? 'border-blue-500 bg-blue-100 shadow-lg' : 'border-slate-200 hover:border-blue-300 bg-white'
                                  }`}>
                                <div className="flex items-start justify-between">
                                  <div>
                                    <span className="font-mono text-xs font-bold text-blue-600">{tc.code}</span>
                                    <p className="text-sm text-slate-800 mt-1 line-clamp-1">{tc.title}</p>
                                    <span className={`inline-block mt-2 px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                                      {statusCfg?.label}
                                    </span>
                                  </div>
                                  {isSelected && <CheckCircle2 className="w-5 h-5 text-blue-500 shrink-0" />}
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </div>

                      {/* Severity Selection */}
                      <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border border-red-200">
                        <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                          <AlertTriangle className="w-5 h-5" />Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø© *
                        </h3>
                        <div className="grid grid-cols-3 gap-4">
                          {[
                            { key: 'High', label: 'Ø¹Ø§Ù„ÙŠ', icon: 'ğŸ”´', desc: 'ÙŠØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙÙˆØ±ÙŠ', color: 'red' },
                            { key: 'Medium', label: 'Ù…ØªÙˆØ³Ø·', icon: 'ğŸŸ¡', desc: 'ÙŠØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø®Ù„Ø§Ù„ 30 ÙŠÙˆÙ…', color: 'amber' },
                            { key: 'Low', label: 'Ù…Ù†Ø®ÙØ¶', icon: 'ğŸŸ¢', desc: 'Ù„Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ…Ø±', color: 'emerald' },
                          ].map(sev => (
                            <button key={sev.key} onClick={() => setFormData({ ...formData, severity: sev.key })}
                              className={`p-5 rounded-2xl border-2 transition-all text-center ${formData.severity === sev.key
                                  ? `border-${sev.color}-500 bg-${sev.color}-100 shadow-lg`
                                  : 'border-slate-200 hover:border-slate-400 bg-white'
                                }`}>
                              <div className="text-4xl mb-2">{sev.icon}</div>
                              <p className="font-bold text-slate-800">{sev.label}</p>
                              <p className="text-xs text-slate-500 mt-1">{sev.desc}</p>
                            </button>
                          ))}
                        </div>
                      </div>

                      {/* Finding Type */}
                      <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 border border-purple-200">
                        <h3 className="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                          <Tag className="w-5 h-5" />Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© *
                        </h3>
                        <div className="grid grid-cols-4 gap-3">
                          {[
                            { key: 'ControlFailure', label: 'ÙØ´Ù„ Ø§Ù„Ø¶Ø§Ø¨Ø·', icon: Shield, desc: 'Ø§Ù„Ø¶Ø§Ø¨Ø· Ù„Ø§ ÙŠØ¹Ù…Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ØªÙˆÙ‚Ø¹' },
                            { key: 'PolicyGap', label: 'ÙØ¬ÙˆØ© Ø³ÙŠØ§Ø³Ø©', icon: FileText, desc: 'Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø£Ùˆ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª' },
                            { key: 'EvidenceInsufficient', label: 'Ø£Ø¯Ù„Ø© ØºÙŠØ± ÙƒØ§ÙÙŠØ©', icon: FileQuestion, desc: 'Ù†Ù‚Øµ ÙÙŠ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©' },
                            { key: 'ProcessGap', label: 'ÙØ¬ÙˆØ© Ø¥Ø¬Ø±Ø§Ø¦ÙŠØ©', icon: GitBranch, desc: 'Ø®Ù„Ù„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡' },
                          ].map(type => {
                            const isSelected = formData.findingType === type.key;
                            return (
                              <button key={type.key} onClick={() => setFormData({ ...formData, findingType: type.key })}
                                className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? 'border-purple-500 bg-purple-100 shadow-lg' : 'border-slate-200 hover:border-purple-300 bg-white'
                                  }`}>
                                <div className={`w-10 h-10 rounded-xl mx-auto mb-2 flex items-center justify-center ${isSelected ? 'bg-purple-500 text-white' : 'bg-slate-100 text-slate-600'
                                  }`}>
                                  <type.icon className="w-5 h-5" />
                                </div>
                                <p className="font-bold text-slate-800 text-sm">{type.label}</p>
                                <p className="text-xs text-slate-500 mt-1 line-clamp-2">{type.desc}</p>
                              </button>
                            );
                          })}
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 1: Description & Details */}
                  {executionStep === 1 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-orange-50 to-amber-50 rounded-2xl p-6 border border-orange-200">
                        <h3 className="text-lg font-bold text-orange-800 mb-4 flex items-center gap-2">
                          <FileText className="w-5 h-5" />ÙˆØµÙ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©
                        </h3>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© *</label>
                            <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl text-lg focus:border-orange-400 focus:outline-none bg-white"
                              placeholder="Ù…Ø«Ø§Ù„: ÙØ¬ÙˆØ© ÙÙŠ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©" />
                          </div>

                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ *</label>
                            <textarea rows={4} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-orange-400 focus:outline-none bg-white resize-none"
                              placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ù…ÙƒØªØ´ÙØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±..." />
                            <p className="text-xs text-slate-500 mt-1 text-left">{formData.description?.length || 0} / 500 Ø­Ø±Ù</p>
                          </div>

                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø±ØªØ¨Ø·</label>
                            <div className="border-2 border-dashed border-slate-300 rounded-xl p-6 text-center bg-white">
                              <Upload className="w-10 h-10 text-slate-400 mx-auto mb-2" />
                              <p className="text-slate-600">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ­Ù…ÙŠÙ„</p>
                              <p className="text-xs text-slate-400 mt-1">PNG, JPG, PDF Ø­ØªÙ‰ 10MB</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* Affected Areas */}
                      <div className="bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl p-6 border border-slate-200">
                        <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                          <Layers className="w-5 h-5" />Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©
                        </h3>
                        <div className="flex flex-wrap gap-2">
                          {['Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', 'Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©'].map(area => (
                            <button key={area} onClick={() => {
                              const areas = formData.affectedAreas || [];
                              setFormData({
                                ...formData,
                                affectedAreas: areas.includes(area) ? areas.filter(a => a !== area) : [...areas, area]
                              });
                            }}
                              className={`px-4 py-2 rounded-xl border-2 text-sm font-bold transition-all ${formData.affectedAreas?.includes(area) ? 'border-orange-500 bg-orange-100 text-orange-700' : 'border-slate-200 bg-white text-slate-600 hover:border-orange-300'
                                }`}>
                              {area}
                            </button>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 2: Analysis & Root Cause */}
                  {executionStep === 2 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-200">
                        <h3 className="text-lg font-bold text-indigo-800 mb-4 flex items-center gap-2">
                          <Search className="w-5 h-5" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ
                        </h3>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ *</label>
                            <textarea rows={3} value={formData.rootCause || ''} onChange={(e) => setFormData({ ...formData, rootCause: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-indigo-400 focus:outline-none bg-white resize-none"
                              placeholder="Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ" />
                          </div>

                          {/* 5 Whys Analysis */}
                          <div className="bg-white rounded-xl p-4 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <HelpCircle className="w-4 h-4" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù€ 5 Ù„Ù…Ø§Ø°Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                            </h4>
                            {[1, 2, 3, 4, 5].map(num => (
                              <div key={num} className="flex items-center gap-3 mb-2">
                                <span className="w-8 h-8 rounded-lg bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm">{num}</span>
                                <input type="text" placeholder={`Ù„Ù…Ø§Ø°Ø§ ${num}ØŸ`}
                                  value={formData[`why${num}`] || ''}
                                  onChange={(e) => setFormData({ ...formData, [`why${num}`]: e.target.value })}
                                  className="flex-1 px-4 py-2 border-2 border-slate-200 rounded-lg text-sm focus:border-indigo-400 focus:outline-none" />
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>

                      {/* Impact Analysis */}
                      <div className="bg-gradient-to-r from-red-50 to-rose-50 rounded-2xl p-6 border border-red-200">
                        <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                          <Activity className="w-5 h-5" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±
                        </h3>
                        <div className="grid grid-cols-3 gap-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ù…Ø§Ù„ÙŠ</label>
                            <select value={formData.financialImpact || 'Low'} onChange={(e) => setFormData({ ...formData, financialImpact: e.target.value })}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                              <option value="High">Ø¹Ø§Ù„ÙŠ</option>
                              <option value="Medium">Ù…ØªÙˆØ³Ø·</option>
                              <option value="Low">Ù…Ù†Ø®ÙØ¶</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£Ø«Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ</label>
                            <select value={formData.operationalImpact || 'Low'} onChange={(e) => setFormData({ ...formData, operationalImpact: e.target.value })}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                              <option value="High">Ø¹Ø§Ù„ÙŠ</option>
                              <option value="Medium">Ù…ØªÙˆØ³Ø·</option>
                              <option value="Low">Ù…Ù†Ø®ÙØ¶</option>
                            </select>
                          </div>
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù…Ø¹Ø©</label>
                            <select value={formData.reputationalImpact || 'Low'} onChange={(e) => setFormData({ ...formData, reputationalImpact: e.target.value })}
                              className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                              <option value="High">Ø¹Ø§Ù„ÙŠ</option>
                              <option value="Medium">Ù…ØªÙˆØ³Ø·</option>
                              <option value="Low">Ù…Ù†Ø®ÙØ¶</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 3: Remediation Plan */}
                  {executionStep === 3 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                        <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                          <Zap className="w-5 h-5" />Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                        </h3>
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ØªÙˆØµÙŠØ© / Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØµØ­ÙŠØ­ÙŠ *</label>
                            <textarea rows={3} value={formData.recommendation || ''} onChange={(e) => setFormData({ ...formData, recommendation: e.target.value })}
                              className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-emerald-400 focus:outline-none bg-white resize-none"
                              placeholder="Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ" />
                          </div>

                          <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© *</label>
                              <div className="space-y-2 max-h-48 overflow-y-auto">
                                {TESTERS.map(user => {
                                  const isSelected = formData.responsibleId === user.id;
                                  return (
                                    <div key={user.id} onClick={() => setFormData({ ...formData, responsibleId: user.id })}
                                      className={`flex items-center gap-3 p-3 rounded-xl border-2 cursor-pointer transition-all ${isSelected ? 'border-emerald-500 bg-emerald-100' : 'border-slate-200 hover:border-emerald-300 bg-white'
                                        }`}>
                                      <div className={`w-10 h-10 rounded-xl flex items-center justify-center font-bold ${isSelected ? 'bg-emerald-500 text-white' : 'bg-slate-200 text-slate-600'
                                        }`}>
                                        {user.name.charAt(0)}
                                      </div>
                                      <div>
                                        <p className="font-bold text-slate-800 text-sm">{user.name}</p>
                                        <p className="text-xs text-slate-500">{user.role}</p>
                                      </div>
                                      {isSelected && <CheckCircle2 className="w-5 h-5 text-emerald-500 mr-auto" />}
                                    </div>
                                  );
                                })}
                              </div>
                            </div>

                            <div className="space-y-4">
                              <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ *</label>
                                <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white focus:border-emerald-400 focus:outline-none" />
                              </div>

                              <div>
                                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
                                <div className="flex gap-2">
                                  {['Urgent', 'High', 'Normal'].map(priority => (
                                    <button key={priority} onClick={() => setFormData({ ...formData, priority })}
                                      className={`flex-1 py-3 rounded-xl border-2 font-bold text-sm transition-all ${formData.priority === priority
                                          ? priority === 'Urgent' ? 'border-red-500 bg-red-100 text-red-700'
                                            : priority === 'High' ? 'border-amber-500 bg-amber-100 text-amber-700'
                                              : 'border-emerald-500 bg-emerald-100 text-emerald-700'
                                          : 'border-slate-200 bg-white text-slate-600'
                                        }`}>
                                      {priority === 'Urgent' ? 'Ø¹Ø§Ø¬Ù„' : priority === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ø¹Ø§Ø¯ÙŠ'}
                                    </button>
                                  ))}
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      {/* CAPA Option */}
                      <div className={`rounded-2xl p-6 border-2 transition-all ${formData.convertToCAPA ? 'bg-purple-50 border-purple-300' : 'bg-slate-50 border-slate-200'
                        }`}>
                        <div className="flex items-center justify-between">
                          <div className="flex items-center gap-4">
                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${formData.convertToCAPA ? 'bg-purple-500 text-white' : 'bg-slate-200 text-slate-600'
                              }`}>
                              <GitBranch className="w-6 h-6" />
                            </div>
                            <div>
                              <h4 className="font-bold text-slate-800">ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ CAPA</h4>
                              <p className="text-sm text-slate-500">Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¬Ø±Ø§Ø¡ ØªØµØ­ÙŠØ­ÙŠ/ÙˆÙ‚Ø§Ø¦ÙŠ Ù…Ø±ØªØ¨Ø·</p>
                            </div>
                          </div>
                          <button onClick={() => setFormData({ ...formData, convertToCAPA: !formData.convertToCAPA })}
                            className={`w-14 h-8 rounded-full transition-all ${formData.convertToCAPA ? 'bg-purple-500' : 'bg-slate-300'
                              }`}>
                            <div className={`w-6 h-6 rounded-full bg-white shadow-md transition-all ${formData.convertToCAPA ? 'translate-x-7' : 'translate-x-1'
                              }`} />
                          </button>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* Step 4: Review & Confirm */}
                  {executionStep === 4 && (
                    <div className="space-y-6">
                      <div className="bg-gradient-to-r from-orange-50 to-amber-50 rounded-2xl p-6 border border-orange-200">
                        <h3 className="text-lg font-bold text-orange-800 mb-6 flex items-center gap-2">
                          <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                        </h3>

                        <div className="grid grid-cols-2 gap-6">
                          {/* Classification */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <AlertTriangle className="w-4 h-4 text-orange-500" />Ø§Ù„ØªØµÙ†ÙŠÙ
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯:</span>
                                <span className="font-bold">{formData.code}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</span>
                                <span className="font-bold">{testCases.find(tc => tc.id === formData.testCaseId)?.code || '-'}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„Ø®Ø·ÙˆØ±Ø©:</span>
                                <span className={`font-bold px-2 py-0.5 rounded ${SEVERITY_CONFIG[formData.severity]?.bg} ${SEVERITY_CONFIG[formData.severity]?.text}`}>
                                  {SEVERITY_CONFIG[formData.severity]?.label}
                                </span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„Ù†ÙˆØ¹:</span>
                                <span className="font-bold">{FINDING_TYPE_CONFIG[formData.findingType]?.label}</span>
                              </div>
                            </div>
                          </div>

                          {/* Details */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <FileText className="w-4 h-4 text-blue-500" />Ø§Ù„ØªÙØ§ØµÙŠÙ„
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
                                <span className="font-bold text-left max-w-[200px] truncate">{formData.title || '-'}</span>
                              </div>
                              <div>
                                <span className="text-slate-500">Ø§Ù„ÙˆØµÙ:</span>
                                <p className="text-slate-700 mt-1 text-xs line-clamp-2">{formData.description || '-'}</p>
                              </div>
                            </div>
                          </div>

                          {/* Analysis */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <Search className="w-4 h-4 text-indigo-500" />Ø§Ù„ØªØ­Ù„ÙŠÙ„
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div>
                                <span className="text-slate-500">Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ:</span>
                                <p className="text-slate-700 mt-1 text-xs line-clamp-2">{formData.rootCause || '-'}</p>
                              </div>
                              <div className="flex gap-2 mt-2">
                                <span className={`px-2 py-0.5 rounded text-xs ${formData.financialImpact === 'High' ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-600'}`}>
                                  Ù…Ø§Ù„ÙŠ: {formData.financialImpact || 'Low'}
                                </span>
                                <span className={`px-2 py-0.5 rounded text-xs ${formData.operationalImpact === 'High' ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-600'}`}>
                                  ØªØ´ØºÙŠÙ„ÙŠ: {formData.operationalImpact || 'Low'}
                                </span>
                              </div>
                            </div>
                          </div>

                          {/* Remediation */}
                          <div className="bg-white rounded-xl p-5 border border-slate-200">
                            <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                              <Zap className="w-4 h-4 text-emerald-500" />Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                            </h4>
                            <div className="space-y-2 text-sm">
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</span>
                                <span className="font-bold">{getUser(formData.responsibleId)?.name || '-'}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</span>
                                <span className="font-bold">{formData.dueDate || '-'}</span>
                              </div>
                              <div className="flex justify-between">
                                <span className="text-slate-500">CAPA:</span>
                                {formData.convertToCAPA ? (
                                  <span className="font-bold text-purple-600 flex items-center gap-1"><CheckCircle2 className="w-4 h-4" />Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</span>
                                ) : (
                                  <span className="text-slate-400">Ù„Ø§</span>
                                )}
                              </div>
                            </div>
                          </div>
                        </div>

                        {/* Validation Summary */}
                        <div className="mt-6 p-4 bg-white rounded-xl border border-slate-200">
                          <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
                          <div className="grid grid-cols-3 gap-3">
                            {[
                              { label: 'Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', valid: !!formData.testCaseId },
                              { label: 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', valid: formData.title?.length >= 3 },
                              { label: 'Ø§Ù„ÙˆØµÙ', valid: formData.description?.length >= 10 },
                              { label: 'Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ', valid: formData.rootCause?.length >= 5 },
                              { label: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„', valid: !!formData.responsibleId },
                              { label: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚', valid: !!formData.dueDate },
                            ].map((check, idx) => (
                              <div key={idx} className={`flex items-center gap-2 p-2 rounded-lg ${check.valid ? 'bg-emerald-50' : 'bg-red-50'}`}>
                                {check.valid ? <CheckCircle2 className="w-4 h-4 text-emerald-500" /> : <XCircle className="w-4 h-4 text-red-500" />}
                                <span className={`text-xs font-medium ${check.valid ? 'text-emerald-700' : 'text-red-700'}`}>{check.label}</span>
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>
                  )}
                </div>

                {/* Footer with Navigation */}
                <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex items-center justify-between">
                  <button onClick={() => executionStep > 0 ? setExecutionStep(executionStep - 1) : setShowModal(false)}
                    className="flex items-center gap-2 px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white transition-all">
                    <ChevronRight className="w-5 h-5" />
                    {executionStep === 0 ? 'Ø¥Ù„ØºØ§Ø¡' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
                  </button>

                  <div className="flex items-center gap-2">
                    {[0, 1, 2, 3, 4].map(step => (
                      <div key={step} className={`w-3 h-3 rounded-full transition-all ${executionStep === step ? 'bg-orange-500 w-8' : executionStep > step ? 'bg-emerald-500' : 'bg-slate-300'}`} />
                    ))}
                  </div>

                  {executionStep < 4 ? (
                    <button onClick={() => setExecutionStep(executionStep + 1)}
                      className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-xl font-bold shadow-lg">
                      Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                    </button>
                  ) : (
                    <button onClick={handleSave}
                      disabled={!formData.testCaseId || !formData.title || !formData.description}
                      className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                      <CheckCircle2 className="w-5 h-5" />ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©
                    </button>
                  )}
                </div>
              </>
            )}

          </div>
        </div>
      )}

      {/* Delete Confirmation */}
      {showDeleteConfirm && deleteTarget && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center"><Trash2 className="w-6 h-6" /></div>
                <div><h2 className="text-xl font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h2></div>
              </div>
            </div>
            <div className="p-6">
              <p className="text-slate-600">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù:</p>
              <p className="font-bold text-slate-800 mt-2">{deleteTarget.code} - {deleteTarget.title}</p>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex justify-between">
              <button onClick={() => setShowDeleteConfirm(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleDelete} className="flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-bold">
                <Trash2 className="w-5 h-5" />Ø­Ø°Ù
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.7: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© ÙˆØªØªØ¨Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
// Regulatory Breach & Compliance Violations Management - World-Class Edition
// Features: Auto Triggers, CAPA, RCA, Exception Workflow, Golden Thread
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ViolationsManagement = () => {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // STATE MANAGEMENT
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [activeTab, setActiveTab] = useState('command');
  const [selectedBreach, setSelectedBreach] = useState(null);
  const [breachTab, setBreachTab] = useState('summary');
  const [showModal, setShowModal] = useState(false);
  const [modalMode, setModalMode] = useState('create');
  const [modalType, setModalType] = useState('breach'); // breach | action | exception
  const [formData, setFormData] = useState(null);
  const [wizardStep, setWizardStep] = useState(0);
  const [notification, setNotification] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterSeverity, setFilterSeverity] = useState('');
  const [filterAuthority, setFilterAuthority] = useState('');
  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
  const [deleteTarget, setDeleteTarget] = useState(null);
  const [viewMode, setViewMode] = useState('table'); // table | cards | kanban | timeline | matrix

  const CURRENT_USER = { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // BREACHES DATA
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [breaches, setBreaches] = useState([
    {
      id: 1, code: 'BRH-2025-001', authorityId: 1, frameworkId: 1, obligationId: 1, controlId: 1, riskId: 1,
      sourceType: 'TaskOverdue', sourceRefId: 101, title: 'ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
      description: 'ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø¹Ù† Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¨Ù€ 15 ÙŠÙˆÙ…',
      severity: 'High', regulatoryExposure: ['Penalty', 'Reputation'],
      breachDate: '2025-01-15', dueDate: '2025-02-15', status: 'Open',
      ownerId: 2, reviewerId: 1, approverId: 3, escalationLevel: 1,
      actions: [
        { id: 1, type: 'ImmediateFix', description: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙÙˆØ±Ø§Ù‹', responsibleId: 2, dueDate: '2025-01-20', status: 'Done' },
        { id: 2, type: 'RootCause', description: 'ØªØ­Ù„ÙŠÙ„ Ø³Ø¨Ø¨ Ø§Ù„ØªØ£Ø®ÙŠØ±', responsibleId: 2, dueDate: '2025-01-25', status: 'Open' },
      ],
      rca: { category: 'Process', rootCause: 'Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…Ø³Ø¨Ù‚Ø©', linkedControlGap: 'Ø¶Ø¹Ù ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©' },
      closureEvidence: [], exceptions: [], escalationHistory: [
        { date: '2025-01-20', level: 1, reason: 'ØªØ¬Ø§ÙˆØ² 5 Ø£ÙŠØ§Ù…', notifiedUsers: [1, 3] }
      ],
      createdAt: '2025-01-15', createdBy: 1,
    },
    {
      id: 2, code: 'BRH-2025-002', authorityId: 3, frameworkId: 5, obligationId: 5, controlId: 6, riskId: 2,
      sourceType: 'TestFail', sourceRefId: 4, title: 'ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      description: 'ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø± ÙØ¹Ø§Ù„ÙŠØ© Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ - ÙˆØ¬ÙˆØ¯ Ø­ÙˆØ§Ø¯Ø« ØºÙŠØ± Ù…ÙˆØ«Ù‚Ø©',
      severity: 'Critical', regulatoryExposure: ['Penalty', 'License', 'Reputation'],
      breachDate: '2025-02-20', dueDate: '2025-03-20', status: 'UnderReview',
      ownerId: 3, reviewerId: 1, approverId: 3, escalationLevel: 2,
      actions: [
        { id: 1, type: 'ImmediateFix', description: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©', responsibleId: 3, dueDate: '2025-02-25', status: 'Done' },
        { id: 2, type: 'ControlUpdate', description: 'ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªÙˆØ«ÙŠÙ‚', responsibleId: 3, dueDate: '2025-03-01', status: 'Open' },
        { id: 3, type: 'Training', description: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', responsibleId: 4, dueDate: '2025-03-10', status: 'Open' },
      ],
      rca: { category: 'People', rootCause: 'Ø¹Ø¯Ù… ÙˆØ¶ÙˆØ­ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªÙˆØ«ÙŠÙ‚', linkedControlGap: 'Ù†Ù‚Øµ Ø§Ù„ØªØ¯Ø±ÙŠØ¨' },
      closureEvidence: [], exceptions: [], escalationHistory: [
        { date: '2025-02-22', level: 1, reason: 'Ù…Ø®Ø§Ù„ÙØ© Critical', notifiedUsers: [1, 3] },
        { date: '2025-02-25', level: 2, reason: 'ØªØ¬Ø§ÙˆØ² 5 Ø£ÙŠØ§Ù…', notifiedUsers: [1, 3, 5] },
      ],
      createdAt: '2025-02-20', createdBy: 1,
    },
    {
      id: 3, code: 'BRH-2025-003', authorityId: 1, frameworkId: 2, obligationId: 2, controlId: 2, riskId: 1,
      sourceType: 'EvidenceRejected', sourceRefId: 7, title: 'Ø±ÙØ¶ Ø¯Ù„ÙŠÙ„ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª',
      description: 'ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø¯Ù… Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø±ØªÙŠÙ† Ø¨Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
      severity: 'Medium', regulatoryExposure: ['Penalty'],
      breachDate: '2025-02-10', dueDate: '2025-03-10', status: 'Remediation',
      ownerId: 2, reviewerId: 1, approverId: 3, escalationLevel: 0,
      actions: [
        { id: 1, type: 'ImmediateFix', description: 'Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø§Ù‚ØµØ©', responsibleId: 2, dueDate: '2025-02-15', status: 'Done' },
        { id: 2, type: 'ProcessUpdate', description: 'ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ±', responsibleId: 2, dueDate: '2025-02-20', status: 'Done' },
      ],
      rca: { category: 'Process', rootCause: 'Ù‚Ø§Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØºÙŠØ± Ù…ÙƒØªÙ…Ù„', linkedControlGap: 'Ø¹Ø¯Ù… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø¯ÙˆØ±ÙŠØ§Ù‹' },
      closureEvidence: [{ id: 1, evidenceId: 8, acceptedBy: 1, acceptedAt: '2025-02-18' }],
      exceptions: [], escalationHistory: [],
      createdAt: '2025-02-10', createdBy: 1,
    },
    {
      id: 4, code: 'BRH-2025-004', authorityId: 4, frameworkId: 7, obligationId: 4, controlId: 3, riskId: 3,
      sourceType: 'ExternalInspection', sourceRefId: null, title: 'Ù…Ù„Ø§Ø­Ø¸Ø© ØªÙØªÙŠØ´ÙŠØ© - Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
      description: 'Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù† Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙˆÙ„ Ø¹Ø¯Ù… Ø§ÙƒØªÙ…Ø§Ù„ Ø³Ø¬Ù„ Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©',
      severity: 'High', regulatoryExposure: ['Penalty', 'Operational'],
      breachDate: '2025-01-25', dueDate: '2025-02-25', status: 'Closed',
      ownerId: 4, reviewerId: 1, approverId: 3, escalationLevel: 0,
      actions: [
        { id: 1, type: 'ImmediateFix', description: 'Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø³Ø¬Ù„ ROPA', responsibleId: 4, dueDate: '2025-02-01', status: 'Done' },
        { id: 2, type: 'PolicyUpdate', description: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚', responsibleId: 4, dueDate: '2025-02-10', status: 'Done' },
      ],
      rca: { category: 'System', rootCause: 'Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù†Ø¸Ø§Ù… Ø¢Ù„ÙŠ Ù„Ù„ØªØªØ¨Ø¹', linkedControlGap: 'ÙŠØ¯ÙˆÙŠØ© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©' },
      closureEvidence: [
        { id: 1, evidenceId: 10, acceptedBy: 1, acceptedAt: '2025-02-12' },
        { id: 2, evidenceId: 11, acceptedBy: 1, acceptedAt: '2025-02-15' },
      ],
      exceptions: [], escalationHistory: [],
      closedAt: '2025-02-20', closedBy: 3,
      createdAt: '2025-01-25', createdBy: 1,
    },
    {
      id: 5, code: 'BRH-2025-005', authorityId: 2, frameworkId: 4, obligationId: 6, controlId: 7, riskId: 4,
      sourceType: 'TaskOverdue', sourceRefId: 105, title: 'ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥ÙØµØ§Ø­ Ù„Ù„Ù‡ÙŠØ¦Ø©',
      description: 'ØªØ£Ø®Ø± ÙÙŠ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
      severity: 'Low', regulatoryExposure: ['Reputation'],
      breachDate: '2025-02-01', dueDate: '2025-04-01', status: 'AcceptedException',
      ownerId: 5, reviewerId: 1, approverId: 3, escalationLevel: 0,
      actions: [],
      rca: null,
      closureEvidence: [],
      exceptions: [{
        id: 1, reason: 'ØªØ£Ø®Ø± Ø¨Ø³Ø¨Ø¨ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¸Ø§Ù… - ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ù…Ù† Ø§Ù„Ù‡ÙŠØ¦Ø©', approvedBy: 3, expiryDate: '2025-04-01', status: 'Active'
      }],
      escalationHistory: [],
      createdAt: '2025-02-01', createdBy: 1,
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CONFIGURATIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const SEVERITY_CONFIG = {
    Critical: { label: 'Ø­Ø±Ø¬', icon: AlertTriangle, bg: 'bg-red-600', light: 'bg-red-100', text: 'text-red-700', border: 'border-red-500' },
    High: { label: 'Ø¹Ø§Ù„ÙŠ', icon: AlertCircle, bg: 'bg-orange-500', light: 'bg-orange-100', text: 'text-orange-700', border: 'border-orange-500' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', icon: AlertCircle, bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-500' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', icon: Info, bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700', border: 'border-emerald-500' },
  };

  const STATUS_CONFIG = {
    Open: { label: 'Ù…ÙØªÙˆØ­', icon: AlertCircle, bg: 'bg-red-100', text: 'text-red-700' },
    UnderReview: { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: Eye, bg: 'bg-blue-100', text: 'text-blue-700' },
    Remediation: { label: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: Zap, bg: 'bg-amber-100', text: 'text-amber-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
    AcceptedException: { label: 'Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ù…Ø¹ØªÙ…Ø¯', icon: Shield, bg: 'bg-purple-100', text: 'text-purple-700' },
  };

  const SOURCE_TYPE_CONFIG = {
    TaskOverdue: { label: 'Ù…Ù‡Ù…Ø© Ù…ØªØ£Ø®Ø±Ø©', icon: Clock, color: 'amber' },
    EvidenceRejected: { label: 'Ø¯Ù„ÙŠÙ„ Ù…Ø±ÙÙˆØ¶', icon: XCircle, color: 'red' },
    TestFail: { label: 'Ø§Ø®ØªØ¨Ø§Ø± ÙØ§Ø´Ù„', icon: FileWarning, color: 'orange' },
    ExternalInspection: { label: 'ØªÙØªÙŠØ´ Ø®Ø§Ø±Ø¬ÙŠ', icon: Building2, color: 'purple' },
  };

  const EXPOSURE_CONFIG = {
    Penalty: { label: 'ØºØ±Ø§Ù…Ø© Ù…Ø§Ù„ÙŠØ©', icon: Scale, color: 'red' },
    License: { label: 'ØªØ±Ø®ÙŠØµ', icon: FileText, color: 'purple' },
    Reputation: { label: 'Ø³Ù…Ø¹Ø©', icon: Globe, color: 'amber' },
    Operational: { label: 'ØªØ´ØºÙŠÙ„ÙŠ', icon: Activity, color: 'blue' },
  };

  const ACTION_TYPE_CONFIG = {
    ImmediateFix: { label: 'Ø¥ØµÙ„Ø§Ø­ ÙÙˆØ±ÙŠ', icon: Zap, color: 'red' },
    RootCause: { label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨', icon: Search, color: 'indigo' },
    ControlUpdate: { label: 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¶Ø§Ø¨Ø·', icon: Shield, color: 'blue' },
    Training: { label: 'ØªØ¯Ø±ÙŠØ¨', icon: Users, color: 'emerald' },
    PolicyUpdate: { label: 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙŠØ§Ø³Ø©', icon: FileText, color: 'purple' },
    ProcessUpdate: { label: 'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', icon: GitBranch, color: 'amber' },
  };

  const RCA_CATEGORY_CONFIG = {
    People: { label: 'Ø§Ù„Ø£ÙØ±Ø§Ø¯', icon: Users, color: 'blue' },
    Process: { label: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª', icon: GitBranch, color: 'amber' },
    System: { label: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø©', icon: Settings, color: 'purple' },
    ThirdParty: { label: 'Ø·Ø±Ù Ø«Ø§Ù„Ø«', icon: Building2, color: 'slate' },
  };

  const USERS = [
    { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' },
    { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', role: 'Compliance Analyst' },
    { id: 3, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', role: 'Compliance Approver' },
    { id: 4, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'Data Protection Officer' },
    { id: 5, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'Governance Analyst' },
  ];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // COMPUTED STATISTICS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const stats = useMemo(() => {
    const open = breaches.filter(b => b.status === 'Open').length;
    const underReview = breaches.filter(b => b.status === 'UnderReview').length;
    const remediation = breaches.filter(b => b.status === 'Remediation').length;
    const closed = breaches.filter(b => b.status === 'Closed').length;
    const exceptions = breaches.filter(b => b.status === 'AcceptedException').length;

    const critical = breaches.filter(b => b.severity === 'Critical' && b.status !== 'Closed').length;
    const high = breaches.filter(b => b.severity === 'High' && b.status !== 'Closed').length;

    const overdue = breaches.filter(b => {
      if (b.status === 'Closed' || b.status === 'AcceptedException') return false;
      return new Date(b.dueDate) < new Date();
    }).length;

    const totalActions = breaches.reduce((sum, b) => sum + (b.actions?.length || 0), 0);
    const doneActions = breaches.reduce((sum, b) => sum + (b.actions?.filter(a => a.status === 'Done').length || 0), 0);

    const penaltyExposure = breaches.filter(b => b.regulatoryExposure?.includes('Penalty') && b.status !== 'Closed').length;
    const licenseExposure = breaches.filter(b => b.regulatoryExposure?.includes('License') && b.status !== 'Closed').length;

    return {
      total: breaches.length, open, underReview, remediation, closed, exceptions,
      critical, high, overdue, totalActions, doneActions, penaltyExposure, licenseExposure,
      activeBreaches: open + underReview + remediation,
    };
  }, [breaches]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // HELPER FUNCTIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  const getUser = (id) => USERS.find(u => u.id === id);
  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);
  const getObligation = (id) => INITIAL_OBLIGATIONS.find(o => o.id === id);
  const getControl = (id) => CONTROLS.find(c => c.id === id);

  const getDaysUntilDue = (dueDate) => {
    if (!dueDate) return null;
    return Math.ceil((new Date(dueDate) - new Date()) / (1000 * 60 * 60 * 24));
  };

  const filteredBreaches = useMemo(() => {
    return breaches.filter(b => {
      if (searchQuery && !b.code.toLowerCase().includes(searchQuery.toLowerCase()) && !b.title.toLowerCase().includes(searchQuery.toLowerCase())) return false;
      if (filterStatus && b.status !== filterStatus) return false;
      if (filterSeverity && b.severity !== filterSeverity) return false;
      if (filterAuthority && b.authorityId !== parseInt(filterAuthority)) return false;
      return true;
    });
  }, [breaches, searchQuery, filterStatus, filterSeverity, filterAuthority]);


  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CRUD HANDLERS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const handleCreateBreach = () => {
    setFormData({
      id: null, code: `BRH-2025-${String(breaches.length + 1).padStart(3, '0')}`,
      authorityId: '', frameworkId: '', obligationId: '', controlId: '', riskId: '',
      sourceType: 'TaskOverdue', sourceRefId: '', title: '', description: '',
      severity: 'Medium', regulatoryExposure: [], breachDate: new Date().toISOString().split('T')[0],
      dueDate: '', status: 'Open', ownerId: '', reviewerId: '', approverId: '',
      escalationLevel: 0, actions: [], rca: null, closureEvidence: [], exceptions: [],
      escalationHistory: [], createdAt: new Date().toISOString().split('T')[0], createdBy: CURRENT_USER.id,
    });
    setWizardStep(0);
    setModalType('breach');
    setModalMode('create');
    setShowModal(true);
  };

  const handleEditBreach = (breach) => {
    setFormData({ ...breach });
    setWizardStep(0);
    setModalType('breach');
    setModalMode('edit');
    setShowModal(true);
  };

  const handleViewBreach = (breach) => {
    setSelectedBreach(breach);
    setBreachTab('summary');
    setActiveTab('workspace');
  };

  const handleAddAction = () => {
    if (!selectedBreach) return;
    setFormData({
      id: null, type: 'ImmediateFix', description: '', responsibleId: '', dueDate: '', status: 'Open'
    });
    setModalType('action');
    setModalMode('create');
    setShowModal(true);
  };

  const handleRequestException = () => {
    if (!selectedBreach) return;
    setFormData({
      id: null, reason: '', approvedBy: '', expiryDate: '', status: 'Pending'
    });
    setModalType('exception');
    setModalMode('create');
    setShowModal(true);
  };

  const handleSave = () => {
    const now = new Date().toISOString().split('T')[0];

    if (modalType === 'breach') {
      if (!formData.title || !formData.obligationId || !formData.ownerId) {
        showNotification('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      if (modalMode === 'create') {
        setBreaches([...breaches, { ...formData, id: breaches.length + 1 }]);
        showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        setBreaches(breaches.map(b => b.id === formData.id ? formData : b));
        if (selectedBreach?.id === formData.id) setSelectedBreach(formData);
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©');
      }
    } else if (modalType === 'action') {
      if (!formData.description || !formData.responsibleId) {
        showNotification('Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      const newAction = { ...formData, id: (selectedBreach.actions?.length || 0) + 1 };
      const updatedBreach = {
        ...selectedBreach,
        actions: [...(selectedBreach.actions || []), newAction]
      };
      setBreaches(breaches.map(b => b.id === selectedBreach.id ? updatedBreach : b));
      setSelectedBreach(updatedBreach);
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØµØ­ÙŠØ­ÙŠ');
    } else if (modalType === 'exception') {
      if (!formData.reason || !formData.expiryDate) {
        showNotification('Ø§Ù„Ø³Ø¨Ø¨ ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      const newException = { ...formData, id: (selectedBreach.exceptions?.length || 0) + 1, approvedBy: CURRENT_USER.id, status: 'Active' };
      const updatedBreach = {
        ...selectedBreach,
        status: 'AcceptedException',
        exceptions: [...(selectedBreach.exceptions || []), newException]
      };
      setBreaches(breaches.map(b => b.id === selectedBreach.id ? updatedBreach : b));
      setSelectedBreach(updatedBreach);
      showNotification('ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡');
    }

    setShowModal(false);
    setFormData(null);
    setWizardStep(0);
  };

  const handleUpdateStatus = (breach, newStatus) => {
    const updatedBreach = { ...breach, status: newStatus };
    if (newStatus === 'Closed') {
      updatedBreach.closedAt = new Date().toISOString().split('T')[0];
      updatedBreach.closedBy = CURRENT_USER.id;
    }
    setBreaches(breaches.map(b => b.id === breach.id ? updatedBreach : b));
    if (selectedBreach?.id === breach.id) setSelectedBreach(updatedBreach);
    showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰: ${STATUS_CONFIG[newStatus]?.label}`);
  };

  const handleUpdateActionStatus = (actionId, newStatus) => {
    const updatedActions = selectedBreach.actions.map(a => a.id === actionId ? { ...a, status: newStatus } : a);
    const updatedBreach = { ...selectedBreach, actions: updatedActions };
    setBreaches(breaches.map(b => b.id === selectedBreach.id ? updatedBreach : b));
    setSelectedBreach(updatedBreach);
    showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
  };

  const handleEscalate = (breach) => {
    const newLevel = (breach.escalationLevel || 0) + 1;
    const escalationEntry = {
      date: new Date().toISOString().split('T')[0],
      level: newLevel,
      reason: 'ØªØµØ¹ÙŠØ¯ ÙŠØ¯ÙˆÙŠ',
      notifiedUsers: [1, 3, 5].slice(0, newLevel + 1)
    };
    const updatedBreach = {
      ...breach,
      escalationLevel: newLevel,
      escalationHistory: [...(breach.escalationHistory || []), escalationEntry]
    };
    setBreaches(breaches.map(b => b.id === breach.id ? updatedBreach : b));
    if (selectedBreach?.id === breach.id) setSelectedBreach(updatedBreach);
    showNotification(`ØªÙ… Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${newLevel}`);
  };

  const handleDelete = () => {
    setBreaches(breaches.filter(b => b.id !== deleteTarget.id));
    if (selectedBreach?.id === deleteTarget.id) setSelectedBreach(null);
    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©');
    setShowDeleteConfirm(false);
    setDeleteTarget(null);
  };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TABS CONFIGURATION
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const mainTabs = [
    { id: 'command', label: 'Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…', icon: LayoutDashboard },
    { id: 'register', label: 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª', icon: ClipboardList, count: stats.activeBreaches },
    { id: 'workspace', label: 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„', icon: Briefcase, disabled: !selectedBreach },
    { id: 'exceptions', label: 'Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', icon: Shield, count: stats.exceptions },
  ];

  const breachTabs = [
    { id: 'summary', label: 'Ø§Ù„Ù…Ù„Ø®Øµ', icon: FileText },
    { id: 'source', label: 'Ø§Ù„Ù…ØµØ¯Ø±', icon: Link2 },
    { id: 'actions', label: 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', icon: Zap },
    { id: 'rca', label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨', icon: Search },
    { id: 'evidence', label: 'Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚', icon: FileCheck },
    { id: 'escalation', label: 'Ø³Ø¬Ù„ Ø§Ù„ØªØµØ¹ÙŠØ¯', icon: TrendingUp },
  ];


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* Notification */}
      {notification && (
        <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold ${notification.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}`}>
          {notification.message}
        </div>
      )}

      {/* Header */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center shadow-lg">
            <AlertTriangle className="w-7 h-7 text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-slate-900">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</h1>
            <p className="text-slate-500">Regulatory Breach Management - Module 4.7</p>
          </div>
        </div>
        <div className="flex items-center gap-3">
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
          </button>
          <button onClick={handleCreateBreach}
            className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-red-500 to-orange-600 text-white rounded-xl font-bold shadow-lg">
            <Plus className="w-5 h-5" />ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ©
          </button>
        </div>
      </div>

      {/* Quick Stats - Alert Cards */}
      <div className="grid grid-cols-8 gap-3">
        <div className={`rounded-2xl p-4 ${stats.critical > 0 ? 'bg-red-600 animate-pulse' : 'bg-red-500'} text-white`}>
          <div className="flex items-center justify-between mb-1">
            <AlertTriangle className="w-5 h-5" />
            <span className="text-3xl font-bold">{stats.critical}</span>
          </div>
          <p className="text-red-100 text-sm">Ø­Ø±Ø¬</p>
        </div>

        <div className={`rounded-2xl p-4 ${stats.overdue > 0 ? 'bg-orange-500 animate-pulse' : 'bg-orange-400'} text-white`}>
          <div className="flex items-center justify-between mb-1">
            <Clock className="w-5 h-5" />
            <span className="text-3xl font-bold">{stats.overdue}</span>
          </div>
          <p className="text-orange-100 text-sm">Ù…ØªØ£Ø®Ø±</p>
        </div>

        <div className="bg-amber-100 rounded-2xl p-4 border-2 border-amber-300">
          <div className="flex items-center justify-between mb-1">
            <AlertCircle className="w-5 h-5 text-amber-600" />
            <span className="text-2xl font-bold text-amber-700">{stats.open}</span>
          </div>
          <p className="text-amber-600 text-sm">Ù…ÙØªÙˆØ­</p>
        </div>

        <div className="bg-blue-100 rounded-2xl p-4 border-2 border-blue-300">
          <div className="flex items-center justify-between mb-1">
            <Eye className="w-5 h-5 text-blue-600" />
            <span className="text-2xl font-bold text-blue-700">{stats.underReview}</span>
          </div>
          <p className="text-blue-600 text-sm">Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
        </div>

        <div className="bg-amber-50 rounded-2xl p-4 border-2 border-amber-200">
          <div className="flex items-center justify-between mb-1">
            <Zap className="w-5 h-5 text-amber-500" />
            <span className="text-2xl font-bold text-amber-600">{stats.remediation}</span>
          </div>
          <p className="text-amber-500 text-sm">Ù…Ø¹Ø§Ù„Ø¬Ø©</p>
        </div>

        <div className="bg-emerald-100 rounded-2xl p-4 border-2 border-emerald-300">
          <div className="flex items-center justify-between mb-1">
            <CheckCircle2 className="w-5 h-5 text-emerald-600" />
            <span className="text-2xl font-bold text-emerald-700">{stats.closed}</span>
          </div>
          <p className="text-emerald-600 text-sm">Ù…ØºÙ„Ù‚</p>
        </div>

        <div className="bg-purple-100 rounded-2xl p-4 border-2 border-purple-300">
          <div className="flex items-center justify-between mb-1">
            <Shield className="w-5 h-5 text-purple-600" />
            <span className="text-2xl font-bold text-purple-700">{stats.exceptions}</span>
          </div>
          <p className="text-purple-600 text-sm">Ø§Ø³ØªØ«Ù†Ø§Ø¡</p>
        </div>

        <div className="bg-slate-100 rounded-2xl p-4 border-2 border-slate-200">
          <div className="flex items-center justify-between mb-1">
            <ClipboardCheck className="w-5 h-5 text-slate-600" />
            <span className="text-2xl font-bold text-slate-700">{stats.total}</span>
          </div>
          <p className="text-slate-500 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
        </div>
      </div>

      {/* Main Content */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
        {/* Tabs */}
        <div className="flex border-b border-slate-200">
          {mainTabs.map(tab => (
            <button key={tab.id} onClick={() => !tab.disabled && setActiveTab(tab.id)}
              disabled={tab.disabled}
              className={`flex items-center gap-2 px-5 py-4 font-bold transition-all border-b-2 ${activeTab === tab.id ? 'text-red-600 border-red-500 bg-red-50' :
                  tab.disabled ? 'text-slate-300 border-transparent cursor-not-allowed' :
                    'text-slate-500 border-transparent hover:bg-slate-50'
                }`}>
              <tab.icon className="w-5 h-5" />
              {tab.label}
              {tab.count > 0 && (
                <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-red-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                  {tab.count}
                </span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: COMMAND CENTER
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'command' && (
          <div className="p-6">
            <div className="grid grid-cols-3 gap-6">
              {/* Regulatory Exposure Heatmap */}
              <div className="col-span-2 bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-5 border border-red-200">
                <h3 className="font-bold text-red-800 mb-4 flex items-center gap-2">
                  <Activity className="w-5 h-5" />Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
                </h3>
                <div className="grid grid-cols-4 gap-4">
                  {Object.entries(EXPOSURE_CONFIG).map(([key, cfg]) => {
                    const count = breaches.filter(b => b.regulatoryExposure?.includes(key) && b.status !== 'Closed').length;
                    return (
                      <div key={key} className={`bg-white rounded-xl p-4 border-2 ${count > 0 ? `border-${cfg.color}-300` : 'border-slate-200'}`}>
                        <div className="flex items-center gap-2 mb-2">
                          <cfg.icon className={`w-5 h-5 text-${cfg.color}-500`} />
                          <span className="text-sm font-bold text-slate-700">{cfg.label}</span>
                        </div>
                        <p className={`text-3xl font-bold ${count > 0 ? `text-${cfg.color}-600` : 'text-slate-400'}`}>{count}</p>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Quick Actions */}
              <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                <h3 className="font-bold mb-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                <div className="space-y-2">
                  <button onClick={handleCreateBreach} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <Plus className="w-5 h-5" /><span>ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</span>
                  </button>
                  <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <FileText className="w-5 h-5" /><span>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª</span>
                  </button>
                  <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <TrendingUp className="w-5 h-5" /><span>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª</span>
                  </button>
                </div>
              </div>

              {/* Breaches by Authority */}
              <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©</h3>
                {AUTHORITIES.slice(0, 5).map(auth => {
                  const count = breaches.filter(b => b.authorityId === auth.id && b.status !== 'Closed').length;
                  const pct = stats.activeBreaches > 0 ? Math.round((count / stats.activeBreaches) * 100) : 0;
                  return (
                    <div key={auth.id} className="mb-3">
                      <div className="flex justify-between mb-1">
                        <span className="text-sm text-slate-600">{auth.code}</span>
                        <span className="text-sm font-bold">{count}</span>
                      </div>
                      <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                        <div className={`h-full rounded-full ${count > 0 ? 'bg-red-500' : 'bg-slate-200'}`} style={{ width: `${pct}%` }}></div>
                      </div>
                    </div>
                  );
                })}
              </div>

              {/* Actions Progress */}
              <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©</h3>
                <div className="flex items-center justify-center">
                  <div className="relative w-32 h-32">
                    <svg className="w-32 h-32 transform -rotate-90">
                      <circle cx="64" cy="64" r="56" stroke="#e2e8f0" strokeWidth="12" fill="none" />
                      <circle cx="64" cy="64" r="56" stroke="#10b981" strokeWidth="12" fill="none"
                        strokeDasharray={`${(stats.doneActions / Math.max(stats.totalActions, 1)) * 352} 352`} strokeLinecap="round" />
                    </svg>
                    <div className="absolute inset-0 flex flex-col items-center justify-center">
                      <span className="text-3xl font-bold text-slate-800">{stats.totalActions > 0 ? Math.round((stats.doneActions / stats.totalActions) * 100) : 0}%</span>
                      <span className="text-xs text-slate-500">{stats.doneActions}/{stats.totalActions}</span>
                    </div>
                  </div>
                </div>
              </div>

              {/* Recent Breaches */}
              <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4">Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª</h3>
                <div className="space-y-2">
                  {breaches.slice(0, 4).map(b => {
                    const sevCfg = SEVERITY_CONFIG[b.severity];
                    const statusCfg = STATUS_CONFIG[b.status];
                    return (
                      <div key={b.id} onClick={() => handleViewBreach(b)}
                        className="flex items-center gap-3 p-3 rounded-xl bg-slate-50 hover:bg-slate-100 cursor-pointer">
                        <div className={`w-3 h-3 rounded-full ${sevCfg?.bg}`}></div>
                        <div className="flex-1 min-w-0">
                          <p className="text-sm font-bold text-slate-800 truncate">{b.code}</p>
                          <p className="text-xs text-slate-500 truncate">{b.title}</p>
                        </div>
                        <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                          {statusCfg?.label}
                        </span>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>
          </div>
        )}


        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: BREACH REGISTER - WORLD-CLASS EDITION
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'register' && (
          <div className="p-6">
            {/* Advanced Header with View Toggle */}
            <div className="flex items-center justify-between mb-6">
              <div className="flex items-center gap-4">
                <h3 className="text-xl font-bold text-slate-800">Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</h3>
                <span className="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-bold">
                  {filteredBreaches.length} Ù…Ø®Ø§Ù„ÙØ©
                </span>
              </div>

              {/* View Mode Toggle */}
              <div className="flex items-center gap-2 bg-slate-100 p-1 rounded-xl">
                {[
                  { id: 'table', icon: Table, label: 'Ø¬Ø¯ÙˆÙ„' },
                  { id: 'cards', icon: LayoutGrid, label: 'Ø¨Ø·Ø§Ù‚Ø§Øª' },
                  { id: 'kanban', icon: Layers, label: 'ÙƒØ§Ù†Ø¨Ø§Ù†' },
                  { id: 'timeline', icon: Activity, label: 'Ø®Ø· Ø²Ù…Ù†ÙŠ' },
                  { id: 'matrix', icon: PieChart, label: 'Ù…ØµÙÙˆÙØ©' },
                ].map(mode => (
                  <button key={mode.id} onClick={() => setViewMode(mode.id)}
                    className={`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all ${viewMode === mode.id ? 'bg-white text-red-600 shadow-md' : 'text-slate-500 hover:text-slate-700'
                      }`}>
                    <mode.icon className="w-4 h-4" />
                    <span className="text-sm">{mode.label}</span>
                  </button>
                ))}
              </div>
            </div>

            {/* Quick Severity Filters */}
            <div className="flex items-center gap-3 mb-4">
              <span className="text-sm text-slate-500">ÙÙ„ØªØ±Ø© Ø³Ø±ÙŠØ¹Ø©:</span>
              <button onClick={() => setFilterSeverity(filterSeverity === 'Critical' ? '' : 'Critical')}
                className={`flex items-center gap-2 px-3 py-2 rounded-xl border-2 transition-all ${filterSeverity === 'Critical' ? 'border-red-500 bg-red-50 text-red-700' : 'border-slate-200 hover:border-red-300'
                  }`}>
                <div className="w-3 h-3 rounded-full bg-red-600"></div>
                <span className="text-sm font-bold">Ø­Ø±Ø¬ ({breaches.filter(b => b.severity === 'Critical').length})</span>
              </button>
              <button onClick={() => setFilterSeverity(filterSeverity === 'High' ? '' : 'High')}
                className={`flex items-center gap-2 px-3 py-2 rounded-xl border-2 transition-all ${filterSeverity === 'High' ? 'border-orange-500 bg-orange-50 text-orange-700' : 'border-slate-200 hover:border-orange-300'
                  }`}>
                <div className="w-3 h-3 rounded-full bg-orange-500"></div>
                <span className="text-sm font-bold">Ø¹Ø§Ù„ÙŠ ({breaches.filter(b => b.severity === 'High').length})</span>
              </button>
              <button onClick={() => setFilterSeverity(filterSeverity === 'Medium' ? '' : 'Medium')}
                className={`flex items-center gap-2 px-3 py-2 rounded-xl border-2 transition-all ${filterSeverity === 'Medium' ? 'border-amber-500 bg-amber-50 text-amber-700' : 'border-slate-200 hover:border-amber-300'
                  }`}>
                <div className="w-3 h-3 rounded-full bg-amber-500"></div>
                <span className="text-sm font-bold">Ù…ØªÙˆØ³Ø· ({breaches.filter(b => b.severity === 'Medium').length})</span>
              </button>
              <button onClick={() => setFilterSeverity(filterSeverity === 'Low' ? '' : 'Low')}
                className={`flex items-center gap-2 px-3 py-2 rounded-xl border-2 transition-all ${filterSeverity === 'Low' ? 'border-emerald-500 bg-emerald-50 text-emerald-700' : 'border-slate-200 hover:border-emerald-300'
                  }`}>
                <div className="w-3 h-3 rounded-full bg-emerald-500"></div>
                <span className="text-sm font-bold">Ù…Ù†Ø®ÙØ¶ ({breaches.filter(b => b.severity === 'Low').length})</span>
              </button>

              <div className="h-6 w-px bg-slate-300 mx-2"></div>

              {/* Status Quick Filters */}
              <button onClick={() => setFilterStatus(filterStatus === 'Open' ? '' : 'Open')}
                className={`px-3 py-2 rounded-xl border-2 text-sm font-bold transition-all ${filterStatus === 'Open' ? 'border-red-500 bg-red-50 text-red-700' : 'border-slate-200 hover:border-red-300'
                  }`}>Ù…ÙØªÙˆØ­</button>
              <button onClick={() => setFilterStatus(filterStatus === 'Remediation' ? '' : 'Remediation')}
                className={`px-3 py-2 rounded-xl border-2 text-sm font-bold transition-all ${filterStatus === 'Remediation' ? 'border-amber-500 bg-amber-50 text-amber-700' : 'border-slate-200 hover:border-amber-300'
                  }`}>Ù…Ø¹Ø§Ù„Ø¬Ø©</button>
              <button onClick={() => setFilterStatus(filterStatus === 'Closed' ? '' : 'Closed')}
                className={`px-3 py-2 rounded-xl border-2 text-sm font-bold transition-all ${filterStatus === 'Closed' ? 'border-emerald-500 bg-emerald-50 text-emerald-700' : 'border-slate-200 hover:border-emerald-300'
                  }`}>Ù…ØºÙ„Ù‚</button>

              {(filterStatus || filterSeverity || filterAuthority || searchQuery) && (
                <button onClick={() => { setFilterStatus(''); setFilterSeverity(''); setFilterAuthority(''); setSearchQuery(''); }}
                  className="px-3 py-2 text-red-600 hover:bg-red-50 rounded-xl text-sm font-bold flex items-center gap-1">
                  <X className="w-4 h-4" />Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±
                </button>
              )}
            </div>

            {/* Advanced Search & Filters Row */}
            <div className="flex items-center gap-3 mb-6">
              <div className="relative flex-1 max-w-lg">
                <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                <input type="text" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ Ø§Ù„ÙˆØµÙ..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl focus:border-red-400 focus:outline-none" />
              </div>
              <select value={filterAuthority} onChange={(e) => setFilterAuthority(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl min-w-[150px]">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
                {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code} - {a.nameAr}</option>)}
              </select>
            </div>

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                VIEW: TABLE
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {viewMode === 'table' && (
              <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                <div className="overflow-x-auto">
                  <table className="w-full">
                    <thead>
                      <tr className="bg-gradient-to-r from-slate-50 to-slate-100 border-b-2 border-slate-200">
                        <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                        <th className="text-right px-4 py-4 font-bold text-slate-700 min-w-[250px]">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ù…ØµØ¯Ø±</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø®Ø·ÙˆØ±Ø©</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</th>
                        <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„ØªÙ‚Ø¯Ù…</th>
                        <th className="text-center px-4 py-4 font-bold text-slate-700 w-44">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                      </tr>
                    </thead>
                    <tbody>
                      {filteredBreaches.map((breach, idx) => {
                        const auth = getAuthority(breach.authorityId);
                        const sevCfg = SEVERITY_CONFIG[breach.severity];
                        const statusCfg = STATUS_CONFIG[breach.status];
                        const sourceCfg = SOURCE_TYPE_CONFIG[breach.sourceType];
                        const daysUntil = getDaysUntilDue(breach.dueDate);
                        const SourceIcon = sourceCfg?.icon || Clock;
                        const actionsCount = breach.actions?.length || 0;
                        const doneActions = breach.actions?.filter(a => a.status === 'Done').length || 0;
                        const progressPct = actionsCount > 0 ? Math.round((doneActions / actionsCount) * 100) : 0;

                        return (
                          <tr key={breach.id} className={`border-b border-slate-100 hover:bg-slate-50 transition-all ${breach.severity === 'Critical' ? 'bg-red-50/50' : ''
                            }`}>
                            <td className="px-4 py-4">
                              <div className="flex items-center gap-2">
                                <div className={`w-1.5 h-10 rounded-full ${sevCfg?.bg}`}></div>
                                <span className="font-mono text-sm font-bold text-red-600 bg-red-50 px-2 py-1 rounded-lg">{breach.code}</span>
                              </div>
                            </td>
                            <td className="px-4 py-4">
                              <div className="cursor-pointer hover:text-red-600" onClick={() => handleViewBreach(breach)}>
                                <p className="font-bold text-slate-800 line-clamp-1">{breach.title}</p>
                                <p className="text-xs text-slate-500 line-clamp-1">{breach.description?.substring(0, 60)}...</p>
                              </div>
                            </td>
                            <td className="px-3 py-4 text-center">
                              <span className="px-3 py-1.5 bg-slate-100 text-slate-700 rounded-lg text-xs font-bold">{auth?.code}</span>
                            </td>
                            <td className="px-3 py-4 text-center">
                              <span className={`inline-flex items-center gap-1.5 px-2.5 py-1.5 bg-${sourceCfg?.color}-100 text-${sourceCfg?.color}-700 rounded-lg text-xs font-bold`}>
                                <SourceIcon className="w-3.5 h-3.5" />{sourceCfg?.label}
                              </span>
                            </td>
                            <td className="px-3 py-4 text-center">
                              <span className={`px-3 py-1.5 rounded-lg text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>
                                {sevCfg?.label}
                              </span>
                            </td>
                            <td className="px-3 py-4 text-center">
                              <span className={`inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                                {React.createElement(statusCfg?.icon || Clock, { className: "w-3 h-3" })}
                                {statusCfg?.label}
                              </span>
                            </td>
                            <td className="px-3 py-4 text-center">
                              <div className="text-sm font-bold text-slate-700">{breach.dueDate}</div>
                              {daysUntil !== null && breach.status !== 'Closed' && breach.status !== 'AcceptedException' && (
                                <span className={`text-xs font-bold px-2 py-0.5 rounded-full ${daysUntil < 0 ? 'bg-red-100 text-red-600' : daysUntil <= 7 ? 'bg-amber-100 text-amber-600' : 'bg-emerald-100 text-emerald-600'
                                  }`}>
                                  {daysUntil < 0 ? `Ù…ØªØ£Ø®Ø± ${Math.abs(daysUntil)} ÙŠÙˆÙ…` : `${daysUntil} ÙŠÙˆÙ…`}
                                </span>
                              )}
                            </td>
                            <td className="px-3 py-4">
                              <div className="flex flex-col items-center gap-1">
                                <div className="w-16 h-2 bg-slate-200 rounded-full overflow-hidden">
                                  <div className={`h-full rounded-full ${progressPct === 100 ? 'bg-emerald-500' : progressPct > 0 ? 'bg-amber-500' : 'bg-slate-300'}`}
                                    style={{ width: `${progressPct}%` }}></div>
                                </div>
                                <span className="text-xs text-slate-500">{doneActions}/{actionsCount}</span>
                              </div>
                            </td>
                            <td className="px-4 py-4">
                              <div className="flex items-center justify-center gap-1">
                                <button onClick={() => handleViewBreach(breach)} className="p-2 hover:bg-blue-100 rounded-lg transition-all" title="Ø¹Ø±Ø¶">
                                  <Eye className="w-4 h-4 text-blue-600" />
                                </button>
                                <button onClick={() => handleEditBreach(breach)} className="p-2 hover:bg-amber-100 rounded-lg transition-all" title="ØªØ¹Ø¯ÙŠÙ„">
                                  <Edit className="w-4 h-4 text-amber-600" />
                                </button>
                                {breach.escalationLevel < 3 && breach.status !== 'Closed' && (
                                  <button onClick={() => handleEscalate(breach)} className="p-2 hover:bg-red-100 rounded-lg transition-all" title="ØªØµØ¹ÙŠØ¯">
                                    <TrendingUp className="w-4 h-4 text-red-600" />
                                  </button>
                                )}
                                {breach.escalationLevel > 0 && (
                                  <span className="px-2 py-1 bg-red-500 text-white rounded text-xs font-bold">L{breach.escalationLevel}</span>
                                )}
                                <button onClick={() => { setDeleteTarget(breach); setShowDeleteConfirm(true); }} className="p-2 hover:bg-red-100 rounded-lg transition-all" title="Ø­Ø°Ù">
                                  <Trash2 className="w-4 h-4 text-red-600" />
                                </button>
                              </div>
                            </td>
                          </tr>
                        );
                      })}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                VIEW: CARDS
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {viewMode === 'cards' && (
              <div className="grid grid-cols-3 gap-4">
                {filteredBreaches.map(breach => {
                  const auth = getAuthority(breach.authorityId);
                  const sevCfg = SEVERITY_CONFIG[breach.severity];
                  const statusCfg = STATUS_CONFIG[breach.status];
                  const sourceCfg = SOURCE_TYPE_CONFIG[breach.sourceType];
                  const daysUntil = getDaysUntilDue(breach.dueDate);
                  const SourceIcon = sourceCfg?.icon || Clock;
                  const actionsCount = breach.actions?.length || 0;
                  const doneActions = breach.actions?.filter(a => a.status === 'Done').length || 0;

                  return (
                    <div key={breach.id} className={`bg-white rounded-2xl border-2 overflow-hidden transition-all hover:shadow-lg cursor-pointer ${breach.severity === 'Critical' ? 'border-red-300 shadow-red-100' : 'border-slate-200 hover:border-red-300'
                      }`} onClick={() => handleViewBreach(breach)}>
                      {/* Card Header */}
                      <div className={`px-4 py-3 ${sevCfg?.light} border-b-2 ${sevCfg?.border}`}>
                        <div className="flex items-center justify-between">
                          <span className="font-mono text-sm font-bold text-red-600">{breach.code}</span>
                          <div className="flex items-center gap-2">
                            {breach.escalationLevel > 0 && (
                              <span className="flex items-center gap-1 px-2 py-0.5 bg-red-500 text-white rounded text-xs font-bold">
                                <TrendingUp className="w-3 h-3" />L{breach.escalationLevel}
                              </span>
                            )}
                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                          </div>
                        </div>
                      </div>

                      {/* Card Body */}
                      <div className="p-4">
                        <h4 className="font-bold text-slate-800 line-clamp-2 mb-3">{breach.title}</h4>

                        <div className="flex flex-wrap gap-2 mb-3">
                          <span className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs font-bold">{auth?.code}</span>
                          <span className={`inline-flex items-center gap-1 px-2 py-1 bg-${sourceCfg?.color}-100 text-${sourceCfg?.color}-700 rounded text-xs font-bold`}>
                            <SourceIcon className="w-3 h-3" />{sourceCfg?.label}
                          </span>
                        </div>

                        <p className="text-sm text-slate-600 line-clamp-2 mb-4">{breach.description}</p>

                        {/* Progress */}
                        {actionsCount > 0 && (
                          <div className="mb-3">
                            <div className="flex justify-between text-xs text-slate-500 mb-1">
                              <span>ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</span>
                              <span>{doneActions}/{actionsCount}</span>
                            </div>
                            <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                              <div className="h-full bg-emerald-500 rounded-full" style={{ width: `${(doneActions / actionsCount) * 100}%` }}></div>
                            </div>
                          </div>
                        )}

                        {/* Footer */}
                        <div className="flex items-center justify-between pt-3 border-t border-slate-100">
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                            {React.createElement(statusCfg?.icon || Clock, { className: "w-3 h-3" })}
                            {statusCfg?.label}
                          </span>
                          <span className={`text-xs font-bold ${daysUntil !== null && daysUntil < 0 ? 'text-red-600' : 'text-slate-500'}`}>
                            {breach.dueDate}
                          </span>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                VIEW: KANBAN
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {viewMode === 'kanban' && (
              <div className="grid grid-cols-5 gap-4">
                {Object.entries(STATUS_CONFIG).map(([statusKey, statusCfg]) => {
                  const statusBreaches = filteredBreaches.filter(b => b.status === statusKey);
                  const StatusIcon = statusCfg.icon;
                  return (
                    <div key={statusKey} className="bg-slate-50 rounded-2xl p-4 min-h-[500px]">
                      <div className={`flex items-center justify-between mb-4 pb-3 border-b-2 ${statusCfg.bg.replace('bg-', 'border-')}`}>
                        <div className="flex items-center gap-2">
                          <StatusIcon className={`w-5 h-5 ${statusCfg.text}`} />
                          <span className={`font-bold ${statusCfg.text}`}>{statusCfg.label}</span>
                        </div>
                        <span className={`w-7 h-7 rounded-lg ${statusCfg.bg} ${statusCfg.text} flex items-center justify-center text-sm font-bold`}>
                          {statusBreaches.length}
                        </span>
                      </div>
                      <div className="space-y-3">
                        {statusBreaches.map(breach => {
                          const sevCfg = SEVERITY_CONFIG[breach.severity];
                          const auth = getAuthority(breach.authorityId);
                          return (
                            <div key={breach.id} onClick={() => handleViewBreach(breach)}
                              className={`bg-white rounded-xl p-3 border-r-4 ${sevCfg?.border} shadow-sm hover:shadow-md cursor-pointer transition-all`}>
                              <div className="flex items-start justify-between mb-2">
                                <span className="font-mono text-xs font-bold text-red-600">{breach.code}</span>
                                <span className={`px-1.5 py-0.5 rounded text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                              </div>
                              <p className="text-sm font-bold text-slate-800 line-clamp-2 mb-2">{breach.title}</p>
                              <div className="flex items-center justify-between text-xs text-slate-500">
                                <span>{auth?.code}</span>
                                <span>{breach.dueDate}</span>
                              </div>
                              {breach.escalationLevel > 0 && (
                                <div className="mt-2 flex items-center gap-1 text-xs text-red-600">
                                  <TrendingUp className="w-3 h-3" />
                                  <span>ØªØµØ¹ÙŠØ¯ L{breach.escalationLevel}</span>
                                </div>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  );
                })}
              </div>
            )}

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                VIEW: TIMELINE
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {viewMode === 'timeline' && (
              <div className="relative">
                <div className="absolute right-8 top-0 bottom-0 w-1 bg-gradient-to-b from-red-500 via-amber-500 to-emerald-500 rounded-full"></div>
                <div className="space-y-6 pr-16">
                  {filteredBreaches.sort((a, b) => new Date(b.breachDate) - new Date(a.breachDate)).map((breach, idx) => {
                    const sevCfg = SEVERITY_CONFIG[breach.severity];
                    const statusCfg = STATUS_CONFIG[breach.status];
                    const auth = getAuthority(breach.authorityId);
                    const SevIcon = sevCfg?.icon || AlertCircle;

                    return (
                      <div key={breach.id} className="relative flex gap-6">
                        <div className={`absolute right-5 w-6 h-6 rounded-full ${sevCfg?.bg} border-4 border-white shadow-lg flex items-center justify-center`}>
                          <SevIcon className="w-3 h-3 text-white" />
                        </div>
                        <div className={`flex-1 bg-white rounded-2xl border-2 ${sevCfg?.border} p-5 hover:shadow-lg cursor-pointer transition-all`}
                          onClick={() => handleViewBreach(breach)}>
                          <div className="flex items-start justify-between mb-3">
                            <div>
                              <div className="flex items-center gap-2 mb-1">
                                <span className="font-mono text-sm font-bold text-red-600 bg-red-50 px-2 py-0.5 rounded">{breach.code}</span>
                                <span className={`px-2 py-0.5 rounded text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                                <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>{statusCfg?.label}</span>
                                {breach.escalationLevel > 0 && (
                                  <span className="flex items-center gap-1 px-2 py-0.5 bg-red-500 text-white rounded text-xs font-bold">
                                    <TrendingUp className="w-3 h-3" />L{breach.escalationLevel}
                                  </span>
                                )}
                              </div>
                              <h4 className="font-bold text-slate-800 text-lg">{breach.title}</h4>
                            </div>
                            <div className="text-left">
                              <p className="text-sm font-bold text-slate-700">{breach.breachDate}</p>
                              <p className="text-xs text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</p>
                            </div>
                          </div>
                          <p className="text-slate-600 mb-4">{breach.description}</p>
                          <div className="flex items-center gap-4 text-sm text-slate-500">
                            <span className="flex items-center gap-1"><Building2 className="w-4 h-4" />{auth?.code}</span>
                            <span className="flex items-center gap-1"><User className="w-4 h-4" />{getUser(breach.ownerId)?.name}</span>
                            <span className="flex items-center gap-1"><Calendar className="w-4 h-4" />Ø§Ø³ØªØ­Ù‚Ø§Ù‚: {breach.dueDate}</span>
                            {breach.actions?.length > 0 && (
                              <span className="flex items-center gap-1">
                                <Zap className="w-4 h-4" />
                                {breach.actions.filter(a => a.status === 'Done').length}/{breach.actions.length} Ø¥Ø¬Ø±Ø§Ø¡
                              </span>
                            )}
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                VIEW: RISK MATRIX
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
            {viewMode === 'matrix' && (
              <div className="space-y-6">
                {/* Risk Heat Matrix */}
                <div className="bg-white rounded-2xl border-2 border-slate-200 p-6">
                  <h3 className="font-bold text-slate-800 mb-4">Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø®Ø§Ø·Ø± - Ø§Ù„Ø®Ø·ÙˆØ±Ø© Ã— Ø§Ù„Ø­Ø§Ù„Ø©</h3>
                  <div className="grid grid-cols-6 gap-2">
                    {/* Header Row */}
                    <div></div>
                    {Object.entries(STATUS_CONFIG).map(([key, cfg]) => (
                      <div key={key} className={`text-center p-2 rounded-lg ${cfg.bg}`}>
                        <span className={`text-sm font-bold ${cfg.text}`}>{cfg.label}</span>
                      </div>
                    ))}

                    {/* Data Rows */}
                    {Object.entries(SEVERITY_CONFIG).map(([sevKey, sevCfg]) => (
                      <React.Fragment key={sevKey}>
                        <div className={`p-3 rounded-lg ${sevCfg.light} flex items-center justify-center`}>
                          <span className={`text-sm font-bold ${sevCfg.text}`}>{sevCfg.label}</span>
                        </div>
                        {Object.keys(STATUS_CONFIG).map(statusKey => {
                          const count = filteredBreaches.filter(b => b.severity === sevKey && b.status === statusKey).length;
                          const isHot = sevKey === 'Critical' && (statusKey === 'Open' || statusKey === 'UnderReview');
                          return (
                            <div key={statusKey}
                              className={`p-4 rounded-lg text-center transition-all cursor-pointer ${count > 0
                                  ? isHot ? 'bg-red-500 text-white animate-pulse' : 'bg-slate-100 hover:bg-slate-200'
                                  : 'bg-slate-50'
                                }`}
                              onClick={() => {
                                setFilterSeverity(sevKey);
                                setFilterStatus(statusKey);
                              }}>
                              <span className={`text-2xl font-bold ${count > 0 && isHot ? 'text-white' : count > 0 ? 'text-slate-800' : 'text-slate-300'}`}>
                                {count}
                              </span>
                            </div>
                          );
                        })}
                      </React.Fragment>
                    ))}
                  </div>
                </div>

                {/* Exposure Analysis */}
                <div className="grid grid-cols-4 gap-4">
                  {Object.entries(EXPOSURE_CONFIG).map(([key, cfg]) => {
                    const count = filteredBreaches.filter(b => b.regulatoryExposure?.includes(key) && b.status !== 'Closed').length;
                    const ExpIcon = cfg.icon;
                    return (
                      <div key={key} className={`bg-gradient-to-br from-${cfg.color}-50 to-${cfg.color}-100 rounded-2xl p-5 border-2 border-${cfg.color}-200`}>
                        <div className="flex items-center justify-between mb-3">
                          <ExpIcon className={`w-8 h-8 text-${cfg.color}-600`} />
                          <span className={`text-4xl font-bold text-${cfg.color}-700`}>{count}</span>
                        </div>
                        <h4 className={`font-bold text-${cfg.color}-800`}>{cfg.label}</h4>
                        <p className="text-sm text-slate-600 mt-1">Ù…Ø®Ø§Ù„ÙØ§Øª Ù†Ø´Ø·Ø©</p>
                      </div>
                    );
                  })}
                </div>

                {/* Authority Distribution */}
                <div className="bg-white rounded-2xl border-2 border-slate-200 p-6">
                  <h3 className="font-bold text-slate-800 mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</h3>
                  <div className="grid grid-cols-5 gap-4">
                    {AUTHORITIES.slice(0, 5).map(auth => {
                      const authBreaches = filteredBreaches.filter(b => b.authorityId === auth.id && b.status !== 'Closed');
                      const criticalCount = authBreaches.filter(b => b.severity === 'Critical').length;
                      const highCount = authBreaches.filter(b => b.severity === 'High').length;

                      return (
                        <div key={auth.id} className={`rounded-xl p-4 border-2 ${authBreaches.length > 0 ? 'border-red-200 bg-red-50' : 'border-slate-200 bg-slate-50'}`}>
                          <div className="text-center mb-3">
                            <span className="text-2xl font-bold text-slate-800">{authBreaches.length}</span>
                            <p className="text-sm text-slate-600">{auth.code}</p>
                          </div>
                          <div className="flex justify-center gap-2">
                            {criticalCount > 0 && (
                              <span className="px-2 py-0.5 bg-red-500 text-white rounded text-xs font-bold">{criticalCount} Ø­Ø±Ø¬</span>
                            )}
                            {highCount > 0 && (
                              <span className="px-2 py-0.5 bg-orange-500 text-white rounded text-xs font-bold">{highCount} Ø¹Ø§Ù„ÙŠ</span>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}

            {/* Empty State */}
            {filteredBreaches.length === 0 && (
              <div className="text-center py-20 bg-slate-50 rounded-2xl">
                <AlertTriangle className="w-16 h-16 text-slate-300 mx-auto mb-4" />
                <h3 className="text-xl font-bold text-slate-600 mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø®Ø§Ù„ÙØ§Øª</h3>
                <p className="text-slate-500 mb-4">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø®Ø§Ù„ÙØ§Øª ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                <button onClick={handleCreateBreach}
                  className="px-6 py-3 bg-red-500 text-white rounded-xl font-bold">
                  ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
                </button>
              </div>
            )}
          </div>
        )}

        {activeTab === 'workspace' && selectedBreach && (
          <div className="p-6">
            {/* Breach Header */}
            <div className={`rounded-2xl p-6 mb-6 border-2 ${SEVERITY_CONFIG[selectedBreach.severity]?.border} ${SEVERITY_CONFIG[selectedBreach.severity]?.light}`}>
              <div className="flex items-start justify-between">
                <div>
                  <div className="flex items-center gap-3 mb-2">
                    <span className="font-mono text-lg font-bold text-red-600 bg-red-100 px-3 py-1 rounded-lg">{selectedBreach.code}</span>
                    <span className={`px-3 py-1 rounded-lg text-sm font-bold ${SEVERITY_CONFIG[selectedBreach.severity]?.light} ${SEVERITY_CONFIG[selectedBreach.severity]?.text}`}>
                      {SEVERITY_CONFIG[selectedBreach.severity]?.label}
                    </span>
                    <span className={`px-3 py-1 rounded-lg text-sm font-bold ${STATUS_CONFIG[selectedBreach.status]?.bg} ${STATUS_CONFIG[selectedBreach.status]?.text}`}>
                      {STATUS_CONFIG[selectedBreach.status]?.label}
                    </span>
                    {selectedBreach.escalationLevel > 0 && (
                      <span className="flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded-lg text-sm font-bold">
                        <TrendingUp className="w-4 h-4" />ØªØµØ¹ÙŠØ¯ L{selectedBreach.escalationLevel}
                      </span>
                    )}
                  </div>
                  <h2 className="text-xl font-bold text-slate-800">{selectedBreach.title}</h2>
                  <div className="flex items-center gap-4 mt-2 text-sm text-slate-600">
                    <span>Ø§Ù„Ø¬Ù‡Ø©: <strong>{getAuthority(selectedBreach.authorityId)?.code}</strong></span>
                    <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: <strong>{getUser(selectedBreach.ownerId)?.name}</strong></span>
                    <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <strong className={getDaysUntilDue(selectedBreach.dueDate) < 0 ? 'text-red-600' : ''}>{selectedBreach.dueDate}</strong></span>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  {selectedBreach.status === 'Open' && (
                    <button onClick={() => handleUpdateStatus(selectedBreach, 'UnderReview')}
                      className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                      <Eye className="w-5 h-5" />Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                    </button>
                  )}
                  {selectedBreach.status === 'UnderReview' && (
                    <button onClick={() => handleUpdateStatus(selectedBreach, 'Remediation')}
                      className="flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-xl font-bold">
                      <Zap className="w-5 h-5" />Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                    </button>
                  )}
                  {selectedBreach.status === 'Remediation' && (
                    <>
                      <button onClick={handleRequestException}
                        className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-xl font-bold">
                        <Shield className="w-5 h-5" />Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡
                      </button>
                      <button onClick={() => handleUpdateStatus(selectedBreach, 'Closed')}
                        disabled={!selectedBreach.actions?.every(a => a.status === 'Done') || !selectedBreach.closureEvidence?.length}
                        className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold disabled:opacity-50 disabled:cursor-not-allowed">
                        <CheckCircle2 className="w-5 h-5" />Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
                      </button>
                    </>
                  )}
                  {selectedBreach.escalationLevel < 3 && selectedBreach.status !== 'Closed' && (
                    <button onClick={() => handleEscalate(selectedBreach)}
                      className="flex items-center gap-2 px-4 py-2 border-2 border-red-500 text-red-500 rounded-xl font-bold hover:bg-red-50">
                      <TrendingUp className="w-5 h-5" />ØªØµØ¹ÙŠØ¯
                    </button>
                  )}
                  <button onClick={() => setSelectedBreach(null)} className="p-2 hover:bg-slate-200 rounded-xl">
                    <X className="w-5 h-5 text-slate-500" />
                  </button>
                </div>
              </div>

              {/* Regulatory Exposure */}
              {selectedBreach.regulatoryExposure?.length > 0 && (
                <div className="flex items-center gap-2 mt-4 pt-4 border-t border-slate-200">
                  <span className="text-sm text-slate-600">Ø§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ:</span>
                  {selectedBreach.regulatoryExposure.map(exp => {
                    const cfg = EXPOSURE_CONFIG[exp];
                    return (
                      <span key={exp} className={`flex items-center gap-1 px-2 py-1 bg-${cfg?.color}-100 text-${cfg?.color}-700 rounded text-xs font-bold`}>
                        <cfg.icon className="w-3 h-3" />{cfg?.label}
                      </span>
                    );
                  })}
                </div>
              )}
            </div>

            {/* Breach Tabs */}
            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <div className="flex border-b border-slate-200 overflow-x-auto">
                {breachTabs.map(tab => (
                  <button key={tab.id} onClick={() => setBreachTab(tab.id)}
                    className={`flex items-center gap-2 px-5 py-3 font-bold transition-all border-b-2 whitespace-nowrap ${breachTab === tab.id ? 'text-red-600 border-red-500 bg-red-50' : 'text-slate-500 border-transparent hover:bg-slate-50'
                      }`}>
                    <tab.icon className="w-4 h-4" />{tab.label}
                  </button>
                ))}
              </div>

              <div className="p-6">
                {/* Summary Tab */}
                {breachTab === 'summary' && (
                  <div className="grid grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ</h4>
                        <p className="text-slate-600">{selectedBreach.description}</p>
                      </div>
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Golden Thread</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex items-center gap-2">
                            <ClipboardCheck className="w-4 h-4 text-emerald-500" />
                            <span>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…: <strong>{getObligation(selectedBreach.obligationId)?.code}</strong></span>
                          </div>
                          {selectedBreach.controlId && (
                            <div className="flex items-center gap-2">
                              <Shield className="w-4 h-4 text-blue-500" />
                              <span>Ø§Ù„Ø¶Ø§Ø¨Ø·: <strong>{getControl(selectedBreach.controlId)?.code}</strong></span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø§Ù„Ùƒ:</span><span className="font-bold">{getUser(selectedBreach.ownerId)?.name}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹:</span><span className="font-bold">{getUser(selectedBreach.reviewerId)?.name}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯:</span><span className="font-bold">{getUser(selectedBreach.approverId)?.name}</span></div>
                        </div>
                      </div>
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªØ´Ø§Ù:</span><span className="font-bold">{selectedBreach.breachDate}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚:</span><span className="font-bold">{selectedBreach.dueDate}</span></div>
                          {selectedBreach.closedAt && (
                            <div className="flex justify-between"><span className="text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØºÙ„Ø§Ù‚:</span><span className="font-bold text-emerald-600">{selectedBreach.closedAt}</span></div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Source Tab */}
                {breachTab === 'source' && (
                  <div className="space-y-4">
                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-200">
                      <h4 className="font-bold text-blue-800 mb-3 flex items-center gap-2">
                        <Link2 className="w-5 h-5" />Ù…ØµØ¯Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
                      </h4>
                      <div className="flex items-center gap-4">
                        <div className={`w-12 h-12 rounded-xl bg-${SOURCE_TYPE_CONFIG[selectedBreach.sourceType]?.color}-500 flex items-center justify-center text-white`}>
                          {React.createElement(SOURCE_TYPE_CONFIG[selectedBreach.sourceType]?.icon || Clock, { className: "w-6 h-6" })}
                        </div>
                        <div>
                          <p className="font-bold text-slate-800">{SOURCE_TYPE_CONFIG[selectedBreach.sourceType]?.label}</p>
                          {selectedBreach.sourceRefId && (
                            <p className="text-sm text-slate-500">Ø§Ù„Ù…Ø±Ø¬Ø¹: #{selectedBreach.sourceRefId}</p>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Actions Tab */}
                {breachTab === 'actions' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800">Ø®Ø·Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ© (CAPA)</h4>
                      <button onClick={handleAddAction}
                        className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold">
                        <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡
                      </button>
                    </div>
                    {selectedBreach.actions?.length > 0 ? (
                      <div className="space-y-3">
                        {selectedBreach.actions.map(action => {
                          const typeCfg = ACTION_TYPE_CONFIG[action.type];
                          const TypeIcon = typeCfg?.icon || Zap;
                          return (
                            <div key={action.id} className={`rounded-xl border-2 p-4 ${action.status === 'Done' ? 'bg-emerald-50 border-emerald-200' : 'bg-white border-slate-200'}`}>
                              <div className="flex items-start justify-between">
                                <div className="flex items-start gap-3">
                                  <div className={`w-10 h-10 rounded-xl bg-${typeCfg?.color}-100 flex items-center justify-center`}>
                                    <TypeIcon className={`w-5 h-5 text-${typeCfg?.color}-600`} />
                                  </div>
                                  <div>
                                    <div className="flex items-center gap-2 mb-1">
                                      <span className={`px-2 py-0.5 bg-${typeCfg?.color}-100 text-${typeCfg?.color}-700 rounded text-xs font-bold`}>{typeCfg?.label}</span>
                                      <span className={`px-2 py-0.5 rounded text-xs font-bold ${action.status === 'Done' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
                                        {action.status === 'Done' ? 'Ù…ÙƒØªÙ…Ù„' : 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°'}
                                      </span>
                                    </div>
                                    <p className="text-slate-800">{action.description}</p>
                                    <div className="flex items-center gap-4 mt-2 text-xs text-slate-500">
                                      <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: {getUser(action.responsibleId)?.name}</span>
                                      <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: {action.dueDate}</span>
                                    </div>
                                  </div>
                                </div>
                                {action.status !== 'Done' && (
                                  <button onClick={() => handleUpdateActionStatus(action.id, 'Done')}
                                    className="flex items-center gap-1 px-3 py-1.5 bg-emerald-500 text-white rounded-lg text-sm font-bold">
                                    <Check className="w-4 h-4" />Ø¥ÙƒÙ…Ø§Ù„
                                  </button>
                                )}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <Zap className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªØµØ­ÙŠØ­ÙŠØ©</p>
                      </div>
                    )}
                  </div>
                )}

                {/* RCA Tab */}
                {breachTab === 'rca' && (
                  <div className="space-y-4">
                    {selectedBreach.rca ? (
                      <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-5 border border-indigo-200">
                        <h4 className="font-bold text-indigo-800 mb-4 flex items-center gap-2">
                          <Search className="w-5 h-5" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ (RCA)
                        </h4>
                        <div className="grid grid-cols-2 gap-4">
                          <div className="bg-white rounded-xl p-4 border border-slate-200">
                            <p className="text-xs text-slate-500 mb-1">ÙØ¦Ø© Ø§Ù„Ø³Ø¨Ø¨</p>
                            <div className="flex items-center gap-2">
                              {React.createElement(RCA_CATEGORY_CONFIG[selectedBreach.rca.category]?.icon || Users, { className: `w-5 h-5 text-${RCA_CATEGORY_CONFIG[selectedBreach.rca.category]?.color}-500` })}
                              <span className="font-bold text-slate-800">{RCA_CATEGORY_CONFIG[selectedBreach.rca.category]?.label}</span>
                            </div>
                          </div>
                          <div className="bg-white rounded-xl p-4 border border-slate-200">
                            <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ</p>
                            <p className="font-bold text-slate-800">{selectedBreach.rca.rootCause}</p>
                          </div>
                          <div className="col-span-2 bg-white rounded-xl p-4 border border-slate-200">
                            <p className="text-xs text-slate-500 mb-1">ÙØ¬ÙˆØ© Ø§Ù„Ø¶Ø§Ø¨Ø· Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©</p>
                            <p className="text-slate-700">{selectedBreach.rca.linkedControlGap}</p>
                          </div>
                        </div>
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <Search className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ</p>
                        <button className="mt-4 px-4 py-2 bg-indigo-500 text-white rounded-xl font-bold">
                          Ø¥Ø¶Ø§ÙØ© RCA
                        </button>
                      </div>
                    )}
                  </div>
                )}

                {/* Evidence Tab */}
                {breachTab === 'evidence' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800">Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚</h4>
                      <button className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                        <Upload className="w-5 h-5" />Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„
                      </button>
                    </div>
                    {selectedBreach.closureEvidence?.length > 0 ? (
                      <div className="space-y-3">
                        {selectedBreach.closureEvidence.map(ev => (
                          <div key={ev.id} className="flex items-center gap-4 p-4 bg-emerald-50 rounded-xl border border-emerald-200">
                            <CheckCircle2 className="w-6 h-6 text-emerald-500" />
                            <div>
                              <p className="font-bold text-slate-800">Ø¯Ù„ÙŠÙ„ #{ev.evidenceId}</p>
                              <p className="text-sm text-slate-500">Ù‚Ø¨ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø©: {getUser(ev.acceptedBy)?.name} ÙÙŠ {ev.acceptedAt}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <FileCheck className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯Ù„Ø© Ø¥ØºÙ„Ø§Ù‚</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Escalation Tab */}
                {breachTab === 'escalation' && (
                  <div className="space-y-4">
                    <h4 className="font-bold text-slate-800 mb-4">Ø³Ø¬Ù„ Ø§Ù„ØªØµØ¹ÙŠØ¯</h4>
                    {selectedBreach.escalationHistory?.length > 0 ? (
                      <div className="relative">
                        <div className="absolute right-5 top-0 bottom-0 w-0.5 bg-slate-200"></div>
                        <div className="space-y-4">
                          {selectedBreach.escalationHistory.map((esc, idx) => (
                            <div key={idx} className="relative flex gap-4 pr-10">
                              <div className="absolute right-3 w-4 h-4 rounded-full bg-red-500 border-4 border-white"></div>
                              <div className="flex-1 bg-red-50 rounded-xl p-4 border border-red-200">
                                <div className="flex items-center justify-between mb-2">
                                  <span className="font-bold text-red-700">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ {esc.level}</span>
                                  <span className="text-sm text-slate-500">{esc.date}</span>
                                </div>
                                <p className="text-slate-600">{esc.reason}</p>
                                <p className="text-xs text-slate-500 mt-2">
                                  ØªÙ… Ø¥Ø®Ø·Ø§Ø±: {esc.notifiedUsers?.map(id => getUser(id)?.name).join(', ')}
                                </p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <TrendingUp className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ ØªØµØ¹ÙŠØ¯</p>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: EXCEPTIONS
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'exceptions' && (
          <div className="p-6">
            <h3 className="font-bold text-slate-800 mb-6">Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h3>
            <div className="grid grid-cols-2 gap-4">
              {breaches.filter(b => b.status === 'AcceptedException' && b.exceptions?.length > 0).map(breach => {
                const exception = breach.exceptions[0];
                const daysUntilExpiry = getDaysUntilDue(exception.expiryDate);
                return (
                  <div key={breach.id} className={`rounded-xl border-2 p-5 ${daysUntilExpiry !== null && daysUntilExpiry <= 7 ? 'border-amber-300 bg-amber-50' : 'border-purple-200 bg-purple-50'}`}>
                    <div className="flex items-start justify-between mb-3">
                      <div>
                        <span className="font-mono text-sm font-bold text-purple-600">{breach.code}</span>
                        <h4 className="font-bold text-slate-800 mt-1">{breach.title}</h4>
                      </div>
                      <span className={`px-2 py-1 rounded text-xs font-bold ${exception.status === 'Active' ? 'bg-emerald-100 text-emerald-700' : 'bg-red-100 text-red-700'}`}>
                        {exception.status === 'Active' ? 'Ù†Ø´Ø·' : 'Ù…Ù†ØªÙ‡ÙŠ'}
                      </span>
                    </div>
                    <p className="text-sm text-slate-600 mb-3">{exception.reason}</p>
                    <div className="flex items-center justify-between text-xs text-slate-500">
                      <span>Ø§Ø¹ØªÙ…Ø§Ø¯: {getUser(exception.approvedBy)?.name}</span>
                      <span className={daysUntilExpiry !== null && daysUntilExpiry <= 7 ? 'text-amber-600 font-bold' : ''}>
                        Ø§Ù†ØªÙ‡Ø§Ø¡: {exception.expiryDate} {daysUntilExpiry !== null && daysUntilExpiry <= 7 && `(${daysUntilExpiry} ÙŠÙˆÙ…)`}
                      </span>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}
      </div>


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          BREACH WIZARD MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'breach' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden">
            {/* Header */}
            <div className="bg-gradient-to-l from-red-500 via-orange-500 to-amber-500 px-8 py-6 text-white">
              <div className="flex items-center justify-between mb-6">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <AlertTriangle className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">{modalMode === 'create' ? 'Ù…Ø¹Ø§Ù„Ø¬ ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ©' : 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©'}</h2>
                    <p className="text-orange-200">{formData.code}</p>
                  </div>
                </div>
                <button onClick={() => { setShowModal(false); setWizardStep(0); }} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>

              {/* Wizard Steps */}
              <div className="flex items-center justify-between">
                {[
                  { step: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText },
                  { step: 1, label: 'Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„Ù…ØµØ¯Ø±', icon: Link2 },
                  { step: 2, label: 'Ø§Ù„ØªØµÙ†ÙŠÙ ÙˆØ§Ù„Ø®Ø·ÙˆØ±Ø©', icon: AlertTriangle },
                  { step: 3, label: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†', icon: Users },
                  { step: 4, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: CheckCircle2 },
                ].map((s, idx) => (
                  <div key={s.step} className="flex items-center">
                    <button onClick={() => setWizardStep(s.step)}
                      className={`flex items-center gap-2 px-3 py-2 rounded-xl transition-all ${wizardStep === s.step ? 'bg-white text-red-600 font-bold shadow-lg' :
                          wizardStep > s.step ? 'bg-white/30 text-white' : 'bg-white/10 text-white/60'
                        }`}>
                      <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${wizardStep === s.step ? 'bg-red-100' : wizardStep > s.step ? 'bg-emerald-400 text-white' : 'bg-white/10'
                        }`}>
                        {wizardStep > s.step ? <Check className="w-5 h-5" /> : <s.icon className="w-4 h-4" />}
                      </div>
                      <span className="hidden xl:inline text-sm">{s.label}</span>
                    </button>
                    {idx < 4 && <ChevronLeft className="w-4 h-4 mx-1 text-white/40" />}
                  </div>
                ))}
              </div>
            </div>

            {/* Content */}
            <div className="p-8 max-h-[55vh] overflow-y-auto">
              {/* Step 0: Basic Info */}
              {wizardStep === 0 && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border border-red-200">
                    <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                      <FileText className="w-5 h-5" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    </h3>
                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© *</label>
                        <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl text-lg focus:border-red-400 focus:outline-none bg-white"
                          placeholder="Ù…Ø«Ø§Ù„: ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ" />
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ *</label>
                        <textarea rows={3} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-red-400 focus:outline-none bg-white resize-none"
                          placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ø®Ø§Ù„ÙØ©..." />
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªØ´Ø§Ù *</label>
                          <input type="date" value={formData.breachDate || ''} onChange={(e) => setFormData({ ...formData, breachDate: e.target.value })}
                            className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-red-400 focus:outline-none bg-white" />
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù *</label>
                          <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                            className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-red-400 focus:outline-none bg-white" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Step 1: Linkage & Source */}
              {wizardStep === 1 && (
                <div className="space-y-6">
                  <div className="grid grid-cols-2 gap-6">
                    {/* Authority & Obligation */}
                    <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                      <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                        <Building2 className="w-5 h-5" />Ø§Ù„Ø¬Ù‡Ø© ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù…
                      </h3>
                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© *</label>
                          <select value={formData.authorityId || ''} onChange={(e) => setFormData({ ...formData, authorityId: parseInt(e.target.value) || '' })}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø©</option>
                            {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code} - {a.nameAr}</option>)}
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ù…Ø±ØªØ¨Ø· *</label>
                          <select value={formData.obligationId || ''} onChange={(e) => setFormData({ ...formData, obligationId: parseInt(e.target.value) || '' })}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</option>
                            {INITIAL_OBLIGATIONS.filter(o => !formData.authorityId || o.authorityId === formData.authorityId).map(o =>
                              <option key={o.id} value={o.id}>{o.code} - {o.title}</option>
                            )}
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¶Ø§Ø¨Ø· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                          <select value={formData.controlId || ''} onChange={(e) => setFormData({ ...formData, controlId: parseInt(e.target.value) || '' })}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                            <option value="">Ø¨Ø¯ÙˆÙ† Ø¶Ø§Ø¨Ø· Ù…Ø­Ø¯Ø¯</option>
                            {CONTROLS.map(c => <option key={c.id} value={c.id}>{c.code} - {c.title}</option>)}
                          </select>
                        </div>
                      </div>
                    </div>

                    {/* Source */}
                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-200">
                      <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                        <Link2 className="w-5 h-5" />Ù…ØµØ¯Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
                      </h3>
                      <div className="space-y-3">
                        {Object.entries(SOURCE_TYPE_CONFIG).map(([key, cfg]) => {
                          const isSelected = formData.sourceType === key;
                          const SourceIcon = cfg.icon;
                          return (
                            <button key={key} onClick={() => setFormData({ ...formData, sourceType: key })}
                              className={`w-full flex items-center gap-4 p-4 rounded-xl border-2 transition-all text-right ${isSelected ? `border-${cfg.color}-500 bg-${cfg.color}-100` : 'border-slate-200 hover:border-slate-400 bg-white'
                                }`}>
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${isSelected ? `bg-${cfg.color}-500 text-white` : 'bg-slate-100 text-slate-600'}`}>
                                <SourceIcon className="w-5 h-5" />
                              </div>
                              <span className="font-bold text-slate-800">{cfg.label}</span>
                              {isSelected && <CheckCircle2 className="w-5 h-5 text-emerald-500 mr-auto" />}
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Step 2: Classification & Severity */}
              {wizardStep === 2 && (
                <div className="space-y-6">
                  {/* Severity */}
                  <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border border-red-200">
                    <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                      <AlertTriangle className="w-5 h-5" />Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø© *
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      {Object.entries(SEVERITY_CONFIG).map(([key, cfg]) => {
                        const isSelected = formData.severity === key;
                        const SevIcon = cfg.icon;
                        return (
                          <button key={key} onClick={() => setFormData({ ...formData, severity: key })}
                            className={`p-5 rounded-2xl border-2 transition-all text-center ${isSelected ? `${cfg.border} ${cfg.light} shadow-lg` : 'border-slate-200 bg-white hover:border-slate-400'
                              }`}>
                            <div className={`w-12 h-12 rounded-xl mx-auto mb-2 flex items-center justify-center ${isSelected ? cfg.bg + ' text-white' : 'bg-slate-100 text-slate-600'}`}>
                              <SevIcon className="w-6 h-6" />
                            </div>
                            <p className="font-bold text-slate-800">{cfg.label}</p>
                          </button>
                        );
                      })}
                    </div>
                  </div>

                  {/* Regulatory Exposure */}
                  <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-2xl p-6 border border-purple-200">
                    <h3 className="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                      <Activity className="w-5 h-5" />Ø§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ *
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      {Object.entries(EXPOSURE_CONFIG).map(([key, cfg]) => {
                        const isSelected = formData.regulatoryExposure?.includes(key);
                        const ExpIcon = cfg.icon;
                        return (
                          <button key={key} onClick={() => {
                            const current = formData.regulatoryExposure || [];
                            setFormData({
                              ...formData,
                              regulatoryExposure: isSelected ? current.filter(e => e !== key) : [...current, key]
                            });
                          }}
                            className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? `border-${cfg.color}-500 bg-${cfg.color}-100` : 'border-slate-200 bg-white hover:border-slate-400'
                              }`}>
                            <ExpIcon className={`w-8 h-8 mx-auto mb-2 ${isSelected ? `text-${cfg.color}-600` : 'text-slate-400'}`} />
                            <p className="font-bold text-slate-800 text-sm">{cfg.label}</p>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                </div>
              )}

              {/* Step 3: Owners */}
              {wizardStep === 3 && (
                <div className="space-y-6">
                  <div className="grid grid-cols-3 gap-6">
                    {/* Owner */}
                    <div className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl p-6 border border-blue-200">
                      <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                        <User className="w-5 h-5" />Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ *
                      </h3>
                      <div className="space-y-2">
                        {USERS.map(user => {
                          const isSelected = formData.ownerId === user.id;
                          return (
                            <button key={user.id} onClick={() => setFormData({ ...formData, ownerId: user.id })}
                              className={`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${isSelected ? 'border-blue-500 bg-blue-100' : 'border-slate-200 hover:border-blue-300 bg-white'
                                }`}>
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center font-bold ${isSelected ? 'bg-blue-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                                {user.name.charAt(0)}
                              </div>
                              <div className="text-right">
                                <p className="font-bold text-slate-800 text-sm">{user.name}</p>
                                <p className="text-xs text-slate-500">{user.role}</p>
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    {/* Reviewer */}
                    <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200">
                      <h3 className="text-lg font-bold text-amber-800 mb-4 flex items-center gap-2">
                        <Eye className="w-5 h-5" />Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ *
                      </h3>
                      <div className="space-y-2">
                        {USERS.map(user => {
                          const isSelected = formData.reviewerId === user.id;
                          return (
                            <button key={user.id} onClick={() => setFormData({ ...formData, reviewerId: user.id })}
                              className={`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${isSelected ? 'border-amber-500 bg-amber-100' : 'border-slate-200 hover:border-amber-300 bg-white'
                                }`}>
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center font-bold ${isSelected ? 'bg-amber-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                                {user.name.charAt(0)}
                              </div>
                              <div className="text-right">
                                <p className="font-bold text-slate-800 text-sm">{user.name}</p>
                                <p className="text-xs text-slate-500">{user.role}</p>
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    {/* Approver */}
                    <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                      <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                        <CheckCircle2 className="w-5 h-5" />Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ *
                      </h3>
                      <div className="space-y-2">
                        {USERS.map(user => {
                          const isSelected = formData.approverId === user.id;
                          return (
                            <button key={user.id} onClick={() => setFormData({ ...formData, approverId: user.id })}
                              className={`w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all ${isSelected ? 'border-emerald-500 bg-emerald-100' : 'border-slate-200 hover:border-emerald-300 bg-white'
                                }`}>
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center font-bold ${isSelected ? 'bg-emerald-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                                {user.name.charAt(0)}
                              </div>
                              <div className="text-right">
                                <p className="font-bold text-slate-800 text-sm">{user.name}</p>
                                <p className="text-xs text-slate-500">{user.role}</p>
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Step 4: Review */}
              {wizardStep === 4 && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border border-red-200">
                    <h3 className="text-lg font-bold text-red-800 mb-6 flex items-center gap-2">
                      <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
                    </h3>
                    <div className="grid grid-cols-2 gap-6">
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯:</span><span className="font-bold">{formData.code}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span><span className="font-bold text-left max-w-[200px] truncate">{formData.title || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø§ÙƒØªØ´Ø§Ù:</span><span className="font-bold">{formData.breachDate}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚:</span><span className="font-bold">{formData.dueDate}</span></div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ø±Ø¨Ø·</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¬Ù‡Ø©:</span><span className="font-bold">{getAuthority(formData.authorityId)?.code || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…:</span><span className="font-bold">{getObligation(formData.obligationId)?.code || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…ØµØ¯Ø±:</span><span className="font-bold">{SOURCE_TYPE_CONFIG[formData.sourceType]?.label}</span></div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„ØªØµÙ†ÙŠÙ</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between">
                            <span className="text-slate-500">Ø§Ù„Ø®Ø·ÙˆØ±Ø©:</span>
                            <span className={`font-bold px-2 py-0.5 rounded ${SEVERITY_CONFIG[formData.severity]?.light} ${SEVERITY_CONFIG[formData.severity]?.text}`}>
                              {SEVERITY_CONFIG[formData.severity]?.label}
                            </span>
                          </div>
                          <div><span className="text-slate-500">Ø§Ù„ØªØ¹Ø±Ø¶:</span>
                            <div className="flex flex-wrap gap-1 mt-1">
                              {formData.regulatoryExposure?.map(exp => (
                                <span key={exp} className={`px-2 py-0.5 bg-${EXPOSURE_CONFIG[exp]?.color}-100 text-${EXPOSURE_CONFIG[exp]?.color}-700 rounded text-xs font-bold`}>
                                  {EXPOSURE_CONFIG[exp]?.label}
                                </span>
                              ))}
                            </div>
                          </div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</span><span className="font-bold">{getUser(formData.ownerId)?.name || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹:</span><span className="font-bold">{getUser(formData.reviewerId)?.name || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯:</span><span className="font-bold">{getUser(formData.approverId)?.name || '-'}</span></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Footer */}
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex items-center justify-between">
              <button onClick={() => wizardStep > 0 ? setWizardStep(wizardStep - 1) : setShowModal(false)}
                className="flex items-center gap-2 px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                <ChevronRight className="w-5 h-5" />{wizardStep === 0 ? 'Ø¥Ù„ØºØ§Ø¡' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
              </button>
              <div className="flex items-center gap-2">
                {[0, 1, 2, 3, 4].map(step => (
                  <div key={step} className={`w-3 h-3 rounded-full transition-all ${wizardStep === step ? 'bg-red-500 w-8' : wizardStep > step ? 'bg-emerald-500' : 'bg-slate-300'}`} />
                ))}
              </div>
              {wizardStep < 4 ? (
                <button onClick={() => setWizardStep(wizardStep + 1)}
                  className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-red-500 to-orange-500 text-white rounded-xl font-bold shadow-lg">
                  Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                </button>
              ) : (
                <button onClick={handleSave}
                  disabled={!formData.title || !formData.obligationId || !formData.ownerId}
                  className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                  <CheckCircle2 className="w-5 h-5" />ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©
                </button>
              )}
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ACTION MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'action' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-emerald-500 to-teal-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Zap className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡ ØªØµØ­ÙŠØ­ÙŠ</h2>
                    <p className="text-emerald-200">CAPA Action</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ *</label>
                <div className="grid grid-cols-3 gap-3">
                  {Object.entries(ACTION_TYPE_CONFIG).map(([key, cfg]) => {
                    const isSelected = formData.type === key;
                    const TypeIcon = cfg.icon;
                    return (
                      <button key={key} onClick={() => setFormData({ ...formData, type: key })}
                        className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? `border-${cfg.color}-500 bg-${cfg.color}-100` : 'border-slate-200 bg-white hover:border-slate-400'
                          }`}>
                        <TypeIcon className={`w-6 h-6 mx-auto mb-2 ${isSelected ? `text-${cfg.color}-600` : 'text-slate-400'}`} />
                        <p className="font-bold text-slate-800 text-sm">{cfg.label}</p>
                      </button>
                    );
                  })}
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØµÙ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ *</label>
                <textarea rows={3} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                  className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl resize-none" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨..." />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ *</label>
                  <select value={formData.responsibleId || ''} onChange={(e) => setFormData({ ...formData, responsibleId: parseInt(e.target.value) || '' })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                    {USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</label>
                  <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" />
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-8 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} className="flex items-center gap-2 px-8 py-3 bg-emerald-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          EXCEPTION MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'exception' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-purple-500 to-indigo-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Shield className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡</h2>
                    <p className="text-purple-200">Regulatory Exception</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div className="bg-amber-50 rounded-xl p-4 border border-amber-200">
                <p className="text-amber-800 text-sm">
                  <AlertTriangle className="w-4 h-4 inline ml-1" />
                  Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ ÙŠØ¹Ù†ÙŠ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ù…Ø¤Ù‚ØªØ§Ù‹. Ø³ÙŠØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡.
                </p>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ *</label>
                <textarea rows={4} value={formData.reason || ''} onChange={(e) => setFormData({ ...formData, reason: e.target.value })}
                  className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl resize-none" placeholder="Ø§Ø´Ø±Ø­ Ø³Ø¨Ø¨ Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡..." />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ *</label>
                <input type="date" value={formData.expiryDate || ''} onChange={(e) => setFormData({ ...formData, expiryDate: e.target.value })}
                  className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl" />
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-8 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} className="flex items-center gap-2 px-8 py-3 bg-purple-500 text-white rounded-xl font-bold">
                <Shield className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Delete Confirmation */}
      {showDeleteConfirm && deleteTarget && (
        <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="bg-gradient-to-l from-red-500 to-rose-600 px-6 py-5 text-white">
              <div className="flex items-center gap-4">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center"><Trash2 className="w-6 h-6" /></div>
                <h2 className="text-xl font-bold">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h2>
              </div>
            </div>
            <div className="p-6">
              <p className="text-slate-600">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©:</p>
              <p className="font-bold text-slate-800 mt-2">{deleteTarget.code} - {deleteTarget.title}</p>
            </div>
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-slate-50 flex justify-between">
              <button onClick={() => setShowDeleteConfirm(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleDelete} className="flex items-center gap-2 px-6 py-3 bg-red-500 text-white rounded-xl font-bold">
                <Trash2 className="w-5 h-5" />Ø­Ø°Ù
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 4.8: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ© ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
// Regulatory Change Management (RCM) - World-Class Edition
// Features: Auto Impact Engine, Change Items, Action Plans, Evidence Closure
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const RegulatoryChanges = () => {
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // STATE MANAGEMENT
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [activeTab, setActiveTab] = useState('command');
  const [selectedChange, setSelectedChange] = useState(null);
  const [changeTab, setChangeTab] = useState('summary');
  const [showModal, setShowModal] = useState(false);
  const [modalMode, setModalMode] = useState('create');
  const [modalType, setModalType] = useState('change'); // change | action | item
  const [formData, setFormData] = useState(null);
  const [wizardStep, setWizardStep] = useState(0);
  const [notification, setNotification] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterType, setFilterType] = useState('');
  const [filterAuthority, setFilterAuthority] = useState('');
  const [viewMode, setViewMode] = useState('table');
  const [showImpactModal, setShowImpactModal] = useState(false);

  const CURRENT_USER = { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // REGULATORY CHANGES DATA
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const [changes, setChanges] = useState([
    {
      id: 1, code: 'CHG-REG-2025-001', authorityId: 1, frameworkId: 1,
      changeType: 'Update', title: 'ØªØ­Ø¯ÙŠØ« Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
      description: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø§Ø¯Ø© 15 Ù…Ù† Ù„Ø§Ø¦Ø­Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø¥Ø¨Ù„Ø§Øº Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 48 Ø³Ø§Ø¹Ø©',
      issueDate: '2025-01-10', effectiveDate: '2025-03-01',
      sourceLink: 'https://sama.gov.sa/ar-sa/Laws/Documents/AML-Update-2025.pdf',
      severity: 'High', status: 'Implementing',
      createdBy: 1, createdAt: '2025-01-12',
      items: [
        { id: 1, requirementId: 'REQ-AML-15', impactType: 'Modified', oldText: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø®Ù„Ø§Ù„ 48 Ø³Ø§Ø¹Ø©', newText: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©' },
        { id: 2, requirementId: 'REQ-AML-15.1', impactType: 'Added', oldText: null, newText: 'ÙŠØ´Ù…Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©' },
      ],
      impact: {
        obligationsCount: 3, controlsCount: 2, risksCount: 1, policiesCount: 1, tasksCount: 5,
        retestingRequired: true, evidenceRefreshRequired: true, overallLevel: 'High',
        assessorId: 1, assessedAt: '2025-01-15',
        affectedObligations: [1, 2, 3], affectedControls: [1, 2], affectedPolicies: [1]
      },
      actions: [
        { id: 1, type: 'UpdatePolicy', description: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª', ownerId: 2, dueDate: '2025-02-01', status: 'Done' },
        { id: 2, type: 'UpdateControl', description: 'ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©', ownerId: 3, dueDate: '2025-02-10', status: 'Done' },
        { id: 3, type: 'Training', description: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª', ownerId: 4, dueDate: '2025-02-20', status: 'InProgress' },
        { id: 4, type: 'Retest', description: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©', ownerId: 1, dueDate: '2025-02-28', status: 'Open' },
      ],
      closureEvidence: [],
    },
    {
      id: 2, code: 'CHG-REG-2025-002', authorityId: 3, frameworkId: 5,
      changeType: 'New', title: 'Ø¥Ø·Ø§Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù„Ø«',
      description: 'Ø¥ØµØ¯Ø§Ø± Ø¥Ø·Ø§Ø± Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù‡ÙŠØ¦Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙŠØªØ¶Ù…Ù† Ù…ØªØ·Ù„Ø¨Ø§Øª Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† ÙˆØ§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©',
      issueDate: '2025-01-20', effectiveDate: '2025-06-01',
      sourceLink: 'https://nca.gov.sa/frameworks/third-party-risk-2025.pdf',
      severity: 'Critical', status: 'Assessed',
      createdBy: 1, createdAt: '2025-01-22',
      items: [
        { id: 1, requirementId: 'REQ-TPR-01', impactType: 'Added', oldText: null, newText: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† Ø³Ù†ÙˆÙŠØ§Ù‹' },
        { id: 2, requirementId: 'REQ-TPR-02', impactType: 'Added', oldText: null, newText: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©' },
        { id: 3, requirementId: 'REQ-TPR-03', impactType: 'Added', oldText: null, newText: 'Ø®Ø·Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ù„Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† Ø§Ù„Ø­Ø±Ø¬ÙŠÙ†' },
      ],
      impact: {
        obligationsCount: 8, controlsCount: 5, risksCount: 3, policiesCount: 2, tasksCount: 12,
        retestingRequired: true, evidenceRefreshRequired: true, overallLevel: 'Critical',
        assessorId: 1, assessedAt: '2025-01-25',
        affectedObligations: [4, 5, 6, 7, 8], affectedControls: [3, 4, 5, 6, 7], affectedPolicies: [2, 3]
      },
      actions: [],
      closureEvidence: [],
    },
    {
      id: 3, code: 'CHG-REG-2025-003', authorityId: 4, frameworkId: 7,
      changeType: 'Update', title: 'ØªØ¹Ø¯ÙŠÙ„ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø®Ø·Ø§Ø± Ø¨Ø®Ø±Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
      description: 'ØªÙ… ØªÙ‚Ù„ÙŠØµ Ù…Ù‡Ù„Ø© Ø§Ù„Ø¥Ø®Ø·Ø§Ø± Ø¨Ø­ÙˆØ§Ø¯Ø« Ø®Ø±Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† 72 Ø³Ø§Ø¹Ø© Ø¥Ù„Ù‰ 48 Ø³Ø§Ø¹Ø©',
      issueDate: '2025-02-01', effectiveDate: '2025-04-01',
      sourceLink: 'https://sdaia.gov.sa/pdpl-update-2025.pdf',
      severity: 'Medium', status: 'UnderReview',
      createdBy: 1, createdAt: '2025-02-03',
      items: [
        { id: 1, requirementId: 'REQ-PDPL-28', impactType: 'Modified', oldText: 'Ø§Ù„Ø¥Ø®Ø·Ø§Ø± Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©', newText: 'Ø§Ù„Ø¥Ø®Ø·Ø§Ø± Ø®Ù„Ø§Ù„ 48 Ø³Ø§Ø¹Ø©' },
      ],
      impact: null,
      actions: [],
      closureEvidence: [],
    },
    {
      id: 4, code: 'CHG-REG-2025-004', authorityId: 1, frameworkId: 2,
      changeType: 'Guidance', title: 'ØªÙˆØ¬ÙŠÙ‡Ø§Øª ØªÙØ³ÙŠØ±ÙŠØ© Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª KYC',
      description: 'Ø¥ØµØ¯Ø§Ø± ØªÙˆØ¬ÙŠÙ‡Ø§Øª ØªÙØ³ÙŠØ±ÙŠØ© Ù„ØªÙˆØ¶ÙŠØ­ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©',
      issueDate: '2025-01-28', effectiveDate: '2025-02-28',
      sourceLink: 'https://sama.gov.sa/guidance/kyc-digital-2025.pdf',
      severity: 'Low', status: 'Closed',
      createdBy: 1, createdAt: '2025-01-30',
      items: [
        { id: 1, requirementId: 'REQ-KYC-05', impactType: 'Modified', oldText: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©', newText: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© Ø¨Ù…Ø§ ÙŠØ´Ù…Ù„ eKYC' },
      ],
      impact: {
        obligationsCount: 2, controlsCount: 1, risksCount: 0, policiesCount: 1, tasksCount: 3,
        retestingRequired: false, evidenceRefreshRequired: true, overallLevel: 'Low',
        assessorId: 1, assessedAt: '2025-02-01',
        affectedObligations: [2, 3], affectedControls: [2], affectedPolicies: [1]
      },
      actions: [
        { id: 1, type: 'UpdatePolicy', description: 'ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª eKYC', ownerId: 2, dueDate: '2025-02-15', status: 'Done' },
      ],
      closureEvidence: [{ id: 1, evidenceId: 15, acceptedBy: 3, acceptedAt: '2025-02-20' }],
      closedAt: '2025-02-22', closedBy: 3,
    },
    {
      id: 5, code: 'CHG-REG-2025-005', authorityId: 2, frameworkId: 4,
      changeType: 'Repeal', title: 'Ø¥Ù„ØºØ§Ø¡ Ù…ØªØ·Ù„Ø¨ Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„Ø±Ø¨Ø¹ÙŠ Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ØµØºÙŠØ±Ø©',
      description: 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ù…ØªØ·Ù„Ø¨ Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„Ø±Ø¨Ø¹ÙŠ Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø¯Ø±Ø¬Ø© Ø°Ø§Øª Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø£Ù‚Ù„ Ù…Ù† 50 Ù…Ù„ÙŠÙˆÙ†',
      issueDate: '2025-02-05', effectiveDate: '2025-03-01',
      sourceLink: 'https://cma.org.sa/circular/2025-001.pdf',
      severity: 'Low', status: 'Draft',
      createdBy: 1, createdAt: '2025-02-07',
      items: [
        { id: 1, requirementId: 'REQ-CMA-12', impactType: 'Removed', oldText: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„Ø±Ø¨Ø¹ÙŠ Ø¥Ù„Ø²Ø§Ù…ÙŠ', newText: null },
      ],
      impact: null,
      actions: [],
      closureEvidence: [],
    },
  ]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CONFIGURATIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const CHANGE_TYPE_CONFIG = {
    New: { label: 'Ø¬Ø¯ÙŠØ¯', icon: Plus, bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700' },
    Update: { label: 'ØªØ­Ø¯ÙŠØ«', icon: RefreshCw, bg: 'bg-blue-500', light: 'bg-blue-100', text: 'text-blue-700' },
    Repeal: { label: 'Ø¥Ù„ØºØ§Ø¡', icon: XCircle, bg: 'bg-red-500', light: 'bg-red-100', text: 'text-red-700' },
    Guidance: { label: 'ØªÙˆØ¬ÙŠÙ‡', icon: BookOpen, bg: 'bg-purple-500', light: 'bg-purple-100', text: 'text-purple-700' },
  };

  const STATUS_CONFIG = {
    Draft: { label: 'Ù…Ø³ÙˆØ¯Ø©', icon: FileText, bg: 'bg-slate-100', text: 'text-slate-700' },
    UnderReview: { label: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: Eye, bg: 'bg-blue-100', text: 'text-blue-700' },
    Assessed: { label: 'ØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…', icon: CheckSquare, bg: 'bg-purple-100', text: 'text-purple-700' },
    Implementing: { label: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°', icon: Zap, bg: 'bg-amber-100', text: 'text-amber-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
  };

  const SEVERITY_CONFIG = {
    Critical: { label: 'Ø­Ø±Ø¬', bg: 'bg-red-600', light: 'bg-red-100', text: 'text-red-700', border: 'border-red-500' },
    High: { label: 'Ø¹Ø§Ù„ÙŠ', bg: 'bg-orange-500', light: 'bg-orange-100', text: 'text-orange-700', border: 'border-orange-500' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700', border: 'border-amber-500' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700', border: 'border-emerald-500' },
  };

  const IMPACT_TYPE_CONFIG = {
    Added: { label: 'Ù…Ø¶Ø§Ù', icon: Plus, color: 'emerald' },
    Modified: { label: 'Ù…Ø¹Ø¯Ù‘Ù„', icon: Edit, color: 'blue' },
    Removed: { label: 'Ù…Ø­Ø°ÙˆÙ', icon: Trash2, color: 'red' },
  };

  const ACTION_TYPE_CONFIG = {
    UpdatePolicy: { label: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø©', icon: FileText, color: 'purple' },
    UpdateControl: { label: 'ØªØ­Ø¯ÙŠØ« Ø¶Ø§Ø¨Ø·', icon: Shield, color: 'blue' },
    NewObligation: { label: 'Ø§Ù„ØªØ²Ø§Ù… Ø¬Ø¯ÙŠØ¯', icon: Plus, color: 'emerald' },
    Training: { label: 'ØªØ¯Ø±ÙŠØ¨', icon: Users, color: 'amber' },
    Retest: { label: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø®ØªØ¨Ø§Ø±', icon: RefreshCw, color: 'indigo' },
    RescheduleTask: { label: 'Ø¥Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙˆÙ„Ø©', icon: Calendar, color: 'cyan' },
  };

  const USERS = [
    { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' },
    { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', role: 'Policy Manager' },
    { id: 3, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', role: 'Compliance Approver' },
    { id: 4, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'Training Coordinator' },
    { id: 5, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'Control Owner' },
  ];


  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // COMPUTED STATISTICS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const stats = useMemo(() => {
    const draft = changes.filter(c => c.status === 'Draft').length;
    const underReview = changes.filter(c => c.status === 'UnderReview').length;
    const assessed = changes.filter(c => c.status === 'Assessed').length;
    const implementing = changes.filter(c => c.status === 'Implementing').length;
    const closed = changes.filter(c => c.status === 'Closed').length;

    const critical = changes.filter(c => c.severity === 'Critical' && c.status !== 'Closed').length;
    const high = changes.filter(c => c.severity === 'High' && c.status !== 'Closed').length;

    const pendingAssessment = changes.filter(c => !c.impact && c.status !== 'Draft').length;
    const overdueActions = changes.reduce((sum, c) => {
      return sum + (c.actions?.filter(a => a.status !== 'Done' && new Date(a.dueDate) < new Date()).length || 0);
    }, 0);

    const totalActions = changes.reduce((sum, c) => sum + (c.actions?.length || 0), 0);
    const doneActions = changes.reduce((sum, c) => sum + (c.actions?.filter(a => a.status === 'Done').length || 0), 0);

    const newChanges = changes.filter(c => c.changeType === 'New').length;
    const updates = changes.filter(c => c.changeType === 'Update').length;
    const repeals = changes.filter(c => c.changeType === 'Repeal').length;

    const effectiveSoon = changes.filter(c => {
      if (c.status === 'Closed') return false;
      const days = Math.ceil((new Date(c.effectiveDate) - new Date()) / (1000 * 60 * 60 * 24));
      return days >= 0 && days <= 30;
    }).length;

    return {
      total: changes.length, draft, underReview, assessed, implementing, closed,
      critical, high, pendingAssessment, overdueActions, totalActions, doneActions,
      newChanges, updates, repeals, effectiveSoon,
      activeChanges: draft + underReview + assessed + implementing,
    };
  }, [changes]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // HELPER FUNCTIONS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  const getUser = (id) => USERS.find(u => u.id === id);
  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);

  const getDaysUntilEffective = (date) => {
    if (!date) return null;
    return Math.ceil((new Date(date) - new Date()) / (1000 * 60 * 60 * 24));
  };

  const filteredChanges = useMemo(() => {
    return changes.filter(c => {
      if (searchQuery && !c.code.toLowerCase().includes(searchQuery.toLowerCase()) && !c.title.toLowerCase().includes(searchQuery.toLowerCase())) return false;
      if (filterStatus && c.status !== filterStatus) return false;
      if (filterType && c.changeType !== filterType) return false;
      if (filterAuthority && c.authorityId !== parseInt(filterAuthority)) return false;
      return true;
    });
  }, [changes, searchQuery, filterStatus, filterType, filterAuthority]);

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // CRUD HANDLERS
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const handleCreateChange = () => {
    setFormData({
      id: null, code: `CHG-REG-2025-${String(changes.length + 1).padStart(3, '0')}`,
      authorityId: '', frameworkId: '', changeType: 'Update', title: '', description: '',
      issueDate: new Date().toISOString().split('T')[0], effectiveDate: '',
      sourceLink: '', severity: 'Medium', status: 'Draft',
      createdBy: CURRENT_USER.id, createdAt: new Date().toISOString().split('T')[0],
      items: [], impact: null, actions: [], closureEvidence: [],
    });
    setWizardStep(0);
    setModalType('change');
    setModalMode('create');
    setShowModal(true);
  };

  const handleEditChange = (change) => {
    setFormData({ ...change });
    setWizardStep(0);
    setModalType('change');
    setModalMode('edit');
    setShowModal(true);
  };

  const handleViewChange = (change) => {
    setSelectedChange(change);
    setChangeTab('summary');
    setActiveTab('workspace');
  };

  const handleAddItem = () => {
    if (!selectedChange) return;
    setFormData({ id: null, requirementId: '', impactType: 'Modified', oldText: '', newText: '' });
    setModalType('item');
    setModalMode('create');
    setShowModal(true);
  };

  const handleAddAction = () => {
    if (!selectedChange) return;
    setFormData({ id: null, type: 'UpdatePolicy', description: '', ownerId: '', dueDate: '', status: 'Open' });
    setModalType('action');
    setModalMode('create');
    setShowModal(true);
  };

  const handleSave = () => {
    if (modalType === 'change') {
      if (!formData.title || !formData.authorityId || !formData.effectiveDate) {
        showNotification('Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ø¬Ù‡Ø© ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ù†ÙØ§Ø° Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      if (modalMode === 'create') {
        setChanges([...changes, { ...formData, id: changes.length + 1 }]);
        showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØºÙŠÙŠØ± Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        setChanges(changes.map(c => c.id === formData.id ? formData : c));
        if (selectedChange?.id === formData.id) setSelectedChange(formData);
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØºÙŠÙŠØ±');
      }
    } else if (modalType === 'item') {
      if (!formData.requirementId) {
        showNotification('Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ·Ù„Ø¨ Ù…Ø·Ù„ÙˆØ¨', 'error');
        return;
      }
      const newItem = { ...formData, id: (selectedChange.items?.length || 0) + 1 };
      const updatedChange = { ...selectedChange, items: [...(selectedChange.items || []), newItem] };
      setChanges(changes.map(c => c.id === selectedChange.id ? updatedChange : c));
      setSelectedChange(updatedChange);
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©');
    } else if (modalType === 'action') {
      if (!formData.description || !formData.ownerId) {
        showNotification('Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      const newAction = { ...formData, id: (selectedChange.actions?.length || 0) + 1 };
      const updatedChange = { ...selectedChange, actions: [...(selectedChange.actions || []), newAction] };
      setChanges(changes.map(c => c.id === selectedChange.id ? updatedChange : c));
      setSelectedChange(updatedChange);
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
    }
    setShowModal(false);
    setFormData(null);
    setWizardStep(0);
  };

  const handleUpdateStatus = (change, newStatus) => {
    const updatedChange = { ...change, status: newStatus };
    if (newStatus === 'Closed') {
      updatedChange.closedAt = new Date().toISOString().split('T')[0];
      updatedChange.closedBy = CURRENT_USER.id;
    }
    setChanges(changes.map(c => c.id === change.id ? updatedChange : c));
    if (selectedChange?.id === change.id) setSelectedChange(updatedChange);
    showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰: ${STATUS_CONFIG[newStatus]?.label}`);
  };

  const handleRunImpactAssessment = (change) => {
    // Simulated Auto Impact Engine
    const impact = {
      obligationsCount: Math.floor(Math.random() * 5) + 1,
      controlsCount: Math.floor(Math.random() * 4) + 1,
      risksCount: Math.floor(Math.random() * 3),
      policiesCount: Math.floor(Math.random() * 2) + 1,
      tasksCount: Math.floor(Math.random() * 8) + 2,
      retestingRequired: change.severity === 'Critical' || change.severity === 'High',
      evidenceRefreshRequired: true,
      overallLevel: change.severity,
      assessorId: CURRENT_USER.id,
      assessedAt: new Date().toISOString().split('T')[0],
      affectedObligations: [1, 2, 3].slice(0, Math.floor(Math.random() * 3) + 1),
      affectedControls: [1, 2, 3, 4].slice(0, Math.floor(Math.random() * 4) + 1),
      affectedPolicies: [1, 2].slice(0, Math.floor(Math.random() * 2) + 1),
    };
    const updatedChange = { ...change, impact, status: 'Assessed' };
    setChanges(changes.map(c => c.id === change.id ? updatedChange : c));
    if (selectedChange?.id === change.id) setSelectedChange(updatedChange);
    showNotification('ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± Ø¨Ù†Ø¬Ø§Ø­');
    setShowImpactModal(true);
  };

  const handleApplyToCalendar = (change) => {
    showNotification('ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ù„Ù‰ ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„');
  };

  const handleUpdateActionStatus = (actionId, newStatus) => {
    const updatedActions = selectedChange.actions.map(a => a.id === actionId ? { ...a, status: newStatus } : a);
    const updatedChange = { ...selectedChange, actions: updatedActions };
    setChanges(changes.map(c => c.id === selectedChange.id ? updatedChange : c));
    setSelectedChange(updatedChange);
    showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡');
  };

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // TABS CONFIGURATION
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const mainTabs = [
    { id: 'command', label: 'Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…', icon: LayoutDashboard },
    { id: 'register', label: 'Ø³Ø¬Ù„ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª', icon: ClipboardList, count: stats.activeChanges },
    { id: 'workspace', label: 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„', icon: Briefcase, disabled: !selectedChange },
    { id: 'timeline', label: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ', icon: Calendar },
  ];

  const changeTabs = [
    { id: 'summary', label: 'Ø§Ù„Ù…Ù„Ø®Øµ', icon: FileText },
    { id: 'items', label: 'Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©', icon: List },
    { id: 'impact', label: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±', icon: Activity },
    { id: 'actions', label: 'Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ°', icon: Zap },
    { id: 'evidence', label: 'Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚', icon: FileCheck },
    { id: 'audit', label: 'Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', icon: History },
  ];


  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // RENDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  return (
    <div className="space-y-6">
      {/* Notification */}
      {notification && (
        <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold ${notification.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}`}>
          {notification.message}
        </div>
      )}

      {/* Header */}
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
            <RefreshCw className="w-7 h-7 text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-slate-900">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</h1>
            <p className="text-slate-500">Regulatory Change Management - Module 4.8</p>
          </div>
        </div>
        <div className="flex items-center gap-3">
          <button className="flex items-center gap-2 px-4 py-2.5 border-2 border-slate-200 rounded-xl text-slate-700 hover:bg-slate-50">
            <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
          </button>
          <button onClick={handleCreateChange}
            className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-bold shadow-lg">
            <Plus className="w-5 h-5" />ØªØ³Ø¬ÙŠÙ„ ØªØºÙŠÙŠØ±
          </button>
        </div>
      </div>

      {/* Quick Stats */}
      <div className="grid grid-cols-8 gap-3">
        <div className={`rounded-2xl p-4 ${stats.critical > 0 ? 'bg-red-500 animate-pulse' : 'bg-red-400'} text-white`}>
          <div className="flex items-center justify-between mb-1">
            <AlertTriangle className="w-5 h-5" />
            <span className="text-3xl font-bold">{stats.critical}</span>
          </div>
          <p className="text-red-100 text-sm">Ø­Ø±Ø¬</p>
        </div>

        <div className={`rounded-2xl p-4 ${stats.effectiveSoon > 0 ? 'bg-amber-500' : 'bg-amber-400'} text-white`}>
          <div className="flex items-center justify-between mb-1">
            <Clock className="w-5 h-5" />
            <span className="text-3xl font-bold">{stats.effectiveSoon}</span>
          </div>
          <p className="text-amber-100 text-sm">Ù‚Ø±ÙŠØ¨ Ø§Ù„Ù†ÙØ§Ø°</p>
        </div>

        <div className="bg-slate-100 rounded-2xl p-4 border-2 border-slate-200">
          <div className="flex items-center justify-between mb-1">
            <FileText className="w-5 h-5 text-slate-500" />
            <span className="text-2xl font-bold text-slate-700">{stats.draft}</span>
          </div>
          <p className="text-slate-500 text-sm">Ù…Ø³ÙˆØ¯Ø©</p>
        </div>

        <div className="bg-blue-100 rounded-2xl p-4 border-2 border-blue-200">
          <div className="flex items-center justify-between mb-1">
            <Eye className="w-5 h-5 text-blue-600" />
            <span className="text-2xl font-bold text-blue-700">{stats.underReview}</span>
          </div>
          <p className="text-blue-600 text-sm">Ù…Ø±Ø§Ø¬Ø¹Ø©</p>
        </div>

        <div className="bg-purple-100 rounded-2xl p-4 border-2 border-purple-200">
          <div className="flex items-center justify-between mb-1">
            <CheckSquare className="w-5 h-5 text-purple-600" />
            <span className="text-2xl font-bold text-purple-700">{stats.assessed}</span>
          </div>
          <p className="text-purple-600 text-sm">Ù…ÙÙ‚ÙŠÙ‘Ù…</p>
        </div>

        <div className="bg-amber-100 rounded-2xl p-4 border-2 border-amber-200">
          <div className="flex items-center justify-between mb-1">
            <Zap className="w-5 h-5 text-amber-600" />
            <span className="text-2xl font-bold text-amber-700">{stats.implementing}</span>
          </div>
          <p className="text-amber-600 text-sm">ØªÙ†ÙÙŠØ°</p>
        </div>

        <div className="bg-emerald-100 rounded-2xl p-4 border-2 border-emerald-200">
          <div className="flex items-center justify-between mb-1">
            <CheckCircle2 className="w-5 h-5 text-emerald-600" />
            <span className="text-2xl font-bold text-emerald-700">{stats.closed}</span>
          </div>
          <p className="text-emerald-600 text-sm">Ù…ØºÙ„Ù‚</p>
        </div>

        <div className="bg-indigo-100 rounded-2xl p-4 border-2 border-indigo-200">
          <div className="flex items-center justify-between mb-1">
            <ClipboardList className="w-5 h-5 text-indigo-600" />
            <span className="text-2xl font-bold text-indigo-700">{stats.total}</span>
          </div>
          <p className="text-indigo-600 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
        </div>
      </div>

      {/* Main Content */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
        {/* Tabs */}
        <div className="flex border-b border-slate-200">
          {mainTabs.map(tab => (
            <button key={tab.id} onClick={() => !tab.disabled && setActiveTab(tab.id)}
              disabled={tab.disabled}
              className={`flex items-center gap-2 px-5 py-4 font-bold transition-all border-b-2 ${activeTab === tab.id ? 'text-indigo-600 border-indigo-500 bg-indigo-50' :
                  tab.disabled ? 'text-slate-300 border-transparent cursor-not-allowed' :
                    'text-slate-500 border-transparent hover:bg-slate-50'
                }`}>
              <tab.icon className="w-5 h-5" />
              {tab.label}
              {tab.count > 0 && (
                <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-indigo-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                  {tab.count}
                </span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: COMMAND CENTER
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'command' && (
          <div className="p-6">
            <div className="grid grid-cols-3 gap-6">
              {/* Change Types Distribution */}
              <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-5 border border-indigo-200">
                <h3 className="font-bold text-indigo-800 mb-4 flex items-center gap-2">
                  <PieChart className="w-5 h-5" />Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
                </h3>
                <div className="grid grid-cols-2 gap-3">
                  {Object.entries(CHANGE_TYPE_CONFIG).map(([key, cfg]) => {
                    const count = changes.filter(c => c.changeType === key).length;
                    const TypeIcon = cfg.icon;
                    return (
                      <div key={key} className="bg-white rounded-xl p-3 border border-slate-200">
                        <div className="flex items-center gap-2 mb-2">
                          <div className={`w-8 h-8 rounded-lg ${cfg.bg} flex items-center justify-center text-white`}>
                            <TypeIcon className="w-4 h-4" />
                          </div>
                          <span className="text-2xl font-bold text-slate-800">{count}</span>
                        </div>
                        <p className="text-sm text-slate-600">{cfg.label}</p>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Impact Summary */}
              <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-5 border border-amber-200">
                <h3 className="font-bold text-amber-800 mb-4 flex items-center gap-2">
                  <Activity className="w-5 h-5" />Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø«Ø±
                </h3>
                <div className="space-y-3">
                  {[
                    { label: 'Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ù…ØªØ£Ø«Ø±Ø©', value: changes.reduce((sum, c) => sum + (c.impact?.obligationsCount || 0), 0), icon: ClipboardCheck, color: 'emerald' },
                    { label: 'Ø¶ÙˆØ§Ø¨Ø· Ù…ØªØ£Ø«Ø±Ø©', value: changes.reduce((sum, c) => sum + (c.impact?.controlsCount || 0), 0), icon: Shield, color: 'blue' },
                    { label: 'Ø³ÙŠØ§Ø³Ø§Øª Ù…ØªØ£Ø«Ø±Ø©', value: changes.reduce((sum, c) => sum + (c.impact?.policiesCount || 0), 0), icon: FileText, color: 'purple' },
                    { label: 'Ù…Ù‡Ø§Ù… ØªØ­ØªØ§Ø¬ Ø¬Ø¯ÙˆÙ„Ø©', value: changes.reduce((sum, c) => sum + (c.impact?.tasksCount || 0), 0), icon: Calendar, color: 'amber' },
                  ].map((item, idx) => {
                    const Icon = item.icon;
                    return (
                      <div key={idx} className="flex items-center justify-between bg-white rounded-xl p-3 border border-slate-200">
                        <div className="flex items-center gap-2">
                          <Icon className={`w-5 h-5 text-${item.color}-500`} />
                          <span className="text-sm text-slate-600">{item.label}</span>
                        </div>
                        <span className={`text-xl font-bold text-${item.color}-600`}>{item.value}</span>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Quick Actions */}
              <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                <h3 className="font-bold mb-4">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                <div className="space-y-2">
                  <button onClick={handleCreateChange} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <Plus className="w-5 h-5" /><span>ØªØ³Ø¬ÙŠÙ„ ØªØºÙŠÙŠØ± Ø¬Ø¯ÙŠØ¯</span>
                  </button>
                  <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <Activity className="w-5 h-5" /><span>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø´Ø§Ù…Ù„</span>
                  </button>
                  <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <Calendar className="w-5 h-5" /><span>ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</span>
                  </button>
                  <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                    <FileText className="w-5 h-5" /><span>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</span>
                  </button>
                </div>
              </div>

              {/* Upcoming Effective Dates */}
              <div className="col-span-2 bg-white rounded-2xl p-5 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <Calendar className="w-5 h-5 text-indigo-500" />ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù†ÙØ§Ø° Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
                </h3>
                <div className="space-y-3">
                  {changes.filter(c => c.status !== 'Closed').sort((a, b) => new Date(a.effectiveDate) - new Date(b.effectiveDate)).slice(0, 4).map(change => {
                    const days = getDaysUntilEffective(change.effectiveDate);
                    const sevCfg = SEVERITY_CONFIG[change.severity];
                    const typeCfg = CHANGE_TYPE_CONFIG[change.changeType];
                    return (
                      <div key={change.id} onClick={() => handleViewChange(change)}
                        className="flex items-center gap-4 p-4 rounded-xl bg-slate-50 hover:bg-slate-100 cursor-pointer">
                        <div className={`w-12 h-12 rounded-xl ${sevCfg?.bg} flex items-center justify-center text-white font-bold`}>
                          {days !== null && days >= 0 ? days : '!'}
                        </div>
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-mono text-xs font-bold text-indigo-600">{change.code}</span>
                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>{typeCfg?.label}</span>
                          </div>
                          <p className="font-bold text-slate-800">{change.title}</p>
                        </div>
                        <div className="text-left">
                          <p className="text-sm font-bold text-slate-700">{change.effectiveDate}</p>
                          <p className={`text-xs font-bold ${days !== null && days <= 30 ? 'text-amber-600' : 'text-slate-500'}`}>
                            {days !== null && days >= 0 ? `${days} ÙŠÙˆÙ…` : 'Ù†Ø§ÙØ°'}
                          </p>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Pending Assessment */}
              <div className="bg-white rounded-2xl p-5 border-2 border-slate-200">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <AlertCircle className="w-5 h-5 text-amber-500" />Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                </h3>
                {changes.filter(c => !c.impact && c.status !== 'Draft' && c.status !== 'Closed').length > 0 ? (
                  <div className="space-y-2">
                    {changes.filter(c => !c.impact && c.status !== 'Draft' && c.status !== 'Closed').map(change => (
                      <div key={change.id} className="flex items-center justify-between p-3 bg-amber-50 rounded-xl border border-amber-200">
                        <div>
                          <span className="font-mono text-xs font-bold text-indigo-600">{change.code}</span>
                          <p className="text-sm text-slate-700 line-clamp-1">{change.title}</p>
                        </div>
                        <button onClick={() => handleRunImpactAssessment(change)}
                          className="px-3 py-1.5 bg-amber-500 text-white rounded-lg text-xs font-bold">
                          ØªÙ‚ÙŠÙŠÙ…
                        </button>
                      </div>
                    ))}
                  </div>
                ) : (
                  <p className="text-center text-slate-400 py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</p>
                )}
              </div>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: CHANGE REGISTER
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'register' && (
          <div className="p-6">
            {/* Filters */}
            <div className="flex items-center gap-3 mb-6">
              <div className="relative flex-1 max-w-lg">
                <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl" />
              </div>
              <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                {Object.entries(STATUS_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
              </select>
              <select value={filterType} onChange={(e) => setFilterType(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                {Object.entries(CHANGE_TYPE_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
              </select>
              <select value={filterAuthority} onChange={(e) => setFilterAuthority(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
                {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code}</option>)}
              </select>

              {/* View Toggle */}
              <div className="flex items-center gap-1 bg-slate-100 p-1 rounded-xl mr-auto">
                <button onClick={() => setViewMode('table')} className={`p-2 rounded-lg ${viewMode === 'table' ? 'bg-white shadow' : ''}`}>
                  <Table className="w-5 h-5" />
                </button>
                <button onClick={() => setViewMode('cards')} className={`p-2 rounded-lg ${viewMode === 'cards' ? 'bg-white shadow' : ''}`}>
                  <LayoutGrid className="w-5 h-5" />
                </button>
              </div>
            </div>

            {/* Table View */}
            {viewMode === 'table' && (
              <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                <table className="w-full">
                  <thead>
                    <tr className="bg-gradient-to-r from-slate-50 to-slate-100 border-b-2 border-slate-200">
                      <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                      <th className="text-right px-4 py-4 font-bold text-slate-700 min-w-[250px]">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ù†ÙˆØ¹</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø®Ø·ÙˆØ±Ø©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ù†ÙØ§Ø°</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø£Ø«Ø±</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700 w-36">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredChanges.map(change => {
                      const auth = getAuthority(change.authorityId);
                      const typeCfg = CHANGE_TYPE_CONFIG[change.changeType];
                      const sevCfg = SEVERITY_CONFIG[change.severity];
                      const statusCfg = STATUS_CONFIG[change.status];
                      const days = getDaysUntilEffective(change.effectiveDate);
                      const TypeIcon = typeCfg?.icon || FileText;

                      return (
                        <tr key={change.id} className={`border-b border-slate-100 hover:bg-slate-50 ${change.severity === 'Critical' ? 'bg-red-50/50' : ''}`}>
                          <td className="px-4 py-4">
                            <div className="flex items-center gap-2">
                              <div className={`w-1.5 h-10 rounded-full ${sevCfg?.bg}`}></div>
                              <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded-lg">{change.code}</span>
                            </div>
                          </td>
                          <td className="px-4 py-4">
                            <div className="cursor-pointer hover:text-indigo-600" onClick={() => handleViewChange(change)}>
                              <p className="font-bold text-slate-800 line-clamp-1">{change.title}</p>
                              <p className="text-xs text-slate-500 line-clamp-1">{change.description?.substring(0, 60)}...</p>
                            </div>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className="px-3 py-1.5 bg-slate-100 text-slate-700 rounded-lg text-xs font-bold">{auth?.code}</span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                              <TypeIcon className="w-3.5 h-3.5" />{typeCfg?.label}
                            </span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`px-3 py-1.5 rounded-lg text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                              {React.createElement(statusCfg?.icon || Clock, { className: "w-3 h-3" })}
                              {statusCfg?.label}
                            </span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <div className="text-sm font-bold text-slate-700">{change.effectiveDate}</div>
                            {days !== null && change.status !== 'Closed' && (
                              <span className={`text-xs font-bold px-2 py-0.5 rounded-full ${days < 0 ? 'bg-emerald-100 text-emerald-600' : days <= 30 ? 'bg-amber-100 text-amber-600' : 'bg-slate-100 text-slate-600'
                                }`}>
                                {days < 0 ? 'Ù†Ø§ÙØ°' : `${days} ÙŠÙˆÙ…`}
                              </span>
                            )}
                          </td>
                          <td className="px-3 py-4 text-center">
                            {change.impact ? (
                              <span className={`px-2 py-1 rounded-lg text-xs font-bold ${SEVERITY_CONFIG[change.impact.overallLevel]?.light} ${SEVERITY_CONFIG[change.impact.overallLevel]?.text}`}>
                                {change.impact.obligationsCount} Ø¥Ù„ØªØ²Ø§Ù…
                              </span>
                            ) : (
                              <button onClick={() => handleRunImpactAssessment(change)}
                                className="px-2 py-1 bg-amber-100 text-amber-700 rounded-lg text-xs font-bold hover:bg-amber-200">
                                ØªÙ‚ÙŠÙŠÙ…
                              </button>
                            )}
                          </td>
                          <td className="px-4 py-4">
                            <div className="flex items-center justify-center gap-1">
                              <button onClick={() => handleViewChange(change)} className="p-2 hover:bg-blue-100 rounded-lg" title="Ø¹Ø±Ø¶">
                                <Eye className="w-4 h-4 text-blue-600" />
                              </button>
                              <button onClick={() => handleEditChange(change)} className="p-2 hover:bg-amber-100 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                                <Edit className="w-4 h-4 text-amber-600" />
                              </button>
                              {change.impact && change.status === 'Assessed' && (
                                <button onClick={() => handleUpdateStatus(change, 'Implementing')} className="p-2 hover:bg-emerald-100 rounded-lg" title="Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°">
                                  <Play className="w-4 h-4 text-emerald-600" />
                                </button>
                              )}
                            </div>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
            )}

            {/* Cards View */}
            {viewMode === 'cards' && (
              <div className="grid grid-cols-3 gap-4">
                {filteredChanges.map(change => {
                  const auth = getAuthority(change.authorityId);
                  const typeCfg = CHANGE_TYPE_CONFIG[change.changeType];
                  const sevCfg = SEVERITY_CONFIG[change.severity];
                  const statusCfg = STATUS_CONFIG[change.status];
                  const days = getDaysUntilEffective(change.effectiveDate);
                  const TypeIcon = typeCfg?.icon || FileText;

                  return (
                    <div key={change.id} onClick={() => handleViewChange(change)}
                      className={`bg-white rounded-2xl border-2 overflow-hidden cursor-pointer hover:shadow-lg transition-all ${change.severity === 'Critical' ? 'border-red-300' : 'border-slate-200 hover:border-indigo-300'
                        }`}>
                      <div className={`px-4 py-3 ${sevCfg?.light} border-b-2 ${sevCfg?.border}`}>
                        <div className="flex items-center justify-between">
                          <span className="font-mono text-sm font-bold text-indigo-600">{change.code}</span>
                          <div className="flex items-center gap-2">
                            <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                              <TypeIcon className="w-3 h-3" />{typeCfg?.label}
                            </span>
                          </div>
                        </div>
                      </div>
                      <div className="p-4">
                        <h4 className="font-bold text-slate-800 line-clamp-2 mb-3">{change.title}</h4>
                        <div className="flex flex-wrap gap-2 mb-3">
                          <span className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs font-bold">{auth?.code}</span>
                          <span className={`px-2 py-1 rounded text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                        </div>
                        <p className="text-sm text-slate-600 line-clamp-2 mb-4">{change.description}</p>

                        {change.impact && (
                          <div className="flex items-center gap-3 mb-3 text-xs text-slate-500">
                            <span>{change.impact.obligationsCount} Ø§Ù„ØªØ²Ø§Ù…</span>
                            <span>{change.impact.controlsCount} Ø¶Ø§Ø¨Ø·</span>
                            <span>{change.impact.tasksCount} Ù…Ù‡Ù…Ø©</span>
                          </div>
                        )}

                        <div className="flex items-center justify-between pt-3 border-t border-slate-100">
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                            {React.createElement(statusCfg?.icon || Clock, { className: "w-3 h-3" })}
                            {statusCfg?.label}
                          </span>
                          <span className={`text-xs font-bold ${days !== null && days <= 30 && days >= 0 ? 'text-amber-600' : 'text-slate-500'}`}>
                            Ù†ÙØ§Ø°: {change.effectiveDate}
                          </span>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        )}


        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: CHANGE WORKSPACE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'workspace' && selectedChange && (
          <div className="p-6">
            {/* Change Header */}
            <div className={`rounded-2xl p-6 mb-6 border-2 ${SEVERITY_CONFIG[selectedChange.severity]?.border} ${SEVERITY_CONFIG[selectedChange.severity]?.light}`}>
              <div className="flex items-start justify-between">
                <div>
                  <div className="flex items-center gap-3 mb-2">
                    <span className="font-mono text-lg font-bold text-indigo-600 bg-indigo-100 px-3 py-1 rounded-lg">{selectedChange.code}</span>
                    <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-sm font-bold ${CHANGE_TYPE_CONFIG[selectedChange.changeType]?.light} ${CHANGE_TYPE_CONFIG[selectedChange.changeType]?.text}`}>
                      {React.createElement(CHANGE_TYPE_CONFIG[selectedChange.changeType]?.icon || FileText, { className: "w-4 h-4" })}
                      {CHANGE_TYPE_CONFIG[selectedChange.changeType]?.label}
                    </span>
                    <span className={`px-3 py-1 rounded-lg text-sm font-bold ${SEVERITY_CONFIG[selectedChange.severity]?.light} ${SEVERITY_CONFIG[selectedChange.severity]?.text}`}>
                      {SEVERITY_CONFIG[selectedChange.severity]?.label}
                    </span>
                    <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-sm font-bold ${STATUS_CONFIG[selectedChange.status]?.bg} ${STATUS_CONFIG[selectedChange.status]?.text}`}>
                      {React.createElement(STATUS_CONFIG[selectedChange.status]?.icon || Clock, { className: "w-4 h-4" })}
                      {STATUS_CONFIG[selectedChange.status]?.label}
                    </span>
                  </div>
                  <h2 className="text-xl font-bold text-slate-800">{selectedChange.title}</h2>
                  <div className="flex items-center gap-4 mt-2 text-sm text-slate-600">
                    <span>Ø§Ù„Ø¬Ù‡Ø©: <strong>{getAuthority(selectedChange.authorityId)?.code}</strong></span>
                    <span>Ø§Ù„Ù†ÙØ§Ø°: <strong className={getDaysUntilEffective(selectedChange.effectiveDate) <= 30 ? 'text-amber-600' : ''}>{selectedChange.effectiveDate}</strong></span>
                    {selectedChange.sourceLink && (
                      <a href={selectedChange.sourceLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 text-indigo-600 hover:underline">
                        <ExternalLink className="w-4 h-4" />Ø§Ù„Ù…ØµØ¯Ø±
                      </a>
                    )}
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  {selectedChange.status === 'UnderReview' && !selectedChange.impact && (
                    <button onClick={() => handleRunImpactAssessment(selectedChange)}
                      className="flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-xl font-bold">
                      <Activity className="w-5 h-5" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±
                    </button>
                  )}
                  {selectedChange.status === 'Assessed' && (
                    <button onClick={() => handleUpdateStatus(selectedChange, 'Implementing')}
                      className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                      <Play className="w-5 h-5" />Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ°
                    </button>
                  )}
                  {selectedChange.status === 'Implementing' && (
                    <>
                      <button onClick={() => handleApplyToCalendar(selectedChange)}
                        className="flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-xl font-bold">
                        <Calendar className="w-5 h-5" />ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
                      </button>
                      <button onClick={() => handleUpdateStatus(selectedChange, 'Closed')}
                        disabled={!selectedChange.actions?.every(a => a.status === 'Done')}
                        className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold disabled:opacity-50">
                        <CheckCircle2 className="w-5 h-5" />Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØºÙŠÙŠØ±
                      </button>
                    </>
                  )}
                  <button onClick={() => setSelectedChange(null)} className="p-2 hover:bg-slate-200 rounded-xl">
                    <X className="w-5 h-5 text-slate-500" />
                  </button>
                </div>
              </div>
            </div>

            {/* Change Tabs */}
            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <div className="flex border-b border-slate-200 overflow-x-auto">
                {changeTabs.map(tab => (
                  <button key={tab.id} onClick={() => setChangeTab(tab.id)}
                    className={`flex items-center gap-2 px-5 py-3 font-bold transition-all border-b-2 whitespace-nowrap ${changeTab === tab.id ? 'text-indigo-600 border-indigo-500 bg-indigo-50' : 'text-slate-500 border-transparent hover:bg-slate-50'
                      }`}>
                    <tab.icon className="w-4 h-4" />{tab.label}
                  </button>
                ))}
              </div>

              <div className="p-6">
                {/* Summary Tab */}
                {changeTab === 'summary' && (
                  <div className="grid grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ</h4>
                        <p className="text-slate-600">{selectedChange.description}</p>
                      </div>
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</span><span className="font-bold">{selectedChange.issueDate}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù†ÙØ§Ø°:</span><span className="font-bold">{selectedChange.effectiveDate}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</span><span className="font-bold">{selectedChange.createdAt}</span></div>
                          {selectedChange.closedAt && (
                            <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¥ØºÙ„Ø§Ù‚:</span><span className="font-bold text-emerald-600">{selectedChange.closedAt}</span></div>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-4">
                        <h4 className="font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„:</span><span className="font-bold">{getUser(selectedChange.createdBy)?.name}</span></div>
                          {selectedChange.impact?.assessorId && (
                            <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…ÙÙ‚ÙŠÙ‘Ù…:</span><span className="font-bold">{getUser(selectedChange.impact.assessorId)?.name}</span></div>
                          )}
                          {selectedChange.closedBy && (
                            <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù…ÙØºÙ„ÙÙ‚:</span><span className="font-bold">{getUser(selectedChange.closedBy)?.name}</span></div>
                          )}
                        </div>
                      </div>
                      {selectedChange.impact && (
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-200">
                          <h4 className="font-bold text-amber-800 mb-2">Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø³Ø±ÙŠØ¹</h4>
                          <div className="grid grid-cols-2 gap-2 text-sm">
                            <div className="bg-white rounded-lg p-2 text-center">
                              <span className="text-2xl font-bold text-emerald-600">{selectedChange.impact.obligationsCount}</span>
                              <p className="text-xs text-slate-500">Ø§Ù„ØªØ²Ø§Ù…</p>
                            </div>
                            <div className="bg-white rounded-lg p-2 text-center">
                              <span className="text-2xl font-bold text-blue-600">{selectedChange.impact.controlsCount}</span>
                              <p className="text-xs text-slate-500">Ø¶Ø§Ø¨Ø·</p>
                            </div>
                            <div className="bg-white rounded-lg p-2 text-center">
                              <span className="text-2xl font-bold text-purple-600">{selectedChange.impact.policiesCount}</span>
                              <p className="text-xs text-slate-500">Ø³ÙŠØ§Ø³Ø©</p>
                            </div>
                            <div className="bg-white rounded-lg p-2 text-center">
                              <span className="text-2xl font-bold text-amber-600">{selectedChange.impact.tasksCount}</span>
                              <p className="text-xs text-slate-500">Ù…Ù‡Ù…Ø©</p>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Items Tab */}
                {changeTab === 'items' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800">Ø§Ù„Ù…ÙˆØ§Ø¯ ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©</h4>
                      <button onClick={handleAddItem}
                        className="flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-xl font-bold">
                        <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©
                      </button>
                    </div>
                    {selectedChange.items?.length > 0 ? (
                      <div className="space-y-3">
                        {selectedChange.items.map(item => {
                          const impactCfg = IMPACT_TYPE_CONFIG[item.impactType];
                          const ImpactIcon = impactCfg?.icon || Edit;
                          return (
                            <div key={item.id} className={`rounded-xl border-2 p-4 bg-${impactCfg?.color}-50 border-${impactCfg?.color}-200`}>
                              <div className="flex items-start justify-between mb-3">
                                <div className="flex items-center gap-2">
                                  <span className={`inline-flex items-center gap-1 px-2 py-1 bg-${impactCfg?.color}-100 text-${impactCfg?.color}-700 rounded-lg text-xs font-bold`}>
                                    <ImpactIcon className="w-3 h-3" />{impactCfg?.label}
                                  </span>
                                  <span className="font-mono text-sm font-bold text-slate-700">{item.requirementId}</span>
                                </div>
                              </div>
                              <div className="grid grid-cols-2 gap-4">
                                {item.oldText && (
                                  <div className="bg-red-50 rounded-lg p-3 border border-red-200">
                                    <p className="text-xs text-red-600 font-bold mb-1">Ø§Ù„Ù†Øµ Ø§Ù„Ø³Ø§Ø¨Ù‚:</p>
                                    <p className="text-sm text-slate-700 line-through">{item.oldText}</p>
                                  </div>
                                )}
                                {item.newText && (
                                  <div className="bg-emerald-50 rounded-lg p-3 border border-emerald-200">
                                    <p className="text-xs text-emerald-600 font-bold mb-1">Ø§Ù„Ù†Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</p>
                                    <p className="text-sm text-slate-700">{item.newText}</p>
                                  </div>
                                )}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <List className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¯ Ù…Ø³Ø¬Ù„Ø©</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Impact Tab */}
                {changeTab === 'impact' && (
                  <div className="space-y-6">
                    {selectedChange.impact ? (
                      <>
                        {/* Impact Overview */}
                        <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-200">
                          <div className="flex items-center justify-between mb-6">
                            <h3 className="text-lg font-bold text-indigo-800 flex items-center gap-2">
                              <Activity className="w-5 h-5" />ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± - Impact Analysis
                            </h3>
                            <div className="flex items-center gap-2">
                              <span className={`px-3 py-1 rounded-lg text-sm font-bold ${SEVERITY_CONFIG[selectedChange.impact.overallLevel]?.light} ${SEVERITY_CONFIG[selectedChange.impact.overallLevel]?.text}`}>
                                Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø«Ø±: {SEVERITY_CONFIG[selectedChange.impact.overallLevel]?.label}
                              </span>
                              <span className="text-sm text-slate-500">ØªÙ‚ÙŠÙŠÙ…: {selectedChange.impact.assessedAt}</span>
                            </div>
                          </div>

                          <div className="grid grid-cols-5 gap-4">
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200">
                              <ClipboardCheck className="w-8 h-8 text-emerald-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-emerald-600">{selectedChange.impact.obligationsCount}</span>
                              <p className="text-sm text-slate-600">Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200">
                              <Shield className="w-8 h-8 text-blue-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-blue-600">{selectedChange.impact.controlsCount}</span>
                              <p className="text-sm text-slate-600">Ø¶ÙˆØ§Ø¨Ø·</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200">
                              <AlertTriangle className="w-8 h-8 text-red-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-red-600">{selectedChange.impact.risksCount}</span>
                              <p className="text-sm text-slate-600">Ù…Ø®Ø§Ø·Ø±</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200">
                              <FileText className="w-8 h-8 text-purple-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-purple-600">{selectedChange.impact.policiesCount}</span>
                              <p className="text-sm text-slate-600">Ø³ÙŠØ§Ø³Ø§Øª</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200">
                              <Calendar className="w-8 h-8 text-amber-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-amber-600">{selectedChange.impact.tasksCount}</span>
                              <p className="text-sm text-slate-600">Ù…Ù‡Ø§Ù…</p>
                            </div>
                          </div>
                        </div>

                        {/* Required Actions */}
                        <div className="grid grid-cols-2 gap-4">
                          <div className={`rounded-xl p-4 border-2 ${selectedChange.impact.retestingRequired ? 'bg-amber-50 border-amber-300' : 'bg-slate-50 border-slate-200'}`}>
                            <div className="flex items-center gap-3">
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${selectedChange.impact.retestingRequired ? 'bg-amber-500 text-white' : 'bg-slate-200 text-slate-500'}`}>
                                <RefreshCw className="w-5 h-5" />
                              </div>
                              <div>
                                <p className="font-bold text-slate-800">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                                <p className={`text-sm ${selectedChange.impact.retestingRequired ? 'text-amber-600 font-bold' : 'text-slate-500'}`}>
                                  {selectedChange.impact.retestingRequired ? 'Ù…Ø·Ù„ÙˆØ¨' : 'ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨'}
                                </p>
                              </div>
                            </div>
                          </div>
                          <div className={`rounded-xl p-4 border-2 ${selectedChange.impact.evidenceRefreshRequired ? 'bg-blue-50 border-blue-300' : 'bg-slate-50 border-slate-200'}`}>
                            <div className="flex items-center gap-3">
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${selectedChange.impact.evidenceRefreshRequired ? 'bg-blue-500 text-white' : 'bg-slate-200 text-slate-500'}`}>
                                <FileCheck className="w-5 h-5" />
                              </div>
                              <div>
                                <p className="font-bold text-slate-800">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ù„Ø©</p>
                                <p className={`text-sm ${selectedChange.impact.evidenceRefreshRequired ? 'text-blue-600 font-bold' : 'text-slate-500'}`}>
                                  {selectedChange.impact.evidenceRefreshRequired ? 'Ù…Ø·Ù„ÙˆØ¨' : 'ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨'}
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>

                        {/* Impact Graph Visualization */}
                        <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                          <h4 className="font-bold text-slate-800 mb-4">Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø£Ø«Ø± - Impact Graph</h4>
                          <div className="flex items-center justify-center gap-8">
                            <div className="text-center">
                              <div className="w-20 h-20 rounded-full bg-indigo-500 flex items-center justify-center text-white mb-2">
                                <RefreshCw className="w-10 h-10" />
                              </div>
                              <p className="text-sm font-bold">Ø§Ù„ØªØºÙŠÙŠØ±</p>
                            </div>
                            <div className="flex flex-col items-center gap-2">
                              <ChevronLeft className="w-8 h-8 text-indigo-400 rotate-180" />
                              <span className="text-xs text-slate-500">ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰</span>
                            </div>
                            <div className="grid grid-cols-3 gap-4">
                              {[
                                { icon: ClipboardCheck, label: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', count: selectedChange.impact.obligationsCount, color: 'emerald' },
                                { icon: Shield, label: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·', count: selectedChange.impact.controlsCount, color: 'blue' },
                                { icon: FileText, label: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', count: selectedChange.impact.policiesCount, color: 'purple' },
                              ].map((item, idx) => (
                                <div key={idx} className={`w-16 h-16 rounded-xl bg-${item.color}-100 border-2 border-${item.color}-300 flex flex-col items-center justify-center`}>
                                  <item.icon className={`w-6 h-6 text-${item.color}-600`} />
                                  <span className={`text-sm font-bold text-${item.color}-700`}>{item.count}</span>
                                </div>
                              ))}
                            </div>
                          </div>
                        </div>
                      </>
                    ) : (
                      <div className="text-center py-16 bg-amber-50 rounded-2xl border-2 border-amber-200">
                        <Activity className="w-16 h-16 text-amber-400 mx-auto mb-4" />
                        <h3 className="text-xl font-bold text-amber-800 mb-2">Ù„Ù… ÙŠØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± Ø¨Ø¹Ø¯</h3>
                        <p className="text-amber-600 mb-6">Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ù…Ø­Ø±Ùƒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©</p>
                        <button onClick={() => handleRunImpactAssessment(selectedChange)}
                          className="px-8 py-3 bg-amber-500 text-white rounded-xl font-bold">
                          <Activity className="w-5 h-5 inline ml-2" />ØªØ´ØºÙŠÙ„ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±
                        </button>
                      </div>
                    )}
                  </div>
                )}

                {/* Actions Tab */}
                {changeTab === 'actions' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800">Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° - Action Plan</h4>
                      <button onClick={handleAddAction}
                        className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold">
                        <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡
                      </button>
                    </div>

                    {/* Progress Overview */}
                    {selectedChange.actions?.length > 0 && (
                      <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-200 mb-4">
                        <div className="flex items-center justify-between mb-2">
                          <span className="font-bold text-emerald-800">ØªÙ‚Ø¯Ù… Ø§Ù„ØªÙ†ÙÙŠØ°</span>
                          <span className="text-sm text-emerald-700">
                            {selectedChange.actions.filter(a => a.status === 'Done').length} / {selectedChange.actions.length} Ø¥Ø¬Ø±Ø§Ø¡ Ù…ÙƒØªÙ…Ù„
                          </span>
                        </div>
                        <div className="h-3 bg-white rounded-full overflow-hidden">
                          <div className="h-full bg-emerald-500 rounded-full transition-all"
                            style={{ width: `${(selectedChange.actions.filter(a => a.status === 'Done').length / selectedChange.actions.length) * 100}%` }}></div>
                        </div>
                      </div>
                    )}

                    {selectedChange.actions?.length > 0 ? (
                      <div className="space-y-3">
                        {selectedChange.actions.map(action => {
                          const typeCfg = ACTION_TYPE_CONFIG[action.type];
                          const TypeIcon = typeCfg?.icon || Zap;
                          const statusColors = {
                            Open: 'bg-slate-100 text-slate-700',
                            InProgress: 'bg-blue-100 text-blue-700',
                            Done: 'bg-emerald-100 text-emerald-700',
                          };
                          return (
                            <div key={action.id} className={`rounded-xl border-2 p-4 ${action.status === 'Done' ? 'bg-emerald-50 border-emerald-200' : 'bg-white border-slate-200'}`}>
                              <div className="flex items-start justify-between">
                                <div className="flex items-start gap-3">
                                  <div className={`w-10 h-10 rounded-xl bg-${typeCfg?.color}-100 flex items-center justify-center`}>
                                    <TypeIcon className={`w-5 h-5 text-${typeCfg?.color}-600`} />
                                  </div>
                                  <div>
                                    <div className="flex items-center gap-2 mb-1">
                                      <span className={`px-2 py-0.5 bg-${typeCfg?.color}-100 text-${typeCfg?.color}-700 rounded text-xs font-bold`}>{typeCfg?.label}</span>
                                      <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusColors[action.status]}`}>
                                        {action.status === 'Done' ? 'Ù…ÙƒØªÙ…Ù„' : action.status === 'InProgress' ? 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°' : 'Ù…ÙØªÙˆØ­'}
                                      </span>
                                    </div>
                                    <p className="text-slate-800">{action.description}</p>
                                    <div className="flex items-center gap-4 mt-2 text-xs text-slate-500">
                                      <span>Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: {getUser(action.ownerId)?.name}</span>
                                      <span>Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: {action.dueDate}</span>
                                    </div>
                                  </div>
                                </div>
                                {action.status !== 'Done' && (
                                  <div className="flex items-center gap-2">
                                    {action.status === 'Open' && (
                                      <button onClick={() => handleUpdateActionStatus(action.id, 'InProgress')}
                                        className="px-3 py-1.5 bg-blue-500 text-white rounded-lg text-sm font-bold">
                                        Ø¨Ø¯Ø¡
                                      </button>
                                    )}
                                    <button onClick={() => handleUpdateActionStatus(action.id, 'Done')}
                                      className="flex items-center gap-1 px-3 py-1.5 bg-emerald-500 text-white rounded-lg text-sm font-bold">
                                      <Check className="w-4 h-4" />Ø¥ÙƒÙ…Ø§Ù„
                                    </button>
                                  </div>
                                )}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <Zap className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…Ø³Ø¬Ù„Ø©</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Evidence Tab */}
                {changeTab === 'evidence' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800">Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚</h4>
                      <button className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold">
                        <Upload className="w-5 h-5" />Ø±ÙØ¹ Ø¯Ù„ÙŠÙ„
                      </button>
                    </div>
                    {selectedChange.closureEvidence?.length > 0 ? (
                      <div className="space-y-3">
                        {selectedChange.closureEvidence.map(ev => (
                          <div key={ev.id} className="flex items-center gap-4 p-4 bg-emerald-50 rounded-xl border border-emerald-200">
                            <CheckCircle2 className="w-6 h-6 text-emerald-500" />
                            <div>
                              <p className="font-bold text-slate-800">Ø¯Ù„ÙŠÙ„ #{ev.evidenceId}</p>
                              <p className="text-sm text-slate-500">Ù‚Ø¨ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø©: {getUser(ev.acceptedBy)?.name} ÙÙŠ {ev.acceptedAt}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <FileCheck className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯Ù„Ø© Ø¥ØºÙ„Ø§Ù‚</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Audit Tab */}
                {changeTab === 'audit' && (
                  <div className="space-y-4">
                    <h4 className="font-bold text-slate-800 mb-4">Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ - Audit Trail</h4>
                    <div className="relative">
                      <div className="absolute right-4 top-0 bottom-0 w-0.5 bg-slate-200"></div>
                      <div className="space-y-4">
                        {[
                          { date: selectedChange.createdAt, action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØºÙŠÙŠØ±', user: selectedChange.createdBy, icon: Plus, color: 'indigo' },
                          selectedChange.impact?.assessedAt && { date: selectedChange.impact.assessedAt, action: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø±', user: selectedChange.impact.assessorId, icon: Activity, color: 'amber' },
                          selectedChange.closedAt && { date: selectedChange.closedAt, action: 'Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØºÙŠÙŠØ±', user: selectedChange.closedBy, icon: CheckCircle2, color: 'emerald' },
                        ].filter(Boolean).map((entry, idx) => {
                          const Icon = entry.icon;
                          return (
                            <div key={idx} className="relative flex gap-4 pr-8">
                              <div className={`absolute right-2 w-5 h-5 rounded-full bg-${entry.color}-500 flex items-center justify-center`}>
                                <Icon className="w-3 h-3 text-white" />
                              </div>
                              <div className={`flex-1 bg-${entry.color}-50 rounded-xl p-4 border border-${entry.color}-200`}>
                                <div className="flex items-center justify-between mb-1">
                                  <span className={`font-bold text-${entry.color}-700`}>{entry.action}</span>
                                  <span className="text-sm text-slate-500">{entry.date}</span>
                                </div>
                                <p className="text-slate-600 text-sm">Ø¨ÙˆØ§Ø³Ø·Ø©: {getUser(entry.user)?.name}</p>
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            TAB: TIMELINE VIEW
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'timeline' && (
          <div className="p-6">
            <h3 className="font-bold text-slate-800 mb-6">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©</h3>
            <div className="relative">
              <div className="absolute right-8 top-0 bottom-0 w-1 bg-gradient-to-b from-indigo-500 via-purple-500 to-emerald-500 rounded-full"></div>
              <div className="space-y-6 pr-16">
                {changes.sort((a, b) => new Date(b.effectiveDate) - new Date(a.effectiveDate)).map(change => {
                  const typeCfg = CHANGE_TYPE_CONFIG[change.changeType];
                  const sevCfg = SEVERITY_CONFIG[change.severity];
                  const statusCfg = STATUS_CONFIG[change.status];
                  const auth = getAuthority(change.authorityId);
                  const days = getDaysUntilEffective(change.effectiveDate);
                  const TypeIcon = typeCfg?.icon || FileText;

                  return (
                    <div key={change.id} className="relative flex gap-6">
                      <div className={`absolute right-5 w-6 h-6 rounded-full ${typeCfg?.bg} border-4 border-white shadow-lg flex items-center justify-center`}>
                        <TypeIcon className="w-3 h-3 text-white" />
                      </div>
                      <div className={`flex-1 bg-white rounded-2xl border-2 ${sevCfg?.border} p-5 hover:shadow-lg cursor-pointer transition-all`}
                        onClick={() => handleViewChange(change)}>
                        <div className="flex items-start justify-between mb-3">
                          <div>
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-mono text-sm font-bold text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded">{change.code}</span>
                              <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                                <TypeIcon className="w-3 h-3" />{typeCfg?.label}
                              </span>
                              <span className={`px-2 py-0.5 rounded text-xs font-bold ${sevCfg?.light} ${sevCfg?.text}`}>{sevCfg?.label}</span>
                              <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                                {React.createElement(statusCfg?.icon || Clock, { className: "w-3 h-3" })}
                                {statusCfg?.label}
                              </span>
                            </div>
                            <h4 className="font-bold text-slate-800 text-lg">{change.title}</h4>
                          </div>
                          <div className="text-left">
                            <div className={`px-3 py-1 rounded-lg text-center ${days !== null && days >= 0 && days <= 30 ? 'bg-amber-100' : days !== null && days < 0 ? 'bg-emerald-100' : 'bg-slate-100'}`}>
                              <p className={`text-lg font-bold ${days !== null && days >= 0 && days <= 30 ? 'text-amber-700' : days !== null && days < 0 ? 'text-emerald-700' : 'text-slate-700'}`}>
                                {days !== null && days >= 0 ? days : 'Ù†Ø§ÙØ°'}
                              </p>
                              <p className="text-xs text-slate-500">{days !== null && days >= 0 ? 'ÙŠÙˆÙ…' : ''}</p>
                            </div>
                            <p className="text-xs text-slate-500 mt-1">{change.effectiveDate}</p>
                          </div>
                        </div>
                        <p className="text-slate-600 mb-4 line-clamp-2">{change.description}</p>
                        <div className="flex items-center gap-4 text-sm text-slate-500">
                          <span className="flex items-center gap-1"><Building2 className="w-4 h-4" />{auth?.code}</span>
                          {change.impact && (
                            <>
                              <span className="flex items-center gap-1"><ClipboardCheck className="w-4 h-4" />{change.impact.obligationsCount} Ø§Ù„ØªØ²Ø§Ù…</span>
                              <span className="flex items-center gap-1"><Shield className="w-4 h-4" />{change.impact.controlsCount} Ø¶Ø§Ø¨Ø·</span>
                            </>
                          )}
                          {change.actions?.length > 0 && (
                            <span className="flex items-center gap-1">
                              <Zap className="w-4 h-4" />
                              {change.actions.filter(a => a.status === 'Done').length}/{change.actions.length} Ø¥Ø¬Ø±Ø§Ø¡
                            </span>
                          )}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        )}
      </div>


      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          CHANGE WIZARD MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'change' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden">
            {/* Header */}
            <div className="bg-gradient-to-l from-indigo-500 via-purple-500 to-pink-500 px-8 py-6 text-white">
              <div className="flex items-center justify-between mb-6">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <RefreshCw className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">{modalMode === 'create' ? 'ØªØ³Ø¬ÙŠÙ„ ØªØºÙŠÙŠØ± ØªÙ†Ø¸ÙŠÙ…ÙŠ' : 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØºÙŠÙŠØ±'}</h2>
                    <p className="text-indigo-200">{formData.code}</p>
                  </div>
                </div>
                <button onClick={() => { setShowModal(false); setWizardStep(0); }} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>

              {/* Wizard Steps */}
              <div className="flex items-center justify-between">
                {[
                  { step: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText },
                  { step: 1, label: 'Ø§Ù„Ø¬Ù‡Ø© ÙˆØ§Ù„Ø¥Ø·Ø§Ø±', icon: Building2 },
                  { step: 2, label: 'Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ù…ØµØ¯Ø±', icon: Calendar },
                  { step: 3, label: 'Ø§Ù„ØªØµÙ†ÙŠÙ', icon: Tag },
                  { step: 4, label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', icon: CheckCircle2 },
                ].map((s, idx) => (
                  <div key={s.step} className="flex items-center">
                    <button onClick={() => setWizardStep(s.step)}
                      className={`flex items-center gap-2 px-3 py-2 rounded-xl transition-all ${wizardStep === s.step ? 'bg-white text-indigo-600 font-bold shadow-lg' :
                          wizardStep > s.step ? 'bg-white/30 text-white' : 'bg-white/10 text-white/60'
                        }`}>
                      <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${wizardStep === s.step ? 'bg-indigo-100' : wizardStep > s.step ? 'bg-emerald-400 text-white' : 'bg-white/10'
                        }`}>
                        {wizardStep > s.step ? <Check className="w-5 h-5" /> : <s.icon className="w-4 h-4" />}
                      </div>
                      <span className="hidden xl:inline text-sm">{s.label}</span>
                    </button>
                    {idx < 4 && <ChevronLeft className="w-4 h-4 mx-1 text-white/40" />}
                  </div>
                ))}
              </div>
            </div>

            {/* Content */}
            <div className="p-8 max-h-[55vh] overflow-y-auto">
              {/* Step 0: Basic Info */}
              {wizardStep === 0 && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-200">
                    <h3 className="text-lg font-bold text-indigo-800 mb-4 flex items-center gap-2">
                      <FileText className="w-5 h-5" />Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                    </h3>
                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØºÙŠÙŠØ± *</label>
                        <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl text-lg focus:border-indigo-400 focus:outline-none bg-white"
                          placeholder="Ù…Ø«Ø§Ù„: ØªØ­Ø¯ÙŠØ« Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©" />
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØµÙ Ø§Ù„ØªØºÙŠÙŠØ± *</label>
                        <textarea rows={4} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-indigo-400 focus:outline-none bg-white resize-none"
                          placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„ØªØºÙŠÙŠØ± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ..." />
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Step 1: Authority & Framework */}
              {wizardStep === 1 && (
                <div className="space-y-6">
                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200">
                      <h3 className="text-lg font-bold text-emerald-800 mb-4 flex items-center gap-2">
                        <Building2 className="w-5 h-5" />Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© *
                      </h3>
                      <div className="space-y-2">
                        {AUTHORITIES.slice(0, 5).map(auth => {
                          const isSelected = formData.authorityId === auth.id;
                          return (
                            <button key={auth.id} onClick={() => setFormData({ ...formData, authorityId: auth.id })}
                              className={`w-full flex items-center gap-3 p-4 rounded-xl border-2 transition-all text-right ${isSelected ? 'border-emerald-500 bg-emerald-100' : 'border-slate-200 hover:border-emerald-300 bg-white'
                                }`}>
                              <div className={`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg ${isSelected ? 'bg-emerald-500 text-white' : 'bg-slate-200 text-slate-600'
                                }`}>
                                {auth.code.substring(0, 2)}
                              </div>
                              <div>
                                <p className="font-bold text-slate-800">{auth.code}</p>
                                <p className="text-sm text-slate-500">{auth.nameAr}</p>
                              </div>
                              {isSelected && <CheckCircle2 className="w-5 h-5 text-emerald-500 mr-auto" />}
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-200">
                      <h3 className="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                        <BookOpen className="w-5 h-5" />Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
                      </h3>
                      <select value={formData.frameworkId || ''} onChange={(e) => setFormData({ ...formData, frameworkId: parseInt(e.target.value) || '' })}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl bg-white mb-4">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø·Ø§Ø±</option>
                        {FRAMEWORKS.filter(f => !formData.authorityId || f.authorityId === formData.authorityId).map(f =>
                          <option key={f.id} value={f.id}>{f.code} - {f.nameAr}</option>
                        )}
                      </select>
                    </div>
                  </div>
                </div>
              )}

              {/* Step 2: Dates & Source */}
              {wizardStep === 2 && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200">
                    <h3 className="text-lg font-bold text-amber-800 mb-4 flex items-center gap-2">
                      <Calendar className="w-5 h-5" />Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ù…ØµØ¯Ø±
                    </h3>
                    <div className="grid grid-cols-2 gap-4 mb-4">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± *</label>
                        <input type="date" value={formData.issueDate || ''} onChange={(e) => setFormData({ ...formData, issueDate: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-amber-400 focus:outline-none bg-white" />
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†ÙØ§Ø° *</label>
                        <input type="date" value={formData.effectiveDate || ''} onChange={(e) => setFormData({ ...formData, effectiveDate: e.target.value })}
                          className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-amber-400 focus:outline-none bg-white" />
                      </div>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                      <input type="url" value={formData.sourceLink || ''} onChange={(e) => setFormData({ ...formData, sourceLink: e.target.value })}
                        className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl focus:border-amber-400 focus:outline-none bg-white"
                        placeholder="https://..." dir="ltr" />
                    </div>
                  </div>
                </div>
              )}

              {/* Step 3: Classification */}
              {wizardStep === 3 && (
                <div className="space-y-6">
                  {/* Change Type */}
                  <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 border border-purple-200">
                    <h3 className="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                      <Tag className="w-5 h-5" />Ù†ÙˆØ¹ Ø§Ù„ØªØºÙŠÙŠØ± *
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      {Object.entries(CHANGE_TYPE_CONFIG).map(([key, cfg]) => {
                        const isSelected = formData.changeType === key;
                        const TypeIcon = cfg.icon;
                        return (
                          <button key={key} onClick={() => setFormData({ ...formData, changeType: key })}
                            className={`p-5 rounded-2xl border-2 transition-all text-center ${isSelected ? `border-purple-500 ${cfg.light} shadow-lg` : 'border-slate-200 bg-white hover:border-purple-300'
                              }`}>
                            <div className={`w-12 h-12 rounded-xl mx-auto mb-2 flex items-center justify-center ${isSelected ? cfg.bg + ' text-white' : 'bg-slate-100 text-slate-600'}`}>
                              <TypeIcon className="w-6 h-6" />
                            </div>
                            <p className="font-bold text-slate-800">{cfg.label}</p>
                          </button>
                        );
                      })}
                    </div>
                  </div>

                  {/* Severity */}
                  <div className="bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-6 border border-red-200">
                    <h3 className="text-lg font-bold text-red-800 mb-4 flex items-center gap-2">
                      <AlertTriangle className="w-5 h-5" />Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù‡Ù…ÙŠØ© *
                    </h3>
                    <div className="grid grid-cols-4 gap-4">
                      {Object.entries(SEVERITY_CONFIG).map(([key, cfg]) => {
                        const isSelected = formData.severity === key;
                        return (
                          <button key={key} onClick={() => setFormData({ ...formData, severity: key })}
                            className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? `${cfg.border} ${cfg.light} shadow-lg` : 'border-slate-200 bg-white hover:border-slate-400'
                              }`}>
                            <div className={`w-10 h-10 rounded-xl mx-auto mb-2 flex items-center justify-center ${isSelected ? cfg.bg + ' text-white' : 'bg-slate-100'}`}>
                              <AlertCircle className="w-5 h-5" />
                            </div>
                            <p className="font-bold text-slate-800">{cfg.label}</p>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                </div>
              )}

              {/* Step 4: Review */}
              {wizardStep === 4 && (
                <div className="space-y-6">
                  <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-6 border border-indigo-200">
                    <h3 className="text-lg font-bold text-indigo-800 mb-6 flex items-center gap-2">
                      <CheckCircle2 className="w-5 h-5" />Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØºÙŠÙŠØ±
                    </h3>
                    <div className="grid grid-cols-2 gap-6">
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯:</span><span className="font-bold">{formData.code}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span><span className="font-bold text-left max-w-[200px] truncate">{formData.title || '-'}</span></div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ø¬Ù‡Ø© ÙˆØ§Ù„Ø¥Ø·Ø§Ø±</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¬Ù‡Ø©:</span><span className="font-bold">{getAuthority(formData.authorityId)?.code || '-'}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¥Ø·Ø§Ø±:</span><span className="font-bold">{FRAMEWORKS.find(f => f.id === formData.frameworkId)?.code || '-'}</span></div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</span><span className="font-bold">{formData.issueDate}</span></div>
                          <div className="flex justify-between"><span className="text-slate-500">Ø§Ù„Ù†ÙØ§Ø°:</span><span className="font-bold">{formData.effectiveDate}</span></div>
                        </div>
                      </div>
                      <div className="bg-white rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„ØªØµÙ†ÙŠÙ</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between">
                            <span className="text-slate-500">Ø§Ù„Ù†ÙˆØ¹:</span>
                            <span className={`font-bold px-2 py-0.5 rounded ${CHANGE_TYPE_CONFIG[formData.changeType]?.light} ${CHANGE_TYPE_CONFIG[formData.changeType]?.text}`}>
                              {CHANGE_TYPE_CONFIG[formData.changeType]?.label}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-slate-500">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©:</span>
                            <span className={`font-bold px-2 py-0.5 rounded ${SEVERITY_CONFIG[formData.severity]?.light} ${SEVERITY_CONFIG[formData.severity]?.text}`}>
                              {SEVERITY_CONFIG[formData.severity]?.label}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Footer */}
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex items-center justify-between">
              <button onClick={() => wizardStep > 0 ? setWizardStep(wizardStep - 1) : setShowModal(false)}
                className="flex items-center gap-2 px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">
                <ChevronRight className="w-5 h-5" />{wizardStep === 0 ? 'Ø¥Ù„ØºØ§Ø¡' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
              </button>
              <div className="flex items-center gap-2">
                {[0, 1, 2, 3, 4].map(step => (
                  <div key={step} className={`w-3 h-3 rounded-full transition-all ${wizardStep === step ? 'bg-indigo-500 w-8' : wizardStep > step ? 'bg-emerald-500' : 'bg-slate-300'}`} />
                ))}
              </div>
              {wizardStep < 4 ? (
                <button onClick={() => setWizardStep(wizardStep + 1)}
                  className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl font-bold shadow-lg">
                  Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                </button>
              ) : (
                <button onClick={handleSave}
                  disabled={!formData.title || !formData.authorityId || !formData.effectiveDate}
                  className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                  <CheckCircle2 className="w-5 h-5" />ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØºÙŠÙŠØ±
                </button>
              )}
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ITEM MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'item' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-blue-500 to-indigo-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <List className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ù…ØªØ£Ø«Ø±Ø©</h2>
                    <p className="text-blue-200">Change Item</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù…ØªØ·Ù„Ø¨/Ø§Ù„Ù…Ø§Ø¯Ø© *</label>
                <input type="text" value={formData.requirementId || ''} onChange={(e) => setFormData({ ...formData, requirementId: e.target.value })}
                  className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl" placeholder="Ù…Ø«Ø§Ù„: REQ-AML-15" />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„ØªØ£Ø«ÙŠØ± *</label>
                <div className="grid grid-cols-3 gap-3">
                  {Object.entries(IMPACT_TYPE_CONFIG).map(([key, cfg]) => {
                    const isSelected = formData.impactType === key;
                    const ImpactIcon = cfg.icon;
                    return (
                      <button key={key} onClick={() => setFormData({ ...formData, impactType: key })}
                        className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? `border-${cfg.color}-500 bg-${cfg.color}-100` : 'border-slate-200 bg-white hover:border-slate-400'
                          }`}>
                        <ImpactIcon className={`w-6 h-6 mx-auto mb-2 ${isSelected ? `text-${cfg.color}-600` : 'text-slate-400'}`} />
                        <p className="font-bold text-slate-800 text-sm">{cfg.label}</p>
                      </button>
                    );
                  })}
                </div>
              </div>
              {formData.impactType !== 'Added' && (
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù†Øµ Ø§Ù„Ø³Ø§Ø¨Ù‚</label>
                  <textarea rows={2} value={formData.oldText || ''} onChange={(e) => setFormData({ ...formData, oldText: e.target.value })}
                    className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl resize-none" placeholder="Ø§Ù„Ù†Øµ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„..." />
                </div>
              )}
              {formData.impactType !== 'Removed' && (
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù†Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯</label>
                  <textarea rows={2} value={formData.newText || ''} onChange={(e) => setFormData({ ...formData, newText: e.target.value })}
                    className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl resize-none" placeholder="Ø§Ù„Ù†Øµ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„..." />
                </div>
              )}
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-8 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} className="flex items-center gap-2 px-8 py-3 bg-blue-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¯Ø©
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ACTION MODAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showModal && formData && modalType === 'action' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-emerald-500 to-teal-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Zap className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ†ÙÙŠØ°ÙŠ</h2>
                    <p className="text-emerald-200">Change Action</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ *</label>
                <div className="grid grid-cols-3 gap-3">
                  {Object.entries(ACTION_TYPE_CONFIG).map(([key, cfg]) => {
                    const isSelected = formData.type === key;
                    const TypeIcon = cfg.icon;
                    return (
                      <button key={key} onClick={() => setFormData({ ...formData, type: key })}
                        className={`p-4 rounded-xl border-2 transition-all text-center ${isSelected ? `border-${cfg.color}-500 bg-${cfg.color}-100` : 'border-slate-200 bg-white hover:border-slate-400'
                          }`}>
                        <TypeIcon className={`w-6 h-6 mx-auto mb-2 ${isSelected ? `text-${cfg.color}-600` : 'text-slate-400'}`} />
                        <p className="font-bold text-slate-800 text-sm">{cfg.label}</p>
                      </button>
                    );
                  })}
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ÙˆØµÙ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ *</label>
                <textarea rows={3} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                  className="w-full px-5 py-4 border-2 border-slate-200 rounded-2xl resize-none" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨..." />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ *</label>
                  <select value={formData.ownerId || ''} onChange={(e) => setFormData({ ...formData, ownerId: parseInt(e.target.value) || '' })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</option>
                    {USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</label>
                  <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl" />
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-8 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} className="flex items-center gap-2 px-8 py-3 bg-emerald-500 text-white rounded-xl font-bold">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const RegulatoryContact = () => {
  const [activeTab, setActiveTab] = useState('command');
  const [selectedCase, setSelectedCase] = useState(null);
  const [caseTab, setCaseTab] = useState('summary');
  const [showModal, setShowModal] = useState(false);
  const [modalType, setModalType] = useState('case');
  const [formData, setFormData] = useState(null);
  const [notification, setNotification] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterType, setFilterType] = useState('');
  const [filterPriority, setFilterPriority] = useState('');
  const [viewMode, setViewMode] = useState('table');

  const CURRENT_USER = { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' };

  const [cases, setCases] = useState([
    {
      id: 1, code: 'REG-CAS-2025-001', authorityId: 1, caseType: 'Inquiry',
      subject: 'Ø§Ø³ØªÙØ³Ø§Ø± Ø­ÙˆÙ„ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„',
      description: 'Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† SAMA Ø­ÙˆÙ„ Ø¢Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
      receivedDate: '2025-01-15', dueDate: '2025-02-15',
      priority: 'High', status: 'InProgress',
      ownerId: 1, reviewerId: 2, approverId: 3, escalationLevel: 0,
      createdAt: '2025-01-15', createdBy: 1,
      messages: [
        { id: 1, direction: 'Incoming', channel: 'Portal', messageDate: '2025-01-15', sender: 'SAMA', recipient: 'Ø§Ù„Ø´Ø±ÙƒØ©', subject: 'Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª RFI-2025-0142', summary: 'Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª AML', status: 'Received', attachments: 2, isRead: true },
        { id: 2, direction: 'Outgoing', channel: 'Portal', messageDate: '2025-01-20', sender: 'Ø§Ù„Ø´Ø±ÙƒØ©', recipient: 'SAMA', subject: 'Ø±Ø¯ Ø¹Ù„Ù‰ RFI-2025-0142', summary: 'Ø±Ø¯ Ù…Ø¨Ø¯Ø¦ÙŠ Ù…Ø¹ Ø·Ù„Ø¨ ØªÙ…Ø¯ÙŠØ¯', status: 'Sent', attachments: 1, isRead: true },
      ],
      linkedObjects: [
        { type: 'Obligation', entityId: 1, code: 'OBL-001', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©', status: 'Active' },
        { type: 'Obligation', entityId: 2, code: 'OBL-002', title: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª', status: 'Active' },
        { type: 'Test', entityId: 3, code: 'TST-015', title: 'Ø§Ø®ØªØ¨Ø§Ø± ÙØ¹Ø§Ù„ÙŠØ© Ù†Ø¸Ø§Ù… AML', status: 'Passed' },
      ],
      responsePack: { id: 1, status: 'Draft', obligationsCount: 2, evidenceCount: 0, evidenceList: [], signedOffBy: null, signedOffAt: null },
      auditTrail: [
        { date: '2025-01-15', action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', details: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©' },
      ],
    },
    {
      id: 2, code: 'REG-CAS-2025-002', authorityId: 3, caseType: 'Inspection',
      subject: 'ØªÙØªÙŠØ´ Ø¯ÙˆØ±ÙŠ Ø¹Ù„Ù‰ Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      description: 'Ø²ÙŠØ§Ø±Ø© ØªÙØªÙŠØ´ÙŠØ© Ù…Ù† Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      receivedDate: '2025-02-01', dueDate: '2025-02-28',
      priority: 'Critical', status: 'Open',
      ownerId: 3, reviewerId: 1, approverId: 3, escalationLevel: 1,
      createdAt: '2025-02-01', createdBy: 1,
      messages: [
        { id: 1, direction: 'Incoming', channel: 'Letter', messageDate: '2025-02-01', sender: 'NCA', recipient: 'Ø§Ù„Ø´Ø±ÙƒØ©', subject: 'Ø¥Ø´Ø¹Ø§Ø± Ø¨Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø©', summary: 'Ø¥Ø´Ø¹Ø§Ø± Ø±Ø³Ù…ÙŠ Ø¨Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØªÙØªÙŠØ´ÙŠØ©', status: 'Received', attachments: 3, isRead: true },
      ],
      linkedObjects: [
        { type: 'Obligation', entityId: 5, code: 'OBL-005', title: 'Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', status: 'Active' },
      ],
      responsePack: null,
      auditTrail: [{ date: '2025-02-01', action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', details: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªÙØªÙŠØ´' }],
    },
    {
      id: 3, code: 'REG-CAS-2025-003', authorityId: 4, caseType: 'ReportRequest',
      subject: 'Ø·Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
      description: 'Ø·Ù„Ø¨ SDAIA Ù„Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ',
      receivedDate: '2025-01-01', dueDate: '2025-01-31',
      priority: 'Medium', status: 'Submitted',
      ownerId: 4, reviewerId: 1, approverId: 3, escalationLevel: 0,
      createdAt: '2025-01-01', createdBy: 1,
      messages: [
        { id: 1, direction: 'Incoming', channel: 'Portal', messageDate: '2025-01-01', sender: 'SDAIA', recipient: 'Ø§Ù„Ø´Ø±ÙƒØ©', subject: 'Ø·Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ', summary: 'Ø·Ù„Ø¨ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ±', status: 'Received', attachments: 1, isRead: true },
        { id: 2, direction: 'Outgoing', channel: 'Portal', messageDate: '2025-01-28', sender: 'Ø§Ù„Ø´Ø±ÙƒØ©', recipient: 'SDAIA', subject: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ±', summary: 'ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ±', status: 'Sent', attachments: 5, isRead: true },
      ],
      linkedObjects: [{ type: 'Obligation', entityId: 4, code: 'OBL-004', title: 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', status: 'Active' }],
      responsePack: { id: 2, status: 'Sent', obligationsCount: 1, evidenceCount: 5, evidenceList: [], signedOffBy: 3, signedOffAt: '2025-01-27' },
      auditTrail: [{ date: '2025-01-01', action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', details: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ±' }],
    },
    {
      id: 4, code: 'REG-CAS-2025-004', authorityId: 1, caseType: 'ViolationNotice',
      subject: 'Ø¥Ø´Ø¹Ø§Ø± Ù…Ø®Ø§Ù„ÙØ© - ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©',
      description: 'Ø¥Ø´Ø¹Ø§Ø± Ø±Ø³Ù…ÙŠ Ù…Ù† Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ',
      receivedDate: '2025-01-20', dueDate: '2025-02-05',
      priority: 'Critical', status: 'Closed',
      ownerId: 1, reviewerId: 2, approverId: 3, escalationLevel: 0,
      createdAt: '2025-01-20', createdBy: 1,
      messages: [
        { id: 1, direction: 'Incoming', channel: 'Letter', messageDate: '2025-01-20', sender: 'SAMA', recipient: 'Ø§Ù„Ø´Ø±ÙƒØ©', subject: 'Ø¥Ø´Ø¹Ø§Ø± Ù…Ø®Ø§Ù„ÙØ©', summary: 'Ø¥Ø´Ø¹Ø§Ø± Ø±Ø³Ù…ÙŠ Ø¨Ù…Ø®Ø§Ù„ÙØ©', status: 'Received', attachments: 2, isRead: true },
        { id: 2, direction: 'Outgoing', channel: 'Letter', messageDate: '2025-01-25', sender: 'Ø§Ù„Ø´Ø±ÙƒØ©', recipient: 'SAMA', subject: 'Ø±Ø¯ Ø¹Ù„Ù‰ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©', summary: 'Ø±Ø¯ Ø±Ø³Ù…ÙŠ ÙˆØ®Ø·Ø© ØªØµØ­ÙŠØ­', status: 'Sent', attachments: 4, isRead: true },
      ],
      linkedObjects: [
        { type: 'Breach', entityId: 1, code: 'BRH-2025-001', title: 'ØªØ£Ø®Ø± ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± AML', status: 'Closed' },
        { type: 'CAPA', entityId: 1, code: 'CAPA-001', title: 'Ø®Ø·Ø© ØªØµØ­ÙŠØ­ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¥Ø¨Ù„Ø§Øº', status: 'Completed' },
      ],
      responsePack: { id: 3, status: 'Sent', obligationsCount: 2, evidenceCount: 4, evidenceList: [], signedOffBy: 3, signedOffAt: '2025-01-24' },
      closedAt: '2025-02-03', closedBy: 3, closureNotes: 'ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø¶ÙŠØ©',
      auditTrail: [{ date: '2025-01-20', action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', details: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©' }],
    },
    {
      id: 5, code: 'REG-CAS-2025-005', authorityId: 2, caseType: 'Meeting',
      subject: 'Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹ Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
      description: 'Ø§Ø¬ØªÙ…Ø§Ø¹ Ø¯ÙˆØ±ÙŠ Ù„Ù…Ù†Ø§Ù‚Ø´Ø© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥ÙØµØ§Ø­',
      receivedDate: '2025-02-10', dueDate: '2025-02-25',
      priority: 'Low', status: 'Open',
      ownerId: 5, reviewerId: 1, approverId: 3, escalationLevel: 0,
      createdAt: '2025-02-10', createdBy: 1,
      messages: [
        { id: 1, direction: 'Incoming', channel: 'Email', messageDate: '2025-02-10', sender: 'CMA', recipient: 'Ø§Ù„Ø´Ø±ÙƒØ©', subject: 'Ø¯Ø¹ÙˆØ© Ù„Ø§Ø¬ØªÙ…Ø§Ø¹', summary: 'Ø¯Ø¹ÙˆØ© Ù„Ø­Ø¶ÙˆØ± Ø§Ø¬ØªÙ…Ø§Ø¹ Ù…ØªØ§Ø¨Ø¹Ø©', status: 'Received', attachments: 1, isRead: false },
      ],
      linkedObjects: [],
      responsePack: null,
      auditTrail: [{ date: '2025-02-10', action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', details: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø¹ÙˆØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹' }],
    },
  ]);

  const CASE_TYPE_CONFIG = {
    Inquiry: { label: 'Ø§Ø³ØªÙØ³Ø§Ø±', icon: HelpCircle, bg: 'bg-blue-500', light: 'bg-blue-100', text: 'text-blue-700' },
    Inspection: { label: 'ØªÙØªÙŠØ´', icon: Search, bg: 'bg-purple-500', light: 'bg-purple-100', text: 'text-purple-700' },
    ReportRequest: { label: 'Ø·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ±', icon: FileText, bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700' },
    ViolationNotice: { label: 'Ø¥Ø´Ø¹Ø§Ø± Ù…Ø®Ø§Ù„ÙØ©', icon: AlertTriangle, bg: 'bg-red-500', light: 'bg-red-100', text: 'text-red-700' },
    Meeting: { label: 'Ø§Ø¬ØªÙ…Ø§Ø¹', icon: Users, bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700' },
  };

  const STATUS_CONFIG = {
    Open: { label: 'Ù…ÙØªÙˆØ­', icon: Inbox, bg: 'bg-slate-100', text: 'text-slate-700' },
    InProgress: { label: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù…Ù„', icon: Zap, bg: 'bg-blue-100', text: 'text-blue-700' },
    PendingApproval: { label: 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', icon: Clock, bg: 'bg-amber-100', text: 'text-amber-700' },
    Submitted: { label: 'ØªÙ… Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…', icon: Send, bg: 'bg-purple-100', text: 'text-purple-700' },
    Closed: { label: 'Ù…ØºÙ„Ù‚', icon: CheckCircle2, bg: 'bg-emerald-100', text: 'text-emerald-700' },
  };

  const PRIORITY_CONFIG = {
    Critical: { label: 'Ø­Ø±Ø¬', bg: 'bg-red-600', light: 'bg-red-100', text: 'text-red-700' },
    High: { label: 'Ø¹Ø§Ù„ÙŠ', bg: 'bg-orange-500', light: 'bg-orange-100', text: 'text-orange-700' },
    Medium: { label: 'Ù…ØªÙˆØ³Ø·', bg: 'bg-amber-500', light: 'bg-amber-100', text: 'text-amber-700' },
    Low: { label: 'Ù…Ù†Ø®ÙØ¶', bg: 'bg-emerald-500', light: 'bg-emerald-100', text: 'text-emerald-700' },
  };

  const CHANNEL_CONFIG = {
    Email: { label: 'Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', icon: Mail },
    Portal: { label: 'Ø¨ÙˆØ§Ø¨Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', icon: Globe },
    Letter: { label: 'Ø®Ø·Ø§Ø¨ Ø±Ø³Ù…ÙŠ', icon: FileText },
    Meeting: { label: 'Ø§Ø¬ØªÙ…Ø§Ø¹', icon: Users },
    Phone: { label: 'Ø§ØªØµØ§Ù„ Ù‡Ø§ØªÙÙŠ', icon: PhoneCall },
  };

  const LINK_TYPE_CONFIG = {
    Obligation: { label: 'Ø§Ù„ØªØ²Ø§Ù…', icon: ClipboardCheck, bg: 'bg-emerald-100', text: 'text-emerald-700' },
    Breach: { label: 'Ù…Ø®Ø§Ù„ÙØ©', icon: AlertTriangle, bg: 'bg-red-100', text: 'text-red-700' },
    ChangeEvent: { label: 'ØªØºÙŠÙŠØ± ØªÙ†Ø¸ÙŠÙ…ÙŠ', icon: RefreshCw, bg: 'bg-indigo-100', text: 'text-indigo-700' },
    CAPA: { label: 'Ø¥Ø¬Ø±Ø§Ø¡ ØªØµØ­ÙŠØ­ÙŠ', icon: Zap, bg: 'bg-amber-100', text: 'text-amber-700' },
    Test: { label: 'Ø§Ø®ØªØ¨Ø§Ø±', icon: ClipboardList, bg: 'bg-blue-100', text: 'text-blue-700' },
    Evidence: { label: 'Ø¯Ù„ÙŠÙ„', icon: FileCheck, bg: 'bg-cyan-100', text: 'text-cyan-700' },
  };

  const COMM_USERS = [
    { id: 1, name: 'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ', role: 'Compliance Officer' },
    { id: 2, name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', role: 'Compliance Reviewer' },
    { id: 3, name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', role: 'Compliance Approver' },
    { id: 4, name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', role: 'DPO' },
    { id: 5, name: 'Ø³Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ', role: 'Governance Analyst' },
  ];

  const stats = useMemo(() => {
    const now = new Date();
    const open = cases.filter(c => c.status === 'Open').length;
    const inProgress = cases.filter(c => c.status === 'InProgress').length;
    const submitted = cases.filter(c => c.status === 'Submitted').length;
    const closed = cases.filter(c => c.status === 'Closed').length;
    const critical = cases.filter(c => c.priority === 'Critical' && c.status !== 'Closed').length;
    const overdue = cases.filter(c => {
      if (c.status === 'Closed' || c.status === 'Submitted') return false;
      return new Date(c.dueDate) < now;
    }).length;
    const dueIn7Days = cases.filter(c => {
      if (c.status === 'Closed' || c.status === 'Submitted') return false;
      const days = Math.ceil((new Date(c.dueDate) - now) / (1000 * 60 * 60 * 24));
      return days >= 0 && days <= 7;
    }).length;
    const pendingApproval = cases.filter(c => c.responsePack && c.responsePack.status === 'Draft').length;
    const totalMessages = cases.reduce((sum, c) => sum + (c.messages?.length || 0), 0);
    const incomingMessages = cases.reduce((sum, c) => sum + (c.messages?.filter(m => m.direction === 'Incoming').length || 0), 0);
    const outgoingMessages = cases.reduce((sum, c) => sum + (c.messages?.filter(m => m.direction === 'Outgoing').length || 0), 0);
    const unreadMessages = cases.reduce((sum, c) => sum + (c.messages?.filter(m => m.direction === 'Incoming' && !m.isRead).length || 0), 0);
    return { total: cases.length, open, inProgress, submitted, closed, critical, overdue, dueIn7Days, pendingApproval, totalMessages, incomingMessages, outgoingMessages, unreadMessages, activeCases: open + inProgress };
  }, [cases]);

  const showNotification = (message, type = 'success') => {
    setNotification({ message, type });
    setTimeout(() => setNotification(null), 3000);
  };

  const getUser = (id) => COMM_USERS.find(u => u.id === id);
  const getAuthority = (id) => AUTHORITIES.find(a => a.id === id);

  const getDaysUntilDue = (date) => {
    if (!date) return null;
    return Math.ceil((new Date(date) - new Date()) / (1000 * 60 * 60 * 24));
  };

  const filteredCases = useMemo(() => {
    return cases.filter(c => {
      if (searchQuery) {
        const q = searchQuery.toLowerCase();
        if (!c.code.toLowerCase().includes(q) && !c.subject.toLowerCase().includes(q)) return false;
      }
      if (filterStatus && c.status !== filterStatus) return false;
      if (filterType && c.caseType !== filterType) return false;
      if (filterPriority && c.priority !== filterPriority) return false;
      return true;
    });
  }, [cases, searchQuery, filterStatus, filterType, filterPriority]);

  const handleCreateCase = () => {
    setFormData({
      id: null, code: `REG-CAS-2025-${String(cases.length + 1).padStart(3, '0')}`,
      authorityId: '', caseType: 'Inquiry', subject: '', description: '',
      receivedDate: new Date().toISOString().split('T')[0], dueDate: '',
      priority: 'Medium', status: 'Open',
      ownerId: CURRENT_USER.id, reviewerId: '', approverId: '',
      escalationLevel: 0, messages: [], linkedObjects: [], responsePack: null, auditTrail: [],
    });
    setModalType('case');
    setShowModal(true);
  };

  const handleEditCase = (caseItem) => {
    setFormData({ ...caseItem });
    setModalType('case');
    setShowModal(true);
  };

  const handleDeleteCase = (caseItem) => {
    if (window.confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù‚Ø¶ÙŠØ© ${caseItem.code}ØŸ`)) {
      setCases(cases.filter(c => c.id !== caseItem.id));
      if (selectedCase?.id === caseItem.id) {
        setSelectedCase(null);
        setActiveTab('register');
      }
      showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù‚Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
    }
  };

  const handleViewCase = (caseItem) => {
    setSelectedCase(caseItem);
    setCaseTab('summary');
    setActiveTab('workspace');
  };

  const handleAddMessage = () => {
    if (!selectedCase) return;
    setFormData({
      id: null, direction: 'Outgoing', channel: 'Email',
      messageDate: new Date().toISOString().split('T')[0],
      sender: 'Ø§Ù„Ø´Ø±ÙƒØ©', recipient: getAuthority(selectedCase.authorityId)?.nameAr || '',
      subject: '', summary: '', status: 'Draft', attachments: 0, isRead: false
    });
    setModalType('message');
    setShowModal(true);
  };

  const handleEditMessage = (msg) => {
    setFormData({ ...msg });
    setModalType('message');
    setShowModal(true);
  };

  const handleDeleteMessage = (msgId) => {
    if (!selectedCase || !window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŸ')) return;
    const updatedCase = {
      ...selectedCase,
      messages: selectedCase.messages.filter(m => m.id !== msgId),
      auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø­Ø°Ù Ø±Ø³Ø§Ù„Ø©', user: CURRENT_USER.name, details: '' }]
    };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©');
  };

  const handleSendMessage = (msgId) => {
    if (!selectedCase) return;
    const updatedCase = {
      ...selectedCase,
      messages: selectedCase.messages.map(m => m.id === msgId ? { ...m, status: 'Sent' } : m),
      auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©', user: CURRENT_USER.name, details: '' }]
    };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©');
  };

  const handleAddLink = () => {
    if (!selectedCase) return;
    setFormData({ type: 'Obligation', entityId: '', code: '', title: '', status: 'Active' });
    setModalType('link');
    setShowModal(true);
  };

  const handleEditLink = (link, idx) => {
    if (!selectedCase) return;
    setFormData({ ...link, _idx: idx });
    setModalType('link');
    setShowModal(true);
  };

  const handleUnlinkObject = (linkIdx) => {
    if (!selectedCase || !window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¨Ø·ØŸ')) return;
    const updatedCase = {
      ...selectedCase,
      linkedObjects: selectedCase.linkedObjects.filter((_, idx) => idx !== linkIdx),
      auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ù„ØºØ§Ø¡ Ø±Ø¨Ø·', user: CURRENT_USER.name, details: '' }]
    };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø·');
  };

  const handleCreateResponsePack = () => {
    if (!selectedCase) return;
    const responsePack = {
      id: Date.now(), status: 'Draft',
      obligationsCount: selectedCase.linkedObjects?.filter(l => l.type === 'Obligation').length || 0,
      evidenceCount: 0, evidenceList: [], signedOffBy: null, signedOffAt: null
    };
    const updatedCase = { ...selectedCase, responsePack, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯', user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
  };

  const handleAddEvidence = () => {
    if (!selectedCase) return;
    setFormData({ evidenceCode: '', evidenceTitle: '', evidenceType: 'Document', evidenceStatus: 'Accepted' });
    setModalType('evidence');
    setShowModal(true);
  };

  const handleRemoveEvidence = (evidenceId) => {
    if (!selectedCase?.responsePack || !window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø²Ø§Ù„Ø© Ù‡Ø°Ø§ Ø§Ù„Ø¯Ù„ÙŠÙ„ØŸ')) return;
    const updatedEvidenceList = selectedCase.responsePack.evidenceList.filter(e => e.id !== evidenceId);
    const updatedPack = { ...selectedCase.responsePack, evidenceCount: updatedEvidenceList.length, evidenceList: updatedEvidenceList };
    const updatedCase = { ...selectedCase, responsePack: updatedPack, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ø²Ø§Ù„Ø© Ø¯Ù„ÙŠÙ„', user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„');
  };

  const handleDeleteResponsePack = () => {
    if (!selectedCase?.responsePack || !window.confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ØŸ')) return;
    const updatedCase = { ...selectedCase, responsePack: null, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø­Ø°Ù Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯', user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø­Ø°Ù Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯');
  };

  const handleApproveResponsePack = () => {
    if (!selectedCase?.responsePack) return;
    const updatedPack = { ...selectedCase.responsePack, status: 'Approved', signedOffBy: CURRENT_USER.id, signedOffAt: new Date().toISOString().split('T')[0] };
    const updatedCase = { ...selectedCase, responsePack: updatedPack, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø§Ø¹ØªÙ…Ø§Ø¯ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯', user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
  };

  const handleSubmitResponse = () => {
    if (!selectedCase?.responsePack || selectedCase.responsePack.status !== 'Approved') {
      showNotification('ÙŠØ¬Ø¨ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    const updatedPack = { ...selectedCase.responsePack, status: 'Sent' };
    const updatedCase = { ...selectedCase, responsePack: updatedPack, status: 'Submitted', auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±Ø¯', user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
    setSelectedCase(updatedCase);
    showNotification('ØªÙ… ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø¬Ø§Ø­');
  };

  const handleUpdateStatus = (caseItem, newStatus) => {
    const updatedCase = { ...caseItem, status: newStatus, auditTrail: [...(caseItem.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: `ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰ ${STATUS_CONFIG[newStatus]?.label}`, user: CURRENT_USER.name, details: '' }] };
    if (newStatus === 'Closed') {
      updatedCase.closedAt = new Date().toISOString().split('T')[0];
      updatedCase.closedBy = CURRENT_USER.id;
    }
    setCases(cases.map(c => c.id === caseItem.id ? updatedCase : c));
    if (selectedCase?.id === caseItem.id) setSelectedCase(updatedCase);
    showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ù„Ù‰: ${STATUS_CONFIG[newStatus]?.label}`);
  };

  const handleEscalate = (caseItem) => {
    const newLevel = (caseItem.escalationLevel || 0) + 1;
    const updatedCase = { ...caseItem, escalationLevel: newLevel, auditTrail: [...(caseItem.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: `Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${newLevel}`, user: CURRENT_USER.name, details: '' }] };
    setCases(cases.map(c => c.id === caseItem.id ? updatedCase : c));
    if (selectedCase?.id === caseItem.id) setSelectedCase(updatedCase);
    showNotification(`ØªÙ… Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${newLevel}`);
  };

  const handleSave = () => {
    if (modalType === 'case') {
      if (!formData.subject || !formData.authorityId || !formData.dueDate) {
        showNotification('Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ ÙˆØ§Ù„Ø¬Ù‡Ø© ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†', 'error');
        return;
      }
      if (formData.id) {
        const updatedCase = { ...formData, auditTrail: [...(formData.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: CURRENT_USER.name, details: '' }] };
        setCases(cases.map(c => c.id === formData.id ? updatedCase : c));
        if (selectedCase?.id === formData.id) setSelectedCase(updatedCase);
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        const newCase = { ...formData, id: Date.now(), auditTrail: [{ date: new Date().toISOString().split('T')[0], action: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©', user: CURRENT_USER.name, details: '' }] };
        setCases([...cases, newCase]);
        showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
      }
    } else if (modalType === 'message') {
      if (!formData.subject || !formData.summary) {
        showNotification('Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ ÙˆØ§Ù„Ù…Ù„Ø®Øµ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
        return;
      }
      if (formData.id) {
        const updatedCase = { ...selectedCase, messages: selectedCase.messages.map(m => m.id === formData.id ? formData : m), auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'ØªØ¹Ø¯ÙŠÙ„ Ø±Ø³Ø§Ù„Ø©', user: CURRENT_USER.name, details: '' }] };
        setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
        setSelectedCase(updatedCase);
        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
      } else {
        const newMessage = { ...formData, id: Date.now(), status: formData.direction === 'Outgoing' ? 'Draft' : 'Received' };
        const updatedCase = { ...selectedCase, messages: [...(selectedCase.messages || []), newMessage], auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø©', user: CURRENT_USER.name, details: '' }] };
        setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
        setSelectedCase(updatedCase);
        showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
      }
    } else if (modalType === 'link') {
      if (!formData.code || !formData.title) {
        showNotification('Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
        return;
      }
      const newLink = { type: formData.type, entityId: formData.entityId || Date.now(), code: formData.code, title: formData.title, status: formData.status };
      let updatedLinks;
      if (formData._idx !== undefined) {
        updatedLinks = selectedCase.linkedObjects.map((l, idx) => idx === formData._idx ? newLink : l);
      } else {
        updatedLinks = [...(selectedCase.linkedObjects || []), newLink];
      }
      const updatedCase = { ...selectedCase, linkedObjects: updatedLinks, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: formData._idx !== undefined ? 'ØªØ¹Ø¯ÙŠÙ„ Ø±Ø¨Ø·' : 'Ø¥Ø¶Ø§ÙØ© Ø±Ø¨Ø·', user: CURRENT_USER.name, details: '' }] };
      setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
      setSelectedCase(updatedCase);
      showNotification(formData._idx !== undefined ? 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­' : 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­');
    } else if (modalType === 'evidence') {
      if (!formData.evidenceCode || !formData.evidenceTitle) {
        showNotification('Ø§Ù„ÙƒÙˆØ¯ ÙˆØ§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨Ø§Ù†', 'error');
        return;
      }
      const newEvidence = { id: Date.now(), code: formData.evidenceCode, title: formData.evidenceTitle, type: formData.evidenceType, status: formData.evidenceStatus };
      const updatedPack = { ...selectedCase.responsePack, evidenceCount: (selectedCase.responsePack.evidenceCount || 0) + 1, evidenceList: [...(selectedCase.responsePack.evidenceList || []), newEvidence] };
      const updatedCase = { ...selectedCase, responsePack: updatedPack, auditTrail: [...(selectedCase.auditTrail || []), { date: new Date().toISOString().split('T')[0], action: 'Ø¥Ø¶Ø§ÙØ© Ø¯Ù„ÙŠÙ„', user: CURRENT_USER.name, details: '' }] };
      setCases(cases.map(c => c.id === selectedCase.id ? updatedCase : c));
      setSelectedCase(updatedCase);
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
    }
    setShowModal(false);
    setFormData(null);
  };

  const mainTabs = [
    { id: 'command', label: 'Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…', icon: LayoutDashboard },
    { id: 'register', label: 'Ø³Ø¬Ù„ Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§', icon: ClipboardList, count: stats.activeCases },
    { id: 'workspace', label: 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„', icon: Briefcase, disabled: !selectedCase },
    { id: 'calendar', label: 'Ø§Ù„ØªÙ‚ÙˆÙŠÙ…', icon: Calendar },
  ];

  const caseTabs = [
    { id: 'summary', label: 'Ø§Ù„Ù…Ù„Ø®Øµ', icon: FileText },
    { id: 'thread', label: 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø§Øª', icon: MessageSquare },
    { id: 'linked', label: 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', icon: Link2 },
    { id: 'response', label: 'Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯', icon: Package },
    { id: 'audit', label: 'Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', icon: History },
  ];

  return (
    <div className="space-y-6">
      {notification && (
        <div className={`fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-3 rounded-xl shadow-lg font-bold flex items-center gap-2 ${notification.type === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'}`}>
          {notification.type === 'success' ? <CheckCircle2 className="w-5 h-5" /> : <AlertCircle className="w-5 h-5" />}
          {notification.message}
        </div>
      )}

      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4">
          <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-cyan-500 via-blue-500 to-indigo-600 flex items-center justify-center shadow-xl">
            <MessageSquare className="w-8 h-8 text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-slate-900">Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</h1>
            <p className="text-slate-500">Regulatory Communications Management</p>
          </div>
        </div>
        <div className="flex items-center gap-3">
          {stats.unreadMessages > 0 && (
            <div className="flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-xl">
              <Mail className="w-5 h-5" />
              <span className="font-bold">{stats.unreadMessages} Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
            </div>
          )}
          <button onClick={handleCreateCase} className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-600 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
            <Plus className="w-5 h-5" />Ù‚Ø¶ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
          </button>
        </div>
      </div>

      <div className="grid grid-cols-10 gap-3">
        <div className={`rounded-2xl p-3 ${stats.critical > 0 ? 'bg-red-500 animate-pulse' : 'bg-red-400'} text-white text-center`}>
          <AlertTriangle className="w-5 h-5 mx-auto mb-1" />
          <span className="text-2xl font-bold block">{stats.critical}</span>
          <span className="text-xs">Ø­Ø±Ø¬</span>
        </div>
        <div className={`rounded-2xl p-3 ${stats.overdue > 0 ? 'bg-orange-500 animate-pulse' : 'bg-orange-400'} text-white text-center`}>
          <Clock className="w-5 h-5 mx-auto mb-1" />
          <span className="text-2xl font-bold block">{stats.overdue}</span>
          <span className="text-xs">Ù…ØªØ£Ø®Ø±</span>
        </div>
        <div className="rounded-2xl p-3 bg-amber-500 text-white text-center">
          <Calendar className="w-5 h-5 mx-auto mb-1" />
          <span className="text-2xl font-bold block">{stats.dueIn7Days}</span>
          <span className="text-xs">7 Ø£ÙŠØ§Ù…</span>
        </div>
        <div className="bg-slate-100 rounded-2xl p-3 border-2 border-slate-200 text-center">
          <Inbox className="w-5 h-5 mx-auto mb-1 text-slate-500" />
          <span className="text-2xl font-bold text-slate-700 block">{stats.open}</span>
          <span className="text-xs text-slate-500">Ù…ÙØªÙˆØ­</span>
        </div>
        <div className="bg-blue-100 rounded-2xl p-3 border-2 border-blue-200 text-center">
          <Zap className="w-5 h-5 mx-auto mb-1 text-blue-600" />
          <span className="text-2xl font-bold text-blue-700 block">{stats.inProgress}</span>
          <span className="text-xs text-blue-600">Ø¬Ø§Ø±ÙŠ</span>
        </div>
        <div className="bg-amber-100 rounded-2xl p-3 border-2 border-amber-200 text-center">
          <Clock className="w-5 h-5 mx-auto mb-1 text-amber-600" />
          <span className="text-2xl font-bold text-amber-700 block">{stats.pendingApproval}</span>
          <span className="text-xs text-amber-600">Ø§Ø¹ØªÙ…Ø§Ø¯</span>
        </div>
        <div className="bg-purple-100 rounded-2xl p-3 border-2 border-purple-200 text-center">
          <Send className="w-5 h-5 mx-auto mb-1 text-purple-600" />
          <span className="text-2xl font-bold text-purple-700 block">{stats.submitted}</span>
          <span className="text-xs text-purple-600">Ù…Ù‚Ø¯Ù‘Ù…</span>
        </div>
        <div className="bg-emerald-100 rounded-2xl p-3 border-2 border-emerald-200 text-center">
          <CheckCircle2 className="w-5 h-5 mx-auto mb-1 text-emerald-600" />
          <span className="text-2xl font-bold text-emerald-700 block">{stats.closed}</span>
          <span className="text-xs text-emerald-600">Ù…ØºÙ„Ù‚</span>
        </div>
        <div className="bg-cyan-100 rounded-2xl p-3 border-2 border-cyan-200 text-center">
          <ArrowDownCircle className="w-5 h-5 mx-auto mb-1 text-cyan-600" />
          <span className="text-2xl font-bold text-cyan-700 block">{stats.incomingMessages}</span>
          <span className="text-xs text-cyan-600">ÙˆØ§Ø±Ø¯Ø©</span>
        </div>
        <div className="bg-teal-100 rounded-2xl p-3 border-2 border-teal-200 text-center">
          <ArrowUpCircle className="w-5 h-5 mx-auto mb-1 text-teal-600" />
          <span className="text-2xl font-bold text-teal-700 block">{stats.outgoingMessages}</span>
          <span className="text-xs text-teal-600">ØµØ§Ø¯Ø±Ø©</span>
        </div>
      </div>

      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden shadow-sm">
        <div className="flex border-b border-slate-200 bg-slate-50">
          {mainTabs.map(tab => (
            <button key={tab.id} onClick={() => !tab.disabled && setActiveTab(tab.id)} disabled={tab.disabled}
              className={`flex items-center gap-2 px-6 py-4 font-bold transition-all border-b-2 ${activeTab === tab.id ? 'text-cyan-600 border-cyan-500 bg-white' :
                  tab.disabled ? 'text-slate-300 border-transparent cursor-not-allowed' :
                    'text-slate-500 border-transparent hover:bg-white hover:text-slate-700'
                }`}>
              <tab.icon className="w-5 h-5" />
              {tab.label}
              {tab.count > 0 && (
                <span className={`px-2 py-0.5 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-cyan-500 text-white' : 'bg-slate-200 text-slate-600'}`}>
                  {tab.count}
                </span>
              )}
            </button>
          ))}
        </div>

        {activeTab === 'command' && (
          <div className="p-6">
            <div className="grid grid-cols-3 gap-6">
              <div className="col-span-2 bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                <div className="bg-gradient-to-r from-red-500 to-orange-500 px-5 py-3 text-white flex items-center justify-between">
                  <h3 className="font-bold flex items-center gap-2"><AlertTriangle className="w-5 h-5" />Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©</h3>
                  <span className="bg-white/20 px-3 py-1 rounded-lg text-sm">{stats.critical + stats.overdue + stats.dueIn7Days} Ù‚Ø¶ÙŠØ©</span>
                </div>
                <div className="p-4 space-y-3 max-h-80 overflow-y-auto">
                  {cases.filter(c => c.status !== 'Closed' && c.status !== 'Submitted').sort((a, b) => {
                    const priorityOrder = { Critical: 0, High: 1, Medium: 2, Low: 3 };
                    if (priorityOrder[a.priority] !== priorityOrder[b.priority]) return priorityOrder[a.priority] - priorityOrder[b.priority];
                    return new Date(a.dueDate) - new Date(b.dueDate);
                  }).slice(0, 5).map(caseItem => {
                    const days = getDaysUntilDue(caseItem.dueDate);
                    const priorityCfg = PRIORITY_CONFIG[caseItem.priority];
                    const typeCfg = CASE_TYPE_CONFIG[caseItem.caseType];
                    const auth = getAuthority(caseItem.authorityId);
                    const TypeIcon = typeCfg?.icon || FileText;
                    return (
                      <div key={caseItem.id} onClick={() => handleViewCase(caseItem)}
                        className={`flex items-center gap-4 p-4 rounded-xl cursor-pointer transition-all hover:shadow-md ${days !== null && days < 0 ? 'bg-red-50 border-2 border-red-200' :
                            days !== null && days <= 7 ? 'bg-amber-50 border-2 border-amber-200' :
                              'bg-slate-50 border-2 border-slate-200'
                          }`}>
                        <div className={`w-14 h-14 rounded-xl ${priorityCfg?.bg} flex items-center justify-center text-white font-bold shadow-lg`}>
                          {days !== null && days >= 0 ? (
                            <div className="text-center">
                              <span className="text-xl font-bold block">{days}</span>
                              <span className="text-[10px]">ÙŠÙˆÙ…</span>
                            </div>
                          ) : (
                            <AlertTriangle className="w-6 h-6" />
                          )}
                        </div>
                        <div className="flex-1 min-w-0">
                          <div className="flex items-center gap-2 mb-1">
                            <span className="font-mono text-xs font-bold text-cyan-600 bg-cyan-100 px-2 py-0.5 rounded">{caseItem.code}</span>
                            <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                              <TypeIcon className="w-3 h-3" />{typeCfg?.label}
                            </span>
                            <span className="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs font-bold">{auth?.code}</span>
                          </div>
                          <p className="font-bold text-slate-800 truncate">{caseItem.subject}</p>
                        </div>
                        <div className="text-left">
                          <p className="text-sm font-bold text-slate-700">{caseItem.dueDate}</p>
                          <p className={`text-xs font-bold ${days !== null && days < 0 ? 'text-red-600' : days !== null && days <= 7 ? 'text-amber-600' : 'text-slate-500'}`}>
                            {days !== null && days < 0 ? `Ù…ØªØ£Ø®Ø± ${Math.abs(days)} ÙŠÙˆÙ…` : days !== null ? `Ø¨Ø§Ù‚ÙŠ ${days} ÙŠÙˆÙ…` : ''}
                          </p>
                        </div>
                        <ChevronLeft className="w-5 h-5 text-slate-400" />
                      </div>
                    );
                  })}
                </div>
              </div>
              <div className="space-y-4">
                <div className="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-5 text-white">
                  <h3 className="font-bold mb-4 flex items-center gap-2"><Zap className="w-5 h-5 text-amber-400" />Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                  <div className="space-y-2">
                    <button onClick={handleCreateCase} className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <Plus className="w-5 h-5" /><span>ØªØ³Ø¬ÙŠÙ„ Ù‚Ø¶ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</span>
                    </button>
                    <button className="w-full flex items-center gap-3 p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all">
                      <Package className="w-5 h-5" /><span>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø±Ø¯</span>
                    </button>
                  </div>
                </div>
                <div className="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-2xl p-5 border border-cyan-200">
                  <h3 className="font-bold text-cyan-800 mb-4">Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©</h3>
                  <div className="space-y-2">
                    {AUTHORITIES.slice(0, 5).map(auth => {
                      const count = cases.filter(c => c.authorityId === auth.id && c.status !== 'Closed').length;
                      return (
                        <div key={auth.id} className={`flex items-center justify-between p-3 rounded-xl transition-all ${count > 0 ? 'bg-white border border-cyan-200 shadow-sm' : 'bg-white/50'}`}>
                          <span className="font-bold text-slate-700">{auth.code}</span>
                          <span className={`text-lg font-bold ${count > 0 ? 'text-cyan-600' : 'text-slate-400'}`}>{count}</span>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {activeTab === 'register' && (
          <div className="p-6">
            <div className="flex items-center gap-3 mb-6 flex-wrap">
              <div className="relative flex-1 max-w-md">
                <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                <input type="text" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                  className="w-full pr-12 pl-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none" />
              </div>
              <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                {Object.entries(STATUS_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
              </select>
              <select value={filterType} onChange={(e) => setFilterType(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                {Object.entries(CASE_TYPE_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
              </select>
              <select value={filterPriority} onChange={(e) => setFilterPriority(e.target.value)}
                className="px-4 py-3 border-2 border-slate-200 rounded-xl bg-white">
                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</option>
                {Object.entries(PRIORITY_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
              </select>
              <div className="flex items-center gap-1 bg-slate-100 p-1 rounded-xl mr-auto">
                <button onClick={() => setViewMode('table')} className={`p-2 rounded-lg transition-all ${viewMode === 'table' ? 'bg-white shadow' : 'hover:bg-white/50'}`}>
                  <LayoutList className="w-5 h-5" />
                </button>
                <button onClick={() => setViewMode('cards')} className={`p-2 rounded-lg transition-all ${viewMode === 'cards' ? 'bg-white shadow' : 'hover:bg-white/50'}`}>
                  <LayoutGrid className="w-5 h-5" />
                </button>
              </div>
            </div>

            {viewMode === 'table' && (
              <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                <table className="w-full">
                  <thead>
                    <tr className="bg-gradient-to-r from-slate-50 to-slate-100 border-b-2 border-slate-200">
                      <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                      <th className="text-right px-4 py-4 font-bold text-slate-700 min-w-[250px]">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ù†ÙˆØ¹</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</th>
                      <th className="text-center px-3 py-4 font-bold text-slate-700">Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700 w-32">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredCases.map(caseItem => {
                      const auth = getAuthority(caseItem.authorityId);
                      const typeCfg = CASE_TYPE_CONFIG[caseItem.caseType];
                      const priorityCfg = PRIORITY_CONFIG[caseItem.priority];
                      const statusCfg = STATUS_CONFIG[caseItem.status];
                      const days = getDaysUntilDue(caseItem.dueDate);
                      const TypeIcon = typeCfg?.icon || FileText;
                      const StatusIcon = statusCfg?.icon || Clock;

                      return (
                        <tr key={caseItem.id} className={`border-b border-slate-100 hover:bg-slate-50 transition-colors ${caseItem.priority === 'Critical' && caseItem.status !== 'Closed' ? 'bg-red-50/50' : ''}`}>
                          <td className="px-4 py-4">
                            <div className="flex items-center gap-2">
                              <div className={`w-1.5 h-12 rounded-full ${priorityCfg?.bg}`}></div>
                              <span className="font-mono text-sm font-bold text-cyan-600 bg-cyan-50 px-2 py-1 rounded-lg">{caseItem.code}</span>
                            </div>
                          </td>
                          <td className="px-4 py-4">
                            <div className="cursor-pointer hover:text-cyan-600" onClick={() => handleViewCase(caseItem)}>
                              <p className="font-bold text-slate-800 line-clamp-1">{caseItem.subject}</p>
                              <p className="text-xs text-slate-500 line-clamp-1">{caseItem.description}</p>
                            </div>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className="px-3 py-1.5 bg-slate-100 text-slate-700 rounded-lg text-xs font-bold">{auth?.code}</span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                              <TypeIcon className="w-3.5 h-3.5" />{typeCfg?.label}
                            </span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`px-3 py-1.5 rounded-lg text-xs font-bold ${priorityCfg?.light} ${priorityCfg?.text}`}>{priorityCfg?.label}</span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <span className={`inline-flex items-center gap-1 px-2.5 py-1.5 rounded-lg text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                              <StatusIcon className="w-3 h-3" />{statusCfg?.label}
                            </span>
                          </td>
                          <td className="px-3 py-4 text-center">
                            <div className="text-sm font-bold text-slate-700">{caseItem.dueDate}</div>
                            {days !== null && caseItem.status !== 'Closed' && caseItem.status !== 'Submitted' && (
                              <span className={`text-xs font-bold px-2 py-0.5 rounded-full ${days < 0 ? 'bg-red-100 text-red-600' : days <= 7 ? 'bg-amber-100 text-amber-600' : 'bg-slate-100 text-slate-600'
                                }`}>
                                {days < 0 ? `Ù…ØªØ£Ø®Ø± ${Math.abs(days)}` : `${days} ÙŠÙˆÙ…`}
                              </span>
                            )}
                          </td>
                          <td className="px-3 py-4 text-center">
                            <div className="flex items-center justify-center gap-2">
                              <span className="flex items-center gap-1 text-blue-600 text-sm">
                                <ArrowDownCircle className="w-4 h-4" />
                                {caseItem.messages?.filter(m => m.direction === 'Incoming').length || 0}
                              </span>
                              <span className="text-slate-300">/</span>
                              <span className="flex items-center gap-1 text-emerald-600 text-sm">
                                <ArrowUpCircle className="w-4 h-4" />
                                {caseItem.messages?.filter(m => m.direction === 'Outgoing').length || 0}
                              </span>
                            </div>
                          </td>
                          <td className="px-4 py-4">
                            <div className="flex items-center justify-center gap-1">
                              <button onClick={() => handleViewCase(caseItem)} className="p-2 hover:bg-blue-100 rounded-lg" title="Ø¹Ø±Ø¶">
                                <Eye className="w-4 h-4 text-blue-600" />
                              </button>
                              <button onClick={(e) => { e.stopPropagation(); handleEditCase(caseItem); }} className="p-2 hover:bg-amber-100 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                                <Edit className="w-4 h-4 text-amber-600" />
                              </button>
                              {caseItem.status !== 'Closed' && caseItem.escalationLevel < 3 && (
                                <button onClick={(e) => { e.stopPropagation(); handleEscalate(caseItem); }} className="p-2 hover:bg-orange-100 rounded-lg" title="ØªØµØ¹ÙŠØ¯">
                                  <TrendingUp className="w-4 h-4 text-orange-600" />
                                </button>
                              )}
                              <button onClick={(e) => { e.stopPropagation(); handleDeleteCase(caseItem); }} className="p-2 hover:bg-red-100 rounded-lg" title="Ø­Ø°Ù">
                                <Trash2 className="w-4 h-4 text-red-600" />
                              </button>
                            </div>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
                {filteredCases.length === 0 && (
                  <div className="text-center py-12 text-slate-400">
                    <Search className="w-12 h-12 mx-auto mb-2 opacity-50" />
                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>
                  </div>
                )}
              </div>
            )}

            {viewMode === 'cards' && (
              <div className="grid grid-cols-3 gap-4">
                {filteredCases.map(caseItem => {
                  const auth = getAuthority(caseItem.authorityId);
                  const typeCfg = CASE_TYPE_CONFIG[caseItem.caseType];
                  const priorityCfg = PRIORITY_CONFIG[caseItem.priority];
                  const statusCfg = STATUS_CONFIG[caseItem.status];
                  const days = getDaysUntilDue(caseItem.dueDate);
                  const TypeIcon = typeCfg?.icon || FileText;
                  const StatusIcon = statusCfg?.icon || Clock;

                  return (
                    <div key={caseItem.id} onClick={() => handleViewCase(caseItem)}
                      className={`bg-white rounded-2xl border-2 overflow-hidden cursor-pointer hover:shadow-lg transition-all ${caseItem.priority === 'Critical' && caseItem.status !== 'Closed' ? 'border-red-300 ring-2 ring-red-100' : 'border-slate-200 hover:border-cyan-300'
                        }`}>
                      <div className={`h-1.5 ${priorityCfg?.bg}`}></div>
                      <div className="p-5">
                        <div className="flex items-center justify-between mb-3">
                          <span className="font-mono text-sm font-bold text-cyan-600 bg-cyan-50 px-2 py-1 rounded">{caseItem.code}</span>
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${typeCfg?.light} ${typeCfg?.text}`}>
                            <TypeIcon className="w-3 h-3" />{typeCfg?.label}
                          </span>
                        </div>
                        <h4 className="font-bold text-slate-800 line-clamp-2 mb-3">{caseItem.subject}</h4>
                        <div className="flex flex-wrap gap-2 mb-3">
                          <span className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs font-bold">{auth?.code}</span>
                          <span className={`px-2 py-1 rounded text-xs font-bold ${priorityCfg?.light} ${priorityCfg?.text}`}>{priorityCfg?.label}</span>
                        </div>
                        <div className="flex items-center gap-4 mb-4 text-sm">
                          <span className="flex items-center gap-1 text-blue-600">
                            <ArrowDownCircle className="w-4 h-4" />
                            {caseItem.messages?.filter(m => m.direction === 'Incoming').length || 0}
                          </span>
                          <span className="flex items-center gap-1 text-emerald-600">
                            <ArrowUpCircle className="w-4 h-4" />
                            {caseItem.messages?.filter(m => m.direction === 'Outgoing').length || 0}
                          </span>
                        </div>
                        <div className="flex items-center justify-between pt-3 border-t border-slate-100">
                          <span className={`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${statusCfg?.bg} ${statusCfg?.text}`}>
                            <StatusIcon className="w-3 h-3" />{statusCfg?.label}
                          </span>
                          <span className={`text-xs font-bold ${days !== null && days < 0 ? 'text-red-600' : days !== null && days <= 7 ? 'text-amber-600' : 'text-slate-500'}`}>
                            {caseItem.dueDate}
                          </span>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        )}

        {activeTab === 'workspace' && selectedCase && (
          <div className="p-6">
            <div className={`rounded-2xl p-6 mb-6 border-2 ${PRIORITY_CONFIG[selectedCase.priority]?.light}`}>
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center gap-3 mb-2 flex-wrap">
                    <span className="font-mono text-lg font-bold text-cyan-600 bg-cyan-100 px-3 py-1 rounded-lg">{selectedCase.code}</span>
                    <span className={`inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-sm font-bold ${CASE_TYPE_CONFIG[selectedCase.caseType]?.light} ${CASE_TYPE_CONFIG[selectedCase.caseType]?.text}`}>
                      {React.createElement(CASE_TYPE_CONFIG[selectedCase.caseType]?.icon || FileText, { className: "w-4 h-4" })}
                      {CASE_TYPE_CONFIG[selectedCase.caseType]?.label}
                    </span>
                    <span className={`px-3 py-1 rounded-lg text-sm font-bold ${PRIORITY_CONFIG[selectedCase.priority]?.light} ${PRIORITY_CONFIG[selectedCase.priority]?.text}`}>
                      {PRIORITY_CONFIG[selectedCase.priority]?.label}
                    </span>
                    <span className={`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-sm font-bold ${STATUS_CONFIG[selectedCase.status]?.bg} ${STATUS_CONFIG[selectedCase.status]?.text}`}>
                      {React.createElement(STATUS_CONFIG[selectedCase.status]?.icon || Clock, { className: "w-4 h-4" })}
                      {STATUS_CONFIG[selectedCase.status]?.label}
                    </span>
                    {selectedCase.escalationLevel > 0 && (
                      <span className="flex items-center gap-1 px-3 py-1 bg-red-500 text-white rounded-lg text-sm font-bold animate-pulse">
                        <TrendingUp className="w-4 h-4" />ØªØµØ¹ÙŠØ¯ L{selectedCase.escalationLevel}
                      </span>
                    )}
                  </div>
                  <h2 className="text-xl font-bold text-slate-800 mb-2">{selectedCase.subject}</h2>
                  <div className="flex items-center gap-4 text-sm text-slate-600 flex-wrap">
                    <span className="flex items-center gap-1"><Building2 className="w-4 h-4" />{getAuthority(selectedCase.authorityId)?.nameAr}</span>
                    <span className="flex items-center gap-1"><User className="w-4 h-4" />{getUser(selectedCase.ownerId)?.name}</span>
                    <span className={`flex items-center gap-1 font-bold ${getDaysUntilDue(selectedCase.dueDate) < 0 ? 'text-red-600' : getDaysUntilDue(selectedCase.dueDate) <= 7 ? 'text-amber-600' : ''}`}>
                      <Calendar className="w-4 h-4" />{selectedCase.dueDate}
                    </span>
                  </div>
                </div>
                <div className="flex items-center gap-2 flex-wrap">
                  {selectedCase.status === 'Open' && (
                    <button onClick={() => handleUpdateStatus(selectedCase, 'InProgress')}
                      className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold hover:bg-blue-600">
                      <Zap className="w-5 h-5" />Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„
                    </button>
                  )}
                  {selectedCase.status === 'InProgress' && (
                    <button onClick={handleAddMessage}
                      className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-xl font-bold hover:bg-purple-600">
                      <MessageSquare className="w-5 h-5" />Ø±Ø³Ø§Ù„Ø©
                    </button>
                  )}
                  {selectedCase.responsePack?.status === 'Draft' && (
                    <button onClick={handleApproveResponsePack}
                      className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                      <CheckCircle2 className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯
                    </button>
                  )}
                  {selectedCase.responsePack?.status === 'Approved' && selectedCase.status !== 'Submitted' && (
                    <button onClick={handleSubmitResponse}
                      className="flex items-center gap-2 px-4 py-2 bg-cyan-500 text-white rounded-xl font-bold hover:bg-cyan-600">
                      <Send className="w-5 h-5" />ØªÙ‚Ø¯ÙŠÙ…
                    </button>
                  )}
                  {selectedCase.status === 'Submitted' && (
                    <button onClick={() => handleUpdateStatus(selectedCase, 'Closed')}
                      className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                      <CheckCircle2 className="w-5 h-5" />Ø¥ØºÙ„Ø§Ù‚
                    </button>
                  )}
                  {selectedCase.status !== 'Closed' && selectedCase.escalationLevel < 3 && (
                    <button onClick={() => handleEscalate(selectedCase)}
                      className="flex items-center gap-2 px-4 py-2 border-2 border-red-500 text-red-500 rounded-xl font-bold hover:bg-red-50">
                      <TrendingUp className="w-5 h-5" />
                    </button>
                  )}
                  <button onClick={() => { setSelectedCase(null); setActiveTab('register'); }} className="p-2 hover:bg-slate-200 rounded-xl">
                    <X className="w-5 h-5 text-slate-500" />
                  </button>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <div className="flex border-b border-slate-200 overflow-x-auto bg-slate-50">
                {caseTabs.map(tab => (
                  <button key={tab.id} onClick={() => setCaseTab(tab.id)}
                    className={`flex items-center gap-2 px-5 py-3 font-bold transition-all border-b-2 whitespace-nowrap ${caseTab === tab.id ? 'text-cyan-600 border-cyan-500 bg-white' : 'text-slate-500 border-transparent hover:bg-white hover:text-slate-700'
                      }`}>
                    <tab.icon className="w-4 h-4" />{tab.label}
                  </button>
                ))}
              </div>

              <div className="p-6">
                {caseTab === 'summary' && (
                  <div className="grid grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2"><FileText className="w-5 h-5" />Ø§Ù„ÙˆØµÙ</h4>
                        <p className="text-slate-600 leading-relaxed">{selectedCase.description}</p>
                      </div>
                      <div className="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2"><Calendar className="w-5 h-5" />Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</h4>
                        <div className="space-y-2 text-sm">
                          <div className="flex justify-between py-2 border-b border-slate-200"><span className="text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</span><span className="font-bold">{selectedCase.receivedDate}</span></div>
                          <div className="flex justify-between py-2 border-b border-slate-200"><span className="text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span><span className="font-bold">{selectedCase.dueDate}</span></div>
                          {selectedCase.closedAt && (
                            <div className="flex justify-between py-2"><span className="text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØºÙ„Ø§Ù‚</span><span className="font-bold text-emerald-600">{selectedCase.closedAt}</span></div>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="space-y-4">
                      <div className="bg-slate-50 rounded-xl p-5 border border-slate-200">
                        <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2"><Users className="w-5 h-5" />Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†</h4>
                        <div className="space-y-3">
                          {[
                            { label: 'Ø§Ù„Ù…Ø§Ù„Ùƒ', id: selectedCase.ownerId },
                            { label: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹', id: selectedCase.reviewerId },
                            { label: 'Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', id: selectedCase.approverId },
                          ].map(item => {
                            const user = getUser(item.id);
                            return (
                              <div key={item.label} className="flex items-center justify-between p-3 bg-white rounded-lg border border-slate-200">
                                <span className="text-slate-500">{item.label}</span>
                                {user ? <span className="font-bold text-slate-700">{user.name}</span> : <span className="text-slate-400">-</span>}
                              </div>
                            );
                          })}
                        </div>
                      </div>
                      <div className="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-5 border border-cyan-200">
                        <h4 className="font-bold text-cyan-800 mb-3">Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø§Øª</h4>
                        <div className="grid grid-cols-2 gap-3">
                          <div className="bg-white rounded-lg p-3 text-center border border-slate-200">
                            <ArrowDownCircle className="w-6 h-6 text-blue-500 mx-auto mb-1" />
                            <span className="text-2xl font-bold text-slate-800">{selectedCase.messages?.filter(m => m.direction === 'Incoming').length || 0}</span>
                            <p className="text-xs text-slate-500">ÙˆØ§Ø±Ø¯Ø©</p>
                          </div>
                          <div className="bg-white rounded-lg p-3 text-center border border-slate-200">
                            <ArrowUpCircle className="w-6 h-6 text-emerald-500 mx-auto mb-1" />
                            <span className="text-2xl font-bold text-slate-800">{selectedCase.messages?.filter(m => m.direction === 'Outgoing').length || 0}</span>
                            <p className="text-xs text-slate-500">ØµØ§Ø¯Ø±Ø©</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {caseTab === 'thread' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800 text-lg">Ø³Ø¬Ù„ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø§Øª</h4>
                      <button onClick={handleAddMessage}
                        className="flex items-center gap-2 px-4 py-2 bg-cyan-500 text-white rounded-xl font-bold hover:bg-cyan-600">
                        <Plus className="w-5 h-5" />Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                      </button>
                    </div>
                    {selectedCase.messages?.length > 0 ? (
                      <div className="relative">
                        <div className="absolute right-6 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-300 via-purple-300 to-emerald-300"></div>
                        <div className="space-y-4">
                          {selectedCase.messages.sort((a, b) => new Date(a.messageDate) - new Date(b.messageDate)).map((msg) => {
                            const isIncoming = msg.direction === 'Incoming';
                            const channelCfg = CHANNEL_CONFIG[msg.channel];
                            const ChannelIcon = channelCfg?.icon || Mail;
                            return (
                              <div key={msg.id} className="relative flex gap-4 pr-10">
                                <div className={`absolute right-4 w-5 h-5 rounded-full ${isIncoming ? 'bg-blue-500' : 'bg-emerald-500'} border-4 border-white shadow-lg z-10`}></div>
                                <div className={`flex-1 rounded-2xl p-5 ${isIncoming ? 'bg-blue-50 border-2 border-blue-200' : 'bg-emerald-50 border-2 border-emerald-200'}`}>
                                  <div className="flex items-center justify-between mb-3">
                                    <div className="flex items-center gap-2 flex-wrap">
                                      <span className={`flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-bold ${isIncoming ? 'bg-blue-100 text-blue-700' : 'bg-emerald-100 text-emerald-700'}`}>
                                        {isIncoming ? <ArrowDownCircle className="w-3.5 h-3.5" /> : <ArrowUpCircle className="w-3.5 h-3.5" />}
                                        {isIncoming ? 'ÙˆØ§Ø±Ø¯' : 'ØµØ§Ø¯Ø±'}
                                      </span>
                                      <span className="flex items-center gap-1.5 px-3 py-1 bg-slate-100 text-slate-700 rounded-lg text-xs font-bold">
                                        <ChannelIcon className="w-3.5 h-3.5" />{channelCfg?.label}
                                      </span>
                                      <span className={`px-2 py-1 rounded-lg text-xs font-bold ${msg.status === 'Sent' ? 'bg-emerald-100 text-emerald-700' : msg.status === 'Received' ? 'bg-blue-100 text-blue-700' : 'bg-amber-100 text-amber-700'}`}>
                                        {msg.status === 'Sent' ? 'Ù…Ø±Ø³Ù„' : msg.status === 'Received' ? 'Ù…Ø³ØªÙ„Ù…' : 'Ù…Ø³ÙˆØ¯Ø©'}
                                      </span>
                                      {msg.attachments > 0 && (
                                        <span className="flex items-center gap-1 px-2 py-1 bg-slate-100 text-slate-600 rounded-lg text-xs font-bold">
                                          <Paperclip className="w-3 h-3" />{msg.attachments}
                                        </span>
                                      )}
                                    </div>
                                    <div className="flex items-center gap-2">
                                      <span className="text-sm text-slate-500 font-bold">{msg.messageDate}</span>
                                      <div className="flex items-center gap-1">
                                        {!isIncoming && msg.status === 'Draft' && (
                                          <button onClick={() => handleSendMessage(msg.id)} className="p-1.5 hover:bg-emerald-100 rounded-lg" title="Ø¥Ø±Ø³Ø§Ù„">
                                            <Send className="w-4 h-4 text-emerald-600" />
                                          </button>
                                        )}
                                        <button onClick={() => handleEditMessage(msg)} className="p-1.5 hover:bg-amber-100 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                                          <Edit className="w-4 h-4 text-amber-600" />
                                        </button>
                                        <button onClick={() => handleDeleteMessage(msg.id)} className="p-1.5 hover:bg-red-100 rounded-lg" title="Ø­Ø°Ù">
                                          <Trash2 className="w-4 h-4 text-red-600" />
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                  <div className="mb-3">
                                    <h5 className="font-bold text-slate-800">{msg.subject}</h5>
                                  </div>
                                  <div className="flex items-center gap-3 mb-3 text-sm text-slate-600">
                                    <span>Ù…Ù†: <strong>{msg.sender}</strong></span>
                                    <ChevronLeft className="w-4 h-4 text-slate-400" />
                                    <span>Ø¥Ù„Ù‰: <strong>{msg.recipient}</strong></span>
                                  </div>
                                  <p className="text-slate-700 bg-white rounded-lg p-3 border border-slate-200">{msg.summary}</p>
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    ) : (
                      <div className="text-center py-16 text-slate-400 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200">
                        <MessageSquare className="w-16 h-16 mx-auto mb-4 opacity-50" />
                        <p className="text-lg font-bold mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø³Ø¬Ù„Ø©</p>
                        <p className="text-sm">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø©</p>
                      </div>
                    )}
                  </div>
                )}

                {caseTab === 'linked' && (
                  <div className="space-y-4">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-slate-800 text-lg">Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© - Golden Thread</h4>
                      <button onClick={handleAddLink} className="flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-xl font-bold hover:bg-indigo-600">
                        <Link2 className="w-5 h-5" />Ø±Ø¨Ø· ÙƒØ§Ø¦Ù†
                      </button>
                    </div>
                    {selectedCase.linkedObjects?.length > 0 ? (
                      <div className="grid grid-cols-2 gap-4">
                        {selectedCase.linkedObjects.map((link, idx) => {
                          const linkCfg = LINK_TYPE_CONFIG[link.type];
                          const LinkIcon = linkCfg?.icon || Link2;
                          return (
                            <div key={idx} className={`rounded-xl border-2 p-4 ${linkCfg?.bg} hover:shadow-md transition-all`}>
                              <div className="flex items-start gap-4">
                                <div className="w-12 h-12 rounded-xl bg-white flex items-center justify-center shadow">
                                  <LinkIcon className="w-6 h-6 text-slate-600" />
                                </div>
                                <div className="flex-1 min-w-0">
                                  <div className="flex items-center gap-2 mb-1">
                                    <span className={`px-2 py-0.5 ${linkCfg?.bg} ${linkCfg?.text} rounded text-xs font-bold`}>{linkCfg?.label}</span>
                                    <span className="font-mono text-xs text-slate-500">{link.code}</span>
                                  </div>
                                  <p className="font-bold text-slate-800 truncate">{link.title}</p>
                                  <span className={`text-xs px-2 py-0.5 rounded mt-1 inline-block ${link.status === 'Active' || link.status === 'Passed' || link.status === 'Completed' ? 'bg-emerald-100 text-emerald-700' :
                                      link.status === 'InProgress' || link.status === 'Scheduled' ? 'bg-blue-100 text-blue-700' :
                                        'bg-slate-100 text-slate-600'
                                    }`}>{link.status}</span>
                                </div>
                                <div className="flex items-center gap-1">
                                  <button onClick={() => handleEditLink(link, idx)} className="p-1.5 hover:bg-amber-100 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                                    <Edit className="w-4 h-4 text-amber-600" />
                                  </button>
                                  <button onClick={() => handleUnlinkObject(idx)} className="p-1.5 hover:bg-red-100 rounded-lg" title="Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø·">
                                    <Trash2 className="w-4 h-4 text-red-600" />
                                  </button>
                                </div>
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    ) : (
                      <div className="text-center py-16 text-slate-400 bg-slate-50 rounded-2xl border-2 border-dashed border-slate-200">
                        <Link2 className="w-16 h-16 mx-auto mb-4 opacity-50" />
                        <p className="text-lg font-bold mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·</p>
                        <p className="text-sm mb-4">Ù‚Ù… Ø¨Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø°Ø§Øª Ø§Ù„ØµÙ„Ø©</p>
                        <button onClick={handleAddLink} className="px-4 py-2 bg-indigo-500 text-white rounded-xl font-bold hover:bg-indigo-600">Ø±Ø¨Ø· ÙƒØ§Ø¦Ù†</button>
                      </div>
                    )}
                  </div>
                )}

                {caseTab === 'response' && (
                  <div className="space-y-6">
                    {selectedCase.responsePack ? (
                      <>
                        <div className={`bg-gradient-to-r ${selectedCase.responsePack.status === 'Sent' ? 'from-emerald-50 to-teal-50 border-emerald-200' :
                            selectedCase.responsePack.status === 'Approved' ? 'from-blue-50 to-indigo-50 border-blue-200' :
                              'from-amber-50 to-orange-50 border-amber-200'
                          } rounded-2xl p-6 border-2`}>
                          <div className="flex items-center justify-between mb-6">
                            <h3 className="text-xl font-bold flex items-center gap-3">
                              <Package className="w-6 h-6" />Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ - Response Pack
                            </h3>
                            <div className="flex items-center gap-2">
                              <span className={`px-4 py-2 rounded-xl text-sm font-bold ${selectedCase.responsePack.status === 'Sent' ? 'bg-emerald-500 text-white' :
                                  selectedCase.responsePack.status === 'Approved' ? 'bg-blue-500 text-white' :
                                    'bg-amber-500 text-white'
                                }`}>
                                {selectedCase.responsePack.status === 'Sent' ? 'âœ“ ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„' :
                                  selectedCase.responsePack.status === 'Approved' ? 'âœ“ Ù…Ø¹ØªÙ…Ø¯' : 'â³ Ù…Ø³ÙˆØ¯Ø©'}
                              </span>
                              {selectedCase.responsePack.status === 'Draft' && (
                                <button onClick={handleDeleteResponsePack} className="p-2 hover:bg-red-100 rounded-xl" title="Ø­Ø°Ù Ø§Ù„Ø­Ø²Ù…Ø©">
                                  <Trash2 className="w-5 h-5 text-red-500" />
                                </button>
                              )}
                            </div>
                          </div>

                          <div className="grid grid-cols-4 gap-4 mb-6">
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200 shadow-sm">
                              <ClipboardCheck className="w-10 h-10 text-emerald-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-slate-800">{selectedCase.responsePack.obligationsCount}</span>
                              <p className="text-sm text-slate-500">Ø§Ù„ØªØ²Ø§Ù… Ù…Ø´Ù…ÙˆÙ„</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200 shadow-sm">
                              <FileCheck className="w-10 h-10 text-blue-500 mx-auto mb-2" />
                              <span className="text-3xl font-bold text-slate-800">{selectedCase.responsePack.evidenceCount || 0}</span>
                              <p className="text-sm text-slate-500">Ø¯Ù„ÙŠÙ„ Ù…Ø±ÙÙ‚</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200 shadow-sm">
                              <User className="w-10 h-10 text-purple-500 mx-auto mb-2" />
                              <span className="text-lg font-bold text-slate-800">{getUser(selectedCase.responsePack.signedOffBy)?.name || '-'}</span>
                              <p className="text-sm text-slate-500">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</p>
                            </div>
                            <div className="bg-white rounded-xl p-4 text-center border border-slate-200 shadow-sm">
                              <Calendar className="w-10 h-10 text-amber-500 mx-auto mb-2" />
                              <span className="text-lg font-bold text-slate-800">{selectedCase.responsePack.signedOffAt || '-'}</span>
                              <p className="text-sm text-slate-500">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</p>
                            </div>
                          </div>

                          <div className="flex items-center gap-3 flex-wrap">
                            {selectedCase.responsePack.status === 'Draft' && (
                              <>
                                <button onClick={handleAddEvidence} className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl font-bold hover:bg-blue-600">
                                  <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø£Ø¯Ù„Ø©
                                </button>
                                <button onClick={handleApproveResponsePack}
                                  className="flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                                  <CheckCircle2 className="w-5 h-5" />Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø­Ø²Ù…Ø©
                                </button>
                              </>
                            )}
                            {selectedCase.responsePack.status === 'Approved' && (
                              <button onClick={handleSubmitResponse}
                                className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
                                <Send className="w-5 h-5" />ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±Ø¯ Ù„Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©
                              </button>
                            )}
                          </div>
                        </div>

                        {selectedCase.responsePack.evidenceList?.length > 0 && (
                          <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                            <h4 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                              <FileCheck className="w-5 h-5 text-blue-500" />Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø© ({selectedCase.responsePack.evidenceList.length})
                            </h4>
                            <div className="grid grid-cols-2 gap-3">
                              {selectedCase.responsePack.evidenceList.map((evidence) => (
                                <div key={evidence.id} className="flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-200">
                                  <div className="flex items-center gap-3">
                                    <div className="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                                      <FileCheck className="w-5 h-5 text-blue-600" />
                                    </div>
                                    <div>
                                      <span className="font-mono text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded">{evidence.code}</span>
                                      <p className="font-bold text-slate-800 text-sm mt-1">{evidence.title}</p>
                                      <span className={`text-xs px-2 py-0.5 rounded ${evidence.status === 'Accepted' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}`}>
                                        {evidence.status === 'Accepted' ? 'Ù…Ù‚Ø¨ÙˆÙ„' : 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'}
                                      </span>
                                    </div>
                                  </div>
                                  {selectedCase.responsePack.status === 'Draft' && (
                                    <button onClick={() => handleRemoveEvidence(evidence.id)} className="p-2 hover:bg-red-100 rounded-lg" title="Ø¥Ø²Ø§Ù„Ø©">
                                      <Trash2 className="w-4 h-4 text-red-500" />
                                    </button>
                                  )}
                                </div>
                              ))}
                            </div>
                          </div>
                        )}

                        {selectedCase.linkedObjects?.filter(l => l.type === 'Obligation').length > 0 && (
                          <div className="bg-white rounded-2xl p-6 border-2 border-slate-200">
                            <h4 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                              <ClipboardCheck className="w-5 h-5 text-emerald-500" />Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø© ({selectedCase.linkedObjects.filter(l => l.type === 'Obligation').length})
                            </h4>
                            <div className="grid grid-cols-2 gap-3">
                              {selectedCase.linkedObjects.filter(l => l.type === 'Obligation').map((obl, idx) => (
                                <div key={idx} className="flex items-center gap-3 p-4 bg-emerald-50 rounded-xl border border-emerald-200">
                                  <div className="w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center">
                                    <ClipboardCheck className="w-5 h-5 text-emerald-600" />
                                  </div>
                                  <div>
                                    <span className="font-mono text-xs text-emerald-600 bg-emerald-100 px-2 py-0.5 rounded">{obl.code}</span>
                                    <p className="font-bold text-slate-800 text-sm mt-1">{obl.title}</p>
                                  </div>
                                </div>
                              ))}
                            </div>
                          </div>
                        )}
                      </>
                    ) : (
                      <div className="text-center py-16 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl border-2 border-amber-200">
                        <Package className="w-20 h-20 text-amber-400 mx-auto mb-4" />
                        <h3 className="text-2xl font-bold text-amber-800 mb-2">Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯</h3>
                        <p className="text-amber-600 mb-6">Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯ Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
                        <button onClick={handleCreateResponsePack}
                          className="px-8 py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl font-bold shadow-lg hover:shadow-xl">
                          <Package className="w-5 h-5 inline ml-2" />Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø²Ù…Ø© Ø§Ù„Ø±Ø¯
                        </button>
                      </div>
                    )}
                  </div>
                )}

                {caseTab === 'audit' && (
                  <div className="space-y-4">
                    <h4 className="font-bold text-slate-800 text-lg mb-4">Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ - Audit Trail</h4>
                    {selectedCase.auditTrail?.length > 0 ? (
                      <div className="relative">
                        <div className="absolute right-4 top-0 bottom-0 w-0.5 bg-slate-200"></div>
                        <div className="space-y-4">
                          {selectedCase.auditTrail.map((entry, idx) => (
                            <div key={idx} className="relative flex gap-4 pr-8">
                              <div className="absolute right-2 w-5 h-5 rounded-full bg-cyan-500 border-4 border-white shadow z-10 flex items-center justify-center">
                                <Check className="w-3 h-3 text-white" />
                              </div>
                              <div className="flex-1 bg-slate-50 rounded-xl p-4 border border-slate-200">
                                <div className="flex items-center justify-between mb-2">
                                  <span className="font-bold text-slate-800">{entry.action}</span>
                                  <span className="text-sm text-slate-500">{entry.date}</span>
                                </div>
                                <p className="text-slate-600 text-sm">{entry.details}</p>
                                <p className="text-xs text-slate-400 mt-2">Ø¨ÙˆØ§Ø³Ø·Ø©: {entry.user}</p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ) : (
                      <div className="text-center py-12 text-slate-400">
                        <History className="w-12 h-12 mx-auto mb-2 opacity-50" />
                        <p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ ØªØ¯Ù‚ÙŠÙ‚</p>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {activeTab === 'calendar' && (
          <div className="p-6">
            <h3 className="font-bold text-slate-800 text-lg mb-6">ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h3>
            <div className="grid grid-cols-4 gap-4">
              {[
                { key: 'overdue', label: 'Ù…ØªØ£Ø®Ø±', icon: AlertTriangle, color: 'red', filter: c => c.status !== 'Closed' && c.status !== 'Submitted' && getDaysUntilDue(c.dueDate) < 0 },
                { key: 'week', label: 'Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', icon: Clock, color: 'amber', filter: c => { const d = getDaysUntilDue(c.dueDate); return c.status !== 'Closed' && c.status !== 'Submitted' && d >= 0 && d <= 7; } },
                { key: 'month', label: 'Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±', icon: Calendar, color: 'blue', filter: c => { const d = getDaysUntilDue(c.dueDate); return c.status !== 'Closed' && c.status !== 'Submitted' && d > 7 && d <= 30; } },
                { key: 'completed', label: 'Ù…ÙƒØªÙ…Ù„', icon: CheckCircle2, color: 'emerald', filter: c => c.status === 'Closed' || c.status === 'Submitted' },
              ].map(section => {
                const SectionIcon = section.icon;
                const sectionCases = cases.filter(section.filter);
                return (
                  <div key={section.key} className={`bg-${section.color}-50 rounded-2xl p-5 border-2 border-${section.color}-200`}>
                    <h4 className={`font-bold text-${section.color}-800 mb-4 flex items-center gap-2`}>
                      <SectionIcon className="w-5 h-5" />{section.label}
                      <span className={`mr-auto px-2 py-0.5 bg-${section.color}-200 text-${section.color}-800 rounded-full text-xs font-bold`}>{sectionCases.length}</span>
                    </h4>
                    <div className="space-y-2 max-h-80 overflow-y-auto">
                      {sectionCases.map(c => {
                        const typeCfg = CASE_TYPE_CONFIG[c.caseType];
                        const TypeIcon = typeCfg?.icon || FileText;
                        return (
                          <div key={c.id} onClick={() => handleViewCase(c)} className="bg-white rounded-xl p-3 cursor-pointer hover:shadow-md transition-all border border-slate-200">
                            <div className="flex items-center gap-2 mb-1">
                              <span className="font-mono text-xs text-cyan-600 font-bold">{c.code}</span>
                              <TypeIcon className={`w-3 h-3 ${typeCfg?.text}`} />
                            </div>
                            <p className="text-sm font-bold text-slate-800 line-clamp-1">{c.subject}</p>
                            <p className={`text-xs font-bold mt-1 ${section.key === 'overdue' ? 'text-red-600' : section.key === 'week' ? 'text-amber-600' : 'text-slate-500'}`}>
                              {section.key === 'overdue' ? `Ù…ØªØ£Ø®Ø± ${Math.abs(getDaysUntilDue(c.dueDate))} ÙŠÙˆÙ…` :
                                section.key === 'completed' ? c.closedAt || c.dueDate :
                                  `${getDaysUntilDue(c.dueDate)} ÙŠÙˆÙ… - ${c.dueDate}`}
                            </p>
                          </div>
                        );
                      })}
                      {sectionCases.length === 0 && (
                        <p className="text-center text-slate-400 py-4 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø¶Ø§ÙŠØ§</p>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}
      </div>

      {showModal && formData && modalType === 'case' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
            <div className="bg-gradient-to-l from-cyan-500 via-blue-500 to-indigo-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <MessageSquare className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">{formData.id ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©' : 'ØªØ³Ø¬ÙŠÙ„ Ù‚Ø¶ÙŠØ© ØªÙ†Ø¸ÙŠÙ…ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©'}</h2>
                    <p className="text-cyan-200">{formData.code}</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 max-h-[60vh] overflow-y-auto space-y-6">
              <div className="grid grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© *</label>
                  <select value={formData.authorityId || ''} onChange={(e) => setFormData({ ...formData, authorityId: parseInt(e.target.value) })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø©...</option>
                    {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code} - {a.nameAr}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø¶ÙŠØ© *</label>
                  <select value={formData.caseType || ''} onChange={(e) => setFormData({ ...formData, caseType: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    {Object.entries(CASE_TYPE_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ *</label>
                <input type="text" value={formData.subject || ''} onChange={(e) => setFormData({ ...formData, subject: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none"
                  placeholder="Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù‚Ø¶ÙŠØ©..." />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ</label>
                <textarea rows={3} value={formData.description || ''} onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none resize-none"
                  placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©..." />
              </div>
              <div className="grid grid-cols-3 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label>
                  <input type="date" value={formData.receivedDate || ''} onChange={(e) => setFormData({ ...formData, receivedDate: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ *</label>
                  <input type="date" value={formData.dueDate || ''} onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
                  <select value={formData.priority || ''} onChange={(e) => setFormData({ ...formData, priority: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    {Object.entries(PRIORITY_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>
              </div>
              <div className="grid grid-cols-3 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                  <select value={formData.ownerId || ''} onChange={(e) => setFormData({ ...formData, ownerId: parseInt(e.target.value) })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    {COMM_USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹</label>
                  <select value={formData.reviewerId || ''} onChange={(e) => setFormData({ ...formData, reviewerId: parseInt(e.target.value) || '' })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    <option value="">Ø§Ø®ØªÙŠØ§Ø±ÙŠ...</option>
                    {COMM_USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</label>
                  <select value={formData.approverId || ''} onChange={(e) => setFormData({ ...formData, approverId: parseInt(e.target.value) || '' })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none">
                    <option value="">Ø§Ø®ØªÙŠØ§Ø±ÙŠ...</option>
                    {COMM_USERS.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}
                  </select>
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} disabled={!formData.subject || !formData.authorityId || !formData.dueDate}
                className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                <CheckCircle2 className="w-5 h-5" />{formData.id ? 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' : 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ©'}
              </button>
            </div>
          </div>
        </div>
      )}

      {showModal && formData && modalType === 'message' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-purple-500 to-indigo-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <MessageSquare className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">{formData.id ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©' : 'Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø©'}</h2>
                    <p className="text-purple-200">Communication Thread</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-3">Ø§Ù„Ø§ØªØ¬Ø§Ù‡ *</label>
                  <div className="flex gap-3">
                    <button onClick={() => setFormData({ ...formData, direction: 'Incoming' })}
                      className={`flex-1 flex items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${formData.direction === 'Incoming' ? 'border-blue-500 bg-blue-100' : 'border-slate-200 bg-white hover:border-blue-300'
                        }`}>
                      <ArrowDownCircle className={`w-5 h-5 ${formData.direction === 'Incoming' ? 'text-blue-600' : 'text-slate-400'}`} />
                      <span className="font-bold">ÙˆØ§Ø±Ø¯</span>
                    </button>
                    <button onClick={() => setFormData({ ...formData, direction: 'Outgoing' })}
                      className={`flex-1 flex items-center justify-center gap-2 p-4 rounded-xl border-2 transition-all ${formData.direction === 'Outgoing' ? 'border-emerald-500 bg-emerald-100' : 'border-slate-200 bg-white hover:border-emerald-300'
                        }`}>
                      <ArrowUpCircle className={`w-5 h-5 ${formData.direction === 'Outgoing' ? 'text-emerald-600' : 'text-slate-400'}`} />
                      <span className="font-bold">ØµØ§Ø¯Ø±</span>
                    </button>
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-3">Ø§Ù„Ù‚Ù†Ø§Ø© *</label>
                  <select value={formData.channel || ''} onChange={(e) => setFormData({ ...formData, channel: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none">
                    {Object.entries(CHANNEL_CONFIG).map(([k, v]) => <option key={k} value={k}>{v.label}</option>)}
                  </select>
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© *</label>
                <input type="text" value={formData.subject || ''} onChange={(e) => setFormData({ ...formData, subject: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                  placeholder="Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø©..." />
              </div>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø±Ø³Ù„</label>
                  <input type="text" value={formData.sender || ''} onChange={(e) => setFormData({ ...formData, sender: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³ØªÙ„Ù…</label>
                  <input type="text" value={formData.recipient || ''} onChange={(e) => setFormData({ ...formData, recipient: e.target.value })}
                    className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none" />
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label>
                <input type="date" value={formData.messageDate || ''} onChange={(e) => setFormData({ ...formData, messageDate: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none" />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© *</label>
                <textarea rows={3} value={formData.summary || ''} onChange={(e) => setFormData({ ...formData, summary: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none resize-none"
                  placeholder="Ù…Ù„Ø®Øµ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©..." />
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} disabled={!formData.subject || !formData.summary}
                className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                {formData.id ? <Save className="w-5 h-5" /> : <Plus className="w-5 h-5" />}{formData.id ? 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' : 'Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø©'}
              </button>
            </div>
          </div>
        </div>
      )}

      {showModal && formData && modalType === 'link' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-l from-indigo-500 to-purple-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Link2 className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">{formData._idx !== undefined ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø·' : 'Ø±Ø¨Ø· ÙƒØ§Ø¦Ù† Ø¬Ø¯ÙŠØ¯'}</h2>
                    <p className="text-indigo-200">Golden Thread Connection</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø¦Ù† *</label>
                <div className="grid grid-cols-3 gap-3">
                  {Object.entries(LINK_TYPE_CONFIG).map(([key, cfg]) => {
                    const TypeIcon = cfg.icon;
                    const isSelected = formData.type === key;
                    return (
                      <button key={key} type="button" onClick={() => setFormData({ ...formData, type: key })}
                        className={`flex flex-col items-center gap-2 p-4 rounded-xl border-2 transition-all ${isSelected ? `border-indigo-500 ${cfg.bg}` : 'border-slate-200 bg-white hover:border-slate-300'
                          }`}>
                        <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${isSelected ? 'bg-indigo-500 text-white' : 'bg-slate-100 text-slate-500'}`}>
                          <TypeIcon className="w-5 h-5" />
                        </div>
                        <span className={`text-sm font-bold ${isSelected ? cfg.text : 'text-slate-600'}`}>{cfg.label}</span>
                      </button>
                    );
                  })}
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ÙƒÙˆØ¯ Ø§Ù„ÙƒØ§Ø¦Ù† *</label>
                <input type="text" value={formData.code || ''} onChange={(e) => setFormData({ ...formData, code: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-400 focus:outline-none"
                  placeholder={formData.type === 'Obligation' ? 'OBL-001' : formData.type === 'Breach' ? 'BRH-001' : formData.type === 'CAPA' ? 'CAPA-001' : formData.type === 'Test' ? 'TST-001' : 'CHG-001'} />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ø¦Ù† *</label>
                <input type="text" value={formData.title || ''} onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-400 focus:outline-none"
                  placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©" />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØ§Ø¦Ù†</label>
                <div className="flex flex-wrap gap-2">
                  {['Active', 'InProgress', 'Completed', 'Passed', 'Failed', 'Scheduled', 'Closed'].map(status => {
                    const isSelected = formData.status === status;
                    const statusLabels = { Active: 'Ù†Ø´Ø·', InProgress: 'Ø¬Ø§Ø±ÙŠ', Completed: 'Ù…ÙƒØªÙ…Ù„', Passed: 'Ù†Ø§Ø¬Ø­', Failed: 'ÙØ§Ø´Ù„', Scheduled: 'Ù…Ø¬Ø¯ÙˆÙ„', Closed: 'Ù…ØºÙ„Ù‚' };
                    return (
                      <button key={status} type="button" onClick={() => setFormData({ ...formData, status })}
                        className={`px-4 py-2 rounded-xl text-sm font-bold transition-all ${isSelected ? 'bg-indigo-500 text-white' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'
                          }`}>
                        {statusLabels[status]}
                      </button>
                    );
                  })}
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} disabled={!formData.code || !formData.title}
                className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                {formData._idx !== undefined ? <Save className="w-5 h-5" /> : <Link2 className="w-5 h-5" />}
                {formData._idx !== undefined ? 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª' : 'Ø±Ø¨Ø· Ø§Ù„ÙƒØ§Ø¦Ù†'}
              </button>
            </div>
          </div>
        </div>
      )}

      {showModal && formData && modalType === 'evidence' && (
        <div className="fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-xl overflow-hidden">
            <div className="bg-gradient-to-l from-blue-500 to-cyan-600 px-8 py-6 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <FileCheck className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-bold">Ø¥Ø¶Ø§ÙØ© Ø¯Ù„ÙŠÙ„ Ù„Ù„Ø­Ø²Ù…Ø©</h2>
                    <p className="text-cyan-200">Evidence Pack Builder</p>
                  </div>
                </div>
                <button onClick={() => setShowModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/10 hover:bg-white/20 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>
            <div className="p-8 space-y-6">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ù†ÙˆØ¹ Ø§Ù„Ø¯Ù„ÙŠÙ„</label>
                <div className="grid grid-cols-4 gap-2">
                  {[
                    { key: 'Document', label: 'Ù…Ø³ØªÙ†Ø¯', icon: FileText },
                    { key: 'Report', label: 'ØªÙ‚Ø±ÙŠØ±', icon: FileCheck },
                    { key: 'Screenshot', label: 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', icon: Eye },
                    { key: 'Log', label: 'Ø³Ø¬Ù„', icon: History }
                  ].map(type => {
                    const TypeIcon = type.icon;
                    const isSelected = formData.evidenceType === type.key;
                    return (
                      <button key={type.key} type="button" onClick={() => setFormData({ ...formData, evidenceType: type.key })}
                        className={`flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-slate-200 bg-white hover:border-slate-300'
                          }`}>
                        <TypeIcon className={`w-5 h-5 ${isSelected ? 'text-blue-600' : 'text-slate-400'}`} />
                        <span className={`text-xs font-bold ${isSelected ? 'text-blue-700' : 'text-slate-600'}`}>{type.label}</span>
                      </button>
                    );
                  })}
                </div>
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø¯Ù„ÙŠÙ„ *</label>
                <input type="text" value={formData.evidenceCode || ''} onChange={(e) => setFormData({ ...formData, evidenceCode: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none"
                  placeholder="EVD-001" />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ù„ÙŠÙ„ *</label>
                <input type="text" value={formData.evidenceTitle || ''} onChange={(e) => setFormData({ ...formData, evidenceTitle: e.target.value })}
                  className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none"
                  placeholder="Ù…Ø«Ø§Ù„: Ø³ÙŠØ§Ø³Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©" />
              </div>
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-3">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„</label>
                <div className="flex gap-3">
                  <button type="button" onClick={() => setFormData({ ...formData, evidenceStatus: 'Accepted' })}
                    className={`flex-1 flex items-center justify-center gap-2 p-3 rounded-xl border-2 transition-all ${formData.evidenceStatus === 'Accepted' ? 'border-emerald-500 bg-emerald-50' : 'border-slate-200 bg-white hover:border-emerald-300'
                      }`}>
                    <CheckCircle2 className={`w-5 h-5 ${formData.evidenceStatus === 'Accepted' ? 'text-emerald-600' : 'text-slate-400'}`} />
                    <span className="font-bold">Ù…Ù‚Ø¨ÙˆÙ„</span>
                  </button>
                  <button type="button" onClick={() => setFormData({ ...formData, evidenceStatus: 'Pending' })}
                    className={`flex-1 flex items-center justify-center gap-2 p-3 rounded-xl border-2 transition-all ${formData.evidenceStatus === 'Pending' ? 'border-amber-500 bg-amber-50' : 'border-slate-200 bg-white hover:border-amber-300'
                      }`}>
                    <Clock className={`w-5 h-5 ${formData.evidenceStatus === 'Pending' ? 'text-amber-600' : 'text-slate-400'}`} />
                    <span className="font-bold">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
                  </button>
                </div>
              </div>
            </div>
            <div className="border-t-2 border-slate-200 px-8 py-5 bg-slate-50 flex justify-between">
              <button onClick={() => setShowModal(false)} className="px-6 py-3 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={handleSave} disabled={!formData.evidenceCode || !formData.evidenceTitle}
                className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-xl font-bold shadow-lg disabled:opacity-50">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ù„ÙŠÙ„
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 5.3: Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„Ù†Ø¶Ø¬ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ
// Maturity Assessment - World-Class Premium Edition
// Features: Multi-level Assessment, Gap Analysis, Benchmarking, Trends, Improvements
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MaturityAssessment = () => {
  const [activeTab, setActiveTab] = useState('overview');
  const [selectedAuthority, setSelectedAuthority] = useState(null);
  const [selectedFramework, setSelectedFramework] = useState(null);
  const [showAssessmentModal, setShowAssessmentModal] = useState(false);
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [assessmentMode, setAssessmentMode] = useState('authority'); // authority | framework | control
  const [viewMode, setViewMode] = useState('cards'); // cards | table | chart

  // Maturity Levels Configuration
  const MATURITY_LEVELS = {
    1: { level: 1, name: 'Ù…Ø¨Ø¯Ø¦ÙŠ', nameEn: 'Initial', color: 'red', description: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ØºÙŠØ± Ù…Ù†Ø¸Ù…Ø© ÙˆØ¹Ø´ÙˆØ§Ø¦ÙŠØ©', icon: 'ğŸ”´' },
    2: { level: 2, name: 'Ù…ÙØ¯Ø§Ø±', nameEn: 'Managed', color: 'orange', description: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ø®Ø·Ø·Ø© ÙˆÙ…ØªØªØ¨Ø¹Ø©', icon: 'ğŸŸ ' },
    3: { level: 3, name: 'Ù…Ø¹Ø±Ù‘Ù', nameEn: 'Defined', color: 'amber', description: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…ÙˆØ­Ø¯Ø© ÙˆÙ…ÙˆØ«Ù‚Ø©', icon: 'ğŸŸ¡' },
    4: { level: 4, name: 'Ù…ÙÙ‚Ø§Ø³', nameEn: 'Quantitatively Managed', color: 'blue', description: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù…Ù‚Ø§Ø³Ø© ÙˆÙ…ØªØ­ÙƒÙ… Ø¨Ù‡Ø§', icon: 'ğŸ”µ' },
    5: { level: 5, name: 'Ù…ÙØ­Ø³Ù‘Ù†', nameEn: 'Optimizing', color: 'emerald', description: 'Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ…Ø± ÙˆØ§Ù„Ø§Ø¨ØªÙƒØ§Ø±', icon: 'ğŸŸ¢' },
  };

  // Assessment Data per Authority
  const [assessments, setAssessments] = useState([
    {
      id: 1, authorityId: 1, authorityCode: 'SAMA', currentLevel: 4, targetLevel: 5, previousLevel: 3, assessmentDate: '2025-01-15', nextAssessment: '2025-04-15', assessor: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯', status: 'Completed', score: 82, domains: [
        { name: 'Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', nameEn: 'Governance', score: 85, level: 4 },
        { name: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', nameEn: 'Risk Management', score: 78, level: 4 },
        { name: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', nameEn: 'Compliance', score: 88, level: 4 },
        { name: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', nameEn: 'Internal Audit', score: 75, level: 4 },
        { name: 'Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªÙˆØ¹ÙŠØ©', nameEn: 'Training', score: 80, level: 4 },
      ]
    },
    {
      id: 2, authorityId: 3, authorityCode: 'NCA', currentLevel: 3, targetLevel: 5, previousLevel: 2, assessmentDate: '2025-01-10', nextAssessment: '2025-04-10', assessor: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ', status: 'Completed', score: 68, domains: [
        { name: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£ØµÙˆÙ„', nameEn: 'Asset Protection', score: 72, level: 3 },
        { name: 'Ø£Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ§Øª', nameEn: 'Network Security', score: 65, level: 3 },
        { name: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ©', nameEn: 'Identity Management', score: 70, level: 3 },
        { name: 'Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø«', nameEn: 'Incident Response', score: 62, level: 3 },
        { name: 'Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', nameEn: 'Business Continuity', score: 71, level: 4 },
      ]
    },
    {
      id: 3, authorityId: 4, authorityCode: 'SDAIA', currentLevel: 2, targetLevel: 4, previousLevel: 1, assessmentDate: '2025-01-20', nextAssessment: '2025-04-20', assessor: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯', status: 'Completed', score: 52, domains: [
        { name: 'Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Collection', score: 55, level: 3 },
        { name: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Processing', score: 48, level: 2 },
        { name: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Protection', score: 58, level: 3 },
        { name: 'Ø­Ù‚ÙˆÙ‚ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', nameEn: 'Data Subject Rights', score: 45, level: 2 },
        { name: 'Ø§Ù„Ù†Ù‚Ù„ Ø¹Ø¨Ø± Ø§Ù„Ø­Ø¯ÙˆØ¯', nameEn: 'Cross-border Transfer', score: 54, level: 2 },
      ]
    },
    {
      id: 4, authorityId: 2, authorityCode: 'CMA', currentLevel: 4, targetLevel: 5, previousLevel: 4, assessmentDate: '2025-01-05', nextAssessment: '2025-04-05', assessor: 'Ù†ÙˆØ±Ø© Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', status: 'Completed', score: 85, domains: [
        { name: 'Ø§Ù„Ø¥ÙØµØ§Ø­ ÙˆØ§Ù„Ø´ÙØ§ÙÙŠØ©', nameEn: 'Disclosure', score: 90, level: 5 },
        { name: 'Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª', nameEn: 'Corporate Governance', score: 88, level: 4 },
        { name: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', nameEn: 'AML', score: 82, level: 4 },
        { name: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†', nameEn: 'Investor Protection', score: 80, level: 4 },
        { name: 'Ø§Ù„Ù†Ø²Ø§Ù‡Ø© Ø§Ù„Ø³ÙˆÙ‚ÙŠØ©', nameEn: 'Market Integrity', score: 85, level: 4 },
      ]
    },
    {
      id: 5, authorityId: 5, authorityCode: 'ZATCA', currentLevel: 3, targetLevel: 4, previousLevel: 3, assessmentDate: '2025-01-25', nextAssessment: '2025-04-25', assessor: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ù‡Ø±ÙŠ', status: 'InProgress', score: 65, domains: [
        { name: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ', nameEn: 'Tax Compliance', score: 70, level: 3 },
        { name: 'Ø§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', nameEn: 'E-Invoicing', score: 75, level: 4 },
        { name: 'Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª', nameEn: 'Returns', score: 60, level: 3 },
        { name: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ', nameEn: 'Tax Audit', score: 55, level: 3 },
        { name: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', nameEn: 'Reporting', score: 65, level: 3 },
      ]
    },
  ]);

  // Improvement Actions
  const [improvements, setImprovements] = useState([
    { id: 1, assessmentId: 1, domain: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', action: 'ØªØ·ÙˆÙŠØ± Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', priority: 'High', status: 'InProgress', dueDate: '2025-03-15', progress: 60 },
    { id: 2, assessmentId: 1, domain: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', action: 'ØªØ­Ø¯ÙŠØ« Ù…Ù†Ù‡Ø¬ÙŠØ© ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', priority: 'Medium', status: 'Planned', dueDate: '2025-04-30', progress: 20 },
    { id: 3, assessmentId: 2, domain: 'Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø«', action: 'Ø¥Ù†Ø´Ø§Ø¡ ÙØ±ÙŠÙ‚ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ©', priority: 'High', status: 'InProgress', dueDate: '2025-02-28', progress: 75 },
    { id: 4, assessmentId: 3, domain: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', action: 'ØªØ·Ø¨ÙŠÙ‚ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', priority: 'High', status: 'Planned', dueDate: '2025-03-31', progress: 10 },
    { id: 5, assessmentId: 3, domain: 'Ø­Ù‚ÙˆÙ‚ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', action: 'ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø¨Ø© Ø·Ù„Ø¨Ø§Øª Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', priority: 'Critical', status: 'InProgress', dueDate: '2025-02-15', progress: 45 },
  ]);

  // Historical Trend Data
  const trendData = [
    { period: 'Q1 2024', SAMA: 3.2, NCA: 2.1, SDAIA: 1.5, CMA: 3.8, ZATCA: 2.8 },
    { period: 'Q2 2024', SAMA: 3.5, NCA: 2.4, SDAIA: 1.8, CMA: 4.0, ZATCA: 2.9 },
    { period: 'Q3 2024', SAMA: 3.7, NCA: 2.7, SDAIA: 2.0, CMA: 4.1, ZATCA: 3.0 },
    { period: 'Q4 2024', SAMA: 3.9, NCA: 2.9, SDAIA: 2.2, CMA: 4.2, ZATCA: 3.1 },
    { period: 'Q1 2025', SAMA: 4.1, NCA: 3.2, SDAIA: 2.5, CMA: 4.3, ZATCA: 3.2 },
  ];

  // Calculate Overall Stats
  const stats = useMemo(() => {
    const avgScore = assessments.reduce((sum, a) => sum + a.score, 0) / assessments.length;
    const avgLevel = assessments.reduce((sum, a) => sum + a.currentLevel, 0) / assessments.length;
    const atTarget = assessments.filter(a => a.currentLevel >= a.targetLevel).length;
    const improving = assessments.filter(a => a.currentLevel > a.previousLevel).length;
    return { avgScore: Math.round(avgScore), avgLevel: avgLevel.toFixed(1), atTarget, improving, total: assessments.length };
  }, [assessments]);

  // Get Level Config
  const getLevelConfig = (level) => MATURITY_LEVELS[level] || MATURITY_LEVELS[1];

  // Tabs
  const tabs = [
    { id: 'overview', label: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©', icon: LayoutDashboard, count: null },
    { id: 'authorities', label: 'Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©', icon: Building2, count: assessments.length },
    { id: 'domains', label: 'Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…', icon: Layers, count: null },
    { id: 'improvements', label: 'Ø®Ø·Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ†', icon: TrendingUp, count: improvements.filter(i => i.status === 'InProgress').length },
    { id: 'trends', label: 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ', icon: BarChart3, count: null },
    { id: 'benchmark', label: 'Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØ©', icon: Scale, count: null },
  ];

  return (
    <div className="space-y-6">
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PREMIUM HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="relative overflow-hidden bg-gradient-to-br from-violet-600 via-purple-600 to-indigo-700 rounded-3xl p-8 text-white">
        <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMtOS45NDEgMC0xOCA4LjA1OS0xOCAxOHM4LjA1OSAxOCAxOCAxOGM5Ljk0MSAwIDE4LTguMDU5IDE4LTE4cy04LjA1OS0xOC0xOC0xOHptMCAzMmMtNy43MzIgMC0xNC02LjI2OC0xNC0xNHM2LjI2OC0xNCAxNC0xNHMxNCA2LjI2OCAxNCAxNC02LjI2OCAxNC0xNCAxNHoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iLjA1Ii8+PC9nPjwvc3ZnPg==')] opacity-30"></div>
        <div className="absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl"></div>
        <div className="absolute bottom-0 left-0 w-64 h-64 bg-cyan-400/20 rounded-full translate-y-1/2 -translate-x-1/2 blur-3xl"></div>

        <div className="relative">
          <div className="flex items-center justify-between mb-6">
            <div className="flex items-center gap-5">
              <div className="w-20 h-20 rounded-2xl bg-white/20 backdrop-blur-xl flex items-center justify-center border border-white/30 shadow-2xl">
                <TrendingUp className="w-10 h-10" />
              </div>
              <div>
                <h1 className="text-3xl font-black mb-1">Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„Ù†Ø¶Ø¬ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ</h1>
                <p className="text-purple-200 text-lg">Maturity Assessment & Continuous Improvement</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <button className="flex items-center gap-2 px-5 py-3 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-xl border border-white/20 font-bold transition-all">
                <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±
              </button>
              <button onClick={() => setShowAssessmentModal(true)} className="flex items-center gap-2 px-6 py-3 bg-white text-purple-600 rounded-xl font-bold shadow-xl hover:shadow-2xl transition-all">
                <Plus className="w-5 h-5" />ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯
              </button>
            </div>
          </div>

          {/* Stats Row */}
          <div className="grid grid-cols-5 gap-4">
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border border-white/20">
              <div className="flex items-center justify-between mb-3">
                <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center">
                  <Target className="w-6 h-6" />
                </div>
                <span className="text-4xl font-black">{stats.avgScore}%</span>
              </div>
              <p className="text-purple-200 font-medium">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù†Ø¶Ø¬ Ø§Ù„Ø¹Ø§Ù…</p>
              <div className="mt-2 h-2 bg-white/20 rounded-full overflow-hidden">
                <div className="h-full bg-gradient-to-r from-emerald-400 to-cyan-400 rounded-full" style={{ width: `${stats.avgScore}%` }}></div>
              </div>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border border-white/20">
              <div className="flex items-center justify-between mb-3">
                <div className="w-12 h-12 rounded-xl bg-emerald-500/30 flex items-center justify-center">
                  <CheckCircle2 className="w-6 h-6 text-emerald-300" />
                </div>
                <span className="text-4xl font-black">{stats.atTarget}</span>
              </div>
              <p className="text-purple-200 font-medium">ÙˆØµÙ„ÙˆØ§ Ù„Ù„Ù‡Ø¯Ù</p>
              <p className="text-xs text-purple-300 mt-1">Ù…Ù† {stats.total} Ø¬Ù‡Ø©</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border border-white/20">
              <div className="flex items-center justify-between mb-3">
                <div className="w-12 h-12 rounded-xl bg-blue-500/30 flex items-center justify-center">
                  <TrendingUp className="w-6 h-6 text-blue-300" />
                </div>
                <span className="text-4xl font-black">{stats.improving}</span>
              </div>
              <p className="text-purple-200 font-medium">ÙÙŠ ØªØ­Ø³Ù†</p>
              <p className="text-xs text-emerald-300 mt-1">â†‘ Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border border-white/20">
              <div className="flex items-center justify-between mb-3">
                <div className="w-12 h-12 rounded-xl bg-amber-500/30 flex items-center justify-center">
                  <Activity className="w-6 h-6 text-amber-300" />
                </div>
                <span className="text-4xl font-black">{stats.avgLevel}</span>
              </div>
              <p className="text-purple-200 font-medium">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø³ØªÙˆÙ‰</p>
              <p className="text-xs text-purple-300 mt-1">Ù…Ù† 5 Ù…Ø³ØªÙˆÙŠØ§Øª</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-5 border border-white/20">
              <div className="flex items-center justify-between mb-3">
                <div className="w-12 h-12 rounded-xl bg-purple-500/30 flex items-center justify-center">
                  <Calendar className="w-6 h-6 text-purple-300" />
                </div>
                <span className="text-2xl font-black">Q1</span>
              </div>
              <p className="text-purple-200 font-medium">Ø¯ÙˆØ±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</p>
              <p className="text-xs text-purple-300 mt-1">2025</p>
            </div>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MATURITY LEVEL SCALE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 p-6 shadow-sm">
        <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
          <Scale className="w-5 h-5 text-purple-500" />Ù…Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù†Ø¶Ø¬ - Maturity Scale
        </h3>
        <div className="flex items-center gap-2">
          {Object.values(MATURITY_LEVELS).map((level, idx) => (
            <div key={level.level} className="flex-1 relative">
              <div className={`p-4 rounded-xl border-2 text-center transition-all hover:shadow-lg hover:scale-[1.02] cursor-pointer ${level.color === 'red' ? 'bg-red-50 border-red-200 hover:border-red-400' :
                  level.color === 'orange' ? 'bg-orange-50 border-orange-200 hover:border-orange-400' :
                    level.color === 'amber' ? 'bg-amber-50 border-amber-200 hover:border-amber-400' :
                      level.color === 'blue' ? 'bg-blue-50 border-blue-200 hover:border-blue-400' :
                        'bg-emerald-50 border-emerald-200 hover:border-emerald-400'
                }`}>
                <div className="text-3xl mb-2">{level.icon}</div>
                <div className={`text-2xl font-black ${level.color === 'red' ? 'text-red-600' :
                    level.color === 'orange' ? 'text-orange-600' :
                      level.color === 'amber' ? 'text-amber-600' :
                        level.color === 'blue' ? 'text-blue-600' :
                          'text-emerald-600'
                  }`}>L{level.level}</div>
                <p className="font-bold text-slate-800 mt-1">{level.name}</p>
                <p className="text-xs text-slate-500">{level.nameEn}</p>
                <p className="text-[10px] text-slate-400 mt-2 leading-tight">{level.description}</p>
              </div>
              {idx < 4 && (
                <div className="absolute top-1/2 -left-1 w-2 h-2 bg-slate-300 rounded-full -translate-y-1/2 z-10"></div>
              )}
            </div>
          ))}
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden shadow-sm">
        <div className="flex border-b-2 border-slate-200 bg-gradient-to-r from-slate-50 to-slate-100 overflow-x-auto">
          {tabs.map(tab => (
            <button key={tab.id} onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-6 py-4 font-bold transition-all whitespace-nowrap border-b-2 ${activeTab === tab.id
                  ? 'text-purple-600 border-purple-500 bg-white -mb-[2px]'
                  : 'text-slate-500 border-transparent hover:text-purple-500 hover:bg-white/50'
                }`}>
              <tab.icon className="w-5 h-5" />{tab.label}
              {tab.count !== null && (
                <span className={`px-2.5 py-1 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-purple-500 text-white' : 'bg-slate-200 text-slate-600'
                  }`}>{tab.count}</span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OVERVIEW TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'overview' && (
          <div className="p-6 space-y-6">
            {/* Authority Maturity Cards */}
            <div>
              <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                <Building2 className="w-5 h-5 text-purple-500" />Ù†Ø¶Ø¬ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©
              </h3>
              <div className="grid grid-cols-5 gap-4">
                {assessments.map(assessment => {
                  const levelConfig = getLevelConfig(assessment.currentLevel);
                  const targetConfig = getLevelConfig(assessment.targetLevel);
                  const gap = assessment.targetLevel - assessment.currentLevel;
                  return (
                    <div key={assessment.id} onClick={() => { setSelectedAuthority(assessment); setShowDetailModal(true); }}
                      className="bg-white rounded-2xl border-2 border-slate-200 p-5 hover:shadow-xl hover:border-purple-300 cursor-pointer transition-all group relative overflow-hidden">
                      <div className={`absolute top-0 left-0 w-full h-1 ${levelConfig.color === 'red' ? 'bg-red-500' :
                          levelConfig.color === 'orange' ? 'bg-orange-500' :
                            levelConfig.color === 'amber' ? 'bg-amber-500' :
                              levelConfig.color === 'blue' ? 'bg-blue-500' :
                                'bg-emerald-500'
                        }`}></div>

                      <div className="flex items-center justify-between mb-4">
                        <div className={`w-14 h-14 rounded-xl flex items-center justify-center text-white font-bold text-lg ${assessment.authorityCode === 'SAMA' ? 'bg-gradient-to-br from-emerald-500 to-teal-600' :
                            assessment.authorityCode === 'NCA' ? 'bg-gradient-to-br from-purple-500 to-violet-600' :
                              assessment.authorityCode === 'SDAIA' ? 'bg-gradient-to-br from-indigo-500 to-blue-600' :
                                assessment.authorityCode === 'CMA' ? 'bg-gradient-to-br from-blue-500 to-cyan-600' :
                                  'bg-gradient-to-br from-amber-500 to-orange-600'
                          }`}>
                          {assessment.authorityCode.substring(0, 2)}
                        </div>
                        <div className="text-4xl">{levelConfig.icon}</div>
                      </div>

                      <h4 className="font-bold text-slate-800 text-lg mb-1">{assessment.authorityCode}</h4>
                      <p className="text-sm text-slate-500 mb-3">{AUTHORITIES.find(a => a.id === assessment.authorityId)?.nameAr}</p>

                      <div className="flex items-center gap-2 mb-3">
                        <span className={`text-3xl font-black ${levelConfig.color === 'red' ? 'text-red-600' :
                            levelConfig.color === 'orange' ? 'text-orange-600' :
                              levelConfig.color === 'amber' ? 'text-amber-600' :
                                levelConfig.color === 'blue' ? 'text-blue-600' :
                                  'text-emerald-600'
                          }`}>L{assessment.currentLevel}</span>
                        <ChevronRight className="w-4 h-4 text-slate-300" />
                        <span className="text-lg text-slate-400">L{assessment.targetLevel}</span>
                      </div>

                      <div className="mb-3">
                        <div className="flex items-center justify-between text-xs mb-1">
                          <span className="text-slate-500">Ø§Ù„Ù†Ø¶Ø¬</span>
                          <span className="font-bold text-slate-700">{assessment.score}%</span>
                        </div>
                        <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                          <div className={`h-full rounded-full transition-all ${assessment.score >= 80 ? 'bg-emerald-500' :
                              assessment.score >= 60 ? 'bg-blue-500' :
                                assessment.score >= 40 ? 'bg-amber-500' :
                                  'bg-red-500'
                            }`} style={{ width: `${assessment.score}%` }}></div>
                        </div>
                      </div>

                      <div className="flex items-center justify-between text-xs">
                        {gap > 0 ? (
                          <span className="px-2 py-1 bg-amber-100 text-amber-700 rounded-lg font-bold">ÙØ¬ÙˆØ©: {gap} Ù…Ø³ØªÙˆÙ‰</span>
                        ) : (
                          <span className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg font-bold flex items-center gap-1">
                            <CheckCircle2 className="w-3 h-3" />Ù‡Ø¯Ù Ù…Ø­Ù‚Ù‚
                          </span>
                        )}
                        {assessment.currentLevel > assessment.previousLevel && (
                          <span className="text-emerald-500 flex items-center gap-1">
                            <TrendingUp className="w-3 h-3" />+{assessment.currentLevel - assessment.previousLevel}
                          </span>
                        )}
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>

            {/* Domain Radar Comparison */}
            <div className="grid grid-cols-2 gap-6">
              <div className="bg-gradient-to-br from-slate-50 to-white rounded-2xl border-2 border-slate-200 p-6">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <PieChart className="w-5 h-5 text-purple-500" />ØªÙˆØ²ÙŠØ¹ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù†Ø¶Ø¬
                </h3>
                <div className="flex items-center justify-around py-8">
                  {[1, 2, 3, 4, 5].map(level => {
                    const count = assessments.filter(a => a.currentLevel === level).length;
                    const config = getLevelConfig(level);
                    return (
                      <div key={level} className="text-center">
                        <div className={`w-16 h-16 rounded-2xl flex items-center justify-center text-2xl font-black mx-auto mb-2 ${config.color === 'red' ? 'bg-red-100 text-red-600' :
                            config.color === 'orange' ? 'bg-orange-100 text-orange-600' :
                              config.color === 'amber' ? 'bg-amber-100 text-amber-600' :
                                config.color === 'blue' ? 'bg-blue-100 text-blue-600' :
                                  'bg-emerald-100 text-emerald-600'
                          }`}>{count}</div>
                        <p className="text-xs font-bold text-slate-600">L{level}</p>
                        <p className="text-[10px] text-slate-400">{config.name}</p>
                      </div>
                    );
                  })}
                </div>
              </div>

              <div className="bg-gradient-to-br from-slate-50 to-white rounded-2xl border-2 border-slate-200 p-6">
                <h3 className="font-bold text-slate-800 mb-4 flex items-center gap-2">
                  <TrendingUp className="w-5 h-5 text-emerald-500" />Ø§Ù„ØªÙ‚Ø¯Ù… Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                </h3>
                <div className="space-y-3">
                  {assessments.map(a => {
                    const change = a.currentLevel - a.previousLevel;
                    return (
                      <div key={a.id} className="flex items-center gap-3">
                        <span className="w-16 font-bold text-slate-700">{a.authorityCode}</span>
                        <div className="flex-1 h-3 bg-slate-100 rounded-full overflow-hidden">
                          <div className={`h-full rounded-full ${a.score >= 80 ? 'bg-emerald-500' :
                              a.score >= 60 ? 'bg-blue-500' :
                                a.score >= 40 ? 'bg-amber-500' : 'bg-red-500'
                            }`} style={{ width: `${a.score}%` }}></div>
                        </div>
                        <span className="w-12 text-sm font-bold text-slate-700">{a.score}%</span>
                        <span className={`w-12 text-sm font-bold ${change > 0 ? 'text-emerald-500' : change < 0 ? 'text-red-500' : 'text-slate-400'}`}>
                          {change > 0 ? `+${change}` : change < 0 ? change : 'â€”'}
                        </span>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>

            {/* Quick Actions */}
            <div className="grid grid-cols-4 gap-4">
              <button onClick={() => setShowAssessmentModal(true)} className="p-5 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-2xl text-white hover:shadow-xl transition-all group">
                <Plus className="w-8 h-8 mb-3 group-hover:scale-110 transition-transform" />
                <p className="font-bold">Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯</p>
                <p className="text-xs text-purple-200 mt-1">New Assessment</p>
              </button>
              <button className="p-5 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl text-white hover:shadow-xl transition-all group">
                <FileText className="w-8 h-8 mb-3 group-hover:scale-110 transition-transform" />
                <p className="font-bold">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¶Ø¬ Ø§Ù„Ø´Ø§Ù…Ù„</p>
                <p className="text-xs text-emerald-200 mt-1">Maturity Report</p>
              </button>
              <button onClick={() => setActiveTab('improvements')} className="p-5 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl text-white hover:shadow-xl transition-all group">
                <TrendingUp className="w-8 h-8 mb-3 group-hover:scale-110 transition-transform" />
                <p className="font-bold">Ø®Ø·Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ†</p>
                <p className="text-xs text-amber-200 mt-1">Improvement Plans</p>
              </button>
              <button onClick={() => setActiveTab('benchmark')} className="p-5 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-2xl text-white hover:shadow-xl transition-all group">
                <Scale className="w-8 h-8 mb-3 group-hover:scale-110 transition-transform" />
                <p className="font-bold">Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØ©</p>
                <p className="text-xs text-blue-200 mt-1">Benchmarking</p>
              </button>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTHORITIES TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'authorities' && (
          <div className="p-6 space-y-6">
            <div className="flex items-center justify-between mb-4">
              <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
                <Building2 className="w-5 h-5 text-purple-500" />ØªÙ‚ÙŠÙŠÙ… Ù†Ø¶Ø¬ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©
              </h3>
              <div className="flex items-center gap-2">
                <button onClick={() => setViewMode('cards')} className={`p-2.5 rounded-lg transition-all ${viewMode === 'cards' ? 'bg-purple-500 text-white' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'}`}>
                  <LayoutGrid className="w-5 h-5" />
                </button>
                <button onClick={() => setViewMode('table')} className={`p-2.5 rounded-lg transition-all ${viewMode === 'table' ? 'bg-purple-500 text-white' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'}`}>
                  <Table className="w-5 h-5" />
                </button>
              </div>
            </div>

            {viewMode === 'table' ? (
              <div className="overflow-hidden rounded-xl border-2 border-slate-200">
                <table className="w-full">
                  <thead>
                    <tr className="bg-gradient-to-r from-slate-50 to-slate-100">
                      <th className="text-right px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„ÙØ¬ÙˆØ©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„ØªÙ‚Ø¯Ù…</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø¢Ø®Ø± ØªÙ‚ÙŠÙŠÙ…</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-center px-4 py-4 font-bold text-slate-700 w-32">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {assessments.map((assessment, idx) => {
                      const levelConfig = getLevelConfig(assessment.currentLevel);
                      const gap = assessment.targetLevel - assessment.currentLevel;
                      const change = assessment.currentLevel - assessment.previousLevel;
                      return (
                        <tr key={assessment.id} className={`border-b border-slate-100 hover:bg-purple-50/50 transition-all ${idx % 2 === 0 ? 'bg-white' : 'bg-slate-50/50'}`}>
                          <td className="px-4 py-4">
                            <div className="flex items-center gap-3">
                              <div className={`w-10 h-10 rounded-xl flex items-center justify-center text-white font-bold text-sm ${assessment.authorityCode === 'SAMA' ? 'bg-emerald-500' :
                                  assessment.authorityCode === 'NCA' ? 'bg-purple-500' :
                                    assessment.authorityCode === 'SDAIA' ? 'bg-indigo-500' :
                                      assessment.authorityCode === 'CMA' ? 'bg-blue-500' : 'bg-amber-500'
                                }`}>{assessment.authorityCode.substring(0, 2)}</div>
                              <div>
                                <p className="font-bold text-slate-800">{assessment.authorityCode}</p>
                                <p className="text-xs text-slate-500">{AUTHORITIES.find(a => a.id === assessment.authorityId)?.nameAr}</p>
                              </div>
                            </div>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <div className="inline-flex items-center gap-2">
                              <span className="text-2xl">{levelConfig.icon}</span>
                              <span className={`text-xl font-black ${levelConfig.color === 'emerald' ? 'text-emerald-600' :
                                  levelConfig.color === 'blue' ? 'text-blue-600' :
                                    levelConfig.color === 'amber' ? 'text-amber-600' :
                                      levelConfig.color === 'orange' ? 'text-orange-600' : 'text-red-600'
                                }`}>L{assessment.currentLevel}</span>
                            </div>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <span className="text-lg font-bold text-slate-600">L{assessment.targetLevel}</span>
                          </td>
                          <td className="px-4 py-4 text-center">
                            {gap > 0 ? (
                              <span className="px-3 py-1.5 bg-amber-100 text-amber-700 rounded-lg font-bold text-sm">{gap} Ù…Ø³ØªÙˆÙ‰</span>
                            ) : (
                              <span className="px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-lg font-bold text-sm flex items-center gap-1 justify-center">
                                <CheckCircle2 className="w-4 h-4" />Ù…Ø­Ù‚Ù‚
                              </span>
                            )}
                          </td>
                          <td className="px-4 py-4 text-center">
                            <div className="inline-flex flex-col items-center">
                              <span className="text-xl font-black text-slate-800">{assessment.score}%</span>
                              <div className="w-20 h-1.5 bg-slate-200 rounded-full mt-1">
                                <div className={`h-full rounded-full ${assessment.score >= 80 ? 'bg-emerald-500' : assessment.score >= 60 ? 'bg-blue-500' : assessment.score >= 40 ? 'bg-amber-500' : 'bg-red-500'}`} style={{ width: `${assessment.score}%` }}></div>
                              </div>
                            </div>
                          </td>
                          <td className="px-4 py-4 text-center">
                            <span className={`font-bold ${change > 0 ? 'text-emerald-500' : change < 0 ? 'text-red-500' : 'text-slate-400'}`}>
                              {change > 0 ? `â†‘ +${change}` : change < 0 ? `â†“ ${change}` : 'â€”'}
                            </span>
                          </td>
                          <td className="px-4 py-4 text-center text-sm text-slate-600">{assessment.assessmentDate}</td>
                          <td className="px-4 py-4 text-center">
                            <span className={`px-3 py-1.5 rounded-lg text-xs font-bold ${assessment.status === 'Completed' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'
                              }`}>{assessment.status === 'Completed' ? 'Ù…ÙƒØªÙ…Ù„' : 'Ø¬Ø§Ø±ÙŠ'}</span>
                          </td>
                          <td className="px-4 py-4">
                            <div className="flex items-center justify-center gap-1">
                              <button onClick={() => { setSelectedAuthority(assessment); setShowDetailModal(true); }} className="p-2 hover:bg-blue-100 rounded-lg transition-all">
                                <Eye className="w-4 h-4 text-blue-500" />
                              </button>
                              <button className="p-2 hover:bg-amber-100 rounded-lg transition-all">
                                <Edit className="w-4 h-4 text-amber-500" />
                              </button>
                              <button className="p-2 hover:bg-purple-100 rounded-lg transition-all">
                                <FileText className="w-4 h-4 text-purple-500" />
                              </button>
                            </div>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
            ) : (
              <div className="grid grid-cols-3 gap-5">
                {assessments.map(assessment => {
                  const levelConfig = getLevelConfig(assessment.currentLevel);
                  const gap = assessment.targetLevel - assessment.currentLevel;
                  return (
                    <div key={assessment.id} className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden hover:shadow-xl hover:border-purple-300 transition-all cursor-pointer group"
                      onClick={() => { setSelectedAuthority(assessment); setShowDetailModal(true); }}>
                      <div className={`h-2 ${levelConfig.color === 'emerald' ? 'bg-emerald-500' :
                          levelConfig.color === 'blue' ? 'bg-blue-500' :
                            levelConfig.color === 'amber' ? 'bg-amber-500' :
                              levelConfig.color === 'orange' ? 'bg-orange-500' : 'bg-red-500'
                        }`}></div>
                      <div className="p-5">
                        <div className="flex items-start justify-between mb-4">
                          <div className={`w-16 h-16 rounded-xl flex items-center justify-center text-white font-bold text-xl ${assessment.authorityCode === 'SAMA' ? 'bg-gradient-to-br from-emerald-500 to-teal-600' :
                              assessment.authorityCode === 'NCA' ? 'bg-gradient-to-br from-purple-500 to-violet-600' :
                                assessment.authorityCode === 'SDAIA' ? 'bg-gradient-to-br from-indigo-500 to-blue-600' :
                                  assessment.authorityCode === 'CMA' ? 'bg-gradient-to-br from-blue-500 to-cyan-600' :
                                    'bg-gradient-to-br from-amber-500 to-orange-600'
                            } shadow-lg`}>{assessment.authorityCode.substring(0, 2)}</div>
                          <span className={`px-3 py-1.5 rounded-xl text-xs font-bold ${assessment.status === 'Completed' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'
                            }`}>{assessment.status === 'Completed' ? 'Ù…ÙƒØªÙ…Ù„' : 'Ø¬Ø§Ø±ÙŠ'}</span>
                        </div>

                        <h4 className="font-bold text-slate-800 text-xl group-hover:text-purple-600 transition-colors">{assessment.authorityCode}</h4>
                        <p className="text-sm text-slate-500 mb-4">{AUTHORITIES.find(a => a.id === assessment.authorityId)?.nameAr}</p>

                        <div className="flex items-center gap-4 mb-4">
                          <div className="flex-1 text-center p-3 bg-slate-50 rounded-xl">
                            <div className="text-3xl mb-1">{levelConfig.icon}</div>
                            <p className={`text-2xl font-black ${levelConfig.color === 'emerald' ? 'text-emerald-600' :
                                levelConfig.color === 'blue' ? 'text-blue-600' :
                                  levelConfig.color === 'amber' ? 'text-amber-600' :
                                    levelConfig.color === 'orange' ? 'text-orange-600' : 'text-red-600'
                              }`}>L{assessment.currentLevel}</p>
                            <p className="text-xs text-slate-500">Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
                          </div>
                          <ChevronRight className="w-6 h-6 text-slate-300" />
                          <div className="flex-1 text-center p-3 bg-purple-50 rounded-xl">
                            <div className="text-3xl mb-1">ğŸ¯</div>
                            <p className="text-2xl font-black text-purple-600">L{assessment.targetLevel}</p>
                            <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</p>
                          </div>
                        </div>

                        <div className="mb-4">
                          <div className="flex items-center justify-between text-sm mb-2">
                            <span className="text-slate-600">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¶Ø¬</span>
                            <span className="font-bold text-slate-800">{assessment.score}%</span>
                          </div>
                          <div className="h-3 bg-slate-100 rounded-full overflow-hidden">
                            <div className={`h-full rounded-full transition-all ${assessment.score >= 80 ? 'bg-gradient-to-r from-emerald-400 to-emerald-500' :
                                assessment.score >= 60 ? 'bg-gradient-to-r from-blue-400 to-blue-500' :
                                  assessment.score >= 40 ? 'bg-gradient-to-r from-amber-400 to-amber-500' :
                                    'bg-gradient-to-r from-red-400 to-red-500'
                              }`} style={{ width: `${assessment.score}%` }}></div>
                          </div>
                        </div>

                        <div className="flex items-center justify-between text-sm pt-4 border-t border-slate-100">
                          <span className="text-slate-500">Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…: {assessment.assessor}</span>
                          {gap > 0 ? (
                            <span className="px-2 py-1 bg-amber-100 text-amber-700 rounded-lg text-xs font-bold">ÙØ¬ÙˆØ©: {gap}</span>
                          ) : (
                            <span className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-xs font-bold">âœ“ Ù…Ø­Ù‚Ù‚</span>
                          )}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DOMAINS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'domains' && (
          <div className="p-6 space-y-6">
            <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
              <Layers className="w-5 h-5 text-purple-500" />ØªØ­Ù„ÙŠÙ„ Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©
            </h3>

            {assessments.map(assessment => (
              <div key={assessment.id} className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
                <div className={`p-4 flex items-center justify-between ${assessment.authorityCode === 'SAMA' ? 'bg-gradient-to-r from-emerald-500 to-teal-600' :
                    assessment.authorityCode === 'NCA' ? 'bg-gradient-to-r from-purple-500 to-violet-600' :
                      assessment.authorityCode === 'SDAIA' ? 'bg-gradient-to-r from-indigo-500 to-blue-600' :
                        assessment.authorityCode === 'CMA' ? 'bg-gradient-to-r from-blue-500 to-cyan-600' :
                          'bg-gradient-to-r from-amber-500 to-orange-600'
                  } text-white`}>
                  <div className="flex items-center gap-3">
                    <div className="w-12 h-12 rounded-xl bg-white/20 flex items-center justify-center font-bold text-lg">{assessment.authorityCode.substring(0, 2)}</div>
                    <div>
                      <h4 className="font-bold text-lg">{assessment.authorityCode}</h4>
                      <p className="text-sm opacity-80">{AUTHORITIES.find(a => a.id === assessment.authorityId)?.nameAr}</p>
                    </div>
                  </div>
                  <div className="flex items-center gap-4">
                    <div className="text-center">
                      <p className="text-3xl font-black">{assessment.score}%</p>
                      <p className="text-xs opacity-80">Ø§Ù„Ù†Ø¶Ø¬ Ø§Ù„ÙƒÙ„ÙŠ</p>
                    </div>
                    <div className="text-center">
                      <p className="text-3xl font-black">L{assessment.currentLevel}</p>
                      <p className="text-xs opacity-80">Ø§Ù„Ù…Ø³ØªÙˆÙ‰</p>
                    </div>
                  </div>
                </div>

                <div className="p-5">
                  <div className="grid grid-cols-5 gap-4">
                    {assessment.domains.map((domain, idx) => {
                      const levelConfig = getLevelConfig(domain.level);
                      return (
                        <div key={idx} className="p-4 rounded-xl border-2 border-slate-200 hover:border-purple-300 hover:shadow-lg transition-all cursor-pointer text-center">
                          <div className="text-2xl mb-2">{levelConfig.icon}</div>
                          <p className="font-bold text-slate-800 text-sm mb-1">{domain.name}</p>
                          <p className="text-[10px] text-slate-400 mb-3">{domain.nameEn}</p>
                          <div className="mb-2">
                            <p className={`text-2xl font-black ${domain.score >= 80 ? 'text-emerald-600' :
                                domain.score >= 60 ? 'text-blue-600' :
                                  domain.score >= 40 ? 'text-amber-600' : 'text-red-600'
                              }`}>{domain.score}%</p>
                          </div>
                          <div className="h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div className={`h-full rounded-full ${domain.score >= 80 ? 'bg-emerald-500' :
                                domain.score >= 60 ? 'bg-blue-500' :
                                  domain.score >= 40 ? 'bg-amber-500' : 'bg-red-500'
                              }`} style={{ width: `${domain.score}%` }}></div>
                          </div>
                          <p className="text-xs text-slate-500 mt-2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: L{domain.level}</p>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• IMPROVEMENTS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'improvements' && (
          <div className="p-6 space-y-6">
            <div className="flex items-center justify-between">
              <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
                <TrendingUp className="w-5 h-5 text-amber-500" />Ø®Ø·Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ† ÙˆØ³Ø¯ Ø§Ù„ÙØ¬ÙˆØ§Øª
              </h3>
              <button className="flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-xl font-bold hover:shadow-lg transition-all">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ø±Ø§Ø¡ ØªØ­Ø³ÙŠÙ†
              </button>
            </div>

            {/* Stats */}
            <div className="grid grid-cols-4 gap-4">
              <div className="bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-5 text-white">
                <Activity className="w-8 h-8 mb-3 opacity-80" />
                <p className="text-3xl font-black">{improvements.length}</p>
                <p className="text-amber-100">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</p>
              </div>
              <div className="bg-white rounded-2xl p-5 border-2 border-blue-200">
                <Clock className="w-8 h-8 mb-3 text-blue-500" />
                <p className="text-3xl font-black text-blue-600">{improvements.filter(i => i.status === 'InProgress').length}</p>
                <p className="text-slate-500">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
              </div>
              <div className="bg-white rounded-2xl p-5 border-2 border-emerald-200">
                <CheckCircle2 className="w-8 h-8 mb-3 text-emerald-500" />
                <p className="text-3xl font-black text-emerald-600">{improvements.filter(i => i.status === 'Completed').length}</p>
                <p className="text-slate-500">Ù…ÙƒØªÙ…Ù„Ø©</p>
              </div>
              <div className="bg-white rounded-2xl p-5 border-2 border-red-200">
                <AlertTriangle className="w-8 h-8 mb-3 text-red-500" />
                <p className="text-3xl font-black text-red-600">{improvements.filter(i => i.priority === 'Critical').length}</p>
                <p className="text-slate-500">Ø­Ø±Ø¬Ø©</p>
              </div>
            </div>

            {/* Improvements List */}
            <div className="space-y-3">
              {improvements.map(imp => {
                const assessment = assessments.find(a => a.id === imp.assessmentId);
                return (
                  <div key={imp.id} className="bg-white rounded-xl border-2 border-slate-200 p-5 hover:shadow-lg hover:border-purple-300 transition-all">
                    <div className="flex items-start justify-between">
                      <div className="flex items-start gap-4">
                        <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold ${imp.priority === 'Critical' ? 'bg-red-500' :
                            imp.priority === 'High' ? 'bg-orange-500' :
                              imp.priority === 'Medium' ? 'bg-amber-500' : 'bg-blue-500'
                          }`}>
                          {imp.priority === 'Critical' ? '!!' : imp.priority === 'High' ? '!' : 'â€¢'}
                        </div>
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-1">
                            <span className={`px-2 py-1 rounded text-xs font-bold ${imp.priority === 'Critical' ? 'bg-red-100 text-red-700' :
                                imp.priority === 'High' ? 'bg-orange-100 text-orange-700' :
                                  imp.priority === 'Medium' ? 'bg-amber-100 text-amber-700' : 'bg-blue-100 text-blue-700'
                              }`}>{imp.priority === 'Critical' ? 'Ø­Ø±Ø¬' : imp.priority === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : imp.priority === 'Medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶'}</span>
                            <span className="px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs font-bold">{assessment?.authorityCode}</span>
                            <span className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs">{imp.domain}</span>
                          </div>
                          <h4 className="font-bold text-slate-800 text-lg">{imp.action}</h4>
                          <p className="text-sm text-slate-500 mt-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: {imp.dueDate}</p>
                        </div>
                      </div>
                      <div className="text-left w-40">
                        <div className="flex items-center justify-between text-sm mb-2">
                          <span className={`font-bold ${imp.status === 'Completed' ? 'text-emerald-600' :
                              imp.status === 'InProgress' ? 'text-blue-600' : 'text-slate-500'
                            }`}>{imp.status === 'Completed' ? 'Ù…ÙƒØªÙ…Ù„' : imp.status === 'InProgress' ? 'Ø¬Ø§Ø±ÙŠ' : 'Ù…Ø®Ø·Ø·'}</span>
                          <span className="font-bold text-slate-800">{imp.progress}%</span>
                        </div>
                        <div className="h-3 bg-slate-100 rounded-full overflow-hidden">
                          <div className={`h-full rounded-full transition-all ${imp.progress >= 80 ? 'bg-emerald-500' :
                              imp.progress >= 50 ? 'bg-blue-500' :
                                imp.progress >= 25 ? 'bg-amber-500' : 'bg-slate-300'
                            }`} style={{ width: `${imp.progress}%` }}></div>
                        </div>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRENDS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'trends' && (
          <div className="p-6 space-y-6">
            <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
              <BarChart3 className="w-5 h-5 text-blue-500" />Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù†Ø¶Ø¬
            </h3>

            {/* Trend Chart Placeholder */}
            <div className="bg-gradient-to-br from-slate-50 to-white rounded-2xl border-2 border-slate-200 p-6">
              <div className="flex items-center justify-between mb-6">
                <h4 className="font-bold text-slate-700">ØªØ·ÙˆØ± Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù†Ø¶Ø¬ Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†</h4>
                <div className="flex items-center gap-4">
                  {['SAMA', 'NCA', 'SDAIA', 'CMA', 'ZATCA'].map((code, idx) => (
                    <div key={code} className="flex items-center gap-2">
                      <div className={`w-3 h-3 rounded-full ${idx === 0 ? 'bg-emerald-500' :
                          idx === 1 ? 'bg-purple-500' :
                            idx === 2 ? 'bg-indigo-500' :
                              idx === 3 ? 'bg-blue-500' : 'bg-amber-500'
                        }`}></div>
                      <span className="text-sm text-slate-600">{code}</span>
                    </div>
                  ))}
                </div>
              </div>

              {/* Simple Visual Chart */}
              <div className="relative h-64">
                <div className="absolute inset-0 flex flex-col justify-between text-xs text-slate-400 py-2">
                  {[5, 4, 3, 2, 1].map(level => (
                    <div key={level} className="flex items-center gap-2">
                      <span className="w-6">L{level}</span>
                      <div className="flex-1 border-t border-dashed border-slate-200"></div>
                    </div>
                  ))}
                </div>

                <div className="absolute inset-0 flex items-end justify-around pt-4 pb-8">
                  {trendData.map((data, idx) => (
                    <div key={idx} className="flex flex-col items-center gap-2 w-1/5">
                      <div className="flex items-end gap-1 h-48">
                        <div className="w-4 rounded-t-lg bg-emerald-500 transition-all hover:opacity-80" style={{ height: `${(data.SAMA / 5) * 100}%` }} title={`SAMA: ${data.SAMA}`}></div>
                        <div className="w-4 rounded-t-lg bg-purple-500 transition-all hover:opacity-80" style={{ height: `${(data.NCA / 5) * 100}%` }} title={`NCA: ${data.NCA}`}></div>
                        <div className="w-4 rounded-t-lg bg-indigo-500 transition-all hover:opacity-80" style={{ height: `${(data.SDAIA / 5) * 100}%` }} title={`SDAIA: ${data.SDAIA}`}></div>
                        <div className="w-4 rounded-t-lg bg-blue-500 transition-all hover:opacity-80" style={{ height: `${(data.CMA / 5) * 100}%` }} title={`CMA: ${data.CMA}`}></div>
                        <div className="w-4 rounded-t-lg bg-amber-500 transition-all hover:opacity-80" style={{ height: `${(data.ZATCA / 5) * 100}%` }} title={`ZATCA: ${data.ZATCA}`}></div>
                      </div>
                      <span className="text-xs text-slate-500 font-medium">{data.period}</span>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* Trend Table */}
            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <table className="w-full">
                <thead>
                  <tr className="bg-slate-50">
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„ÙØªØ±Ø©</th>
                    {['SAMA', 'NCA', 'SDAIA', 'CMA', 'ZATCA'].map(code => (
                      <th key={code} className="text-center px-4 py-3 font-bold text-slate-700">{code}</th>
                    ))}
                  </tr>
                </thead>
                <tbody>
                  {trendData.map((data, idx) => (
                    <tr key={idx} className="border-t border-slate-100">
                      <td className="px-4 py-3 font-bold text-slate-700">{data.period}</td>
                      <td className="px-4 py-3 text-center"><span className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded font-bold">{data.SAMA}</span></td>
                      <td className="px-4 py-3 text-center"><span className="px-2 py-1 bg-purple-100 text-purple-700 rounded font-bold">{data.NCA}</span></td>
                      <td className="px-4 py-3 text-center"><span className="px-2 py-1 bg-indigo-100 text-indigo-700 rounded font-bold">{data.SDAIA}</span></td>
                      <td className="px-4 py-3 text-center"><span className="px-2 py-1 bg-blue-100 text-blue-700 rounded font-bold">{data.CMA}</span></td>
                      <td className="px-4 py-3 text-center"><span className="px-2 py-1 bg-amber-100 text-amber-700 rounded font-bold">{data.ZATCA}</span></td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BENCHMARK TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'benchmark' && (
          <div className="p-6 space-y-6">
            <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
              <Scale className="w-5 h-5 text-indigo-500" />Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØ© - Industry Benchmarking
            </h3>

            {/* Benchmark Cards */}
            <div className="grid grid-cols-3 gap-6">
              <div className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-6 text-white">
                <div className="flex items-center justify-between mb-4">
                  <div className="w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center">
                    <TrendingUp className="w-7 h-7" />
                  </div>
                  <span className="text-4xl font-black">{stats.avgScore}%</span>
                </div>
                <h4 className="font-bold text-lg mb-1">Ù…ØªÙˆØ³Ø· Ù†Ø¶Ø¬Ùƒ</h4>
                <p className="text-emerald-100 text-sm">Your Average Maturity</p>
                <div className="mt-4 h-2 bg-white/20 rounded-full overflow-hidden">
                  <div className="h-full bg-white rounded-full" style={{ width: `${stats.avgScore}%` }}></div>
                </div>
              </div>

              <div className="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-6 text-white">
                <div className="flex items-center justify-between mb-4">
                  <div className="w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center">
                    <Building2 className="w-7 h-7" />
                  </div>
                  <span className="text-4xl font-black">72%</span>
                </div>
                <h4 className="font-bold text-lg mb-1">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‚Ø·Ø§Ø¹</h4>
                <p className="text-blue-100 text-sm">Industry Average</p>
                <div className="mt-4 h-2 bg-white/20 rounded-full overflow-hidden">
                  <div className="h-full bg-white rounded-full" style={{ width: '72%' }}></div>
                </div>
              </div>

              <div className="bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl p-6 text-white">
                <div className="flex items-center justify-between mb-4">
                  <div className="w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center">
                    <Target className="w-7 h-7" />
                  </div>
                  <span className="text-4xl font-black">85%</span>
                </div>
                <h4 className="font-bold text-lg mb-1">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª</h4>
                <p className="text-purple-100 text-sm">Best Practice</p>
                <div className="mt-4 h-2 bg-white/20 rounded-full overflow-hidden">
                  <div className="h-full bg-white rounded-full" style={{ width: '85%' }}></div>
                </div>
              </div>
            </div>

            {/* Comparison Table */}
            <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden">
              <div className="p-4 bg-slate-50 border-b border-slate-200">
                <h4 className="font-bold text-slate-700">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ù…Ø¹ Ø§Ù„Ù…Ø¹ÙŠØ§Ø±</h4>
              </div>
              <div className="p-5">
                {['Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', 'Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'].map((domain, idx) => {
                  const yourScore = [85, 78, 82, 68, 52][idx];
                  const industryScore = [75, 70, 72, 65, 60][idx];
                  const bestPractice = [90, 85, 88, 82, 78][idx];
                  const diff = yourScore - industryScore;
                  return (
                    <div key={idx} className="mb-6 last:mb-0">
                      <div className="flex items-center justify-between mb-2">
                        <span className="font-bold text-slate-700">{domain}</span>
                        <span className={`text-sm font-bold ${diff >= 0 ? 'text-emerald-600' : 'text-red-600'}`}>
                          {diff >= 0 ? `+${diff}%` : `${diff}%`} Ø¹Ù† Ø§Ù„Ù‚Ø·Ø§Ø¹
                        </span>
                      </div>
                      <div className="relative h-8 bg-slate-100 rounded-lg overflow-hidden">
                        <div className="absolute inset-y-0 right-0 bg-emerald-500/30 rounded-lg" style={{ width: `${yourScore}%` }}>
                          <div className="absolute inset-y-0 right-0 bg-emerald-500 rounded-lg flex items-center justify-end px-2" style={{ width: '100%' }}>
                            <span className="text-xs font-bold text-white">{yourScore}%</span>
                          </div>
                        </div>
                        <div className="absolute top-1/2 -translate-y-1/2 w-1 h-6 bg-blue-500 rounded" style={{ right: `${industryScore}%` }} title="Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‚Ø·Ø§Ø¹"></div>
                        <div className="absolute top-1/2 -translate-y-1/2 w-1 h-6 bg-purple-500 rounded" style={{ right: `${bestPractice}%` }} title="Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª"></div>
                      </div>
                      <div className="flex items-center gap-4 mt-1 text-xs text-slate-500">
                        <span className="flex items-center gap-1"><span className="w-2 h-2 bg-blue-500 rounded-full"></span>Ø§Ù„Ù‚Ø·Ø§Ø¹: {industryScore}%</span>
                        <span className="flex items-center gap-1"><span className="w-2 h-2 bg-purple-500 rounded-full"></span>Ø£ÙØ¶Ù„: {bestPractice}%</span>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>

            {/* Position Indicator */}
            <div className="bg-gradient-to-r from-slate-50 to-purple-50 rounded-2xl border-2 border-purple-200 p-6">
              <h4 className="font-bold text-purple-800 mb-4 flex items-center gap-2">
                <Target className="w-5 h-5" />Ù…ÙˆÙ‚Ø¹Ùƒ ÙÙŠ Ø§Ù„Ù‚Ø·Ø§Ø¹
              </h4>
              <div className="flex items-center gap-4">
                <div className="flex-1">
                  <div className="relative h-4 bg-gradient-to-r from-red-200 via-amber-200 via-emerald-200 to-emerald-400 rounded-full">
                    <div className="absolute top-1/2 -translate-y-1/2 w-6 h-6 bg-white border-4 border-purple-500 rounded-full shadow-lg transition-all"
                      style={{ right: `calc(${stats.avgScore}% - 12px)` }}>
                    </div>
                    <div className="absolute -bottom-6 right-[25%] text-xs text-slate-500">25%</div>
                    <div className="absolute -bottom-6 right-[50%] text-xs text-slate-500">50%</div>
                    <div className="absolute -bottom-6 right-[75%] text-xs text-slate-500">75%</div>
                  </div>
                </div>
                <div className="w-32 text-center">
                  <p className="text-3xl font-black text-purple-600">{stats.avgScore >= 80 ? 'Ù…ØªÙ…ÙŠØ²' : stats.avgScore >= 60 ? 'Ø¬ÙŠØ¯' : stats.avgScore >= 40 ? 'Ù…ØªÙˆØ³Ø·' : 'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†'}</p>
                  <p className="text-sm text-slate-500">ØªØµÙ†ÙŠÙÙƒ</p>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DETAIL MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDetailModal && selectedAuthority && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
            <div className={`px-6 py-5 text-white ${selectedAuthority.authorityCode === 'SAMA' ? 'bg-gradient-to-r from-emerald-500 to-teal-600' :
                selectedAuthority.authorityCode === 'NCA' ? 'bg-gradient-to-r from-purple-500 to-violet-600' :
                  selectedAuthority.authorityCode === 'SDAIA' ? 'bg-gradient-to-r from-indigo-500 to-blue-600' :
                    selectedAuthority.authorityCode === 'CMA' ? 'bg-gradient-to-r from-blue-500 to-cyan-600' :
                      'bg-gradient-to-r from-amber-500 to-orange-600'
              }`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-16 h-16 rounded-2xl bg-white/20 flex items-center justify-center font-bold text-2xl">{selectedAuthority.authorityCode.substring(0, 2)}</div>
                  <div>
                    <h2 className="text-2xl font-bold">{selectedAuthority.authorityCode}</h2>
                    <p className="opacity-80">{AUTHORITIES.find(a => a.id === selectedAuthority.authorityId)?.nameAr}</p>
                  </div>
                </div>
                <button onClick={() => setShowDetailModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/20 hover:bg-white/30 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>

            <div className="flex-1 overflow-y-auto p-6 space-y-6">
              {/* Summary */}
              <div className="grid grid-cols-4 gap-4">
                <div className="bg-slate-50 rounded-xl p-4 text-center">
                  <p className="text-3xl mb-1">{getLevelConfig(selectedAuthority.currentLevel).icon}</p>
                  <p className="text-2xl font-black text-slate-800">L{selectedAuthority.currentLevel}</p>
                  <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
                </div>
                <div className="bg-purple-50 rounded-xl p-4 text-center">
                  <p className="text-3xl mb-1">ğŸ¯</p>
                  <p className="text-2xl font-black text-purple-600">L{selectedAuthority.targetLevel}</p>
                  <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</p>
                </div>
                <div className="bg-blue-50 rounded-xl p-4 text-center">
                  <p className="text-3xl font-black text-blue-600">{selectedAuthority.score}%</p>
                  <p className="text-xs text-slate-500 mt-2">Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¶Ø¬</p>
                </div>
                <div className="bg-emerald-50 rounded-xl p-4 text-center">
                  <p className="text-3xl font-black text-emerald-600">+{selectedAuthority.currentLevel - selectedAuthority.previousLevel}</p>
                  <p className="text-xs text-slate-500 mt-2">Ø§Ù„ØªØ­Ø³Ù†</p>
                </div>
              </div>

              {/* Domains */}
              <div>
                <h4 className="font-bold text-slate-800 mb-4">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª</h4>
                <div className="space-y-3">
                  {selectedAuthority.domains.map((domain, idx) => (
                    <div key={idx} className="bg-slate-50 rounded-xl p-4">
                      <div className="flex items-center justify-between mb-2">
                        <div className="flex items-center gap-3">
                          <span className="text-xl">{getLevelConfig(domain.level).icon}</span>
                          <div>
                            <p className="font-bold text-slate-800">{domain.name}</p>
                            <p className="text-xs text-slate-500">{domain.nameEn}</p>
                          </div>
                        </div>
                        <div className="text-left">
                          <p className="text-xl font-black text-slate-800">{domain.score}%</p>
                          <p className="text-xs text-slate-500">L{domain.level}</p>
                        </div>
                      </div>
                      <div className="h-2 bg-slate-200 rounded-full overflow-hidden">
                        <div className={`h-full rounded-full ${domain.score >= 80 ? 'bg-emerald-500' :
                            domain.score >= 60 ? 'bg-blue-500' :
                              domain.score >= 40 ? 'bg-amber-500' : 'bg-red-500'
                          }`} style={{ width: `${domain.score}%` }}></div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Info */}
              <div className="grid grid-cols-2 gap-4">
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…</p>
                  <p className="font-bold text-slate-800">{selectedAuthority.assessor}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</p>
                  <p className="font-bold text-slate-800">{selectedAuthority.assessmentDate}</p>
                </div>
              </div>
            </div>

            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowDetailModal(false)} className="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥ØºÙ„Ø§Ù‚</button>
              <div className="flex items-center gap-2">
                <button className="flex items-center gap-2 px-5 py-2.5 bg-amber-100 text-amber-700 rounded-xl font-bold hover:bg-amber-200">
                  <Edit className="w-4 h-4" />ØªØ¹Ø¯ÙŠÙ„
                </button>
                <button className="flex items-center gap-2 px-5 py-2.5 bg-purple-100 text-purple-700 rounded-xl font-bold hover:bg-purple-200">
                  <FileText className="w-4 h-4" />ØªÙ‚Ø±ÙŠØ±
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ASSESSMENT MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showAssessmentModal && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-5 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-2xl bg-white/20 flex items-center justify-center">
                    <Plus className="w-7 h-7" />
                  </div>
                  <div>
                    <h2 className="text-xl font-bold">Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø¬Ø¯ÙŠØ¯</h2>
                    <p className="text-purple-200">New Maturity Assessment</p>
                  </div>
                </div>
                <button onClick={() => setShowAssessmentModal(false)} className="w-12 h-12 flex items-center justify-center bg-white/20 hover:bg-white/30 rounded-xl">
                  <X className="w-6 h-6" />
                </button>
              </div>
            </div>

            <div className="p-6 space-y-5">
              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© *</label>
                <select className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none">
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø©...</option>
                  {AUTHORITIES.map(a => <option key={a.id} value={a.id}>{a.code} - {a.nameAr}</option>)}
                </select>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ</label>
                  <select className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    {Object.values(MATURITY_LEVELS).map(l => (
                      <option key={l.level} value={l.level}>{l.icon} L{l.level} - {l.name}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</label>
                  <select className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                    {Object.values(MATURITY_LEVELS).map(l => (
                      <option key={l.level} value={l.level}>{l.icon} L{l.level} - {l.name}</option>
                    ))}
                  </select>
                </div>
              </div>

              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…</label>
                <select className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl">
                  <option>Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø¹ÙŠØ¯</option>
                  <option>ÙØ§Ø·Ù…Ø© Ø§Ù„Ø£Ø­Ù…Ø¯</option>
                  <option>Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ</option>
                </select>
              </div>

              <div>
                <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                <textarea rows={3} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl resize-none" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
              </div>
            </div>

            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => setShowAssessmentModal(false)} className="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={() => { alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­!'); setShowAssessmentModal(false); }} className="flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold shadow-lg">
                <Save className="w-5 h-5" />Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Module 5.4: Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ
// Saudi Regulatory Pack v1 - World-Class Premium Edition
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ADVANCED ACTIVATION WIZARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SaudiRegulatoryPack = () => {
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // STATE MANAGEMENT - Premium Edition
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const [activeTab, setActiveTab] = useState('catalog');
  const [searchQuery, setSearchQuery] = useState('');
  const [filterAuthority, setFilterAuthority] = useState('');
  const [filterSeverity, setFilterSeverity] = useState('');
  const [filterSector, setFilterSector] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [filterCountry, setFilterCountry] = useState('');
  const [viewMode, setViewMode] = useState('table');

  // Modal States
  const [showProgramModal, setShowProgramModal] = useState(false);
  const [showObligationModal, setShowObligationModal] = useState(false);
  const [showStandardModal, setShowStandardModal] = useState(false);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [showAdvancedWizard, setShowAdvancedWizard] = useState(false);
  const [programModalTab, setProgramModalTab] = useState(0);

  // Edit States
  const [editMode, setEditMode] = useState(false);
  const [selectedProgram, setSelectedProgram] = useState(null);
  const [selectedObligation, setSelectedObligation] = useState(null);
  const [deleteTarget, setDeleteTarget] = useState(null);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // REFERENCE DATA - Comprehensive
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const authorities = [
    { code: 'MOI-NIC', name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© - Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠ', nameEn: 'Ministry of Interior - NIC', country: 'SA' },
    { code: 'SAMA', name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', nameEn: 'Saudi Central Bank', country: 'SA' },
    { code: 'NCA', name: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', nameEn: 'National Cybersecurity Authority', country: 'SA' },
    { code: 'SDAIA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', nameEn: 'Saudi Data & AI Authority', country: 'SA' },
    { code: 'ZATCA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ', nameEn: 'Zakat, Tax & Customs Authority', country: 'SA' },
    { code: 'CMA', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', nameEn: 'Capital Market Authority', country: 'SA' },
    { code: 'CITC', name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', nameEn: 'Communications & IT Commission', country: 'SA' },
    { code: 'MHRSD', name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', nameEn: 'Ministry of Human Resources', country: 'SA' },
    { code: 'MOH', name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©', nameEn: 'Ministry of Health', country: 'SA' },
    { code: 'CBAHI', name: 'Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØµØ­ÙŠØ©', nameEn: 'CBAHI', country: 'SA' },
    { code: 'SFDA', name: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØºØ°Ø§Ø¡ ÙˆØ§Ù„Ø¯ÙˆØ§Ø¡', nameEn: 'Saudi FDA', country: 'SA' },
    { code: 'CD', name: 'Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ', nameEn: 'Civil Defense', country: 'SA' },
    { code: 'GOSI', name: 'Ø§Ù„Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©', nameEn: 'GOSI', country: 'SA' },
    { code: 'ISO', name: 'Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ±', nameEn: 'ISO', country: 'INT' },
    { code: 'PCI-SSC', name: 'Ù…Ø¬Ù„Ø³ Ù…Ø¹Ø§ÙŠÙŠØ± Ø£Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹', nameEn: 'PCI Security Standards Council', country: 'INT' },
    { code: 'AICPA', name: 'Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ Ù„Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠÙ†', nameEn: 'AICPA', country: 'INT' },
    { code: 'EU', name: 'Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ', nameEn: 'European Union', country: 'INT' },
  ];

  const sectors = [
    'Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ„', 'Ø§Ù„ØªØ£Ù…ÙŠÙ†', 'Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
    'Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ ÙˆØ§Ù„Ø¶ÙŠØ§ÙØ©', 'ØªØ£Ø¬ÙŠØ± Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª', 'Ø§Ù„Ø¹Ù‚Ø§Ø±', 'Ø§Ù„Ø°Ù‡Ø¨ ÙˆØ§Ù„Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª',
    'Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©', 'Ø§Ù„Ø£Ø¯ÙˆÙŠØ©', 'Ø§Ù„ØªØ¬Ø²Ø¦Ø©', 'Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
    'Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª', 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ø·Ø§Ù‚Ø©', 'Ø§Ù„Ù†ÙØ· ÙˆØ§Ù„ØºØ§Ø²',
    'Ø§Ù„ØªØµÙ†ÙŠØ¹', 'Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ù„ÙˆØ¬Ø³ØªÙŠØ§Øª', 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…', 'Ø§Ù„Ø­ÙƒÙˆÙ…Ø©',
    'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'
  ];

  const severities = ['Critical', 'High', 'Medium', 'Low'];
  const recurrences = ['Once', 'Daily', 'Weekly', 'Monthly', 'Quarterly', 'Semi-Annual', 'Annual', 'Continuous', 'On Demand', 'On Incident', 'Per Transaction'];
  const programTypes = ['Mandatory', 'Voluntary', 'Conditional', 'Industry Standard'];
  const countries = [
    { code: 'SA', name: 'Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', flag: 'ğŸ‡¸ğŸ‡¦' },
    { code: 'INT', name: 'Ø¯ÙˆÙ„ÙŠ', flag: 'ğŸŒ' },
    { code: 'US', name: 'Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©', flag: 'ğŸ‡ºğŸ‡¸' },
    { code: 'EU', name: 'Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ', flag: 'ğŸ‡ªğŸ‡º' },
  ];
  const icons = ['ğŸ›¡ï¸', 'ğŸ¦', 'ğŸ”', 'ğŸ“Š', 'ğŸ§¾', 'ğŸ“ˆ', 'ğŸ¥', 'ğŸ‘¥', 'ğŸš’', 'ğŸ“‹', 'âš–ï¸', 'ğŸ”’', 'ğŸ’³', 'ğŸŒ', 'ğŸ“¡', 'ğŸ­', 'ğŸš—', 'ğŸ¨', 'ğŸ’Š', 'ğŸ“', 'ğŸ›ï¸', 'â˜ï¸', 'ğŸ”‘', 'ğŸ“±'];

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // PROGRAMS DATA - Complete Saudi & International Regulatory Programs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const [programs, setPrograms] = useState([
    // â•â•â•â•â•â•â•â•â•â• 1. SHOMOOS - MOI â•â•â•â•â•â•â•â•â•â•
    {
      id: 1,
      code: 'SA-MOI-SHOMOOS',
      name: 'Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ Ø§Ù„Ø£Ù…Ù†ÙŠ',
      nameEn: 'Shomoos Security System',
      authority: 'MOI-NIC',
      authorityName: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© - Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠ',
      icon: 'ğŸ›¡ï¸',
      color: 'red',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2.0',
      effectiveDate: '2020-01-01',
      lastUpdated: '2024-06-15',
      description: 'Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ Ø§Ù„Ø£Ù…Ù†ÙŠ Ù„Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø±ØµØ¯ Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„Ù†Ø²Ù„Ø§Ø¡ ÙˆØ§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ø£Ù…Ù†ÙŠØ©',
      scope: 'ÙŠØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØªÙŠ ØªØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø²Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØªØªØ·Ù„Ø¨ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©',
      sectorAr: ['Ø§Ù„ÙÙ†Ø§Ø¯Ù‚ ÙˆØ§Ù„Ø¶ÙŠØ§ÙØ©', 'ØªØ£Ø¬ÙŠØ± Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª', 'Ø§Ù„Ø¹Ù‚Ø§Ø±', 'Ø§Ù„Ø°Ù‡Ø¨ ÙˆØ§Ù„Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø© Ù…Ø§Ù„ÙŠØ© ØªØµÙ„ Ø¥Ù„Ù‰ 100,000 Ø±ÙŠØ§Ù„ + Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø´Ø§Ø· + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª',
      penaltyDetails: {
        financial: { min: 10000, max: 100000, currency: 'SAR' },
        operational: ['Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù†Ø´Ø£Ø©', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø±Ø®ØµØ©', 'Ù…Ù†Ø¹ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©'],
        criminal: 'Ù‚Ø¯ ØªØµÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ³ØªØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ÙŠÙ†'
      },
      complianceRate: 85,
      riskScore: 9,
      obligations: [
        { code: 'SHM-OBL-001', title: 'Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠ ÙÙŠ Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ Ù‚Ø¨Ù„ Ù…Ø²Ø§ÙˆÙ„Ø© Ø§Ù„Ù†Ø´Ø§Ø·', description: 'ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„Ù†Ø´Ø§Ø·', severity: 'Critical', recurrence: 'Once', deadline: 'Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø´Ø§Ø·', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„', 'Ø¹Ù‚Ø¯ Ø§Ù„Ø±Ø¨Ø· Ø§Ù„ØªÙ‚Ù†ÙŠ'] },
        { code: 'SHM-OBL-002', title: 'Ø±ÙØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡/Ø§Ù„Ù†Ø²Ù„Ø§Ø¡ ÙÙˆØ±ÙŠØ§Ù‹ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…', description: 'Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ù†Ø²ÙŠÙ„ Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰ Ù…Ù† ÙˆÙ‚Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„', severity: 'Critical', recurrence: 'Per Transaction', deadline: 'â‰¤ 1 Ø³Ø§Ø¹Ø©', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ£Ø®ÙŠØ±'] },
        { code: 'SHM-OBL-003', title: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚Ø§Ø±Ø¦ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯', description: 'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¬Ù‡Ø²Ø© Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ù…Ù† NIC Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚', severity: 'High', recurrence: 'Per Transaction', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ù…Ø³Ø­', 'ØµÙˆØ± Ø§Ù„Ù‡ÙˆÙŠØ©'] },
        { code: 'SHM-OBL-004', title: 'Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ØªØ¹Ø§Ù…Ù„ÙŠÙ† Ù„Ù…Ø¯Ø© 5 Ø³Ù†ÙˆØ§Øª', description: 'Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…Ø¯Ø© Ù„Ø§ ØªÙ‚Ù„ Ø¹Ù† 5 Ø³Ù†ÙˆØ§Øª', severity: 'High', recurrence: 'Continuous', deadline: '5 Ø³Ù†ÙˆØ§Øª', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ø±Ø´ÙŠÙ', 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸'] },
        { code: 'SHM-OBL-005', title: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙØªÙŠØ´ ÙˆØ§Ù„ØªØ­Ø±ÙŠØ§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© ÙˆØªÙˆÙÙŠØ± Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙˆØ±Ø§Ù‹', severity: 'Critical', recurrence: 'On Demand', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª', 'Ù…Ø­Ø§Ø¶Ø± Ø§Ù„ØªÙØªÙŠØ´'] },
        { code: 'SHM-OBL-006', title: 'Ø¹Ø¯Ù… Ø¥ÙŠÙˆØ§Ø¡ Ø£Ùˆ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙÙŠÙ† Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©', description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© ÙˆØ§Ù„ØªØ£Ø´ÙŠØ±Ø© ÙˆØ¹Ø¯Ù… Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙÙŠÙ†', severity: 'Critical', recurrence: 'Continuous', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ­Ù‚Ù‚', 'Ø³Ø¬Ù„ Ø§Ù„Ø±ÙØ¶'] },
        { code: 'SHM-OBL-007', title: 'ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…', description: 'Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø£ÙŠ ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø´Ø£Ø© Ø®Ù„Ø§Ù„ 7 Ø£ÙŠØ§Ù…', severity: 'Medium', recurrence: 'On Demand', deadline: '7 Ø£ÙŠØ§Ù…', evidenceRequired: ['Ø·Ù„Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠØ«', 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯'] },
      ],
      standards: [
        { code: 'STD-SHM-01', title: 'ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ù†Ø²ÙŠÙ„ Ø®Ù„Ø§Ù„ â‰¤ 1 Ø³Ø§Ø¹Ø©', metric: 'â‰¤ 60 Ø¯Ù‚ÙŠÙ‚Ø©', target: 100, unit: '%' },
        { code: 'STD-SHM-02', title: 'Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ', metric: 'â‰¥ 99.5%', target: 99.5, unit: '%' },
        { code: 'STD-SHM-03', title: 'ØªÙˆÙØ± Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ø±Ø¨Ø· Ø§Ù„ØªÙ‚Ù†ÙŠ', metric: 'â‰¥ 99.9%', target: 99.9, unit: '%' },
        { code: 'STD-SHM-04', title: 'Ø¯Ù‚Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø´Ù…ÙˆØ³', 'ØªÙ‚Ø±ÙŠØ± Ù…Ø³Ø­ Ø§Ù„Ù‡ÙˆÙŠØ©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø±Ø¨Ø· Ø§Ù„ØªÙ‚Ù†ÙŠ', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ'],
      schedule: [
        { frequency: 'Real-time', task: 'Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù†Ø²Ù„Ø§Ø¡/Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', responsible: 'Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' },
        { frequency: 'Daily', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§Ù„ØªØ£Ø®ÙŠØ±', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
        { frequency: 'Weekly', task: 'ØªÙ‚Ø±ÙŠØ± Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø±Ø¨Ø· Ø§Ù„ØªÙ‚Ù†ÙŠ', responsible: 'Ù‚Ø³Ù… IT' },
        { frequency: 'Monthly', task: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø´Ø§Ù…Ù„', responsible: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
        { frequency: 'Quarterly', task: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ NIC', responsible: 'Ù‚Ø³Ù… IT' },
      ],
      breachTriggers: ['TaskOverdue>0', 'SubmissionDelay>1h', 'SystemDowntime>1h', 'IdentityMismatch>0'],
      contacts: [
        { name: 'Ù…Ø±ÙƒØ² Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ', email: 'support@nic.gov.sa', phone: '920000911' },
        { name: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', email: 'compliance@nic.gov.sa', phone: '0114567890' },
      ],
      resources: [
        { name: 'Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', url: 'https://nic.gov.sa/shomoos/guide', type: 'PDF' },
        { name: 'Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©', url: 'https://nic.gov.sa/shomoos/tech', type: 'PDF' },
      ],
    },
    // â•â•â•â•â•â•â•â•â•â• 2. SAMA Cybersecurity Framework â•â•â•â•â•â•â•â•â•â•
    {
      id: 2,
      code: 'SA-SAMA-CSF',
      name: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ù„Ø³Ø§Ù…Ø§',
      nameEn: 'SAMA Cybersecurity Framework',
      authority: 'SAMA',
      authorityName: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ',
      icon: 'ğŸ¦',
      color: 'emerald',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '3.0',
      effectiveDate: '2017-05-01',
      lastUpdated: '2024-01-15',
      description: 'Ø¥Ø·Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙŠØ­Ø¯Ø¯ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ù„Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ø¥Ø´Ø±Ø§Ù Ø³Ø§Ù…Ø§',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ´Ø±ÙƒØ§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ§Ù„ØªØ£Ù…ÙŠÙ† ÙˆØ´Ø±ÙƒØ§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø±Ø®ØµØ©',
      sectorAr: ['Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ„', 'Ø§Ù„ØªØ£Ù…ÙŠÙ†', 'Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 10 Ù…Ù„Ø§ÙŠÙŠÙ† Ø±ÙŠØ§Ù„ + ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„ØªØ±Ø®ÙŠØµ + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª',
      penaltyDetails: {
        financial: { min: 100000, max: 10000000, currency: 'SAR' },
        operational: ['ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„ØªØ±Ø®ÙŠØµ', 'Ø¥ÙŠÙ‚Ø§Ù Ø®Ø¯Ù…Ø§Øª Ù…Ø¹ÙŠÙ†Ø©', 'Ø²ÙŠØ§Ø¯Ø© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„'],
        criminal: 'Ù‚Ø¯ ØªØ´Ù…Ù„ Ø¹Ù‚ÙˆØ¨Ø§Øª Ø¬Ù†Ø§Ø¦ÙŠØ© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø¬Ø³ÙŠÙ…'
      },
      complianceRate: 78,
      riskScore: 10,
      obligations: [
        { code: 'SAMA-CSF-001', title: 'ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø·Ø§Ø± Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', description: 'Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø­ÙˆÙƒÙ…Ø© Ø´Ø§Ù…Ù„ Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙŠØ´Ù…Ù„ Ø§Ù„Ù„Ø¬Ø§Ù† ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ù…ÙŠØ«Ø§Ù‚ Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ù„Ø¬Ø§Ù†', 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©'] },
        { code: 'SAMA-CSF-002', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©', description: 'Ø¥Ø¨Ù„Ø§Øº Ø³Ø§Ù…Ø§ Ø¹Ù† Ø£ÙŠ Ø­Ø§Ø¯Ø« Ø£Ù…Ù†ÙŠ Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø© Ù…Ù† Ø§ÙƒØªØ´Ø§ÙÙ‡', severity: 'Critical', recurrence: 'On Incident', deadline: '24 Ø³Ø§Ø¹Ø©', evidenceRequired: ['Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ø¯Ø«', 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'] },
        { code: 'SAMA-CSF-003', title: 'ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„', description: 'ØªØ·Ø¨ÙŠÙ‚ MFA ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø¯ÙˆØ±ÙŠØ©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø© IAM', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„'] },
        { code: 'SAMA-CSF-004', title: 'Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©', description: 'ØªÙ‚ÙŠÙŠÙ… ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù…Ø²ÙˆØ¯ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ†', severity: 'High', recurrence: 'Quarterly', deadline: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø£Ù…Ø§Ù†', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©'] },
        { code: 'SAMA-CSF-005', title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø³Ù†ÙˆÙŠ', description: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø®ØªØ±Ø§Ù‚ Ø´Ø§Ù…Ù„ Ø³Ù†ÙˆÙŠØ§Ù‹ Ù…Ù† Ø¬Ù‡Ø© Ù…Ø³ØªÙ‚Ù„Ø© Ù…Ø¹ØªÙ…Ø¯Ø©', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ù‡Ø©'] },
        { code: 'SAMA-CSF-006', title: 'ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙˆØ¹ÙŠØ© Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'ØªØ¯Ø±ÙŠØ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ø®Ø·Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±', 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª'] },
        { code: 'SAMA-CSF-007', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'ÙØ­Øµ ÙˆØªÙ‚ÙŠÙŠÙ… ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ', severity: 'Critical', recurrence: 'Monthly', deadline: 'Ø´Ù‡Ø±ÙŠ', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ', 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡'] },
        { code: 'SAMA-CSF-008', title: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', description: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ø³Ù†ÙˆÙŠ Ø´Ø§Ù…Ù„ Ø¹Ù† ÙˆØ¶Ø¹ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ù„Ø³Ø§Ù…Ø§', severity: 'High', recurrence: 'Annual', deadline: 'Q1', evidenceRequired: ['Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ', 'Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ù…Ø¯Ù‚Ù‚', 'Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†'] },
      ],
      standards: [
        { code: 'STD-SAMA-01', title: 'ØªØ·Ø¨ÙŠÙ‚ MFA Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ø³Ø§Ø³Ø©', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-SAMA-02', title: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø­Ø±Ø¬Ø©', metric: 'â‰¤ 7 Ø£ÙŠØ§Ù…', target: 7, unit: 'days' },
        { code: 'STD-SAMA-03', title: 'ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©', metric: 'AES-256', target: 100, unit: '%' },
        { code: 'STD-SAMA-04', title: 'ØªÙˆÙØ± SOC 24/7', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-SAMA-05', title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø®Ø·Ø© Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', metric: 'Ø³Ù†ÙˆÙŠ', target: 1, unit: 'per year' },
      ],
      evidenceTypes: ['Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', 'ØªÙ‚Ø§Ø±ÙŠØ± SOC', 'Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­ÙˆØ§Ø¯Ø«', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', 'Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚'],
      schedule: [
        { frequency: 'Daily', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ†Ø¨ÙŠÙ‡Ø§Øª SOC', responsible: 'ÙØ±ÙŠÙ‚ SOC' },
        { frequency: 'Weekly', task: 'ØªÙ‚Ø±ÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø«ØºØ±Ø§Øª', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†' },
        { frequency: 'Monthly', task: 'Ø§Ø¬ØªÙ…Ø§Ø¹ Ù„Ø¬Ù†Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', responsible: 'CISO' },
        { frequency: 'Quarterly', task: 'ØªÙ‚ÙŠÙŠÙ… Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ø·Ø±Ø§Ù Ø§Ù„Ø«Ø§Ù„Ø«Ø©', responsible: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±' },
        { frequency: 'Annual', task: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ ÙˆØ§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³Ù†ÙˆÙŠ', responsible: 'CISO' },
      ],
      breachTriggers: ['IncidentNotReported>24h', 'CriticalVulnerability>7d', 'MFANotEnabled', 'PenTestOverdue'],
      contacts: [
        { name: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ - Ø³Ø§Ù…Ø§', email: 'cybersecurity@sama.gov.sa', phone: '0114662333' },
      ],
      resources: [
        { name: 'Ø¥Ø·Ø§Ø± Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', url: 'https://sama.gov.sa/csf', type: 'PDF' },
        { name: 'Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø«', url: 'https://sama.gov.sa/incident', type: 'PDF' },
      ],
    },
    // â•â•â•â•â•â•â•â•â•â• 3. NCA ECC â•â•â•â•â•â•â•â•â•â•
    {
      id: 3,
      code: 'SA-NCA-ECC',
      name: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      nameEn: 'Essential Cybersecurity Controls (ECC)',
      authority: 'NCA',
      authorityName: 'Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ',
      icon: 'ğŸ”',
      color: 'purple',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2.0',
      effectiveDate: '2018-09-01',
      lastUpdated: '2024-03-01',
      description: 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ECC 2.0 - Ø¥Ø·Ø§Ø± ÙˆØ·Ù†ÙŠ Ø´Ø§Ù…Ù„ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„ÙØ¶Ø§Ø¡ Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ø§Ù„Ø­Ø±Ø¬Ø© ÙˆØ§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ',
      sectorAr: ['Ø§Ù„Ø­ÙƒÙˆÙ…Ø©', 'Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© Ø§Ù„Ø­Ø±Ø¬Ø©', 'Ø§Ù„Ø·Ø§Ù‚Ø©', 'Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª', 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©'],
      penalty: 'Ø¹Ù‚ÙˆØ¨Ø§Øª ØªÙ†Ø¸ÙŠÙ…ÙŠØ© + Ø¥Ù„Ø²Ø§Ù… Ø¨Ø§Ù„Ø¥ØµÙ„Ø§Ø­ + ØºØ±Ø§Ù…Ø§Øª Ù…Ø§Ù„ÙŠØ©',
      penaltyDetails: {
        financial: { min: 50000, max: 5000000, currency: 'SAR' },
        operational: ['Ø¥Ù„Ø²Ø§Ù… Ø¨Ø§Ù„Ø¥ØµÙ„Ø§Ø­', 'ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„Ø®Ø¯Ù…Ø§Øª', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹'],
        criminal: 'Ø¹Ù‚ÙˆØ¨Ø§Øª Ø¬Ù†Ø§Ø¦ÙŠØ© Ø­Ø³Ø¨ Ù†Ø¸Ø§Ù… Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¬Ø±Ø§Ø¦Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©'
      },
      complianceRate: 72,
      riskScore: 9,
      obligations: [
        { code: 'NCA-ECC-001', title: 'Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', description: 'Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªÙˆØ«ÙŠÙ‚ Ø¥Ø·Ø§Ø± Ø­ÙˆÙƒÙ…Ø© Ø´Ø§Ù…Ù„ Ù„Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ù…ÙŠØ«Ø§Ù‚ Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª'] },
        { code: 'NCA-ECC-002', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©', description: 'Ø¬Ø±Ø¯ ÙˆØªØµÙ†ÙŠÙ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø£ØµÙˆÙ„', 'ØªØµÙ†ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ø§Ù„Ù…Ø§Ù„ÙƒÙŠÙ†'] },
        { code: 'NCA-ECC-003', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ù‚ÙˆÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆÙŠØ© ÙˆØ§Ù„ÙˆØµÙˆÙ„', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø© IAM', 'Ù…ØµÙÙˆÙØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'] },
        { code: 'NCA-ECC-004', title: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ø´Ø¨ÙƒØ§Øª', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù„Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ø´Ø¨ÙƒØ§Øª', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«'] },
        { code: 'NCA-ECC-005', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'Ø§ÙƒØªØ´Ø§Ù ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©', severity: 'High', recurrence: 'Monthly', deadline: 'Ø´Ù‡Ø±ÙŠ', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ', 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª'] },
        { code: 'NCA-ECC-006', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠØ©', description: 'Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© ÙˆØ§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠØ©', severity: 'Critical', recurrence: 'On Incident', deadline: '4 Ø³Ø§Ø¹Ø§Øª', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ø¯Ø«', 'Ø³Ø¬Ù„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©', 'Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø³ØªÙØ§Ø¯Ø©'] },
        { code: 'NCA-ECC-007', title: 'Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠØ©', description: 'Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠØ©', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ø®Ø·Ø© BCP', 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'ØªÙ‚Ø±ÙŠØ± DR'] },
        { code: 'NCA-ECC-008', title: 'Ø£Ù…Ù† Ø§Ù„Ø­ÙˆØ³Ø¨Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø¶ÙˆØ§Ø¨Ø· Ø£Ù…Ù† Ø§Ù„Ø­ÙˆØ³Ø¨Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø²ÙˆØ¯', 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©'] },
      ],
      standards: [
        { code: 'STD-NCA-01', title: 'Ù†Ø³Ø¨Ø© Ø¬Ø±Ø¯ Ø§Ù„Ø£ØµÙˆÙ„', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-NCA-02', title: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø­Ø±Ø¬Ø©', metric: 'â‰¤ 48 Ø³Ø§Ø¹Ø©', target: 48, unit: 'hours' },
        { code: 'STD-NCA-03', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø«', metric: 'â‰¤ 4 Ø³Ø§Ø¹Ø§Øª', target: 4, unit: 'hours' },
        { code: 'STD-NCA-04', title: 'Ø§Ø®ØªØ¨Ø§Ø± BCP/DR', metric: 'Ø³Ù†ÙˆÙŠ', target: 1, unit: 'per year' },
      ],
      evidenceTypes: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù…ØªØ«Ø§Ù„ ECC', 'Ø³Ø¬Ù„ Ø§Ù„Ø£ØµÙˆÙ„', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø«ØºØ±Ø§Øª', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­ÙˆØ§Ø¯Ø«', 'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª'],
      schedule: [
        { frequency: 'Daily', task: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª', responsible: 'ÙØ±ÙŠÙ‚ SOC' },
        { frequency: 'Monthly', task: 'ÙØ­Øµ Ø§Ù„Ø«ØºØ±Ø§Øª', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù†' },
        { frequency: 'Quarterly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù…ØªØ«Ø§Ù„ ECC', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
        { frequency: 'Annual', task: 'ØªÙ‚ÙŠÙŠÙ… Ø´Ø§Ù…Ù„ ÙˆØªÙ‚Ø±ÙŠØ± NCA', responsible: 'CISO' },
      ],
      breachTriggers: ['ECCControlFailed', 'IncidentNotReported>4h', 'CriticalAssetUnpatched>48h'],
      contacts: [
        { name: 'Ø¨ÙˆØ§Ø¨Ø© Ø­ØµÙŠÙ†', email: 'haseen@nca.gov.sa', phone: '920020405' },
      ],
      resources: [
        { name: 'Ø¶ÙˆØ§Ø¨Ø· ECC 2.0', url: 'https://nca.gov.sa/ecc', type: 'PDF' },
      ],
    },
    // â•â•â•â•â•â•â•â•â•â• 4. PDPL â•â•â•â•â•â•â•â•â•â•
    {
      id: 4,
      code: 'SA-SDAIA-PDPL',
      name: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
      nameEn: 'Personal Data Protection Law (PDPL)',
      authority: 'SDAIA',
      authorityName: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
      icon: 'ğŸ“Š',
      color: 'indigo',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '1.0',
      effectiveDate: '2023-09-14',
      lastUpdated: '2024-03-01',
      description: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© - Ø¥Ø·Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø´Ø§Ù…Ù„ Ù„Ø­Ù…Ø§ÙŠØ© Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ©',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„ØªÙŠ ØªØ¬Ù…Ø¹ Ø£Ùˆ ØªØ¹Ø§Ù„Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù…Ù„ÙƒØ©',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 5 Ù…Ù„Ø§ÙŠÙŠÙ† Ø±ÙŠØ§Ù„ + Ø§Ù„Ø³Ø¬Ù† Ø­ØªÙ‰ Ø³Ù†ØªÙŠÙ†',
      penaltyDetails: {
        financial: { min: 5000, max: 5000000, currency: 'SAR' },
        operational: ['Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ù†Ø´Ø± Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©'],
        criminal: 'Ø§Ù„Ø³Ø¬Ù† Ø­ØªÙ‰ Ø³Ù†ØªÙŠÙ† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥ÙØ´Ø§Ø¡ Ø£Ùˆ Ø¥Ø³Ø§Ø¡Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…'
      },
      complianceRate: 65,
      riskScore: 8,
      obligations: [
        { code: 'PDPL-OBL-001', title: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØµØ§Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', description: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØµØ±ÙŠØ­Ø© ÙˆÙ…Ø³ØªÙ†ÙŠØ±Ø© Ù‚Ø¨Ù„ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', severity: 'Critical', recurrence: 'Per Collection', deadline: 'Ù‚Ø¨Ù„ Ø§Ù„Ø¬Ù…Ø¹', evidenceRequired: ['Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©', 'Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª', 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø®ØµÙˆØµÙŠØ©'] },
        { code: 'PDPL-OBL-002', title: 'ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¨Ø¯Ø£ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØºØ±Ø¶', description: 'Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙ‚Ø· Ù„Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙˆØ§Ù„Ù…Ø´Ø±ÙˆØ¹Ø©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø£ØºØ±Ø§Ø¶', 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¶Ø±ÙˆØ±Ø©'] },
        { code: 'PDPL-OBL-003', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©', description: 'Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø®ØªØµØ© ÙˆØ£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù† Ø£ÙŠ Ø§Ø®ØªØ±Ø§Ù‚', severity: 'Critical', recurrence: 'On Breach', deadline: '72 Ø³Ø§Ø¹Ø©', evidenceRequired: ['Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', 'Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¶Ø±Ø±ÙŠÙ†'] },
        { code: 'PDPL-OBL-004', title: 'ØªÙ…ÙƒÙŠÙ† Ø­Ù‚ÙˆÙ‚ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', description: 'Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„ ÙˆØ§Ù„ØªØµØ­ÙŠØ­ ÙˆØ§Ù„Ø­Ø°Ù', severity: 'High', recurrence: 'On Request', deadline: '30 ÙŠÙˆÙ…', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©'] },
        { code: 'PDPL-OBL-005', title: 'ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', description: 'ØªØ¹ÙŠÙŠÙ† DPO Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„ØªÙŠ ØªØ¹Ø§Ù„Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ø£Ùˆ ÙˆØ§Ø³Ø¹Ø© Ø§Ù„Ù†Ø·Ø§Ù‚', severity: 'High', recurrence: 'Once', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ¹ÙŠÙŠÙ†', 'Ø§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª', 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„'] },
        { code: 'PDPL-OBL-006', title: 'Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®ØµÙˆØµÙŠØ©', description: 'DPIA Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', severity: 'High', recurrence: 'On Demand', deadline: 'Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± DPIA', 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ®ÙÙŠÙ', 'Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª'] },
        { code: 'PDPL-OBL-007', title: 'Ø¶Ù…Ø§Ù† Ø£Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', description: 'ØªØ·Ø¨ÙŠÙ‚ ØªØ¯Ø§Ø¨ÙŠØ± Ø£Ù…Ù†ÙŠØ© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©'] },
      ],
      standards: [
        { code: 'STD-PDPL-01', title: 'Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ø§Øª DSR', metric: 'â‰¤ 30 ÙŠÙˆÙ…', target: 30, unit: 'days' },
        { code: 'STD-PDPL-02', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª', metric: 'â‰¤ 72 Ø³Ø§Ø¹Ø©', target: 72, unit: 'hours' },
        { code: 'STD-PDPL-03', title: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± DPIA', 'Ø³Ø¬Ù„Ø§Øª DSR', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª'],
      schedule: [
        { frequency: 'On Request', task: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ø§Øª Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', responsible: 'DPO' },
        { frequency: 'Monthly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', responsible: 'DPO' },
        { frequency: 'Quarterly', task: 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
        { frequency: 'Annual', task: 'ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©', responsible: 'DPO' },
      ],
      breachTriggers: ['BreachNotReported>72h', 'DSRNotProcessed>30d', 'NoConsent', 'DataRetentionExceeded'],
      contacts: [
        { name: 'SDAIA', email: 'pdpl@sdaia.gov.sa', phone: '920000985' },
      ],
      resources: [
        { name: 'Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©', url: 'https://sdaia.gov.sa/pdpl', type: 'PDF' },
        { name: 'Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠØ©', url: 'https://sdaia.gov.sa/pdpl/regulations', type: 'PDF' },
      ],
    },
    // â•â•â•â•â•â•â•â•â•â• 5. ZATCA VAT & E-Invoicing â•â•â•â•â•â•â•â•â•â•
    {
      id: 5,
      code: 'SA-ZATCA-VAT',
      name: 'Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙˆØ§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
      nameEn: 'VAT & FATOORA E-Invoicing',
      authority: 'ZATCA',
      authorityName: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø²ÙƒØ§Ø© ÙˆØ§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙˆØ§Ù„Ø¬Ù…Ø§Ø±Ùƒ',
      icon: 'ğŸ§¾',
      color: 'amber',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2.0',
      effectiveDate: '2018-01-01',
      lastUpdated: '2024-01-01',
      description: 'Ù†Ø¸Ø§Ù… Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© ÙˆÙ…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© (ÙØ§ØªÙˆØ±Ø©) ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ©',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 50% Ù…Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© + ØºØ±Ø§Ù…Ø§Øª ØªØ£Ø®ÙŠØ±',
      penaltyDetails: {
        financial: { min: 1000, max: 50, currency: '%' },
        operational: ['Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©', 'Ø­Ø¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©'],
        criminal: 'Ù‚Ø¯ ØªØµÙ„ Ù„Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªÙ‡Ø±Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ'
      },
      complianceRate: 88,
      riskScore: 8,
      obligations: [
        { code: 'ZATCA-VAT-001', title: 'ØªÙ‚Ø¯ÙŠÙ… Ø¥Ù‚Ø±Ø§Ø±Ø§Øª Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©', description: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©', severity: 'Critical', recurrence: 'Monthly', deadline: 'Ø¢Ø®Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„ØªØ§Ù„ÙŠ', evidenceRequired: ['Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ', 'Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯', 'Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ©'] },
        { code: 'ZATCA-VAT-002', title: 'ØªØ·Ø¨ÙŠÙ‚ Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙˆØªØ±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© - Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©', description: 'Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ù…Ù†Ø¸ÙˆÙ…Ø© ÙØ§ØªÙˆØ±Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø±Ø¨Ø·', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„'] },
        { code: 'ZATCA-VAT-003', title: 'Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©', description: 'Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø³Ø¬Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ© Ù„Ù…Ø¯Ø© 6 Ø³Ù†ÙˆØ§Øª', severity: 'High', recurrence: 'Continuous', deadline: '6 Ø³Ù†ÙˆØ§Øª', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ø±Ø´ÙŠÙ', 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸'] },
        { code: 'ZATCA-VAT-004', title: 'Ø¥ØµØ¯Ø§Ø± ÙÙˆØ§ØªÙŠØ± Ø¶Ø±ÙŠØ¨ÙŠØ© ØµØ­ÙŠØ­Ø©', description: 'Ø¥ØµØ¯Ø§Ø± ÙÙˆØ§ØªÙŠØ± ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', severity: 'High', recurrence: 'Per Transaction', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ÙÙˆØ§ØªÙŠØ±', 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'] },
        { code: 'ZATCA-VAT-005', title: 'Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø©', description: 'Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©', severity: 'Critical', recurrence: 'Monthly', deadline: 'Ù…Ø¹ Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±', evidenceRequired: ['Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¯Ø§Ø¯', 'ÙƒØ´Ù Ø§Ù„Ø¨Ù†Ùƒ'] },
      ],
      standards: [
        { code: 'STD-ZATCA-01', title: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± ÙÙŠ Ø§Ù„Ù…ÙˆØ¹Ø¯', metric: 'On Time', target: 100, unit: '%' },
        { code: 'STD-ZATCA-02', title: 'Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±', metric: 'â‰¥ 99.5%', target: 99.5, unit: '%' },
        { code: 'STD-ZATCA-03', title: 'Ø¯Ù‚Ø© Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø§Ù„Ø¥Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠØ©', 'Ø´Ù‡Ø§Ø¯Ø© ÙØ§ØªÙˆØ±Ø©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙÙˆØ§ØªÙŠØ±', 'Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¯Ø§Ø¯'],
      schedule: [
        { frequency: 'Per Transaction', task: 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', responsible: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª' },
        { frequency: 'Monthly', task: 'Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ', responsible: 'Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©' },
        { frequency: 'Quarterly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ', responsible: 'Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ' },
      ],
      breachTriggers: ['VATReturnLate', 'InvoiceNotCompliant', 'PaymentOverdue', 'IntegrationFailure'],
      contacts: [{ name: 'Ù…Ø±ÙƒØ² Ø§ØªØµØ§Ù„ ZATCA', email: 'info@zatca.gov.sa', phone: '19993' }],
      resources: [{ name: 'Ø¯Ù„ÙŠÙ„ Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©', url: 'https://zatca.gov.sa/vat', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 6. CMA â•â•â•â•â•â•â•â•â•â•
    {
      id: 6,
      code: 'SA-CMA-REGS',
      name: 'Ø£Ù†Ø¸Ù…Ø© ÙˆÙ„ÙˆØ§Ø¦Ø­ Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
      nameEn: 'CMA Regulations',
      authority: 'CMA',
      authorityName: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
      icon: 'ğŸ“ˆ',
      color: 'blue',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2024',
      effectiveDate: '2004-07-31',
      lastUpdated: '2024-06-01',
      description: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ù„ÙˆØ§Ø¦Ø­ Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ù„Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†',
      scope: 'Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø¯Ø±Ø¬Ø© ÙˆØ´Ø±ÙƒØ§Øª Ø§Ù„ÙˆØ³Ø§Ø·Ø© ÙˆØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±',
      sectorAr: ['Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'Ø§Ù„ÙˆØ³Ø§Ø·Ø©', 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙˆÙ„'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 100 Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„ + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ¯Ø§ÙˆÙ„',
      penaltyDetails: {
        financial: { min: 10000, max: 100000000, currency: 'SAR' },
        operational: ['Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ¯Ø§ÙˆÙ„', 'Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ', 'Ù…Ù†Ø¹ Ù…Ù† Ø§Ù„Ø³ÙˆÙ‚'],
        criminal: 'Ø§Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ù„'
      },
      complianceRate: 82,
      riskScore: 9,
      obligations: [
        { code: 'CMA-OBL-001', title: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø¹Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠØ©', description: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù† Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¬ÙˆÙ‡Ø±ÙŠØ© ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø³Ø¹Ø± Ø§Ù„Ø³Ù‡Ù…', severity: 'Critical', recurrence: 'On Demand', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¥ÙØµØ§Ø­', 'Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«'] },
        { code: 'CMA-OBL-002', title: 'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©', description: 'Ù†Ø´Ø± Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø±Ø¨Ø¹ÙŠØ© ÙˆØ§Ù„Ø³Ù†ÙˆÙŠØ©', severity: 'Critical', recurrence: 'Quarterly', deadline: '30 ÙŠÙˆÙ… Ù…Ù† Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©', evidenceRequired: ['Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹'] },
        { code: 'CMA-OBL-003', title: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª', description: 'ØªØ·Ø¨ÙŠÙ‚ Ù„Ø§Ø¦Ø­Ø© Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ù…Ø­Ø§Ø¶Ø± Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'] },
        { code: 'CMA-OBL-004', title: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙÙŠ Ø§Ù„Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª KYC ÙˆAML', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø§Øª AML', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©'] },
        { code: 'CMA-OBL-005', title: 'Ø­Ù…Ø§ÙŠØ© Ø£ØµÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', description: 'ÙØµÙ„ Ø£ØµÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ­Ù…Ø§ÙŠØªÙ‡Ø§', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ÙƒØ´ÙˆÙ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©'] },
      ],
      standards: [
        { code: 'STD-CMA-01', title: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©', metric: 'â‰¤ 24 Ø³Ø§Ø¹Ø©', target: 24, unit: 'hours' },
        { code: 'STD-CMA-02', title: 'Ø¯Ù‚Ø© Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-CMA-03', title: 'ÙØµÙ„ Ø£ØµÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¥ÙØµØ§Ø­', 'Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', 'Ø³Ø¬Ù„Ø§Øª AML'],
      schedule: [
        { frequency: 'On Demand', task: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ', responsible: 'Ø³ÙƒØ±ØªÙŠØ± Ø§Ù„Ø´Ø±ÙƒØ©' },
        { frequency: 'Quarterly', task: 'Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©', responsible: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©' },
        { frequency: 'Annual', task: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø³Ù†ÙˆÙŠ', responsible: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©' },
      ],
      breachTriggers: ['DisclosureDelay>24h', 'FinancialStatementsLate', 'AMLViolation'],
      contacts: [{ name: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø§Ù„ÙŠØ©', email: 'info@cma.org.sa', phone: '920005555' }],
      resources: [{ name: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ù„ÙˆØ§Ø¦Ø­', url: 'https://cma.org.sa/regulations', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 7. SAMA AML/CFT â•â•â•â•â•â•â•â•â•â•
    {
      id: 7,
      code: 'SA-SAMA-AML',
      name: 'Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨',
      nameEn: 'AML/CFT Regulations',
      authority: 'SAMA',
      authorityName: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ',
      icon: 'âš–ï¸',
      color: 'slate',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2023',
      effectiveDate: '2017-08-01',
      lastUpdated: '2023-12-01',
      description: 'Ù†Ø¸Ø§Ù… Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨ ÙˆØ§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©',
      scope: 'Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ´Ø±ÙƒØ§Øª Ø§Ù„ØªÙ…ÙˆÙŠÙ„ ÙˆØ´Ø±ÙƒØ§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙˆÙ…Ù†Ø´Ø¢Øª Ø§Ù„ØµØ±Ø§ÙØ©',
      sectorAr: ['Ø§Ù„Ø¨Ù†ÙˆÙƒ ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ„', 'Ø§Ù„ØªØ£Ù…ÙŠÙ†', 'Ø§Ù„ØµØ±Ø§ÙØ©', 'Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 25 Ù…Ù„ÙŠÙˆÙ† Ø±ÙŠØ§Ù„ + Ø§Ù„Ø³Ø¬Ù† Ø­ØªÙ‰ 15 Ø³Ù†Ø©',
      penaltyDetails: {
        financial: { min: 100000, max: 25000000, currency: 'SAR' },
        operational: ['Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø·', 'Ø­Ø¸Ø± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†'],
        criminal: 'Ø§Ù„Ø³Ø¬Ù† Ù…Ù† 2 Ø¥Ù„Ù‰ 15 Ø³Ù†Ø©'
      },
      complianceRate: 75,
      riskScore: 10,
      obligations: [
        { code: 'AML-OBL-001', title: 'ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ø¹Ø±Ù Ø¹Ù…ÙŠÙ„Ùƒ (KYC)', description: 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØ© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', severity: 'Critical', recurrence: 'Per Customer', deadline: 'Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©', evidenceRequired: ['Ù…Ù„ÙØ§Øª KYC', 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù‡ÙˆÙŠØ©'] },
        { code: 'AML-OBL-002', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø© (STR)', description: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù† Ø£ÙŠ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø©', severity: 'Critical', recurrence: 'On Incident', deadline: '10 Ø£ÙŠØ§Ù… Ø¹Ù…Ù„', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± STR', 'Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„'] },
        { code: 'AML-OBL-003', title: 'ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ AML', description: 'ØªØ¹ÙŠÙŠÙ† MLRO Ù…Ø³ØªÙ‚Ù„ ÙˆÙ…Ø¤Ù‡Ù„', severity: 'Critical', recurrence: 'Once', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ¹ÙŠÙŠÙ†', 'Ø§Ù„Ù…Ø¤Ù‡Ù„Ø§Øª'] },
        { code: 'AML-OBL-004', title: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ AML', description: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¯Ø±ÙŠØ¨ Ø³Ù†ÙˆÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ø®Ø·Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±'] },
        { code: 'AML-OBL-005', title: 'ÙØ­Øµ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', description: 'ÙØ­Øµ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¶Ø¯ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠØ©', severity: 'Critical', recurrence: 'Continuous', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©'] },
        { code: 'AML-OBL-006', title: 'Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø³Ø¬Ù„Ø§Øª 10 Ø³Ù†ÙˆØ§Øª', description: 'Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª', severity: 'High', recurrence: 'Continuous', deadline: '10 Ø³Ù†ÙˆØ§Øª', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ø±Ø´ÙŠÙ'] },
      ],
      standards: [
        { code: 'STD-AML-01', title: 'Ø¥ØªÙ…Ø§Ù… KYC Ù‚Ø¨Ù„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø©', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-AML-02', title: 'ØªÙ‚Ø¯ÙŠÙ… STR Ø®Ù„Ø§Ù„ 10 Ø£ÙŠØ§Ù…', metric: 'â‰¤ 10 Ø£ÙŠØ§Ù…', target: 10, unit: 'days' },
        { code: 'STD-AML-03', title: 'ÙØ­Øµ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª ÙÙˆØ±ÙŠ', metric: 'Real-time', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ù…Ù„ÙØ§Øª KYC', 'ØªÙ‚Ø§Ø±ÙŠØ± STR', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'Ù†ØªØ§Ø¦Ø¬ ÙØ­Øµ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª'],
      schedule: [
        { frequency: 'Real-time', task: 'ÙØ­Øµ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', responsible: 'Ù†Ø¸Ø§Ù… AML' },
        { frequency: 'On Demand', task: 'ØªÙ‚Ø§Ø±ÙŠØ± STR', responsible: 'MLRO' },
        { frequency: 'Annual', task: 'ØªØ¯Ø±ÙŠØ¨ AML', responsible: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©' },
      ],
      breachTriggers: ['STRNotFiled>10d', 'KYCIncomplete', 'SanctionMatch', 'TrainingOverdue'],
      contacts: [{ name: 'ÙˆØ­Ø¯Ø© Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', email: 'aml@sama.gov.sa', phone: '0114662000' }],
      resources: [{ name: 'Ù†Ø¸Ø§Ù… Ù…ÙƒØ§ÙØ­Ø© ØºØ³Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„', url: 'https://sama.gov.sa/aml', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 8. CBAHI/GAHAR â•â•â•â•â•â•â•â•â•â•
    {
      id: 8,
      code: 'SA-CBAHI-GAHAR',
      name: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ØµØ­ÙŠ Ø§Ù„ÙˆØ·Ù†ÙŠØ©',
      nameEn: 'CBAHI Healthcare Accreditation',
      authority: 'CBAHI',
      authorityName: 'Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØµØ­ÙŠØ©',
      icon: 'ğŸ¥',
      color: 'teal',
      criticality: 'High',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '4.0',
      effectiveDate: '2006-01-01',
      lastUpdated: '2024-01-01',
      description: 'Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØµØ­ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø© ÙˆØ³Ù„Ø§Ù…Ø© Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØµØ­ÙŠØ© (Ù…Ø³ØªØ´ÙÙŠØ§ØªØŒ Ù…Ø±Ø§ÙƒØ² Ø·Ø¨ÙŠØ©ØŒ Ø¹ÙŠØ§Ø¯Ø§Øª)',
      sectorAr: ['Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©'],
      penalty: 'Ø³Ø­Ø¨ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ±Ø®ÙŠØµ + ØºØ±Ø§Ù…Ø§Øª',
      penaltyDetails: {
        financial: { min: 10000, max: 1000000, currency: 'SAR' },
        operational: ['Ø³Ø­Ø¨ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ±Ø®ÙŠØµ', 'Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø³Ù…'],
        criminal: 'Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¬Ù†Ø§Ø¦ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø·Ø¨ÙŠ'
      },
      complianceRate: 70,
      riskScore: 8,
      obligations: [
        { code: 'CBAHI-OBL-001', title: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠ', description: 'Ø§Ø¬ØªÙŠØ§Ø² ØªÙ‚ÙŠÙŠÙ… CBAHI ÙˆØ§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', severity: 'Critical', recurrence: 'Once', deadline: 'Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…'] },
        { code: 'CBAHI-OBL-002', title: 'ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„Ù…Ø±Ø¶Ù‰', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­ÙˆØ§Ø¯Ø«'] },
        { code: 'CBAHI-OBL-003', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ…Ø±', description: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆÙ‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø¯Ø§Ø¡', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©', 'Ø®Ø·Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ†'] },
        { code: 'CBAHI-OBL-004', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©', description: 'ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„ ÙˆØ¯Ù‚ÙŠÙ‚ Ù„Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©', 'ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„ØªÙˆØ«ÙŠÙ‚'] },
        { code: 'CBAHI-OBL-005', title: 'Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰', description: 'Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø´Ø§Ù…Ù„ Ù„Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø§Øª Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰', 'Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø¹Ø¯ÙˆÙ‰'] },
      ],
      standards: [
        { code: 'STD-CBAHI-01', title: 'Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø¯ÙˆÙ‰ Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©', metric: '< 5%', target: 5, unit: '%' },
        { code: 'STD-CBAHI-02', title: 'Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©', metric: 'â‰¥ 95%', target: 95, unit: '%' },
        { code: 'STD-CBAHI-03', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø³Ù„Ø§Ù…Ø©', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬ÙˆØ¯Ø©', 'Ø³Ø¬Ù„Ø§Øª Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰', 'Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©'],
      schedule: [
        { frequency: 'Daily', task: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰', responsible: 'Ù‚Ø³Ù… Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø¹Ø¯ÙˆÙ‰' },
        { frequency: 'Monthly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©', responsible: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©' },
        { frequency: 'Annual', task: 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø°Ø§ØªÙŠ', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯' },
      ],
      breachTriggers: ['InfectionRateHigh', 'SafetyIncident', 'DocumentationGap'],
      contacts: [{ name: 'CBAHI', email: 'info@cbahi.gov.sa', phone: '920000943' }],
      resources: [{ name: 'Ù…Ø¹Ø§ÙŠÙŠØ± CBAHI', url: 'https://cbahi.gov.sa/standards', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 9. Civil Defense â•â•â•â•â•â•â•â•â•â•
    {
      id: 9,
      code: 'SA-CD-SAFETY',
      name: 'Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø­Ø±ÙŠÙ‚',
      nameEn: 'Civil Defense Fire Safety',
      authority: 'CD',
      authorityName: 'Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ',
      icon: 'ğŸš’',
      color: 'orange',
      criticality: 'Critical',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2023',
      effectiveDate: '1986-01-01',
      lastUpdated: '2023-06-01',
      description: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø­Ø±ÙŠÙ‚ Ù„Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„ØµÙ†Ø§Ø¹ÙŠØ©',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„ØµÙ†Ø§Ø¹ÙŠØ© ÙˆØ§Ù„Ø³ÙƒÙ†ÙŠØ©',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª + Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù†Ø´Ø£Ø© + Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¬Ù†Ø§Ø¦ÙŠØ©',
      penaltyDetails: {
        financial: { min: 5000, max: 500000, currency: 'SAR' },
        operational: ['Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù†Ø´Ø£Ø©', 'Ø³Ø­Ø¨ Ø§Ù„Ø±Ø®ØµØ©'],
        criminal: 'Ø§Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ù…ØªØ³Ø¨Ø¨ ÙÙŠ Ø­ÙˆØ§Ø¯Ø«'
      },
      complianceRate: 80,
      riskScore: 9,
      obligations: [
        { code: 'CD-OBL-001', title: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø©', description: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø³Ù„Ø§Ù…Ø© Ø³Ø§Ø±ÙŠØ© Ù…Ù† Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ', severity: 'Critical', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø©', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©'] },
        { code: 'CD-OBL-002', title: 'ØµÙŠØ§Ù†Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¥Ø·ÙØ§Ø¡', description: 'ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ© Ù„Ø£Ù†Ø¸Ù…Ø© Ø¥Ø·ÙØ§Ø¡ Ø§Ù„Ø­Ø±ÙŠÙ‚', severity: 'Critical', recurrence: 'Monthly', deadline: 'Ø´Ù‡Ø±ÙŠ', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø©', 'Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ÙØ­Øµ'] },
        { code: 'CD-OBL-003', title: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡', description: 'ØªØ¯Ø±ÙŠØ¨ Ø¯ÙˆØ±ÙŠ Ø¹Ù„Ù‰ Ø®Ø·Ø· Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡ ÙˆØ§Ù„Ø·ÙˆØ§Ø±Ø¦', severity: 'High', recurrence: 'Semi-Annual', deadline: 'Ù†ØµÙ Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†'] },
        { code: 'CD-OBL-004', title: 'ØªÙˆÙÙŠØ± Ù…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦', description: 'Ø¶Ù…Ø§Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø®Ø§Ø±Ø¬ Ø·ÙˆØ§Ø±Ø¦ ÙƒØ§ÙÙŠØ© ÙˆÙ…Ø¶Ø§Ø¡Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø±Ø¬', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©'] },
        { code: 'CD-OBL-005', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø­Ø±ÙŠÙ‚', description: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„ÙÙˆØ±ÙŠ Ø¹Ù† Ø£ÙŠ Ø­ÙˆØ§Ø¯Ø« Ø­Ø±ÙŠÙ‚', severity: 'Critical', recurrence: 'On Incident', deadline: 'ÙÙˆØ±ÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø§Ø¯Ø«', 'Ù…Ø­Ø¶Ø± Ø§Ù„ØªØ­Ù‚ÙŠÙ‚'] },
      ],
      standards: [
        { code: 'STD-CD-01', title: 'ØµÙ„Ø§Ø­ÙŠØ© Ø·ÙØ§ÙŠØ§Øª Ø§Ù„Ø­Ø±ÙŠÙ‚', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-CD-02', title: 'Ø¥Ø¶Ø§Ø¡Ø© Ù…Ø®Ø§Ø±Ø¬ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-CD-03', title: 'ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡', metric: '2 Ø³Ù†ÙˆÙŠØ§Ù‹', target: 2, unit: 'per year' },
      ],
      evidenceTypes: ['Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¨', 'Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡'],
      schedule: [
        { frequency: 'Monthly', task: 'ÙØ­Øµ Ø·ÙØ§ÙŠØ§Øª Ø§Ù„Ø­Ø±ÙŠÙ‚', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø³Ù„Ø§Ù…Ø©' },
        { frequency: 'Quarterly', task: 'ÙØ­Øµ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¥Ù†Ø°Ø§Ø±', responsible: 'Ø´Ø±ÙƒØ© Ø§Ù„ØµÙŠØ§Ù†Ø©' },
        { frequency: 'Semi-Annual', task: 'ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦' },
        { frequency: 'Annual', task: 'ØªØ¬Ø¯ÙŠØ¯ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø©', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø³Ù„Ø§Ù…Ø©' },
      ],
      breachTriggers: ['CertificateExpired', 'MaintenanceOverdue', 'FireIncident'],
      contacts: [{ name: 'Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ', email: 'info@998.gov.sa', phone: '998' }],
      resources: [{ name: 'ÙƒÙˆØ¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ - Ø§Ù„Ø­Ø±ÙŠÙ‚', url: 'https://998.gov.sa/codes', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 10. MHRSD Labor Law â•â•â•â•â•â•â•â•â•â•
    {
      id: 10,
      code: 'SA-MHRSD-LABOR',
      name: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©',
      nameEn: 'Labor Law & Social Insurance',
      authority: 'MHRSD',
      authorityName: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© ÙˆØ§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©',
      icon: 'ğŸ‘¥',
      color: 'cyan',
      criticality: 'High',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2024',
      effectiveDate: '2005-04-23',
      lastUpdated: '2024-03-01',
      description: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ ÙˆÙ…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ© ÙˆØ¨Ø±Ù†Ø§Ù…Ø¬ Ù†Ø·Ø§Ù‚Ø§Øª',
      scope: 'Ø¬Ù…ÙŠØ¹ Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª + Ø­Ø¸Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…',
      penaltyDetails: {
        financial: { min: 1000, max: 100000, currency: 'SAR' },
        operational: ['Ø¥ÙŠÙ‚Ø§Ù Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙˆØ²Ø§Ø±Ø©', 'Ø­Ø¸Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…', 'Ø¥ÙŠÙ‚Ø§Ù ØªØµØ§Ø±ÙŠØ­ Ø§Ù„Ø¹Ù…Ù„'],
        criminal: 'Ù‚Ø¯ ØªØµÙ„ Ù„Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø¹Ù…Ø§Ù„'
      },
      complianceRate: 85,
      riskScore: 7,
      obligations: [
        { code: 'MHRSD-OBL-001', title: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ† (Ù†Ø·Ø§Ù‚Ø§Øª)', description: 'ØªØ­Ù‚ÙŠÙ‚ Ù†Ø³Ø¨ Ø§Ù„Ø³Ø¹ÙˆØ¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†Ø´Ø§Ø·', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø© Ù†Ø·Ø§Ù‚Ø§Øª', 'Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†'] },
        { code: 'MHRSD-OBL-002', title: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª', description: 'ØªØ³Ø¬ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©', severity: 'Critical', recurrence: 'Per Employee', deadline: '15 ÙŠÙˆÙ… Ù…Ù† Ø§Ù„ØªØ¹ÙŠÙŠÙ†', evidenceRequired: ['Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„', 'Ø³Ø¬Ù„ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª'] },
        { code: 'MHRSD-OBL-003', title: 'ØµØ±Ù Ø§Ù„Ø£Ø¬ÙˆØ± Ø¹Ø¨Ø± Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¬ÙˆØ±', description: 'ØµØ±Ù Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ Ø¹Ø¨Ø± WPS', severity: 'Critical', recurrence: 'Monthly', deadline: 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±', evidenceRequired: ['Ù…Ù„ÙØ§Øª WPS', 'ÙƒØ´ÙˆÙ Ø§Ù„Ø±ÙˆØ§ØªØ¨'] },
        { code: 'MHRSD-OBL-004', title: 'ØªÙˆØ«ÙŠÙ‚ Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø¹Ù…Ù„ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹', description: 'ØªÙˆØ«ÙŠÙ‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙÙŠ Ù…Ù†ØµØ© Ù‚ÙˆÙ‰', severity: 'High', recurrence: 'Per Employee', deadline: '30 ÙŠÙˆÙ…', evidenceRequired: ['Ø¹Ù‚ÙˆØ¯ Ù…ÙˆØ«Ù‚Ø©', 'Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ«ÙŠÙ‚'] },
        { code: 'MHRSD-OBL-005', title: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª', description: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø£Ø­ÙƒØ§Ù… Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ±', 'Ø³Ø¬Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª'] },
        { code: 'MHRSD-OBL-006', title: 'ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© Ø¹Ù…Ù„ Ø¢Ù…Ù†Ø©', description: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø³Ù„Ø§Ù…Ø©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª'] },
      ],
      standards: [
        { code: 'STD-MHRSD-01', title: 'Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙˆØ·ÙŠÙ†', metric: 'Ø­Ø³Ø¨ Ø§Ù„Ù†Ø´Ø§Ø·', target: 100, unit: '%' },
        { code: 'STD-MHRSD-02', title: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù€ WPS', metric: '100%', target: 100, unit: '%' },
        { code: 'STD-MHRSD-03', title: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø¹Ù‚ÙˆØ¯', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø´Ù‡Ø§Ø¯Ø© Ù†Ø·Ø§Ù‚Ø§Øª', 'Ù…Ù„ÙØ§Øª WPS', 'Ø¹Ù‚ÙˆØ¯ Ù…ÙˆØ«Ù‚Ø©', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª'],
      schedule: [
        { frequency: 'Monthly', task: 'ØµØ±Ù Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø¹Ø¨Ø± WPS', responsible: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©' },
        { frequency: 'Monthly', task: 'Ø³Ø¯Ø§Ø¯ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†Ø§Øª', responsible: 'Ø§Ù„Ù…Ø§Ù„ÙŠØ©' },
        { frequency: 'Quarterly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ·ÙŠÙ†', responsible: 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©' },
      ],
      breachTriggers: ['NitaqatRed', 'WPSDelayed', 'GOSIUnpaid', 'ContractNotDocumented'],
      contacts: [{ name: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©', email: 'cs@hrsd.gov.sa', phone: '19911' }],
      resources: [{ name: 'Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ù…Ù„', url: 'https://hrsd.gov.sa/labor-law', type: 'PDF' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 11. ISO 27001 â•â•â•â•â•â•â•â•â•â•
    {
      id: 11,
      code: 'INT-ISO-27001',
      name: 'ISO 27001 Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      nameEn: 'ISO 27001 ISMS',
      authority: 'ISO',
      authorityName: 'Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ±',
      icon: 'ğŸ”’',
      color: 'gray',
      criticality: 'High',
      status: 'Active',
      type: 'Voluntary',
      country: 'INT',
      version: '2022',
      effectiveDate: '2005-10-15',
      lastUpdated: '2022-10-25',
      description: 'Ø§Ù„Ù…Ø¹ÙŠØ§Ø± Ø§Ù„Ø¯ÙˆÙ„ÙŠ Ù„Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø¸Ù…Ø§Øª Ø§Ù„ØªÙŠ ØªØ³Ø¹Ù‰ Ù„Ø´Ù‡Ø§Ø¯Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª'],
      penalty: 'ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© + Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯',
      penaltyDetails: {
        financial: { min: 0, max: 0, currency: 'SAR' },
        operational: ['Ø³Ø­Ø¨ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©', 'Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯', 'Ø¶Ø±Ø± Ø§Ù„Ø³Ù…Ø¹Ø©'],
        criminal: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
      },
      complianceRate: 90,
      riskScore: 6,
      obligations: [
        { code: 'ISO27K-OBL-001', title: 'Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', description: 'ØªØµÙ…ÙŠÙ… ÙˆØªÙˆØ«ÙŠÙ‚ ISMS Ø´Ø§Ù…Ù„', severity: 'Critical', recurrence: 'Once', deadline: 'Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø© ISMS', 'Ù†Ø·Ø§Ù‚ ISMS', 'Ø¨ÙŠØ§Ù† Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚'] },
        { code: 'ISO27K-OBL-002', title: 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'Ø¥Ø¬Ø±Ø§Ø¡ ØªÙ‚ÙŠÙŠÙ… Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø£Ù…Ù†ÙŠØ©', severity: 'Critical', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'] },
        { code: 'ISO27K-OBL-003', title: 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ù…Ù† Annex A', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['SoA', 'Ø£Ø¯Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚'] },
        { code: 'ISO27K-OBL-004', title: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', description: 'ØªØ¯Ù‚ÙŠÙ‚ Ø¯Ø§Ø®Ù„ÙŠ Ø³Ù†ÙˆÙŠ Ù„Ù„Ù€ ISMS', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', 'Ø®Ø·Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ÙŠØ©'] },
        { code: 'ISO27K-OBL-005', title: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', description: 'Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù€ ISMS', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['Ù…Ø­Ø§Ø¶Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', 'Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†'] },
        { code: 'ISO27K-OBL-006', title: 'Ø§Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø³ØªÙ…Ø±', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø¯ÙˆØ±Ø© PDCA Ù„Ù„ØªØ­Ø³ÙŠÙ†', severity: 'Medium', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª', 'Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡'] },
      ],
      standards: [
        { code: 'STD-ISO-01', title: 'ØªØºØ·ÙŠØ© Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·', metric: '100% Ù…Ù† SoA', target: 100, unit: '%' },
        { code: 'STD-ISO-02', title: 'Ø¥ØºÙ„Ø§Ù‚ Ø¹Ø¯Ù… Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø§Øª', metric: '< 30 ÙŠÙˆÙ…', target: 30, unit: 'days' },
        { code: 'STD-ISO-03', title: 'ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙˆØ¹ÙŠ Ø§Ù„Ø£Ù…Ù†ÙŠ', metric: '100%', target: 100, unit: '%' },
      ],
      evidenceTypes: ['Ø´Ù‡Ø§Ø¯Ø© ISO 27001', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø§Ø·Ø±', 'SoA'],
      schedule: [
        { frequency: 'Quarterly', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', responsible: 'Ù…Ø³Ø¤ÙˆÙ„ Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' },
        { frequency: 'Annual', task: 'Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚' },
        { frequency: 'Annual', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', responsible: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„ÙŠØ§' },
        { frequency: 'Annual', task: 'ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©/Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©', responsible: 'Ø¬Ù‡Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯' },
      ],
      breachTriggers: ['MajorNonConformity', 'RiskAssessmentOverdue', 'AuditOverdue'],
      contacts: [{ name: 'Ø¬Ù‡Ø© Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©', email: 'certification@example.com', phone: '+1234567890' }],
      resources: [{ name: 'ISO 27001:2022', url: 'https://iso.org/27001', type: 'Standard' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 12. PCI DSS â•â•â•â•â•â•â•â•â•â•
    {
      id: 12,
      code: 'INT-PCI-DSS',
      name: 'Ù…Ø¹ÙŠØ§Ø± Ø£Ù…Ø§Ù† Ø¨ÙŠØ§Ù†Ø§Øª ØµÙ†Ø§Ø¹Ø© Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙØ¹',
      nameEn: 'PCI DSS',
      authority: 'PCI-SSC',
      authorityName: 'Ù…Ø¬Ù„Ø³ Ù…Ø¹Ø§ÙŠÙŠØ± Ø£Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹',
      icon: 'ğŸ’³',
      color: 'violet',
      criticality: 'Critical',
      status: 'Active',
      type: 'Conditional',
      country: 'INT',
      version: '4.0',
      effectiveDate: '2022-03-31',
      lastUpdated: '2024-03-31',
      description: 'Ù…Ø¹ÙŠØ§Ø± Ø£Ù…Ø§Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø§Ù…Ù„ÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª',
      scope: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„ØªÙŠ ØªØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª',
      sectorAr: ['Ø§Ù„ØªØ¬Ø²Ø¦Ø©', 'Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©', 'Ø§Ù„Ø¨Ù†ÙˆÙƒ', 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª Ù…Ù† Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª + Ø³Ø­Ø¨ Ø­Ù‚ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª',
      penaltyDetails: {
        financial: { min: 5000, max: 100000, currency: 'USD' },
        operational: ['Ø³Ø­Ø¨ Ø­Ù‚ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª', 'Ø²ÙŠØ§Ø¯Ø© Ø±Ø³ÙˆÙ… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'],
        criminal: 'Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª'
      },
      complianceRate: 75,
      riskScore: 9,
      obligations: [
        { code: 'PCI-OBL-001', title: 'ØªØ«Ø¨ÙŠØª ÙˆØµÙŠØ§Ù†Ø© Ø¬Ø¯Ø§Ø± Ø§Ù„Ø­Ù…Ø§ÙŠØ©', description: 'Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø§Ù…Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬Ø¯Ø§Ø±', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'] },
        { code: 'PCI-OBL-002', title: 'Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø§Ù…Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©', description: 'ØªØ´ÙÙŠØ± ÙˆØ­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØªØ´ÙÙŠØ±', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ'] },
        { code: 'PCI-OBL-003', title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©', description: 'ÙØ­Øµ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ', severity: 'High', recurrence: 'Quarterly', deadline: 'Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± ASV', 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'] },
        { code: 'PCI-OBL-004', title: 'ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª', description: 'ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ù…Ø¹Ø±ÙØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ù…ØµÙÙˆÙØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª', 'Ø³Ø¬Ù„Ø§Øª Ø§Ù„ÙˆØµÙˆÙ„'] },
        { code: 'PCI-OBL-005', title: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø³Ù†ÙˆÙŠ', description: 'Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø®ØªØ±Ø§Ù‚ Ø³Ù†ÙˆÙŠ', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', 'Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©'] },
        { code: 'PCI-OBL-006', title: 'ØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', description: 'ØªÙ‚Ø¯ÙŠÙ… SAQ Ø£Ùˆ ROC Ø³Ù†ÙˆÙŠØ§Ù‹', severity: 'Critical', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['SAQ/ROC', 'AOC'] },
      ],
      standards: [
        { code: 'STD-PCI-01', title: 'ØªØ´ÙÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©', metric: 'AES-256', target: 100, unit: '%' },
        { code: 'STD-PCI-02', title: 'ÙØ­Øµ ASV Ù†Ø§Ø¬Ø­', metric: 'Pass', target: 100, unit: '%' },
        { code: 'STD-PCI-03', title: 'Ø¹Ø¯Ù… ØªØ®Ø²ÙŠÙ† CVV/PIN', metric: '0', target: 0, unit: 'instances' },
      ],
      evidenceTypes: ['SAQ', 'ROC', 'AOC', 'ØªÙ‚Ø§Ø±ÙŠØ± ASV', 'Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚'],
      schedule: [
        { frequency: 'Quarterly', task: 'ÙØ­Øµ ASV', responsible: 'Ù…Ø²ÙˆØ¯ ASV' },
        { frequency: 'Annual', task: 'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', responsible: 'Ø¬Ù‡Ø© Ù…Ø¹ØªÙ…Ø¯Ø©' },
        { frequency: 'Annual', task: 'ØªÙ‚ÙŠÙŠÙ… PCI DSS', responsible: 'QSA/ISA' },
      ],
      breachTriggers: ['ASVScanFailed', 'DataBreach', 'ComplianceExpired'],
      contacts: [{ name: 'PCI SSC', email: 'info@pcissc.org', phone: '+1-781-876-8855' }],
      resources: [{ name: 'PCI DSS v4.0', url: 'https://pcisecuritystandards.org/document_library', type: 'Standard' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 13. SOC 2 â•â•â•â•â•â•â•â•â•â•
    {
      id: 13,
      code: 'INT-SOC2',
      name: 'ØªÙ‚Ø±ÙŠØ± SOC 2',
      nameEn: 'SOC 2 Type II',
      authority: 'AICPA',
      authorityName: 'Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ Ù„Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠÙŠÙ†',
      icon: 'â˜ï¸',
      color: 'sky',
      criticality: 'High',
      status: 'Active',
      type: 'Voluntary',
      country: 'INT',
      version: '2017',
      effectiveDate: '2017-04-01',
      lastUpdated: '2023-01-01',
      description: 'ØªÙ‚Ø±ÙŠØ± Ø±Ù‚Ø§Ø¨ÙŠ Ù„Ù…Ø²ÙˆØ¯ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ©',
      scope: 'Ù…Ø²ÙˆØ¯ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ© ÙˆØ´Ø±ÙƒØ§Øª SaaS',
      sectorAr: ['ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ø­ÙˆØ³Ø¨Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©', 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ¹Ù‡ÙŠØ¯'],
      penalty: 'Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¯',
      penaltyDetails: {
        financial: { min: 0, max: 0, currency: 'USD' },
        operational: ['Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚ÙˆØ¯', 'ÙÙ‚Ø¯Ø§Ù† Ø«Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡'],
        criminal: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'
      },
      complianceRate: 85,
      riskScore: 6,
      obligations: [
        { code: 'SOC2-OBL-001', title: 'ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹Ø§ÙŠÙŠØ± Trust Services', description: 'ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„ØªÙˆØ§ÙØ± ÙˆØ§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØ§Ù„Ø³Ø±ÙŠØ© ÙˆØ§Ù„Ø®ØµÙˆØµÙŠØ©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', 'Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·', 'Ø§Ù„Ø£Ø¯Ù„Ø©'] },
        { code: 'SOC2-OBL-002', title: 'Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¯Ù‚ÙŠÙ‚ SOC 2', description: 'ØªØ¯Ù‚ÙŠÙ‚ Ø³Ù†ÙˆÙŠ Ù…Ù† Ù…Ø¯Ù‚Ù‚ Ù…Ø³ØªÙ‚Ù„', severity: 'High', recurrence: 'Annual', deadline: 'Ø³Ù†ÙˆÙŠ', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± SOC 2', 'Ø®Ø·Ø§Ø¨ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'] },
        { code: 'SOC2-OBL-003', title: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª', description: 'Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£ÙŠ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ù…Ù† Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', severity: 'High', recurrence: 'On Demand', deadline: '90 ÙŠÙˆÙ…', evidenceRequired: ['Ø®Ø·Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ø£Ø¯Ù„Ø© Ø§Ù„Ø¥ØµÙ„Ø§Ø­'] },
      ],
      standards: [
        { code: 'STD-SOC2-01', title: 'ØªÙ‚Ø±ÙŠØ± Ù†Ø¸ÙŠÙ', metric: 'No Exceptions', target: 0, unit: 'exceptions' },
        { code: 'STD-SOC2-02', title: 'ØªÙˆÙØ± Ø§Ù„Ø®Ø¯Ù…Ø©', metric: 'â‰¥ 99.9%', target: 99.9, unit: '%' },
      ],
      evidenceTypes: ['ØªÙ‚Ø±ÙŠØ± SOC 2 Type II', 'Bridge Letter', 'Ø®Ø·Ø© Ø§Ù„Ø¥ØµÙ„Ø§Ø­'],
      schedule: [
        { frequency: 'Continuous', task: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·', responsible: 'ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„' },
        { frequency: 'Annual', task: 'ØªØ¯Ù‚ÙŠÙ‚ SOC 2', responsible: 'Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ' },
      ],
      breachTriggers: ['ExceptionIdentified', 'ControlFailure', 'ReportExpired'],
      contacts: [{ name: 'Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ', email: 'audit@example.com', phone: '+1234567890' }],
      resources: [{ name: 'AICPA Trust Services', url: 'https://aicpa.org/soc', type: 'Guide' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 14. GDPR â•â•â•â•â•â•â•â•â•â•
    {
      id: 14,
      code: 'INT-EU-GDPR',
      name: 'Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
      nameEn: 'GDPR',
      authority: 'EU',
      authorityName: 'Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ',
      icon: 'ğŸ‡ªğŸ‡º',
      color: 'blue',
      criticality: 'Critical',
      status: 'Active',
      type: 'Conditional',
      country: 'INT',
      version: '2016/679',
      effectiveDate: '2018-05-25',
      lastUpdated: '2018-05-25',
      description: 'Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
      scope: 'Ø£ÙŠ Ù…Ù†Ø´Ø£Ø© ØªØ¹Ø§Ù„Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ§Ø·Ù†ÙŠ Ø§Ù„Ø§ØªØ­Ø§Ø¯ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ',
      sectorAr: ['Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª ØªØµÙ„ Ø¥Ù„Ù‰ 20 Ù…Ù„ÙŠÙˆÙ† ÙŠÙˆØ±Ùˆ Ø£Ùˆ 4% Ù…Ù† Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©',
      penaltyDetails: {
        financial: { min: 10000000, max: 20000000, currency: 'EUR' },
        operational: ['Ø­Ø¸Ø± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ø£ÙˆØ§Ù…Ø± Ù‚Ø¶Ø§Ø¦ÙŠØ©'],
        criminal: 'Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø´Ø®ØµÙŠØ© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†'
      },
      complianceRate: 70,
      riskScore: 9,
      obligations: [
        { code: 'GDPR-OBL-001', title: 'Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', description: 'ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ù„ÙƒÙ„ Ù†Ø´Ø§Ø· Ù…Ø¹Ø§Ù„Ø¬Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'Ø§Ù„Ø£Ø³Ø§Ø³ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ'] },
        { code: 'GDPR-OBL-002', title: 'Ø­Ù‚ÙˆÙ‚ Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', description: 'ØªÙ…ÙƒÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ‚ GDPR', severity: 'Critical', recurrence: 'On Request', deadline: '30 ÙŠÙˆÙ…', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©'] },
        { code: 'GDPR-OBL-003', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚Ø§Øª 72 Ø³Ø§Ø¹Ø©', description: 'Ø¥Ø¨Ù„Ø§Øº DPA Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©', severity: 'Critical', recurrence: 'On Breach', deadline: '72 Ø³Ø§Ø¹Ø©', evidenceRequired: ['Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº', 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚'] },
        { code: 'GDPR-OBL-004', title: 'ØªØ¹ÙŠÙŠÙ† DPO', description: 'ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø¤ÙˆÙ„ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø°Ø§ Ù…Ø·Ù„ÙˆØ¨', severity: 'High', recurrence: 'Once', deadline: 'Ø­Ø³Ø¨ Ø§Ù„Ù†Ø´Ø§Ø·', evidenceRequired: ['Ù‚Ø±Ø§Ø± Ø§Ù„ØªØ¹ÙŠÙŠÙ†', 'ØªØ³Ø¬ÙŠÙ„ DPA'] },
        { code: 'GDPR-OBL-005', title: 'Ø¥Ø¬Ø±Ø§Ø¡ DPIA', description: 'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø«Ø± Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø®Ø§Ø·Ø±', severity: 'High', recurrence: 'On Demand', deadline: 'Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', evidenceRequired: ['ØªÙ‚Ø±ÙŠØ± DPIA'] },
        { code: 'GDPR-OBL-006', title: 'Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø¨Ø§Ù„ØªØµÙ…ÙŠÙ…', description: 'ØªØ·Ø¨ÙŠÙ‚ Privacy by Design', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„ØªØµÙ…ÙŠÙ…', 'ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ©'] },
      ],
      standards: [
        { code: 'STD-GDPR-01', title: 'Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù€ DSR', metric: 'â‰¤ 30 ÙŠÙˆÙ…', target: 30, unit: 'days' },
        { code: 'STD-GDPR-02', title: 'Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚', metric: 'â‰¤ 72 Ø³Ø§Ø¹Ø©', target: 72, unit: 'hours' },
      ],
      evidenceTypes: ['Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'ØªÙ‚Ø§Ø±ÙŠØ± DPIA', 'Ø³Ø¬Ù„Ø§Øª DSR', 'Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚'],
      schedule: [
        { frequency: 'On Request', task: 'Ù…Ø¹Ø§Ù„Ø¬Ø© DSR', responsible: 'DPO' },
        { frequency: 'Annual', task: 'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', responsible: 'DPO' },
      ],
      breachTriggers: ['BreachNotReported>72h', 'DSROverdue>30d', 'NoLegalBasis'],
      contacts: [{ name: 'Data Protection Authority', email: 'dpa@eu-dpa.eu', phone: '+3212345678' }],
      resources: [{ name: 'GDPR Full Text', url: 'https://gdpr.eu/tag/gdpr/', type: 'Regulation' }],
    },
    // â•â•â•â•â•â•â•â•â•â• 15. CITC â•â•â•â•â•â•â•â•â•â•
    {
      id: 15,
      code: 'SA-CITC-TELECOM',
      name: 'Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      nameEn: 'CITC Telecom Regulations',
      authority: 'CITC',
      authorityName: 'Ù‡ÙŠØ¦Ø© Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      icon: 'ğŸ“¡',
      color: 'pink',
      criticality: 'High',
      status: 'Active',
      type: 'Mandatory',
      country: 'SA',
      version: '2024',
      effectiveDate: '2001-06-12',
      lastUpdated: '2024-01-01',
      description: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ù„ÙˆØ§Ø¦Ø­ Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      scope: 'Ù…Ø´ØºÙ„ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª ÙˆÙ…Ø²ÙˆØ¯ÙŠ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª',
      sectorAr: ['Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª', 'ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª'],
      penalty: 'ØºØ±Ø§Ù…Ø§Øª + Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ',
      penaltyDetails: {
        financial: { min: 50000, max: 10000000, currency: 'SAR' },
        operational: ['Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ', 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø®Ø¯Ù…Ø§Øª'],
        criminal: 'Ù‚Ø¯ ØªØµÙ„ Ù„Ù„Ø³Ø¬Ù† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ù…Ø¹ÙŠÙ†Ø©'
      },
      complianceRate: 88,
      riskScore: 7,
      obligations: [
        { code: 'CITC-OBL-001', title: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø´Ø±ÙˆØ· Ø§Ù„ØªØ±Ø®ÙŠØµ', description: 'Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø´Ø±ÙˆØ· Ø±Ø®ØµØ© Ø§Ù„ØªØ´ØºÙŠÙ„', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø§Ù„Ø±Ø®ØµØ©', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„'] },
        { code: 'CITC-OBL-002', title: 'Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø© QoS', description: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['ØªÙ‚Ø§Ø±ÙŠØ± QoS', 'Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡'] },
        { code: 'CITC-OBL-003', title: 'Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ', description: 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù„ÙˆØ§Ø¦Ø­ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ù„Ùƒ', severity: 'High', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø­Ù„'] },
        { code: 'CITC-OBL-004', title: 'Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†', description: 'Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ù„Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', severity: 'Critical', recurrence: 'Continuous', deadline: 'Ù…Ø³ØªÙ…Ø±', evidenceRequired: ['Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸'] },
      ],
      standards: [
        { code: 'STD-CITC-01', title: 'ØªÙˆÙØ± Ø§Ù„Ø´Ø¨ÙƒØ©', metric: 'â‰¥ 99.9%', target: 99.9, unit: '%' },
        { code: 'STD-CITC-02', title: 'Ø­Ù„ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰', metric: 'â‰¤ 5 Ø£ÙŠØ§Ù…', target: 5, unit: 'days' },
      ],
      evidenceTypes: ['ØªÙ‚Ø§Ø±ÙŠØ± QoS', 'Ø³Ø¬Ù„ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰', 'ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„'],
      schedule: [
        { frequency: 'Monthly', task: 'ØªÙ‚Ø±ÙŠØ± Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©', responsible: 'Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª' },
        { frequency: 'Quarterly', task: 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', responsible: 'Ø§Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©' },
      ],
      breachTriggers: ['QoSBelowStandard', 'ComplaintBacklog', 'LicenseViolation'],
      contacts: [{ name: 'CITC', email: 'info@citc.gov.sa', phone: '19966' }],
      resources: [{ name: 'Ø£Ù†Ø¸Ù…Ø© CITC', url: 'https://citc.gov.sa/regulations', type: 'PDF' }],
    },
  ]);

  const [activatedPrograms, setActivatedPrograms] = useState([1, 2, 3, 4, 5, 7]);

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // FORM DATA - Premium with Multiple Tabs
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const [programForm, setProgramForm] = useState({
    // Tab 1: Basic Info
    name: '', nameEn: '', code: '', description: '', scope: '', version: '',
    // Tab 2: Authority & Classification
    authority: '', authorityName: '', country: 'SA', type: 'Mandatory', criticality: 'High', icon: 'ğŸ“‹', color: 'emerald',
    // Tab 3: Sectors
    sectorAr: [],
    // Tab 4: Dates
    effectiveDate: '', lastUpdated: new Date().toISOString().split('T')[0],
    // Tab 5: Penalties
    penalty: '',
    penaltyDetails: { financial: { min: 0, max: 0, currency: 'SAR' }, operational: [], criminal: '' },
    // Tab 6: Contacts & Resources
    contacts: [],
    resources: [],
    // Tab 7: Metrics
    complianceRate: 0, riskScore: 5,
    // Arrays
    obligations: [], standards: [], evidenceTypes: [], schedule: [], breachTriggers: [],
  });

  const [obligationForm, setObligationForm] = useState({
    code: '', title: '', description: '', severity: 'High', recurrence: 'Monthly', deadline: '', evidenceRequired: [],
  });

  const [standardForm, setStandardForm] = useState({
    code: '', title: '', metric: '', target: 0, unit: '%',
  });

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // CRUD HANDLERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const handleAddProgram = () => {
    const newProgram = {
      id: Date.now(),
      code: programForm.code || `SA-${programForm.authority}-${Date.now().toString().slice(-4)}`,
      ...programForm,
      status: 'Active',
    };
    setPrograms(prev => [...prev, newProgram]);
    setShowProgramModal(false);
    resetProgramForm();
  };

  const handleEditProgram = () => {
    setPrograms(prev => prev.map(p => p.id === selectedProgram.id ? { ...p, ...programForm } : p));
    setShowProgramModal(false);
    setEditMode(false);
    setSelectedProgram(null);
    resetProgramForm();
  };

  const handleDeleteProgram = () => {
    setPrograms(prev => prev.filter(p => p.id !== deleteTarget.id));
    setActivatedPrograms(prev => prev.filter(id => id !== deleteTarget.id));
    setShowDeleteModal(false);
    setDeleteTarget(null);
  };

  const handleAddObligation = () => {
    if (!selectedProgram) return;
    const newObl = {
      code: obligationForm.code || `${selectedProgram.authority}-OBL-${Date.now().toString().slice(-4)}`,
      ...obligationForm,
    };
    setPrograms(prev => prev.map(p =>
      p.id === selectedProgram.id ? { ...p, obligations: [...p.obligations, newObl] } : p
    ));
    setShowObligationModal(false);
    resetObligationForm();
  };

  const handleEditObligation = () => {
    setPrograms(prev => prev.map(p => {
      if (p.id === selectedProgram.id) {
        return { ...p, obligations: p.obligations.map(o => o.code === selectedObligation.code ? { ...obligationForm } : o) };
      }
      return p;
    }));
    setShowObligationModal(false);
    setEditMode(false);
    setSelectedObligation(null);
    resetObligationForm();
  };

  const handleDeleteObligation = () => {
    setPrograms(prev => prev.map(p => ({
      ...p, obligations: p.obligations.filter(o => o.code !== deleteTarget.code)
    })));
    setShowDeleteModal(false);
    setDeleteTarget(null);
  };

  const handleAddStandard = () => {
    if (!selectedProgram) return;
    const newStd = {
      code: standardForm.code || `STD-${selectedProgram.authority}-${Date.now().toString().slice(-4)}`,
      ...standardForm,
    };
    setPrograms(prev => prev.map(p =>
      p.id === selectedProgram.id ? { ...p, standards: [...(p.standards || []), newStd] } : p
    ));
    setShowStandardModal(false);
    setStandardForm({ code: '', title: '', metric: '', target: 0, unit: '%' });
  };

  const handleActivateProgram = (id) => {
    if (!activatedPrograms.includes(id)) setActivatedPrograms(prev => [...prev, id]);
  };

  const handleDeactivateProgram = (id) => {
    setActivatedPrograms(prev => prev.filter(pid => pid !== id));
  };

  const resetProgramForm = () => {
    setProgramForm({
      name: '', nameEn: '', code: '', description: '', scope: '', version: '',
      authority: '', authorityName: '', country: 'SA', type: 'Mandatory', criticality: 'High', icon: 'ğŸ“‹', color: 'emerald',
      sectorAr: [], effectiveDate: '', lastUpdated: new Date().toISOString().split('T')[0],
      penalty: '', penaltyDetails: { financial: { min: 0, max: 0, currency: 'SAR' }, operational: [], criminal: '' },
      contacts: [], resources: [], complianceRate: 0, riskScore: 5,
      obligations: [], standards: [], evidenceTypes: [], schedule: [], breachTriggers: [],
    });
    setProgramModalTab(0);
  };

  const resetObligationForm = () => {
    setObligationForm({ code: '', title: '', description: '', severity: 'High', recurrence: 'Monthly', deadline: '', evidenceRequired: [] });
  };

  const openAddProgram = () => { setEditMode(false); resetProgramForm(); setShowProgramModal(true); };

  const openEditProgram = (prog) => {
    setEditMode(true);
    setSelectedProgram(prog);
    setProgramForm({ ...prog });
    setProgramModalTab(0);
    setShowProgramModal(true);
  };

  const openAddObligation = (prog) => { setEditMode(false); setSelectedProgram(prog); resetObligationForm(); setShowObligationModal(true); };

  const openEditObligation = (prog, obl) => {
    setEditMode(true);
    setSelectedProgram(prog);
    setSelectedObligation(obl);
    setObligationForm({ ...obl });
    setShowObligationModal(true);
  };

  const openDeleteProgram = (prog) => { setDeleteTarget({ ...prog, type: 'program' }); setShowDeleteModal(true); };
  const openDeleteObligation = (obl) => { setDeleteTarget({ ...obl, type: 'obligation' }); setShowDeleteModal(true); };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // COMPUTED VALUES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  const allObligations = useMemo(() => {
    const result = [];
    programs.forEach(prog => {
      prog.obligations.forEach(obl => {
        result.push({ ...obl, programId: prog.id, programName: prog.name, authority: prog.authority, programIcon: prog.icon });
      });
    });
    return result;
  }, [programs]);

  const filteredPrograms = useMemo(() => {
    let result = [...programs];
    if (searchQuery) {
      result = result.filter(p =>
        p.name.includes(searchQuery) || p.nameEn.toLowerCase().includes(searchQuery.toLowerCase()) || p.code.toLowerCase().includes(searchQuery.toLowerCase())
      );
    }
    if (filterAuthority) result = result.filter(p => p.authority === filterAuthority);
    if (filterCountry) result = result.filter(p => p.country === filterCountry);
    if (filterSector) result = result.filter(p => p.sectorAr?.includes(filterSector));
    if (filterStatus === 'activated') result = result.filter(p => activatedPrograms.includes(p.id));
    if (filterStatus === 'inactive') result = result.filter(p => !activatedPrograms.includes(p.id));
    return result;
  }, [programs, searchQuery, filterAuthority, filterCountry, filterSector, filterStatus, activatedPrograms]);

  const filteredObligations = useMemo(() => {
    let result = [...allObligations];
    if (searchQuery) result = result.filter(o => o.title.includes(searchQuery) || o.code.toLowerCase().includes(searchQuery.toLowerCase()));
    if (filterAuthority) result = result.filter(o => o.authority === filterAuthority);
    if (filterSeverity) result = result.filter(o => o.severity === filterSeverity);
    return result;
  }, [allObligations, searchQuery, filterAuthority, filterSeverity]);

  const stats = useMemo(() => ({
    totalPrograms: programs.length,
    activatedCount: activatedPrograms.length,
    totalObligations: allObligations.length,
    criticalPrograms: programs.filter(p => p.criticality === 'Critical').length,
    saudiPrograms: programs.filter(p => p.country === 'SA').length,
    internationalPrograms: programs.filter(p => p.country === 'INT').length,
    criticalObligations: allObligations.filter(o => o.severity === 'Critical').length,
  }), [programs, activatedPrograms, allObligations]);

  const tabs = [
    { id: 'catalog', label: 'ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬', icon: FolderOpen, count: programs.length },
    { id: 'activated', label: 'Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…ÙØ¹Ù‘Ù„Ø©', icon: CheckCircle2, count: activatedPrograms.length },
    { id: 'obligations', label: 'Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª', icon: FileText, count: allObligations.length },
    { id: 'analytics', label: 'Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª', icon: BarChart3, count: null },
  ];

  const programModalTabs = [
    { id: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText },
    { id: 1, label: 'Ø§Ù„Ø¬Ù‡Ø© ÙˆØ§Ù„ØªØµÙ†ÙŠÙ', icon: Building },
    { id: 2, label: 'Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª', icon: Layers },
    { id: 3, label: 'Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®', icon: Calendar },
    { id: 4, label: 'Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', icon: AlertTriangle },
    { id: 5, label: 'Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„', icon: Users },
    { id: 6, label: 'Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³', icon: Target },
  ];

  return (
    <div className="space-y-6">
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PREMIUM HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="relative overflow-hidden bg-gradient-to-br from-green-600 via-emerald-600 to-teal-700 rounded-3xl p-8 text-white">
        <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zNiAxOGMtOS45NDEgMC0xOCA4LjA1OS0xOCAxOHM4LjA1OSAxOCAxOCAxOGM5Ljk0MSAwIDE4LTguMDU5IDE4LTE4cy04LjA1OS0xOC0xOC0xOHptMCAzMmMtNy43MzIgMC0xNC02LjI2OC0xNC0xNHM2LjI2OC0xNCAxNC0xNHMxNCA2LjI2OCAxNCAxNC02LjI2OCAxNC0xNCAxNHoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iLjA1Ii8+PC9nPjwvc3ZnPg==')] opacity-30"></div>
        <div className="absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2 blur-3xl"></div>

        <div className="relative">
          <div className="flex items-center justify-between mb-6">
            <div className="flex items-center gap-5">
              <div className="w-20 h-20 rounded-2xl bg-white/20 backdrop-blur-xl flex items-center justify-center border border-white/30 shadow-2xl text-4xl">ğŸ‡¸ğŸ‡¦</div>
              <div>
                <div className="flex items-center gap-3 mb-1">
                  <h1 className="text-3xl font-black">Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                  <span className="px-3 py-1 bg-white/20 rounded-full text-xs font-bold">Premium v3.0</span>
                </div>
                <p className="text-emerald-200 text-lg">Saudi & International Regulatory Programs â€¢ {programs.length} Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <button className="flex items-center gap-2 px-5 py-3 bg-white/10 hover:bg-white/20 rounded-xl border border-white/20 font-bold transition-all">
                <Download className="w-5 h-5" />ØªØµØ¯ÙŠØ±
              </button>
              <button onClick={openAddProgram} className="flex items-center gap-2 px-6 py-3 bg-white text-emerald-600 rounded-xl font-bold shadow-xl hover:shadow-2xl transition-all">
                <Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù†Ø§Ù…Ø¬
              </button>
            </div>
          </div>

          <div className="grid grid-cols-6 gap-4">
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <FolderOpen className="w-6 h-6 text-white/80" />
                <span className="text-3xl font-black">{stats.totalPrograms}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <CheckCircle2 className="w-6 h-6 text-emerald-300" />
                <span className="text-3xl font-black">{stats.activatedCount}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ù…ÙØ¹Ù‘Ù„Ø©</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <FileText className="w-6 h-6 text-blue-300" />
                <span className="text-3xl font-black">{stats.totalObligations}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ø§Ù„ØªØ²Ø§Ù…</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <AlertTriangle className="w-6 h-6 text-red-300" />
                <span className="text-3xl font-black">{stats.criticalObligations}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ø§Ù„ØªØ²Ø§Ù… Ø­Ø±Ø¬</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <span className="text-xl">ğŸ‡¸ğŸ‡¦</span>
                <span className="text-3xl font-black">{stats.saudiPrograms}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø³Ø¹ÙˆØ¯ÙŠ</p>
            </div>
            <div className="bg-white/10 backdrop-blur-sm rounded-2xl p-4 border border-white/20">
              <div className="flex items-center justify-between mb-2">
                <Globe className="w-6 h-6 text-purple-300" />
                <span className="text-3xl font-black">{stats.internationalPrograms}</span>
              </div>
              <p className="text-emerald-200 text-sm">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¯ÙˆÙ„ÙŠ</p>
            </div>
          </div>
        </div>
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      <div className="bg-white rounded-2xl border-2 border-slate-200 overflow-hidden shadow-sm">
        <div className="flex border-b-2 border-slate-200 bg-slate-50">
          {tabs.map(tab => (
            <button key={tab.id} onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-6 py-4 font-bold transition-all border-b-2 ${activeTab === tab.id ? 'text-emerald-600 border-emerald-500 bg-white -mb-[2px]' : 'text-slate-500 border-transparent hover:text-emerald-500'
                }`}>
              <tab.icon className="w-5 h-5" />{tab.label}
              {tab.count !== null && (
                <span className={`px-2.5 py-1 rounded-full text-xs font-bold ${activeTab === tab.id ? 'bg-emerald-500 text-white' : 'bg-slate-200 text-slate-600'}`}>{tab.count}</span>
              )}
            </button>
          ))}
        </div>

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CATALOG TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'catalog' && (
          <div className="p-6 space-y-4">
            {/* Advanced Filters */}
            <div className="flex items-center justify-between gap-4 flex-wrap">
              <div className="flex items-center gap-3 flex-wrap">
                <div className="relative">
                  <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                  <input type="text" placeholder="Ø¨Ø­Ø«..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                    className="w-56 pr-12 pl-4 py-2.5 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" />
                </div>
                <select value={filterAuthority} onChange={(e) => setFilterAuthority(e.target.value)} className="px-4 py-2.5 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
                  {authorities.map(a => <option key={a.code} value={a.code}>{a.code} - {a.name}</option>)}
                </select>
                <select value={filterCountry} onChange={(e) => setFilterCountry(e.target.value)} className="px-4 py-2.5 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆÙ„</option>
                  {countries.map(c => <option key={c.code} value={c.code}>{c.flag} {c.name}</option>)}
                </select>
                <select value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)} className="px-4 py-2.5 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                  <option value="activated">Ù…ÙØ¹Ù‘Ù„</option>
                  <option value="inactive">ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„</option>
                </select>
              </div>
              <div className="flex items-center gap-2">
                <button onClick={() => setViewMode(viewMode === 'table' ? 'grid' : 'table')} className="p-2.5 border-2 border-slate-200 rounded-xl hover:bg-slate-50">
                  {viewMode === 'table' ? <LayoutGrid className="w-5 h-5" /> : <List className="w-5 h-5" />}
                </button>
                <button onClick={openAddProgram} className="flex items-center gap-2 px-4 py-2.5 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                  <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù†Ø§Ù…Ø¬
                </button>
              </div>
            </div>

            {/* Programs Table */}
            {viewMode === 'table' ? (
              <div className="overflow-hidden rounded-xl border-2 border-slate-200">
                <table className="w-full">
                  <thead>
                    <tr className="bg-slate-50">
                      <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¬Ù‡Ø©</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¯ÙˆÙ„Ø©</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ù†ÙˆØ¹</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                      <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                  </thead>
                  <tbody>
                    {filteredPrograms.map(prog => {
                      const isActivated = activatedPrograms.includes(prog.id);
                      const country = countries.find(c => c.code === prog.country);
                      return (
                        <tr key={prog.id} className="border-t border-slate-100 hover:bg-slate-50">
                          <td className="px-4 py-3">
                            <div className="flex items-center gap-3">
                              <span className="text-2xl">{prog.icon}</span>
                              <div>
                                <p className="font-bold text-slate-800">{prog.name}</p>
                                <p className="text-xs text-slate-500">{prog.code}</p>
                              </div>
                            </div>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <span className="px-2 py-1 bg-slate-100 text-slate-700 rounded text-xs font-bold">{prog.authority}</span>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <span className="text-lg">{country?.flag}</span>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <span className={`px-2 py-1 rounded text-xs font-bold ${prog.type === 'Mandatory' ? 'bg-red-100 text-red-700' :
                                prog.type === 'Conditional' ? 'bg-amber-100 text-amber-700' :
                                  'bg-blue-100 text-blue-700'
                              }`}>{prog.type === 'Mandatory' ? 'Ø¥Ù„Ø²Ø§Ù…ÙŠ' : prog.type === 'Conditional' ? 'Ù…Ø´Ø±ÙˆØ·' : 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ'}</span>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <span className={`px-2 py-1 rounded text-xs font-bold ${prog.criticality === 'Critical' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}`}>
                              {prog.criticality === 'Critical' ? 'Ø­Ø±Ø¬' : 'Ø¹Ø§Ù„ÙŠ'}
                            </span>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <span className="px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-bold">{prog.obligations.length}</span>
                          </td>
                          <td className="px-4 py-3 text-center">
                            <div className="flex items-center justify-center gap-2">
                              <div className="w-16 h-2 bg-slate-200 rounded-full overflow-hidden">
                                <div className={`h-full rounded-full ${prog.complianceRate >= 80 ? 'bg-emerald-500' : prog.complianceRate >= 60 ? 'bg-amber-500' : 'bg-red-500'}`}
                                  style={{ width: `${prog.complianceRate}%` }}></div>
                              </div>
                              <span className="text-xs font-bold text-slate-600">{prog.complianceRate}%</span>
                            </div>
                          </td>
                          <td className="px-4 py-3 text-center">
                            {isActivated ? (
                              <span className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-bold flex items-center gap-1 justify-center">
                                <CheckCircle2 className="w-3 h-3" />Ù…ÙØ¹Ù‘Ù„
                              </span>
                            ) : (
                              <span className="px-2 py-1 bg-slate-100 text-slate-500 rounded text-xs font-bold">ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„</span>
                            )}
                          </td>
                          <td className="px-4 py-3">
                            <div className="flex items-center justify-center gap-1">
                              <button onClick={() => { setSelectedProgram(prog); setShowDetailModal(true); }} className="p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg" title="Ø¹Ø±Ø¶">
                                <Eye className="w-4 h-4" />
                              </button>
                              <button onClick={() => openEditProgram(prog)} className="p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg" title="ØªØ¹Ø¯ÙŠÙ„">
                                <Edit className="w-4 h-4" />
                              </button>
                              <button onClick={() => openDeleteProgram(prog)} className="p-1.5 text-red-600 hover:bg-red-50 rounded-lg" title="Ø­Ø°Ù">
                                <Trash2 className="w-4 h-4" />
                              </button>
                              {!isActivated ? (
                                <button onClick={() => { setSelectedProgram(prog); setShowAdvancedWizard(true); }} className="p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg" title="ØªÙØ¹ÙŠÙ„">
                                  <Zap className="w-4 h-4" />
                                </button>
                              ) : (
                                <button onClick={() => handleDeactivateProgram(prog.id)} className="p-1.5 text-slate-400 hover:bg-slate-50 rounded-lg" title="Ø¥Ù„ØºØ§Ø¡">
                                  <XCircle className="w-4 h-4" />
                                </button>
                              )}
                            </div>
                          </td>
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
            ) : (
              <div className="grid grid-cols-3 gap-4">
                {filteredPrograms.map(prog => {
                  const isActivated = activatedPrograms.includes(prog.id);
                  const country = countries.find(c => c.code === prog.country);
                  return (
                    <div key={prog.id} className={`rounded-2xl p-5 border-2 transition-all hover:shadow-lg ${isActivated ? 'bg-gradient-to-br from-emerald-50 to-teal-50 border-emerald-200' : 'bg-white border-slate-200'}`}>
                      <div className="flex items-start justify-between mb-4">
                        <div className="flex items-center gap-3">
                          <span className="text-3xl">{prog.icon}</span>
                          <div>
                            <p className="font-bold text-slate-800">{prog.name}</p>
                            <p className="text-xs text-slate-500">{prog.authority} â€¢ {country?.flag}</p>
                          </div>
                        </div>
                        {isActivated && <CheckCircle2 className="w-5 h-5 text-emerald-500" />}
                      </div>
                      <p className="text-sm text-slate-600 mb-4 line-clamp-2">{prog.description}</p>
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-2">
                          <span className={`px-2 py-1 rounded text-xs font-bold ${prog.criticality === 'Critical' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}`}>
                            {prog.criticality === 'Critical' ? 'Ø­Ø±Ø¬' : 'Ø¹Ø§Ù„ÙŠ'}
                          </span>
                          <span className="text-xs text-slate-500">{prog.obligations.length} Ø§Ù„ØªØ²Ø§Ù…</span>
                        </div>
                        <div className="flex items-center gap-1">
                          <button onClick={() => { setSelectedProgram(prog); setShowDetailModal(true); }} className="p-1.5 text-blue-600 hover:bg-blue-50 rounded-lg"><Eye className="w-4 h-4" /></button>
                          <button onClick={() => openEditProgram(prog)} className="p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg"><Edit className="w-4 h-4" /></button>
                          {!isActivated && <button onClick={() => { setSelectedProgram(prog); setShowAdvancedWizard(true); }} className="p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg"><Zap className="w-4 h-4" /></button>}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
            <p className="text-sm text-slate-500">{filteredPrograms.length} Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ACTIVATED TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'activated' && (
          <div className="p-6 space-y-4">
            <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
              <CheckCircle2 className="w-5 h-5 text-emerald-500" />Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…ÙØ¹Ù‘Ù„Ø© ÙÙŠ Ù…Ù†Ø¸Ù…ØªÙƒ ({activatedPrograms.length})
            </h3>

            {activatedPrograms.length > 0 ? (
              <div className="grid grid-cols-3 gap-4">
                {programs.filter(p => activatedPrograms.includes(p.id)).map(prog => (
                  <div key={prog.id} className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-5 text-white relative overflow-hidden group">
                    <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"></div>
                    <div className="relative">
                      <div className="flex items-center justify-between mb-4">
                        <span className="text-4xl">{prog.icon}</span>
                        <div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-all">
                          <button onClick={() => openEditProgram(prog)} className="p-2 bg-white/20 hover:bg-white/30 rounded-lg"><Edit className="w-4 h-4" /></button>
                          <button onClick={() => handleDeactivateProgram(prog.id)} className="p-2 bg-white/20 hover:bg-white/30 rounded-lg"><XCircle className="w-4 h-4" /></button>
                        </div>
                      </div>
                      <h4 className="font-bold text-xl mb-1">{prog.name}</h4>
                      <p className="text-emerald-100 text-sm mb-4">{prog.authority} â€¢ {prog.country === 'SA' ? 'ğŸ‡¸ğŸ‡¦' : 'ğŸŒ'}</p>
                      <div className="grid grid-cols-3 gap-2">
                        <div className="bg-white/20 rounded-xl p-2 text-center">
                          <p className="text-xl font-black">{prog.obligations.length}</p>
                          <p className="text-xs text-emerald-100">Ø§Ù„ØªØ²Ø§Ù…</p>
                        </div>
                        <div className="bg-white/20 rounded-xl p-2 text-center">
                          <p className="text-xl font-black">{prog.standards?.length || 0}</p>
                          <p className="text-xs text-emerald-100">Ù…Ø¹ÙŠØ§Ø±</p>
                        </div>
                        <div className="bg-white/20 rounded-xl p-2 text-center">
                          <p className="text-xl font-black">{prog.complianceRate}%</p>
                          <p className="text-xs text-emerald-100">Ø§Ù…ØªØ«Ø§Ù„</p>
                        </div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            ) : (
              <div className="text-center py-12 bg-slate-50 rounded-2xl">
                <FolderOpen className="w-16 h-16 text-slate-300 mx-auto mb-4" />
                <p className="text-slate-500 text-lg mb-4">Ù„Ù… ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø£ÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¨Ø¹Ø¯</p>
                <button onClick={() => setActiveTab('catalog')} className="px-6 py-3 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬</button>
              </div>
            )}
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OBLIGATIONS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'obligations' && (
          <div className="p-6 space-y-4">
            <div className="flex items-center justify-between gap-4 flex-wrap">
              <div className="flex items-center gap-3">
                <div className="relative">
                  <Search className="absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" />
                  <input type="text" placeholder="Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)}
                    className="w-64 pr-12 pl-4 py-2.5 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" />
                </div>
                <select value={filterAuthority} onChange={(e) => setFilterAuthority(e.target.value)} className="px-4 py-2.5 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø§Øª</option>
                  {authorities.map(a => <option key={a.code} value={a.code}>{a.code}</option>)}
                </select>
                <select value={filterSeverity} onChange={(e) => setFilterSeverity(e.target.value)} className="px-4 py-2.5 border-2 border-slate-200 rounded-xl">
                  <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‡Ù…ÙŠØ§Øª</option>
                  <option value="Critical">Ø­Ø±Ø¬</option>
                  <option value="High">Ø¹Ø§Ù„ÙŠ</option>
                  <option value="Medium">Ù…ØªÙˆØ³Ø·</option>
                </select>
              </div>
            </div>

            <div className="overflow-hidden rounded-xl border-2 border-slate-200">
              <table className="w-full">
                <thead>
                  <tr className="bg-slate-50">
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„ÙƒÙˆØ¯</th>
                    <th className="text-right px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„ØªÙƒØ±Ø§Ø±</th>
                    <th className="text-center px-4 py-3 font-bold text-slate-700">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                  </tr>
                </thead>
                <tbody>
                  {filteredObligations.slice(0, 50).map((obl, idx) => {
                    const prog = programs.find(p => p.id === obl.programId);
                    return (
                      <tr key={`${obl.code}-${idx}`} className="border-t border-slate-100 hover:bg-slate-50">
                        <td className="px-4 py-3">
                          <span className="font-mono text-xs bg-slate-100 px-2 py-1 rounded font-bold">{obl.code}</span>
                        </td>
                        <td className="px-4 py-3">
                          <p className="text-slate-800 font-medium">{obl.title}</p>
                          {obl.description && <p className="text-xs text-slate-500 mt-1 line-clamp-1">{obl.description}</p>}
                        </td>
                        <td className="px-4 py-3 text-center">
                          <div className="flex items-center justify-center gap-1">
                            <span className="text-lg">{obl.programIcon}</span>
                            <span className="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-bold">{obl.authority}</span>
                          </div>
                        </td>
                        <td className="px-4 py-3 text-center">
                          <span className={`px-2 py-1 rounded text-xs font-bold ${obl.severity === 'Critical' ? 'bg-red-100 text-red-700' :
                              obl.severity === 'High' ? 'bg-amber-100 text-amber-700' : 'bg-blue-100 text-blue-700'
                            }`}>{obl.severity === 'Critical' ? 'Ø­Ø±Ø¬' : obl.severity === 'High' ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·'}</span>
                        </td>
                        <td className="px-4 py-3 text-center text-sm text-slate-600">{obl.recurrence}</td>
                        <td className="px-4 py-3">
                          <div className="flex items-center justify-center gap-1">
                            <button onClick={() => prog && openEditObligation(prog, obl)} className="p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg"><Edit className="w-4 h-4" /></button>
                            <button onClick={() => openDeleteObligation(obl)} className="p-1.5 text-red-600 hover:bg-red-50 rounded-lg"><Trash2 className="w-4 h-4" /></button>
                          </div>
                        </td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
            <p className="text-sm text-slate-500">{filteredObligations.length} Ø§Ù„ØªØ²Ø§Ù… (Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 50)</p>
          </div>
        )}

        {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANALYTICS TAB â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
        {activeTab === 'analytics' && (
          <div className="p-6 space-y-6">
            <h3 className="font-bold text-slate-800 text-lg flex items-center gap-2">
              <BarChart3 className="w-5 h-5 text-purple-500" />ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
            </h3>

            <div className="grid grid-cols-4 gap-4">
              <div className="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-5 text-white">
                <h4 className="font-bold mb-2">Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„</h4>
                <p className="text-5xl font-black">{Math.round((stats.activatedCount / Math.max(stats.totalPrograms, 1)) * 100)}%</p>
                <p className="text-emerald-100 text-sm mt-2">{stats.activatedCount} Ù…Ù† {stats.totalPrograms}</p>
              </div>
              <div className="bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-5 text-white">
                <h4 className="font-bold mb-2">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</h4>
                <p className="text-5xl font-black">{Math.round(programs.reduce((sum, p) => sum + p.complianceRate, 0) / programs.length)}%</p>
                <p className="text-blue-100 text-sm mt-2">Ø¹Ø¨Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬</p>
              </div>
              <div className="bg-gradient-to-br from-red-500 to-rose-600 rounded-2xl p-5 text-white">
                <h4 className="font-bold mb-2">Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø­Ø±Ø¬Ø©</h4>
                <p className="text-5xl font-black">{stats.criticalObligations}</p>
                <p className="text-red-100 text-sm mt-2">ØªØªØ·Ù„Ø¨ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Ù‹ ÙÙˆØ±ÙŠØ§Ù‹</p>
              </div>
              <div className="bg-gradient-to-br from-purple-500 to-violet-600 rounded-2xl p-5 text-white">
                <h4 className="font-bold mb-2">Ø¨Ø±Ø§Ù…Ø¬ Ø¯ÙˆÙ„ÙŠØ©</h4>
                <p className="text-5xl font-black">{stats.internationalPrograms}</p>
                <p className="text-purple-100 text-sm mt-2">ISO, PCI, SOC, GDPR</p>
              </div>
            </div>

            <div className="grid grid-cols-2 gap-6">
              <div className="bg-white rounded-2xl border-2 border-slate-200 p-5">
                <h4 className="font-bold text-slate-700 mb-4">ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù‡Ø©</h4>
                <div className="space-y-3">
                  {authorities.slice(0, 8).map(auth => {
                    const oblCount = allObligations.filter(o => o.authority === auth.code).length;
                    return (
                      <div key={auth.code} className="flex items-center gap-3">
                        <span className="w-20 text-xs font-bold text-slate-600">{auth.code}</span>
                        <div className="flex-1 h-5 bg-slate-100 rounded-full overflow-hidden">
                          <div className="h-full bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full" style={{ width: `${Math.min((oblCount / Math.max(allObligations.length, 1)) * 100 * 3, 100)}%` }}></div>
                        </div>
                        <span className="w-8 text-sm font-bold text-slate-700">{oblCount}</span>
                      </div>
                    );
                  })}
                </div>
              </div>

              <div className="bg-white rounded-2xl border-2 border-slate-200 p-5">
                <h4 className="font-bold text-slate-700 mb-4">ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</h4>
                <div className="flex items-center justify-around py-4">
                  <div className="text-center">
                    <div className="w-20 h-20 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-2">
                      <span className="text-2xl font-black text-red-600">{allObligations.filter(o => o.severity === 'Critical').length}</span>
                    </div>
                    <p className="text-sm font-bold text-slate-600">Ø­Ø±Ø¬</p>
                  </div>
                  <div className="text-center">
                    <div className="w-20 h-20 rounded-full bg-amber-100 flex items-center justify-center mx-auto mb-2">
                      <span className="text-2xl font-black text-amber-600">{allObligations.filter(o => o.severity === 'High').length}</span>
                    </div>
                    <p className="text-sm font-bold text-slate-600">Ø¹Ø§Ù„ÙŠ</p>
                  </div>
                  <div className="text-center">
                    <div className="w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-2">
                      <span className="text-2xl font-black text-blue-600">{allObligations.filter(o => o.severity === 'Medium').length}</span>
                    </div>
                    <p className="text-sm font-bold text-slate-600">Ù…ØªÙˆØ³Ø·</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}
      </div>

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PREMIUM PROGRAM MODAL - 7 TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showProgramModal && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
            {/* Header */}
            <div className="bg-gradient-to-r from-emerald-500 to-teal-600 px-6 py-5 text-white shrink-0">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center text-3xl">{programForm.icon || 'ğŸ“‹'}</div>
                  <div>
                    <h2 className="text-xl font-bold">{editMode ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ' : 'Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø¬Ø¯ÙŠØ¯'}</h2>
                    <p className="text-emerald-200 text-sm">{editMode ? 'Edit Regulatory Program' : 'Add New Regulatory Program'}</p>
                  </div>
                </div>
                <button onClick={() => { setShowProgramModal(false); setEditMode(false); resetProgramForm(); }} className="w-10 h-10 rounded-xl bg-white/20 hover:bg-white/30 flex items-center justify-center">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>

            {/* Tabs Navigation */}
            <div className="flex border-b border-slate-200 bg-slate-50 px-4 shrink-0 overflow-x-auto">
              {programModalTabs.map(tab => (
                <button key={tab.id} onClick={() => setProgramModalTab(tab.id)}
                  className={`flex items-center gap-2 px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 transition-all ${programModalTab === tab.id ? 'text-emerald-600 border-emerald-500 bg-white -mb-[1px]' : 'text-slate-500 border-transparent hover:text-emerald-500'
                    }`}>
                  <tab.icon className="w-4 h-4" />{tab.label}
                </button>
              ))}
            </div>

            {/* Tab Content */}
            <div className="flex-1 overflow-y-auto p-6">
              {/* Tab 0: Basic Info */}
              {programModalTab === 0 && (
                <div className="space-y-4">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© *</label>
                      <input type="text" value={programForm.name} onChange={(e) => setProgramForm(p => ({ ...p, name: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" placeholder="Ù…Ø«Ø§Ù„: Ù†Ø¸Ø§Ù… Ø´Ù…ÙˆØ³ Ø§Ù„Ø£Ù…Ù†ÙŠ" />
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© *</label>
                      <input type="text" value={programForm.nameEn} onChange={(e) => setProgramForm(p => ({ ...p, nameEn: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" placeholder="Shomoos Security System" />
                    </div>
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</label>
                      <input type="text" value={programForm.code} onChange={(e) => setProgramForm(p => ({ ...p, code: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none font-mono" placeholder="SA-MOI-SHOMOOS (ÙŠÙÙˆÙ„Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)" />
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</label>
                      <input type="text" value={programForm.version} onChange={(e) => setProgramForm(p => ({ ...p, version: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" placeholder="2.0" />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ *</label>
                    <textarea value={programForm.description} onChange={(e) => setProgramForm(p => ({ ...p, description: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none h-24 resize-none" placeholder="ÙˆØµÙ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙˆØ£Ù‡Ø¯Ø§ÙÙ‡..." />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</label>
                    <textarea value={programForm.scope} onChange={(e) => setProgramForm(p => ({ ...p, scope: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none h-20 resize-none" placeholder="Ø§Ù„Ø¬Ù‡Ø§Øª ÙˆØ§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬..." />
                  </div>
                </div>
              )}

              {/* Tab 1: Authority & Classification */}
              {programModalTab === 1 && (
                <div className="space-y-4">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© *</label>
                      <select value={programForm.authority} onChange={(e) => {
                        const auth = authorities.find(a => a.code === e.target.value);
                        setProgramForm(p => ({ ...p, authority: e.target.value, authorityName: auth?.name || '', country: auth?.country || 'SA' }));
                      }} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</option>
                        {authorities.map(a => <option key={a.code} value={a.code}>{a.code} - {a.name}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø©</label>
                      <input type="text" value={programForm.authorityName} onChange={(e) => setProgramForm(p => ({ ...p, authorityName: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none" placeholder="ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©" />
                    </div>
                  </div>
                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¯ÙˆÙ„Ø© *</label>
                      <select value={programForm.country} onChange={(e) => setProgramForm(p => ({ ...p, country: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400">
                        {countries.map(c => <option key={c.code} value={c.code}>{c.flag} {c.name}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ *</label>
                      <select value={programForm.type} onChange={(e) => setProgramForm(p => ({ ...p, type: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400">
                        {programTypes.map(t => <option key={t} value={t}>{t === 'Mandatory' ? 'Ø¥Ù„Ø²Ø§Ù…ÙŠ' : t === 'Voluntary' ? 'Ø§Ø®ØªÙŠØ§Ø±ÙŠ' : t === 'Conditional' ? 'Ù…Ø´Ø±ÙˆØ·' : 'Ù…Ø¹ÙŠØ§Ø± ØµÙ†Ø§Ø¹ÙŠ'}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù‡Ù…ÙŠØ© *</label>
                      <select value={programForm.criticality} onChange={(e) => setProgramForm(p => ({ ...p, criticality: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400">
                        <option value="Critical">Ø­Ø±Ø¬ (Critical)</option>
                        <option value="High">Ø¹Ø§Ù„ÙŠ (High)</option>
                        <option value="Medium">Ù…ØªÙˆØ³Ø· (Medium)</option>
                      </select>
                    </div>
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©</label>
                      <div className="flex flex-wrap gap-2 p-3 border-2 border-slate-200 rounded-xl">
                        {icons.map(ic => (
                          <button key={ic} type="button" onClick={() => setProgramForm(p => ({ ...p, icon: ic }))}
                            className={`w-10 h-10 rounded-lg text-xl flex items-center justify-center transition-all ${programForm.icon === ic ? 'bg-emerald-100 ring-2 ring-emerald-500' : 'hover:bg-slate-100'}`}>{ic}</button>
                        ))}
                      </div>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù„ÙˆÙ†</label>
                      <div className="flex flex-wrap gap-2 p-3 border-2 border-slate-200 rounded-xl">
                        {['red', 'emerald', 'blue', 'purple', 'amber', 'indigo', 'teal', 'pink', 'orange', 'cyan', 'violet', 'slate'].map(c => (
                          <button key={c} type="button" onClick={() => setProgramForm(p => ({ ...p, color: c }))}
                            className={`w-8 h-8 rounded-lg bg-${c}-500 transition-all ${programForm.color === c ? 'ring-2 ring-offset-2 ring-slate-400' : ''}`}></button>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Tab 2: Sectors - PREMIUM */}
              {programModalTab === 2 && (
                <div className="space-y-5">
                  {/* Info Box */}
                  <div className="bg-amber-50 border border-amber-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-amber-700">
                      <Layers className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</p>
                    </div>
                    <p className="text-amber-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„ØªÙŠ ÙŠØ·Ø¨Ù‚ Ø¹Ù„ÙŠÙ‡Ø§ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                  </div>

                  {/* Quick Actions */}
                  <div className="flex items-center justify-between">
                    <label className="block text-sm font-bold text-slate-700">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø©</label>
                    <div className="flex gap-2">
                      <button type="button" onClick={() => setProgramForm(p => ({ ...p, sectorAr: [...sectors] }))}
                        className="text-sm text-emerald-600 hover:text-emerald-700 font-bold flex items-center gap-1">
                        <CheckCircle2 className="w-4 h-4" />ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
                      </button>
                      <span className="text-slate-300">|</span>
                      <button type="button" onClick={() => setProgramForm(p => ({ ...p, sectorAr: [] }))}
                        className="text-sm text-red-600 hover:text-red-700 font-bold flex items-center gap-1">
                        <XCircle className="w-4 h-4" />Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„
                      </button>
                    </div>
                  </div>

                  {/* Sectors Grid */}
                  <div className="grid grid-cols-4 gap-2 p-4 border-2 border-slate-200 rounded-xl max-h-72 overflow-y-auto bg-slate-50">
                    {sectors.map(sector => (
                      <label key={sector} className={`flex items-center gap-2 p-3 rounded-xl cursor-pointer transition-all border-2 ${programForm.sectorAr?.includes(sector)
                          ? 'bg-emerald-100 border-emerald-500 text-emerald-700'
                          : 'bg-white border-slate-200 hover:border-emerald-300 text-slate-700'
                        }`}>
                        <input type="checkbox" checked={programForm.sectorAr?.includes(sector)} onChange={(e) => {
                          if (e.target.checked) {
                            setProgramForm(p => ({ ...p, sectorAr: [...(p.sectorAr || []), sector] }));
                          } else {
                            setProgramForm(p => ({ ...p, sectorAr: (p.sectorAr || []).filter(s => s !== sector) }));
                          }
                        }} className="w-4 h-4 text-emerald-500 rounded border-2" />
                        <span className="text-sm font-medium">{sector}</span>
                      </label>
                    ))}
                  </div>

                  {/* Selected Sectors Display */}
                  <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                    <div className="flex items-center justify-between mb-3">
                      <p className="text-sm font-bold text-emerald-700">Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</p>
                      <span className="px-3 py-1 bg-emerald-500 text-white rounded-full text-sm font-bold">{programForm.sectorAr?.length || 0} Ù‚Ø·Ø§Ø¹</span>
                    </div>
                    {programForm.sectorAr?.length > 0 ? (
                      <div className="flex flex-wrap gap-2">
                        {programForm.sectorAr.map((sector, idx) => (
                          <span key={idx} className="inline-flex items-center gap-1 px-3 py-1.5 bg-emerald-500 text-white rounded-full text-sm font-bold">
                            {sector}
                            <button type="button" onClick={() => setProgramForm(p => ({ ...p, sectorAr: p.sectorAr.filter(s => s !== sector) }))}
                              className="hover:bg-white/20 rounded-full p-0.5 transition-all">
                              <X className="w-3 h-3" />
                            </button>
                          </span>
                        ))}
                      </div>
                    ) : (
                      <p className="text-emerald-600 text-sm">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù‚Ø·Ø§Ø¹ Ø¨Ø¹Ø¯</p>
                    )}
                  </div>
                </div>
              )}

              {/* Tab 3: Dates & Timeline - PREMIUM */}
              {programModalTab === 3 && (
                <div className="space-y-5">
                  {/* Info Box */}
                  <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-blue-700">
                      <Calendar className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ÙˆØ§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø²Ù…Ù†ÙŠØ©</p>
                    </div>
                    <p className="text-blue-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…Ù‡Ù…Ø© ÙˆØ§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                  </div>

                  {/* Main Dates */}
                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-slate-50 rounded-xl p-4">
                      <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                        <span className="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center">ğŸ“…</span>
                        ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†
                      </label>
                      <input type="date" value={programForm.effectiveDate} onChange={(e) => setProgramForm(p => ({ ...p, effectiveDate: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none bg-white" />
                      <p className="text-xs text-slate-500 mt-2">Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°ÙŠ ÙŠØ¨Ø¯Ø£ ÙÙŠÙ‡ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
                    </div>
                    <div className="bg-slate-50 rounded-xl p-4">
                      <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                        <span className="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">ğŸ”„</span>
                        Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
                      </label>
                      <input type="date" value={programForm.lastUpdated} onChange={(e) => setProgramForm(p => ({ ...p, lastUpdated: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none bg-white" />
                      <p className="text-xs text-slate-500 mt-2">ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
                    </div>
                  </div>

                  {/* Review & Expiry */}
                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-slate-50 rounded-xl p-4">
                      <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                        <span className="w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center">ğŸ”</span>
                        ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
                      </label>
                      <input type="date" value={programForm.reviewDate || ''} onChange={(e) => setProgramForm(p => ({ ...p, reviewDate: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none bg-white" />
                      <p className="text-xs text-slate-500 mt-2">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</p>
                    </div>
                    <div className="bg-slate-50 rounded-xl p-4">
                      <label className="flex items-center gap-2 text-sm font-bold text-slate-700 mb-3">
                        <span className="w-8 h-8 rounded-lg bg-red-100 flex items-center justify-center">â°</span>
                        ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ (Ø¥Ù† ÙˆØ¬Ø¯)
                      </label>
                      <input type="date" value={programForm.expiryDate || ''} onChange={(e) => setProgramForm(p => ({ ...p, expiryDate: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400 focus:outline-none bg-white" />
                      <p className="text-xs text-slate-500 mt-2">Ù„Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø°Ø§Øª Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>
                    </div>
                  </div>

                  {/* Grace & Transition Periods */}
                  <div className="bg-purple-50 rounded-xl p-5 border border-purple-200">
                    <h4 className="font-bold text-purple-700 mb-4 flex items-center gap-2">
                      <Clock className="w-5 h-5" />
                      Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø²Ù…Ù†ÙŠØ©
                    </h4>
                    <div className="grid grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…)</label>
                        <input type="number" min="0" value={programForm.gracePeriod || 0} onChange={(e) => setProgramForm(p => ({ ...p, gracePeriod: parseInt(e.target.value) || 0 }))}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none bg-white" />
                        <p className="text-xs text-slate-500 mt-1">Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ù…Ù†ÙˆØ­Ø© Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø±ÙŠØ§Ù†</p>
                      </div>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">ÙØªØ±Ø© Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…)</label>
                        <input type="number" min="0" value={programForm.transitionPeriod || 0} onChange={(e) => setProgramForm(p => ({ ...p, transitionPeriod: parseInt(e.target.value) || 0 }))}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none bg-white" />
                        <p className="text-xs text-slate-500 mt-1">ÙØªØ±Ø© Ø§Ù„ØªØ­ÙˆÙ„ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {/* Tab 4: Penalties & Risks - PREMIUM */}
              {programModalTab === 4 && (
                <div className="space-y-5">
                  {/* Info Box */}
                  <div className="bg-red-50 border border-red-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-red-700">
                      <AlertTriangle className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±</p>
                    </div>
                    <p className="text-red-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…ØªØ±ØªØ¨Ø© Ø¹Ù„Ù‰ Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆÙ…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</p>
                  </div>

                  {/* Penalty Summary */}
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">ğŸ“ Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª</label>
                    <textarea value={programForm.penalty} onChange={(e) => setProgramForm(p => ({ ...p, penalty: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-red-400 focus:outline-none h-24 resize-none"
                      placeholder="ÙˆØµÙ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…ØªØ±ØªØ¨Ø© Ø¹Ù„Ù‰ Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ØŒ Ù…Ø«Ù„: ØºØ±Ø§Ù…Ø§Øª Ù…Ø§Ù„ÙŠØ© ØªØµÙ„ Ø¥Ù„Ù‰ X Ø±ÙŠØ§Ù„ + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø· + Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµ..." />
                  </div>

                  {/* Financial Penalties */}
                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <h4 className="font-bold text-slate-700 flex items-center gap-2">ğŸ’° Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h4>
                    <div className="grid grid-cols-4 gap-4">
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰</label>
                        <input type="number" value={programForm.penaltyDetails?.financial?.min || 0} onChange={(e) => setProgramForm(p => ({
                          ...p, penaltyDetails: { ...p.penaltyDetails, financial: { ...p.penaltyDetails?.financial, min: parseInt(e.target.value) || 0 } }
                        }))} className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-red-400 focus:outline-none" />
                      </div>
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰</label>
                        <input type="number" value={programForm.penaltyDetails?.financial?.max || 0} onChange={(e) => setProgramForm(p => ({
                          ...p, penaltyDetails: { ...p.penaltyDetails, financial: { ...p.penaltyDetails?.financial, max: parseInt(e.target.value) || 0 } }
                        }))} className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-red-400 focus:outline-none" />
                      </div>
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ø¹Ù…Ù„Ø©</label>
                        <select value={programForm.penaltyDetails?.financial?.currency || 'SAR'} onChange={(e) => setProgramForm(p => ({
                          ...p, penaltyDetails: { ...p.penaltyDetails, financial: { ...p.penaltyDetails?.financial, currency: e.target.value } }
                        }))} className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-red-400">
                          <option value="SAR">ğŸ‡¸ğŸ‡¦ Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</option>
                          <option value="USD">ğŸ‡ºğŸ‡¸ Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ</option>
                          <option value="EUR">ğŸ‡ªğŸ‡º ÙŠÙˆØ±Ùˆ</option>
                          <option value="%">ğŸ“Š Ù†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ©</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</label>
                        <select value={programForm.penaltyDetails?.financial?.method || 'Fixed'} onChange={(e) => setProgramForm(p => ({
                          ...p, penaltyDetails: { ...p.penaltyDetails, financial: { ...p.penaltyDetails?.financial, method: e.target.value } }
                        }))} className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-red-400">
                          <option value="Fixed">Ø«Ø§Ø¨Øª</option>
                          <option value="PerViolation">Ù„ÙƒÙ„ Ù…Ø®Ø§Ù„ÙØ©</option>
                          <option value="PerDay">ÙŠÙˆÙ…ÙŠØ§Ù‹</option>
                          <option value="Revenue">% Ù…Ù† Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  {/* Operational Penalties */}
                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <h4 className="font-bold text-slate-700 flex items-center gap-2">ğŸš« Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</h4>
                    <div className="flex gap-2 mb-3">
                      <input type="text" id="opPenaltyInput" placeholder="Ù…Ø«Ø§Ù„: Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…Ù†Ø´Ø£Ø©ØŒ Ø³Ø­Ø¨ Ø§Ù„ØªØ±Ø®ÙŠØµØŒ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø·..."
                        className="flex-1 px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-red-400 focus:outline-none"
                        onKeyPress={(e) => {
                          if (e.key === 'Enter' && e.target.value) {
                            setProgramForm(p => ({
                              ...p,
                              penaltyDetails: {
                                ...p.penaltyDetails,
                                operational: [...(p.penaltyDetails?.operational || []), e.target.value]
                              }
                            }));
                            e.target.value = '';
                          }
                        }} />
                      <button type="button" onClick={() => {
                        const input = document.getElementById('opPenaltyInput');
                        if (input.value) {
                          setProgramForm(p => ({
                            ...p,
                            penaltyDetails: {
                              ...p.penaltyDetails,
                              operational: [...(p.penaltyDetails?.operational || []), input.value]
                            }
                          }));
                          input.value = '';
                        }
                      }} className="px-4 py-2.5 bg-red-500 text-white rounded-lg hover:bg-red-600 font-bold flex items-center gap-1">
                        <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ©
                      </button>
                    </div>
                    <div className="flex flex-wrap gap-2">
                      {programForm.penaltyDetails?.operational?.map((penalty, idx) => (
                        <span key={idx} className="inline-flex items-center gap-1 px-3 py-1.5 bg-red-100 text-red-700 rounded-lg text-sm font-bold">
                          ğŸš« {penalty}
                          <button type="button" onClick={() => setProgramForm(p => ({
                            ...p,
                            penaltyDetails: {
                              ...p.penaltyDetails,
                              operational: (p.penaltyDetails?.operational || []).filter((_, i) => i !== idx)
                            }
                          }))} className="hover:bg-red-200 rounded-full p-0.5 transition-all">
                            <X className="w-3 h-3" />
                          </button>
                        </span>
                      ))}
                    </div>
                  </div>

                  {/* Criminal Penalties */}
                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">âš–ï¸ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©</label>
                    <input type="text" value={programForm.penaltyDetails?.criminal || ''} onChange={(e) => setProgramForm(p => ({
                      ...p, penaltyDetails: { ...p.penaltyDetails, criminal: e.target.value }
                    }))} className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-red-400 focus:outline-none"
                      placeholder="Ø§Ù„Ø³Ø¬Ù† Ø­ØªÙ‰ Ø³Ù†ØªÙŠÙ† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥Ù‡Ù…Ø§Ù„ Ø§Ù„Ø¬Ø³ÙŠÙ…ØŒ Ø£Ùˆ 5 Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ¹Ù…Ø¯..." />
                  </div>
                </div>
              )}

              {/* Tab 5: Contacts & Resources - PREMIUM */}
              {programModalTab === 5 && (
                <div className="space-y-6">
                  {/* Info Box */}
                  <div className="bg-indigo-50 border border-indigo-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-indigo-700">
                      <Users className="w-5 h-5" />
                      <p className="font-bold">Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©</p>
                    </div>
                    <p className="text-indigo-600 text-sm mt-1">Ø£Ø¶Ù Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù…Ù‡Ù…Ø©</p>
                  </div>

                  {/* Contacts Section */}
                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <div className="flex items-center justify-between">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <User className="w-5 h-5 text-indigo-600" />
                        Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ({programForm.contacts?.length || 0})
                      </h4>
                    </div>

                    {/* Add Contact Form */}
                    <div className="bg-white rounded-xl p-4 border-2 border-dashed border-slate-300">
                      <div className="grid grid-cols-4 gap-3 mb-3">
                        <input type="text" id="contactName" placeholder="Ø§Ù„Ø§Ø³Ù… *" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-indigo-400 focus:outline-none text-sm" />
                        <input type="text" id="contactRole" placeholder="Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-indigo-400 focus:outline-none text-sm" />
                        <input type="email" id="contactEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-indigo-400 focus:outline-none text-sm" />
                        <input type="tel" id="contactPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-indigo-400 focus:outline-none text-sm" />
                      </div>
                      <button type="button" onClick={() => {
                        const name = document.getElementById('contactName').value;
                        const email = document.getElementById('contactEmail').value;
                        if (name && email) {
                          const newContact = {
                            name,
                            role: document.getElementById('contactRole').value,
                            email,
                            phone: document.getElementById('contactPhone').value
                          };
                          setProgramForm(p => ({ ...p, contacts: [...(p.contacts || []), newContact] }));
                          document.getElementById('contactName').value = '';
                          document.getElementById('contactRole').value = '';
                          document.getElementById('contactEmail').value = '';
                          document.getElementById('contactPhone').value = '';
                        }
                      }} className="w-full py-2.5 bg-indigo-500 text-white rounded-lg font-bold hover:bg-indigo-600 flex items-center justify-center gap-2">
                        <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„
                      </button>
                    </div>

                    {/* Contacts List */}
                    {programForm.contacts?.length > 0 && (
                      <div className="space-y-2">
                        {programForm.contacts.map((contact, idx) => (
                          <div key={idx} className="flex items-center justify-between p-3 bg-white rounded-xl border border-slate-200 hover:border-indigo-300 transition-all">
                            <div className="flex items-center gap-3">
                              <div className="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center">
                                <User className="w-5 h-5 text-indigo-600" />
                              </div>
                              <div>
                                <p className="font-bold text-slate-800">{contact.name} {contact.role && <span className="font-normal text-slate-500 text-sm">({contact.role})</span>}</p>
                                <div className="flex items-center gap-3 text-sm text-slate-600">
                                  <span className="flex items-center gap-1">ğŸ“§ {contact.email}</span>
                                  {contact.phone && <span className="flex items-center gap-1">ğŸ“ {contact.phone}</span>}
                                </div>
                              </div>
                            </div>
                            <button type="button" onClick={() => setProgramForm(p => ({ ...p, contacts: p.contacts.filter((_, i) => i !== idx) }))}
                              className="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-all">
                              <Trash2 className="w-4 h-4" />
                            </button>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>

                  {/* Resources Section */}
                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <div className="flex items-center justify-between">
                      <h4 className="font-bold text-slate-700 flex items-center gap-2">
                        <ExternalLink className="w-5 h-5 text-blue-600" />
                        Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„Ù…Ø±Ø§Ø¬Ø¹ ({programForm.resources?.length || 0})
                      </h4>
                    </div>

                    {/* Add Resource Form */}
                    <div className="bg-white rounded-xl p-4 border-2 border-dashed border-slate-300">
                      <div className="grid grid-cols-4 gap-3 mb-3">
                        <input type="text" id="resourceName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯ *" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-blue-400 focus:outline-none text-sm" />
                        <input type="url" id="resourceUrl" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· (URL) *" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-blue-400 focus:outline-none text-sm col-span-2" />
                        <select id="resourceType" className="px-3 py-2.5 border-2 border-slate-200 rounded-lg focus:border-blue-400 text-sm">
                          <option value="PDF">ğŸ“„ PDF</option>
                          <option value="Website">ğŸŒ Ù…ÙˆÙ‚Ø¹ ÙˆÙŠØ¨</option>
                          <option value="Video">ğŸ¬ ÙÙŠØ¯ÙŠÙˆ</option>
                          <option value="Template">ğŸ“ Ù‚Ø§Ù„Ø¨</option>
                          <option value="Checklist">âœ… Ù‚Ø§Ø¦Ù…Ø© ØªØ­Ù‚Ù‚</option>
                          <option value="FAQ">â“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</option>
                          <option value="API">ğŸ”Œ API</option>
                          <option value="Portal">ğŸšª Ø¨ÙˆØ§Ø¨Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</option>
                        </select>
                      </div>
                      <button type="button" onClick={() => {
                        const name = document.getElementById('resourceName').value;
                        const url = document.getElementById('resourceUrl').value;
                        if (name && url) {
                          const newResource = {
                            name,
                            url,
                            type: document.getElementById('resourceType').value
                          };
                          setProgramForm(p => ({ ...p, resources: [...(p.resources || []), newResource] }));
                          document.getElementById('resourceName').value = '';
                          document.getElementById('resourceUrl').value = '';
                        }
                      }} className="w-full py-2.5 bg-blue-500 text-white rounded-lg font-bold hover:bg-blue-600 flex items-center justify-center gap-2">
                        <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ±Ø¯
                      </button>
                    </div>

                    {/* Resources List */}
                    {programForm.resources?.length > 0 && (
                      <div className="grid grid-cols-2 gap-2">
                        {programForm.resources.map((resource, idx) => (
                          <div key={idx} className="flex items-center justify-between p-3 bg-white rounded-xl border border-slate-200 hover:border-blue-300 transition-all">
                            <div className="flex items-center gap-3">
                              <div className={`w-10 h-10 rounded-lg flex items-center justify-center ${resource.type === 'PDF' ? 'bg-red-100 text-red-600' :
                                  resource.type === 'Video' ? 'bg-purple-100 text-purple-600' :
                                    resource.type === 'Template' ? 'bg-amber-100 text-amber-600' :
                                      'bg-blue-100 text-blue-600'
                                }`}>
                                <FileText className="w-5 h-5" />
                              </div>
                              <div>
                                <p className="font-bold text-slate-800 text-sm">{resource.name}</p>
                                <p className="text-xs text-blue-600 truncate max-w-[150px]">{resource.url}</p>
                              </div>
                              <span className="px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs font-bold">{resource.type}</span>
                            </div>
                            <button type="button" onClick={() => setProgramForm(p => ({ ...p, resources: p.resources.filter((_, i) => i !== idx) }))}
                              className="p-2 text-red-500 hover:bg-red-50 rounded-lg transition-all">
                              <Trash2 className="w-4 h-4" />
                            </button>
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                </div>
              )}

              {/* Tab 6: Metrics & KPIs - PREMIUM */}
              {programModalTab === 6 && (
                <div className="space-y-6">
                  {/* Info Box */}
                  <div className="bg-teal-50 border border-teal-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-teal-700">
                      <Target className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³ ÙˆÙ…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡</p>
                    </div>
                    <p className="text-teal-600 text-sm mt-1">Ø­Ø¯Ø¯ Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© ÙˆÙ…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</p>
                  </div>

                  {/* Compliance Metrics */}
                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-slate-50 rounded-xl p-5">
                      <label className="block text-sm font-bold text-slate-700 mb-4">ğŸ“Š Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label>
                      <div className="flex items-center gap-4">
                        <input type="range" min="0" max="100" value={programForm.complianceRate || 0}
                          onChange={(e) => setProgramForm(p => ({ ...p, complianceRate: parseInt(e.target.value) }))}
                          className="flex-1 h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-emerald-500" />
                        <div className={`w-16 h-16 rounded-2xl flex items-center justify-center font-black text-white text-xl shadow-lg ${(programForm.complianceRate || 0) >= 80 ? 'bg-gradient-to-br from-emerald-400 to-emerald-600' :
                            (programForm.complianceRate || 0) >= 60 ? 'bg-gradient-to-br from-amber-400 to-amber-600' :
                              'bg-gradient-to-br from-red-400 to-red-600'
                          }`}>{programForm.complianceRate || 0}%</div>
                      </div>
                      <div className="h-4 bg-slate-200 rounded-full mt-4 overflow-hidden">
                        <div className={`h-full rounded-full transition-all duration-300 ${(programForm.complianceRate || 0) >= 80 ? 'bg-emerald-500' :
                            (programForm.complianceRate || 0) >= 60 ? 'bg-amber-500' : 'bg-red-500'
                          }`} style={{ width: `${programForm.complianceRate || 0}%` }}></div>
                      </div>
                      <p className="text-xs text-slate-500 mt-2 text-center">
                        {(programForm.complianceRate || 0) >= 80 ? 'âœ… Ù…Ù…ØªØ§Ø² - Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¬ÙŠØ¯' :
                          (programForm.complianceRate || 0) >= 60 ? 'âš ï¸ Ù…ØªÙˆØ³Ø· - ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†' :
                            'ğŸ”´ Ù…Ù†Ø®ÙØ¶ - ÙŠØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø¹Ø§Ø¬Ù„'}
                      </p>
                    </div>

                    <div className="bg-slate-50 rounded-xl p-5">
                      <label className="block text-sm font-bold text-slate-700 mb-4">ğŸ¯ Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</label>
                      <div className="flex items-center gap-4">
                        <input type="range" min="0" max="100" value={programForm.targetComplianceRate || 100}
                          onChange={(e) => setProgramForm(p => ({ ...p, targetComplianceRate: parseInt(e.target.value) }))}
                          className="flex-1 h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-500" />
                        <div className="w-16 h-16 rounded-2xl flex items-center justify-center font-black text-white text-xl shadow-lg bg-gradient-to-br from-blue-400 to-blue-600">
                          {programForm.targetComplianceRate || 100}%
                        </div>
                      </div>
                      <div className="h-4 bg-slate-200 rounded-full mt-4 overflow-hidden">
                        <div className="h-full rounded-full bg-blue-500 transition-all duration-300" style={{ width: `${programForm.targetComplianceRate || 100}%` }}></div>
                      </div>
                      <p className="text-xs text-slate-500 mt-2 text-center">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØªØ­Ù‚ÙŠÙ‚Ù‡</p>
                    </div>
                  </div>

                  {/* Risk Score */}
                  <div className="bg-slate-50 rounded-xl p-5">
                    <label className="block text-sm font-bold text-slate-700 mb-4">âš ï¸ Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± (1-10)</label>
                    <div className="flex items-center gap-4">
                      <span className="text-green-600 font-bold">Ù…Ù†Ø®ÙØ¶</span>
                      <input type="range" min="1" max="10" value={programForm.riskScore || 5}
                        onChange={(e) => setProgramForm(p => ({ ...p, riskScore: parseInt(e.target.value) }))}
                        className="flex-1 h-3 bg-gradient-to-r from-green-200 via-amber-200 to-red-200 rounded-lg appearance-none cursor-pointer" />
                      <span className="text-red-600 font-bold">Ø¹Ø§Ù„ÙŠ</span>
                      <div className={`w-14 h-14 rounded-xl flex items-center justify-center font-black text-white text-xl shadow-lg ${(programForm.riskScore || 5) >= 8 ? 'bg-gradient-to-br from-red-400 to-red-600' :
                          (programForm.riskScore || 5) >= 5 ? 'bg-gradient-to-br from-amber-400 to-amber-600' :
                            'bg-gradient-to-br from-green-400 to-green-600'
                        }`}>{programForm.riskScore || 5}</div>
                    </div>
                  </div>

                  {/* Summary Cards */}
                  <div className="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-5 border border-emerald-200">
                    <h4 className="font-bold text-emerald-700 mb-4 flex items-center gap-2">ğŸ“ˆ Ù…Ù„Ø®Øµ Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡</h4>
                    <div className="grid grid-cols-4 gap-4">
                      <div className="bg-white rounded-xl p-4 text-center shadow-sm">
                        <p className="text-3xl font-black text-emerald-600">{programForm.complianceRate || 0}%</p>
                        <p className="text-xs text-slate-600 mt-1">Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 text-center shadow-sm">
                        <p className="text-3xl font-black text-blue-600">{programForm.targetComplianceRate || 100}%</p>
                        <p className="text-xs text-slate-600 mt-1">Ø§Ù„Ù‡Ø¯Ù</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 text-center shadow-sm">
                        <p className="text-3xl font-black text-amber-600">{(programForm.targetComplianceRate || 100) - (programForm.complianceRate || 0)}%</p>
                        <p className="text-xs text-slate-600 mt-1">Ø§Ù„ÙØ¬ÙˆØ©</p>
                      </div>
                      <div className="bg-white rounded-xl p-4 text-center shadow-sm">
                        <p className={`text-3xl font-black ${(programForm.riskScore || 5) >= 8 ? 'text-red-600' :
                            (programForm.riskScore || 5) >= 5 ? 'text-amber-600' : 'text-green-600'
                          }`}>{programForm.riskScore || 5}/10</p>
                        <p className="text-xs text-slate-600 mt-1">Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Enhanced Footer */}
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between shrink-0">
              <div className="flex items-center gap-3">
                <button disabled={programModalTab === 0} onClick={() => setProgramModalTab(t => t - 1)}
                  className="px-5 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2 transition-all shadow-sm">
                  <ChevronRight className="w-5 h-5" />Ø§Ù„Ø³Ø§Ø¨Ù‚
                </button>
                <button disabled={programModalTab === programModalTabs.length - 1} onClick={() => setProgramModalTab(t => t + 1)}
                  className="px-5 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2 transition-all shadow-sm">
                  Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                </button>
              </div>

              {/* Summary Stats */}
              <div className="flex items-center gap-4 text-sm">
                <span className="px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-lg font-bold flex items-center gap-1">
                  <Layers className="w-4 h-4" />{programForm.sectorAr?.length || 0} Ù‚Ø·Ø§Ø¹
                </span>
                <span className="px-3 py-1.5 bg-indigo-100 text-indigo-700 rounded-lg font-bold flex items-center gap-1">
                  <Users className="w-4 h-4" />{programForm.contacts?.length || 0} Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„
                </span>
                <span className="px-3 py-1.5 bg-blue-100 text-blue-700 rounded-lg font-bold flex items-center gap-1">
                  <ExternalLink className="w-4 h-4" />{programForm.resources?.length || 0} Ù…ÙˆØ±Ø¯
                </span>
              </div>

              <div className="flex items-center gap-3">
                <button onClick={() => { setShowProgramModal(false); setEditMode(false); resetProgramForm(); }}
                  className="px-6 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 transition-all shadow-sm">
                  Ø¥Ù„ØºØ§Ø¡
                </button>
                <button onClick={editMode ? handleEditProgram : handleAddProgram} disabled={!programForm.name || !programForm.authority}
                  className="flex items-center gap-2 px-8 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-xl font-bold shadow-lg hover:shadow-xl disabled:opacity-50 transition-all">
                  {editMode ? <><Save className="w-5 h-5" />Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</> : <><Plus className="w-5 h-5" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</>}
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {/* WORLD-CLASS OBLIGATION WIZARD - 10 TABS ENTERPRISE GRADE                        */}
      {/* Program-Driven Compliance Object Creator                                         */}
      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showObligationModal && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden flex flex-col">
            {/* Header */}
            <div className="bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-700 px-6 py-5 text-white shrink-0">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-16 h-16 rounded-2xl bg-white/20 backdrop-blur flex items-center justify-center">
                    <ClipboardCheck className="w-8 h-8" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-black">{editMode ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ²Ø§Ù… ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø¬Ø¯ÙŠØ¯'}</h2>
                    <p className="text-blue-200">Program-Driven Compliance Object Creator</p>
                  </div>
                </div>
                <div className="flex items-center gap-3">
                  <div className="text-left bg-white/10 rounded-xl px-4 py-2">
                    <p className="text-xs text-blue-200">Ø§Ù„Ø®Ø·ÙˆØ©</p>
                    <p className="text-lg font-bold">{(obligationForm.wizardTab || 0) + 1} / 10</p>
                  </div>
                  <button onClick={() => { setShowObligationModal(false); setEditMode(false); resetObligationForm(); }}
                    className="w-12 h-12 rounded-xl bg-white/20 hover:bg-white/30 flex items-center justify-center transition-all">
                    <X className="w-6 h-6" />
                  </button>
                </div>
              </div>
            </div>

            {/* Progress Bar */}
            <div className="bg-slate-100 px-6 py-3 shrink-0">
              <div className="flex items-center gap-1">
                {[0, 1, 2, 3, 4, 5, 6, 7, 8, 9].map((idx) => (
                  <div key={idx} className={`flex-1 h-2 rounded-full transition-all ${idx <= (obligationForm.wizardTab || 0) ? 'bg-blue-500' : 'bg-slate-300'}`} />
                ))}
              </div>
            </div>

            {/* Tabs Navigation */}
            <div className="flex border-b border-slate-200 bg-slate-50 px-2 shrink-0 overflow-x-auto">
              {[
                { id: 0, label: 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©', icon: FileText },
                { id: 1, label: 'Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ', icon: BookOpen },
                { id: 2, label: 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙˆØ§Ù„Ù‚Ø§Ù„Ø¨', icon: Layers },
                { id: 3, label: 'Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', icon: CheckSquare },
                { id: 4, label: 'Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø©', icon: FileCheck },
                { id: 5, label: 'Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…', icon: Calendar },
                { id: 6, label: 'Ø®Ø·Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±', icon: ClipboardList },
                { id: 7, label: 'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø°', icon: AlertTriangle },
                { id: 8, label: 'Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª', icon: Scale },
                { id: 9, label: 'Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©', icon: GitBranch },
              ].map((tab, idx) => (
                <button key={tab.id} onClick={() => setObligationForm(o => ({ ...o, wizardTab: idx }))}
                  className={`flex items-center gap-1 px-3 py-2.5 text-xs font-bold whitespace-nowrap border-b-2 transition-all ${(obligationForm.wizardTab || 0) === idx ? 'text-blue-600 border-blue-500 bg-white -mb-[1px]' :
                      idx < (obligationForm.wizardTab || 0) ? 'text-blue-500 border-transparent' :
                        'text-slate-500 border-transparent hover:text-blue-500'
                    }`}>
                  <tab.icon className="w-3 h-3" />
                  <span className="hidden xl:inline">{tab.label}</span>
                  {idx < (obligationForm.wizardTab || 0) && <CheckCircle2 className="w-3 h-3 text-blue-500" />}
                </button>
              ))}
            </div>

            {/* Tab Content */}
            <div className="flex-1 overflow-y-auto p-6">
              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 0: Basic Info â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 0 && (
                <div className="space-y-5">
                  <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-blue-700">
                      <FileText className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                    </div>
                    <p className="text-blue-600 text-sm mt-1">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„ØªÙŠ ØªØ¹Ø±Ù‘Ù Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                        ÙƒÙˆØ¯ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… <span className="text-red-500">*</span>
                      </label>
                      <input type="text" value={obligationForm.code} onChange={(e) => setObligationForm(o => ({ ...o, code: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none font-mono"
                        placeholder="SHM-OBL-001" />
                      <p className="text-xs text-slate-500 mt-1">Ù…Ø«Ø§Ù„: SHM-OBL-001, PDPL-ART-18</p>
                    </div>
                    <div className="col-span-2">
                      <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                        Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… <span className="text-red-500">*</span>
                      </label>
                      <input type="text" value={obligationForm.title} onChange={(e) => setObligationForm(o => ({ ...o, title: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none"
                        placeholder="Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ø¶Ø­ ÙˆÙ…Ø­Ø¯Ø¯ Ù„Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ" />
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ØµÙŠØ§ØºØ© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© / Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                    <textarea value={obligationForm.legalText || ''} onChange={(e) => setObligationForm(o => ({ ...o, legalText: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none h-24 resize-none font-mono text-sm"
                      placeholder="Ø§Ù„Ù†Øµ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù…Ù† Ø§Ù„Ù„Ø§Ø¦Ø­Ø© Ø£Ùˆ Ø§Ù„Ù†Ø¸Ø§Ù…..." />
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</label>
                    <textarea value={obligationForm.description} onChange={(e) => setObligationForm(o => ({ ...o, description: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:outline-none h-20 resize-none"
                      placeholder="Ø´Ø±Ø­ ØªÙØµÙŠÙ„ÙŠ Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆÙƒÙŠÙÙŠØ© ØªØ·Ø¨ÙŠÙ‚Ù‡..." />
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</label>
                      <select value={obligationForm.severity} onChange={(e) => setObligationForm(o => ({ ...o, severity: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400">
                        <option value="Critical">ğŸ”´ Ø­Ø±Ø¬ (Critical)</option>
                        <option value="High">ğŸŸ  Ø¹Ø§Ù„ÙŠ (High)</option>
                        <option value="Medium">ğŸŸ¡ Ù…ØªÙˆØ³Ø· (Medium)</option>
                        <option value="Low">ğŸŸ¢ Ù…Ù†Ø®ÙØ¶ (Low)</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© (Control Type)</label>
                      <select value={obligationForm.controlType || 'Preventive'} onChange={(e) => setObligationForm(o => ({ ...o, controlType: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-400">
                        <option value="Preventive">ğŸ›¡ï¸ ÙˆÙ‚Ø§Ø¦ÙŠ (Preventive)</option>
                        <option value="Detective">ğŸ” ÙƒØ´ÙÙŠ (Detective)</option>
                        <option value="Corrective">ğŸ”§ ØªØµØ­ÙŠØ­ÙŠ (Corrective)</option>
                        <option value="Directive">ğŸ“‹ ØªÙˆØ¬ÙŠÙ‡ÙŠ (Directive)</option>
                        <option value="Compensating">âš–ï¸ ØªØ¹ÙˆÙŠØ¶ÙŠ (Compensating)</option>
                      </select>
                    </div>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 1: Regulatory Reference â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 1 && (
                <div className="space-y-5">
                  <div className="bg-purple-50 border border-purple-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-purple-700">
                      <BookOpen className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                    </div>
                    <p className="text-purple-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                  </div>

                  <div className="grid grid-cols-2 gap-6">
                    <div>
                      <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                        Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ© <span className="text-red-500">*</span>
                      </label>
                      <select value={obligationForm.authority || ''} onChange={(e) => setObligationForm(o => ({ ...o, authority: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</option>
                        <optgroup label="ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">
                          {authorities.filter(a => a.country === 'SA').map(a => <option key={a.code} value={a.code}>{a.code} - {a.name}</option>)}
                        </optgroup>
                        <optgroup label="ğŸŒ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©">
                          {authorities.filter(a => a.country === 'INT').map(a => <option key={a.code} value={a.code}>{a.code} - {a.name}</option>)}
                        </optgroup>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</label>
                      <input type="text" value={obligationForm.framework || ''} onChange={(e) => setObligationForm(o => ({ ...o, framework: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                        placeholder="Ù…Ø«Ø§Ù„: ECC 2.0, PDPL, VAT Regulations" />
                    </div>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ù…Ø§Ø¯Ø©/Ø§Ù„Ø¨Ù†Ø¯</label>
                      <input type="text" value={obligationForm.articleNumber || ''} onChange={(e) => setObligationForm(o => ({ ...o, articleNumber: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                        placeholder="Ø§Ù„Ù…Ø§Ø¯Ø© 18" />
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø±Ù‚Ù… Ø§Ù„ÙÙ‚Ø±Ø©</label>
                      <input type="text" value={obligationForm.clauseNumber || ''} onChange={(e) => setObligationForm(o => ({ ...o, clauseNumber: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                        placeholder="Ø§Ù„ÙÙ‚Ø±Ø© 3" />
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù„Ø§Ø¦Ø­Ø©</label>
                      <input type="text" value={obligationForm.regulationVersion || ''} onChange={(e) => setObligationForm(o => ({ ...o, regulationVersion: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                        placeholder="v2.0 - 2024" />
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</label>
                    <input type="url" value={obligationForm.referenceUrl || ''} onChange={(e) => setObligationForm(o => ({ ...o, referenceUrl: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:outline-none"
                      placeholder="https://..." />
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 2: Program & Template Source â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 2 && (
                <div className="space-y-5">
                  <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-emerald-700">
                      <Layers className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙˆÙ…ØµØ¯Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨</p>
                    </div>
                    <p className="text-emerald-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ ÙˆÙ†ÙˆØ¹ Ù…ØµØ¯Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                  </div>

                  <div>
                    <label className="flex items-center gap-1 text-sm font-bold text-slate-700 mb-2">
                      Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ <span className="text-red-500">*</span>
                    </label>
                    <select value={obligationForm.programId || ''} onChange={(e) => setObligationForm(o => ({ ...o, programId: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-emerald-400">
                      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</option>
                      {programs.map(p => (
                        <option key={p.id} value={p.id}>{p.icon} {p.name} ({p.authority})</option>
                      ))}
                    </select>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5">
                    <label className="block text-sm font-bold text-slate-700 mb-4">Ù…ØµØ¯Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… (Obligation Source)</label>
                    <div className="grid grid-cols-2 gap-4">
                      <label className={`flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${obligationForm.sourceType === 'template' ? 'bg-emerald-100 border-emerald-500' : 'bg-white border-slate-200 hover:border-emerald-300'
                        }`}>
                        <input type="radio" name="sourceType" value="template" checked={obligationForm.sourceType === 'template'}
                          onChange={(e) => setObligationForm(o => ({ ...o, sourceType: e.target.value }))} className="w-5 h-5 text-emerald-500" />
                        <div>
                          <p className="font-bold text-slate-800">âœ… Ù…ÙˆÙ„Ù‘Ø¯ Ù…Ù† Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
                          <p className="text-sm text-slate-600">Template-Generated</p>
                          <p className="text-xs text-slate-500 mt-1">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ù…Ø³ØªÙˆØ±Ø¯ Ù…Ù† Saudi Regulatory Pack</p>
                        </div>
                      </label>
                      <label className={`flex items-center gap-4 p-4 rounded-xl border-2 cursor-pointer transition-all ${obligationForm.sourceType === 'custom' ? 'bg-blue-100 border-blue-500' : 'bg-white border-slate-200 hover:border-blue-300'
                        }`}>
                        <input type="radio" name="sourceType" value="custom" checked={obligationForm.sourceType === 'custom'}
                          onChange={(e) => setObligationForm(o => ({ ...o, sourceType: e.target.value }))} className="w-5 h-5 text-blue-500" />
                        <div>
                          <p className="font-bold text-slate-800">âœï¸ Ø§Ù„ØªØ²Ø§Ù… ÙŠØ¯ÙˆÙŠ Ù…Ø®ØµØµ</p>
                          <p className="text-sm text-slate-600">Custom Manual</p>
                          <p className="text-xs text-slate-500 mt-1">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ²Ø§Ù… Ø¬Ø¯ÙŠØ¯ ÙŠØ¯ÙˆÙŠØ§Ù‹</p>
                        </div>
                      </label>
                    </div>
                  </div>

                  {obligationForm.sourceType === 'template' && (
                    <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                      <p className="text-emerald-700 font-bold mb-2">ğŸ“‹ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…ØµØ¯Ø±</p>
                      <p className="text-sm text-emerald-600">Ø³ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ù† Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø§Ù„Ù…Ø­Ø¯Ø¯</p>
                    </div>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 3: Applicability â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 3 && (
                <div className="space-y-5">
                  <div className="bg-amber-50 border border-amber-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-amber-700">
                      <CheckSquare className="w-5 h-5" />
                      <p className="font-bold">Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª</p>
                    </div>
                    <p className="text-amber-600 text-sm mt-1">Ø­Ø¯Ø¯ Ù…Ø¯Ù‰ Ø§Ù†Ø·Ø¨Ø§Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¸Ù…Ø©</p>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5">
                    <label className="block text-sm font-bold text-slate-700 mb-4">Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Applicability Status)</label>
                    <div className="grid grid-cols-3 gap-4">
                      <label className={`flex flex-col items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all text-center ${obligationForm.applicability === 'applicable' ? 'bg-emerald-100 border-emerald-500' : 'bg-white border-slate-200 hover:border-emerald-300'
                        }`}>
                        <input type="radio" name="applicability" value="applicable" checked={obligationForm.applicability === 'applicable'}
                          onChange={(e) => setObligationForm(o => ({ ...o, applicability: e.target.value }))} className="w-5 h-5 text-emerald-500" />
                        <div className="w-12 h-12 rounded-full bg-emerald-100 flex items-center justify-center text-2xl">âœ…</div>
                        <div>
                          <p className="font-bold text-slate-800">Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</p>
                          <p className="text-xs text-slate-500">Applicable</p>
                        </div>
                      </label>
                      <label className={`flex flex-col items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all text-center ${obligationForm.applicability === 'partial' ? 'bg-amber-100 border-amber-500' : 'bg-white border-slate-200 hover:border-amber-300'
                        }`}>
                        <input type="radio" name="applicability" value="partial" checked={obligationForm.applicability === 'partial'}
                          onChange={(e) => setObligationForm(o => ({ ...o, applicability: e.target.value }))} className="w-5 h-5 text-amber-500" />
                        <div className="w-12 h-12 rounded-full bg-amber-100 flex items-center justify-center text-2xl">âš ï¸</div>
                        <div>
                          <p className="font-bold text-slate-800">ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø²Ø¦ÙŠ</p>
                          <p className="text-xs text-slate-500">Partial</p>
                        </div>
                      </label>
                      <label className={`flex flex-col items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all text-center ${obligationForm.applicability === 'not_applicable' ? 'bg-red-100 border-red-500' : 'bg-white border-slate-200 hover:border-red-300'
                        }`}>
                        <input type="radio" name="applicability" value="not_applicable" checked={obligationForm.applicability === 'not_applicable'}
                          onChange={(e) => setObligationForm(o => ({ ...o, applicability: e.target.value }))} className="w-5 h-5 text-red-500" />
                        <div className="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-2xl">âŒ</div>
                        <div>
                          <p className="font-bold text-slate-800">ØºÙŠØ± Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</p>
                          <p className="text-xs text-slate-500">Not Applicable</p>
                        </div>
                      </label>
                    </div>
                  </div>

                  {(obligationForm.applicability === 'not_applicable' || obligationForm.applicability === 'partial') && (
                    <div className="bg-red-50 rounded-xl p-5 border border-red-200 space-y-4">
                      <h4 className="font-bold text-red-700 flex items-center gap-2">
                        <AlertCircle className="w-5 h-5" />
                        ÙŠØªØ·Ù„Ø¨ Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø±Ø³Ù…ÙŠ
                      </h4>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ù…Ø¨Ø±Ø± Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ *</label>
                        <textarea value={obligationForm.exceptionJustification || ''} onChange={(e) => setObligationForm(o => ({ ...o, exceptionJustification: e.target.value }))}
                          className="w-full px-4 py-3 border-2 border-red-200 rounded-xl focus:border-red-400 focus:outline-none h-20 resize-none"
                          placeholder="Ø§Ø´Ø±Ø­ Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù†Ø·Ø¨Ø§Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…..." />
                      </div>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ (Approver) *</label>
                          <input type="text" value={obligationForm.exceptionApprover || ''} onChange={(e) => setObligationForm(o => ({ ...o, exceptionApprover: e.target.value }))}
                            className="w-full px-4 py-3 border-2 border-red-200 rounded-xl focus:border-red-400 focus:outline-none"
                            placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹ØªÙ…Ø¯" />
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</label>
                          <input type="date" value={obligationForm.exceptionDate || ''} onChange={(e) => setObligationForm(o => ({ ...o, exceptionDate: e.target.value }))}
                            className="w-full px-4 py-3 border-2 border-red-200 rounded-xl focus:border-red-400 focus:outline-none" />
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 4: Evidence Requirements â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 4 && (
                <div className="space-y-5">
                  <div className="bg-teal-50 border border-teal-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-teal-700">
                      <FileCheck className="w-5 h-5" />
                      <p className="font-bold">Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„Ø¥Ø«Ø¨Ø§Øª</p>
                    </div>
                    <p className="text-teal-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</p>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5">
                    <div className="flex items-center justify-between mb-4">
                      <label className="font-bold text-slate-700">Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø£Ø¯Ù„Ø©ØŸ</label>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={obligationForm.evidenceRequired !== false} onChange={(e) => setObligationForm(o => ({ ...o, evidenceRequired: e.target.checked }))}
                          className="sr-only peer" />
                        <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-teal-500"></div>
                        <span className="mr-3 text-sm font-bold text-slate-700">{obligationForm.evidenceRequired !== false ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}</span>
                      </label>
                    </div>
                  </div>

                  {obligationForm.evidenceRequired !== false && (
                    <>
                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                        <div className="grid grid-cols-3 gap-2">
                          {['Ø´Ù‡Ø§Ø¯Ø© ØªØ³Ø¬ÙŠÙ„', 'ØªÙ‚Ø±ÙŠØ± ØªØ¯Ù‚ÙŠÙ‚', 'Ø³Ø¬Ù„ Ø¹Ù…Ù„ÙŠØ§Øª', 'Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø©', 'Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹', 'ØªÙ‚Ø±ÙŠØ± Ù†Ø¸Ø§Ù…', 'ÙˆØ«ÙŠÙ‚Ø© Ù…Ø¹ØªÙ…Ø¯Ø©', 'ØµÙˆØ±Ø© ÙÙˆØªÙˆØºØ±Ø§ÙÙŠØ©', 'Ø¹Ù‚Ø¯/Ø§ØªÙØ§Ù‚ÙŠØ©'].map(type => (
                            <label key={type} className={`flex items-center gap-2 p-3 rounded-xl border-2 cursor-pointer transition-all ${(obligationForm.evidenceTypes || []).includes(type) ? 'bg-teal-100 border-teal-500' : 'bg-white border-slate-200 hover:border-teal-300'
                              }`}>
                              <input type="checkbox" checked={(obligationForm.evidenceTypes || []).includes(type)} onChange={(e) => {
                                if (e.target.checked) {
                                  setObligationForm(o => ({ ...o, evidenceTypes: [...(o.evidenceTypes || []), type] }));
                                } else {
                                  setObligationForm(o => ({ ...o, evidenceTypes: (o.evidenceTypes || []).filter(t => t !== type) }));
                                }
                              }} className="w-4 h-4 text-teal-500 rounded" />
                              <span className="text-sm text-slate-700">{type}</span>
                            </label>
                          ))}
                        </div>
                      </div>

                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">ÙØªØ±Ø© ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¯Ù„ÙŠÙ„ (Ø¨Ø§Ù„Ø£ÙŠØ§Ù…)</label>
                          <input type="number" min="1" value={obligationForm.evidenceValidityDays || 365} onChange={(e) => setObligationForm(o => ({ ...o, evidenceValidityDays: parseInt(e.target.value) || 365 }))}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-400 focus:outline-none" />
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                          <input type="number" min="1" value={obligationForm.minEvidenceCount || 1} onChange={(e) => setObligationForm(o => ({ ...o, minEvidenceCount: parseInt(e.target.value) || 1 }))}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-teal-400 focus:outline-none" />
                        </div>
                      </div>
                    </>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 5: Schedule & Calendar â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 5 && (
                <div className="space-y-5">
                  <div className="bg-indigo-50 border border-indigo-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-indigo-700">
                      <Calendar className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„ØªÙ‚ÙˆÙŠÙ…</p>
                    </div>
                    <p className="text-indigo-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… ÙˆÙ‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ ÙˆØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                  </div>

                  <div className="grid grid-cols-2 gap-6">
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø¯ÙˆØ±ÙŠØ© Ø§Ù„ØªÙƒØ±Ø§Ø±</label>
                      <select value={obligationForm.recurrence} onChange={(e) => setObligationForm(o => ({ ...o, recurrence: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-400">
                        {recurrences.map(r => <option key={r} value={r}>{r}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-bold text-slate-700 mb-2">Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</label>
                      <input type="text" value={obligationForm.deadline} onChange={(e) => setObligationForm(o => ({ ...o, deadline: e.target.value }))}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-indigo-400 focus:outline-none"
                        placeholder="Ù…Ø«Ø§Ù„: Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©ØŒ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±" />
                    </div>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <h4 className="font-bold text-slate-700">Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ (Due Rule)</h4>
                    <div className="grid grid-cols-3 gap-4">
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©</label>
                        <select value={obligationForm.dueRuleType || 'fixed'} onChange={(e) => setObligationForm(o => ({ ...o, dueRuleType: e.target.value }))}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg">
                          <option value="fixed">ÙŠÙˆÙ… Ø«Ø§Ø¨Øª</option>
                          <option value="relative">Ù†Ø³Ø¨ÙŠ Ù…Ù† Ø§Ù„Ø­Ø¯Ø«</option>
                          <option value="realtime">ÙÙˆØ±ÙŠ (Real-time)</option>
                          <option value="ondemand">Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨</option>
                        </select>
                      </div>
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„Ù‚ÙŠÙ…Ø©</label>
                        <input type="number" value={obligationForm.dueRuleValue || 1} onChange={(e) => setObligationForm(o => ({ ...o, dueRuleValue: parseInt(e.target.value) || 1 }))}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg" />
                      </div>
                      <div>
                        <label className="block text-xs font-bold text-slate-600 mb-1">Ø§Ù„ÙˆØ­Ø¯Ø©</label>
                        <select value={obligationForm.dueRuleUnit || 'days'} onChange={(e) => setObligationForm(o => ({ ...o, dueRuleUnit: e.target.value }))}
                          className="w-full px-3 py-2.5 border-2 border-slate-200 rounded-lg">
                          <option value="hours">Ø³Ø§Ø¹Ø§Øª</option>
                          <option value="days">Ø£ÙŠØ§Ù…</option>
                          <option value="weeks">Ø£Ø³Ø§Ø¨ÙŠØ¹</option>
                          <option value="months">Ø£Ø´Ù‡Ø±</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div className="bg-indigo-50 rounded-xl p-5 border border-indigo-200">
                    <div className="flex items-center justify-between mb-4">
                      <h4 className="font-bold text-indigo-700 flex items-center gap-2">
                        <Zap className="w-5 h-5" />
                        ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù‡Ø§Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                      </h4>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={obligationForm.autoTaskGeneration !== false} onChange={(e) => setObligationForm(o => ({ ...o, autoTaskGeneration: e.target.checked }))}
                          className="sr-only peer" />
                        <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-indigo-500"></div>
                      </label>
                    </div>
                    <p className="text-sm text-indigo-600">Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 6: Testing Plan â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 6 && (
                <div className="space-y-5">
                  <div className="bg-cyan-50 border border-cyan-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-cyan-700">
                      <ClipboardList className="w-5 h-5" />
                      <p className="font-bold">Ø®Ø·Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                    </div>
                    <p className="text-cyan-600 text-sm mt-1">Ø­Ø¯Ø¯ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5">
                    <div className="flex items-center justify-between mb-4">
                      <label className="font-bold text-slate-700">Ù‡Ù„ ÙŠØªØ·Ù„Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù…ØªØ«Ø§Ù„ØŸ</label>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" checked={obligationForm.testingRequired !== false} onChange={(e) => setObligationForm(o => ({ ...o, testingRequired: e.target.checked }))}
                          className="sr-only peer" />
                        <div className="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-cyan-500"></div>
                        <span className="mr-3 text-sm font-bold text-slate-700">{obligationForm.testingRequired !== false ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}</span>
                      </label>
                    </div>
                  </div>

                  {obligationForm.testingRequired !== false && (
                    <>
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                          <select value={obligationForm.testType || 'manual'} onChange={(e) => setObligationForm(o => ({ ...o, testType: e.target.value }))}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400">
                            <option value="manual">Ø§Ø®ØªØ¨Ø§Ø± ÙŠØ¯ÙˆÙŠ</option>
                            <option value="automated">Ø§Ø®ØªØ¨Ø§Ø± Ø¢Ù„ÙŠ</option>
                            <option value="sampling">Ø§Ø®ØªØ¨Ø§Ø± Ø¹ÙŠÙ†Ø§Øª</option>
                            <option value="walkthrough">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</option>
                          </select>
                        </div>
                        <div>
                          <label className="block text-sm font-bold text-slate-700 mb-2">Ø¯ÙˆØ±ÙŠØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                          <select value={obligationForm.testFrequency || 'Quarterly'} onChange={(e) => setObligationForm(o => ({ ...o, testFrequency: e.target.value }))}
                            className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400">
                            <option value="Monthly">Ø´Ù‡Ø±ÙŠ</option>
                            <option value="Quarterly">Ø±Ø¨Ø¹ Ø³Ù†ÙˆÙŠ</option>
                            <option value="Semi-Annual">Ù†ØµÙ Ø³Ù†ÙˆÙŠ</option>
                            <option value="Annual">Ø³Ù†ÙˆÙŠ</option>
                          </select>
                        </div>
                      </div>

                      <div>
                        <label className="block text-sm font-bold text-slate-700 mb-2">Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                        <input type="text" value={obligationForm.testTemplate || ''} onChange={(e) => setObligationForm(o => ({ ...o, testTemplate: e.target.value }))}
                          className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-cyan-400 focus:outline-none"
                          placeholder="Ø§Ø®ØªØ± Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" />
                      </div>
                    </>
                  )}
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 7: Enforcement Rules â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 7 && (
                <div className="space-y-5">
                  <div className="bg-red-50 border border-red-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-red-700">
                      <AlertTriangle className="w-5 h-5" />
                      <p className="font-bold">Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†ÙØ§Ø° ÙˆÙ…Ø­ÙØ²Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚</p>
                    </div>
                    <p className="text-red-600 text-sm mt-1">Ø­Ø¯Ø¯ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ø±ØµØ¯ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª ÙˆØ§Ù„ØªØµØ¹ÙŠØ¯</p>
                  </div>

                  <div className="bg-slate-50 rounded-xl p-5 space-y-4">
                    <h4 className="font-bold text-slate-700">Ù…Ø­ÙØ²Ø§Øª Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (Auto Breach Triggers)</h4>

                    <div className="space-y-3">
                      <label className={`flex items-center justify-between p-4 rounded-xl border-2 cursor-pointer transition-all ${obligationForm.breachOnOverdue ? 'bg-red-100 border-red-400' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center gap-3">
                          <input type="checkbox" checked={obligationForm.breachOnOverdue} onChange={(e) => setObligationForm(o => ({ ...o, breachOnOverdue: e.target.checked }))}
                            className="w-5 h-5 text-red-500 rounded" />
                          <div>
                            <p className="font-bold text-slate-800">ğŸš¨ Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ£Ø®Ø±</p>
                            <p className="text-sm text-slate-600">Overdue 0 days â†’ Critical Breach</p>
                          </div>
                        </div>
                        <input type="number" value={obligationForm.overdueThreshold || 0} onChange={(e) => setObligationForm(o => ({ ...o, overdueThreshold: parseInt(e.target.value) || 0 }))}
                          className="w-20 px-3 py-2 border-2 border-slate-200 rounded-lg text-center" placeholder="Ø£ÙŠØ§Ù…" />
                      </label>

                      <label className={`flex items-center justify-between p-4 rounded-xl border-2 cursor-pointer transition-all ${obligationForm.breachOnRejection ? 'bg-red-100 border-red-400' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center gap-3">
                          <input type="checkbox" checked={obligationForm.breachOnRejection} onChange={(e) => setObligationForm(o => ({ ...o, breachOnRejection: e.target.checked }))}
                            className="w-5 h-5 text-red-500 rounded" />
                          <div>
                            <p className="font-bold text-slate-800">âŒ ØªØµØ¹ÙŠØ¯ Ø¹Ù†Ø¯ Ø±ÙØ¶ Ø§Ù„Ø¯Ù„ÙŠÙ„</p>
                            <p className="text-sm text-slate-600">Evidence Rejected Twice â†’ Escalate</p>
                          </div>
                        </div>
                        <input type="number" value={obligationForm.rejectionThreshold || 2} onChange={(e) => setObligationForm(o => ({ ...o, rejectionThreshold: parseInt(e.target.value) || 2 }))}
                          className="w-20 px-3 py-2 border-2 border-slate-200 rounded-lg text-center" placeholder="Ù…Ø±Ø§Øª" />
                      </label>

                      <label className={`flex items-center justify-between p-4 rounded-xl border-2 cursor-pointer transition-all ${obligationForm.breachOnMissing ? 'bg-red-100 border-red-400' : 'bg-white border-slate-200'
                        }`}>
                        <div className="flex items-center gap-3">
                          <input type="checkbox" checked={obligationForm.breachOnMissing} onChange={(e) => setObligationForm(o => ({ ...o, breachOnMissing: e.target.checked }))}
                            className="w-5 h-5 text-red-500 rounded" />
                          <div>
                            <p className="font-bold text-slate-800">ğŸ“­ Ø§Ø®ØªØ±Ø§Ù‚ Ø¹Ù†Ø¯ ÙÙ‚Ø¯ Ø§Ù„Ø¯Ù„ÙŠÙ„</p>
                            <p className="text-sm text-slate-600">Missing Evidence â†’ Auto Breach</p>
                          </div>
                        </div>
                      </label>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">Ù‚ÙˆØ§Ø¹Ø¯ Ø¥Ù†ÙØ§Ø° Ù…Ø®ØµØµØ©</label>
                    <textarea value={obligationForm.customEnforcementRules || ''} onChange={(e) => setObligationForm(o => ({ ...o, customEnforcementRules: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-red-400 focus:outline-none h-20 resize-none font-mono text-sm"
                      placeholder="Ø£Ø¯Ø®Ù„ Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ø®ØµØµØ©..." />
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 8: Impact & Penalties â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 8 && (
                <div className="space-y-5">
                  <div className="bg-orange-50 border border-orange-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-orange-700">
                      <Scale className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</p>
                    </div>
                    <p className="text-orange-600 text-sm mt-1">Ø­Ø¯Ø¯ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ£Ø«ÙŠØ± ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©</p>
                  </div>

                  <div className="grid grid-cols-2 gap-6">
                    <div className="bg-slate-50 rounded-xl p-5">
                      <label className="block text-sm font-bold text-slate-700 mb-4">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ£Ø«ÙŠØ± (Impact Level)</label>
                      <div className="flex items-center gap-4">
                        <input type="range" min="1" max="5" value={obligationForm.impactLevel || 3} onChange={(e) => setObligationForm(o => ({ ...o, impactLevel: parseInt(e.target.value) }))}
                          className="flex-1 h-3 bg-gradient-to-r from-green-200 via-amber-200 to-red-200 rounded-lg appearance-none cursor-pointer" />
                        <span className={`w-12 h-12 rounded-xl flex items-center justify-center font-black text-white text-lg ${(obligationForm.impactLevel || 3) >= 4 ? 'bg-red-500' : (obligationForm.impactLevel || 3) >= 3 ? 'bg-amber-500' : 'bg-green-500'
                          }`}>{obligationForm.impactLevel || 3}</span>
                      </div>
                      <div className="flex justify-between text-xs text-slate-500 mt-2">
                        <span>Ù…Ù†Ø®ÙØ¶</span>
                        <span>Ù…ØªÙˆØ³Ø·</span>
                        <span>Ø¹Ø§Ù„ÙŠ</span>
                      </div>
                    </div>

                    <div className="bg-slate-50 rounded-xl p-5">
                      <label className="block text-sm font-bold text-slate-700 mb-4">Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</label>
                      <div className="space-y-2">
                        {[
                          { value: 'financial', label: 'ğŸ’° Ù…Ø§Ù„ÙŠ (ØºØ±Ø§Ù…Ø§Øª)', color: 'red' },
                          { value: 'license', label: 'ğŸ“œ ØªØ±Ø®ÙŠØµ (Ø¥ÙŠÙ‚Ø§Ù/Ø³Ø­Ø¨)', color: 'purple' },
                          { value: 'reputation', label: 'ğŸ¢ Ø³Ù…Ø¹Ø© (ØªØ´Ù‡ÙŠØ±)', color: 'orange' },
                          { value: 'criminal', label: 'âš–ï¸ Ø¬Ù†Ø§Ø¦ÙŠ (Ù…Ø­Ø§ÙƒÙ…Ø©)', color: 'slate' },
                        ].map(exp => (
                          <label key={exp.value} className={`flex items-center gap-2 p-2 rounded-lg cursor-pointer ${(obligationForm.exposureTypes || []).includes(exp.value) ? `bg-${exp.color}-100` : 'hover:bg-slate-100'
                            }`}>
                            <input type="checkbox" checked={(obligationForm.exposureTypes || []).includes(exp.value)} onChange={(e) => {
                              if (e.target.checked) {
                                setObligationForm(o => ({ ...o, exposureTypes: [...(o.exposureTypes || []), exp.value] }));
                              } else {
                                setObligationForm(o => ({ ...o, exposureTypes: (o.exposureTypes || []).filter(t => t !== exp.value) }));
                              }
                            }} className="w-4 h-4 rounded" />
                            <span className="text-sm">{exp.label}</span>
                          </label>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-bold text-slate-700 mb-2">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©</label>
                    <textarea value={obligationForm.penaltyDetails || ''} onChange={(e) => setObligationForm(o => ({ ...o, penaltyDetails: e.target.value }))}
                      className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-orange-400 focus:outline-none h-20 resize-none"
                      placeholder="Ù…Ø«Ø§Ù„: ØºØ±Ø§Ù…Ø© ØªØµÙ„ Ø¥Ù„Ù‰ 100,000 Ø±ÙŠØ§Ù„ + Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù…Ø¯Ø© 30 ÙŠÙˆÙ…..." />
                  </div>
                </div>
              )}

              {/* â•â•â•â•â•â•â•â•â•â•â• Tab 9: Mapping & Preview â•â•â•â•â•â•â•â•â•â•â• */}
              {(obligationForm.wizardTab || 0) === 9 && (
                <div className="space-y-5">
                  <div className="bg-violet-50 border border-violet-200 rounded-xl p-4">
                    <div className="flex items-center gap-2 text-violet-700">
                      <GitBranch className="w-5 h-5" />
                      <p className="font-bold">Ø§Ù„Ø±Ø¨Ø· ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (Golden Thread)</p>
                    </div>
                    <p className="text-violet-600 text-sm mt-1">Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª</p>
                  </div>

                  <div className="grid grid-cols-3 gap-4">
                    <div className="bg-blue-50 rounded-xl p-4 border border-blue-200">
                      <h4 className="font-bold text-blue-700 mb-3 flex items-center gap-2">
                        <Shield className="w-5 h-5" />
                        Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©
                      </h4>
                      <div className="space-y-2">
                        <div className="p-2 bg-white rounded-lg border border-blue-100 text-sm">
                          <p className="font-bold text-slate-800">CTRL-001</p>
                          <p className="text-slate-600 text-xs">Ø¶Ø§Ø¨Ø· Ø§Ù„ÙˆØµÙˆÙ„ ÙˆØ§Ù„Ù‡ÙˆÙŠØ©</p>
                        </div>
                        <div className="p-2 bg-white rounded-lg border border-blue-100 text-sm">
                          <p className="font-bold text-slate-800">CTRL-002</p>
                          <p className="text-slate-600 text-xs">Ø¶Ø§Ø¨Ø· Ø§Ù„ØªØ´ÙÙŠØ±</p>
                        </div>
                        <button className="w-full py-2 text-blue-600 hover:bg-blue-100 rounded-lg text-sm font-bold">+ Ø±Ø¨Ø· Ø¶Ø§Ø¨Ø·</button>
                      </div>
                    </div>

                    <div className="bg-red-50 rounded-xl p-4 border border-red-200">
                      <h4 className="font-bold text-red-700 mb-3 flex items-center gap-2">
                        <AlertTriangle className="w-5 h-5" />
                        Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
                      </h4>
                      <div className="space-y-2">
                        <div className="p-2 bg-white rounded-lg border border-red-100 text-sm">
                          <p className="font-bold text-slate-800">RISK-001</p>
                          <p className="text-slate-600 text-xs">Ù…Ø®Ø§Ø·Ø± Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                        </div>
                        <button className="w-full py-2 text-red-600 hover:bg-red-100 rounded-lg text-sm font-bold">+ Ø±Ø¨Ø· Ù…Ø®Ø§Ø·Ø±Ø©</button>
                      </div>
                    </div>

                    <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                      <h4 className="font-bold text-emerald-700 mb-3 flex items-center gap-2">
                        <FileText className="w-5 h-5" />
                        Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
                      </h4>
                      <div className="space-y-2">
                        <div className="p-2 bg-white rounded-lg border border-emerald-100 text-sm">
                          <p className="font-bold text-slate-800">POL-001</p>
                          <p className="text-slate-600 text-xs">Ø³ÙŠØ§Ø³Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
                        </div>
                        <button className="w-full py-2 text-emerald-600 hover:bg-emerald-100 rounded-lg text-sm font-bold">+ Ø±Ø¨Ø· Ø³ÙŠØ§Ø³Ø©</button>
                      </div>
                    </div>
                  </div>

                  {/* Summary Preview */}
                  <div className="bg-gradient-to-r from-violet-50 to-purple-50 rounded-xl p-5 border border-violet-200">
                    <h4 className="font-bold text-violet-700 mb-4">ğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</h4>
                    <div className="grid grid-cols-4 gap-4 text-sm">
                      <div className="bg-white rounded-lg p-3 text-center">
                        <p className="text-2xl font-black text-blue-600">{obligationForm.code || '-'}</p>
                        <p className="text-slate-500">Ø§Ù„ÙƒÙˆØ¯</p>
                      </div>
                      <div className="bg-white rounded-lg p-3 text-center">
                        <p className="text-2xl font-black text-emerald-600">{obligationForm.severity || '-'}</p>
                        <p className="text-slate-500">Ø§Ù„Ø£Ù‡Ù…ÙŠØ©</p>
                      </div>
                      <div className="bg-white rounded-lg p-3 text-center">
                        <p className="text-2xl font-black text-amber-600">{obligationForm.recurrence || '-'}</p>
                        <p className="text-slate-500">Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</p>
                      </div>
                      <div className="bg-white rounded-lg p-3 text-center">
                        <p className="text-2xl font-black text-purple-600">{(obligationForm.evidenceTypes || []).length}</p>
                        <p className="text-slate-500">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø©</p>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Enhanced Footer */}
            <div className="border-t-2 border-slate-200 px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 flex items-center justify-between shrink-0">
              <div className="flex items-center gap-3">
                <button disabled={(obligationForm.wizardTab || 0) === 0} onClick={() => setObligationForm(o => ({ ...o, wizardTab: (o.wizardTab || 0) - 1 }))}
                  className="px-5 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2 transition-all shadow-sm">
                  <ChevronRight className="w-5 h-5" />Ø§Ù„Ø³Ø§Ø¨Ù‚
                </button>
                <button disabled={(obligationForm.wizardTab || 0) === 9} onClick={() => setObligationForm(o => ({ ...o, wizardTab: (o.wizardTab || 0) + 1 }))}
                  className="px-5 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2 transition-all shadow-sm">
                  Ø§Ù„ØªØ§Ù„ÙŠ<ChevronLeft className="w-5 h-5" />
                </button>
              </div>

              <div className="flex items-center gap-3">
                <button onClick={() => { setShowObligationModal(false); setEditMode(false); resetObligationForm(); }}
                  className="px-6 py-2.5 bg-white border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-slate-50 transition-all shadow-sm">
                  Ø¥Ù„ØºØ§Ø¡
                </button>
                <button onClick={editMode ? handleEditObligation : handleAddObligation} disabled={!obligationForm.title || !obligationForm.code}
                  className="flex items-center gap-2 px-8 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl font-bold shadow-lg hover:shadow-xl disabled:opacity-50 transition-all">
                  {editMode ? <><Save className="w-5 h-5" />Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</> : <><Plus className="w-5 h-5" />Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</>}
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DELETE MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDeleteModal && deleteTarget && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden">
            <div className="p-6 text-center">
              <div className="w-16 h-16 rounded-full bg-red-100 flex items-center justify-center mx-auto mb-4">
                <Trash2 className="w-8 h-8 text-red-600" />
              </div>
              <h3 className="text-xl font-bold text-slate-800 mb-2">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù</h3>
              <p className="text-slate-600 mb-4">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù {deleteTarget.type === 'program' ? 'Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ' : 'Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…'}ØŸ</p>
              <div className="p-3 bg-slate-100 rounded-xl mb-4">
                <p className="font-bold text-slate-800">{deleteTarget.name || deleteTarget.title}</p>
                <p className="text-sm text-slate-500">{deleteTarget.code}</p>
              </div>
              <p className="text-red-600 text-sm font-bold">âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡</p>
            </div>
            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-center gap-3">
              <button onClick={() => { setShowDeleteModal(false); setDeleteTarget(null); }} className="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={deleteTarget.type === 'program' ? handleDeleteProgram : handleDeleteObligation}
                className="flex items-center gap-2 px-6 py-2.5 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600">
                <Trash2 className="w-5 h-5" />Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ
              </button>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DETAIL MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showDetailModal && selectedProgram && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
            <div className={`px-6 py-5 text-white shrink-0 bg-gradient-to-r ${selectedProgram.color === 'red' ? 'from-red-500 to-rose-600' :
                selectedProgram.color === 'emerald' ? 'from-emerald-500 to-teal-600' :
                  selectedProgram.color === 'purple' ? 'from-purple-500 to-violet-600' :
                    selectedProgram.color === 'indigo' ? 'from-indigo-500 to-blue-600' :
                      selectedProgram.color === 'amber' ? 'from-amber-500 to-orange-600' :
                        selectedProgram.color === 'blue' ? 'from-blue-500 to-indigo-600' :
                          selectedProgram.color === 'teal' ? 'from-teal-500 to-cyan-600' :
                            selectedProgram.color === 'pink' ? 'from-pink-500 to-rose-600' :
                              selectedProgram.color === 'orange' ? 'from-orange-500 to-amber-600' :
                                selectedProgram.color === 'cyan' ? 'from-cyan-500 to-teal-600' :
                                  selectedProgram.color === 'violet' ? 'from-violet-500 to-purple-600' :
                                    'from-slate-500 to-gray-600'
              }`}>
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-16 h-16 rounded-xl bg-white/20 flex items-center justify-center text-4xl">{selectedProgram.icon}</div>
                  <div>
                    <div className="flex items-center gap-2">
                      <h2 className="text-2xl font-bold">{selectedProgram.name}</h2>
                      <span className="text-lg">{selectedProgram.country === 'SA' ? 'ğŸ‡¸ğŸ‡¦' : 'ğŸŒ'}</span>
                    </div>
                    <p className="opacity-80">{selectedProgram.nameEn} â€¢ {selectedProgram.code}</p>
                  </div>
                </div>
                <button onClick={() => { setShowDetailModal(false); setSelectedProgram(null); }} className="w-10 h-10 rounded-xl bg-white/20 hover:bg-white/30 flex items-center justify-center">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>

            <div className="flex-1 overflow-y-auto p-6 space-y-6">
              {/* Quick Stats */}
              <div className="grid grid-cols-5 gap-3">
                <div className="bg-slate-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-black text-slate-800">{selectedProgram.obligations?.length || 0}</p>
                  <p className="text-xs text-slate-500">Ø§Ù„ØªØ²Ø§Ù…</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-black text-slate-800">{selectedProgram.standards?.length || 0}</p>
                  <p className="text-xs text-slate-500">Ù…Ø¹ÙŠØ§Ø±</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-black text-emerald-600">{selectedProgram.complianceRate}%</p>
                  <p className="text-xs text-slate-500">Ø§Ù…ØªØ«Ø§Ù„</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-black text-red-600">{selectedProgram.riskScore}/10</p>
                  <p className="text-xs text-slate-500">Ø§Ù„Ù…Ø®Ø§Ø·Ø±</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-3 text-center">
                  <span className={`px-2 py-1 rounded text-xs font-bold ${selectedProgram.criticality === 'Critical' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}`}>
                    {selectedProgram.criticality === 'Critical' ? 'Ø­Ø±Ø¬' : 'Ø¹Ø§Ù„ÙŠ'}
                  </span>
                </div>
              </div>

              {/* Info Grid */}
              <div className="grid grid-cols-3 gap-4">
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©</p>
                  <p className="font-bold text-slate-800">{selectedProgram.authority}</p>
                  <p className="text-sm text-slate-600">{selectedProgram.authorityName}</p>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</p>
                  <span className={`px-2 py-1 rounded text-xs font-bold ${selectedProgram.type === 'Mandatory' ? 'bg-red-100 text-red-700' : 'bg-blue-100 text-blue-700'
                    }`}>{selectedProgram.type === 'Mandatory' ? 'Ø¥Ù„Ø²Ø§Ù…ÙŠ' : selectedProgram.type}</span>
                </div>
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-1">Ø§Ù„Ø¥ØµØ¯Ø§Ø±</p>
                  <p className="font-bold text-slate-800">{selectedProgram.version}</p>
                </div>
              </div>

              {/* Description */}
              {selectedProgram.description && (
                <div className="bg-slate-50 rounded-xl p-4">
                  <p className="text-xs text-slate-500 mb-2">Ø§Ù„ÙˆØµÙ</p>
                  <p className="text-slate-700">{selectedProgram.description}</p>
                </div>
              )}

              {/* Sectors */}
              {selectedProgram.sectorAr?.length > 0 && (
                <div>
                  <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©</h4>
                  <div className="flex flex-wrap gap-2">
                    {selectedProgram.sectorAr.map((sector, idx) => (
                      <span key={idx} className="px-3 py-1.5 bg-emerald-100 text-emerald-700 rounded-lg text-sm font-bold">{sector}</span>
                    ))}
                  </div>
                </div>
              )}

              {/* Penalties */}
              {selectedProgram.penalty && (
                <div className="bg-red-50 rounded-xl p-4 border border-red-100">
                  <p className="text-xs text-red-500 mb-2 font-bold">âš ï¸ Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©</p>
                  <p className="text-red-700 font-medium">{selectedProgram.penalty}</p>
                </div>
              )}

              {/* Obligations */}
              <div>
                <div className="flex items-center justify-between mb-3">
                  <h4 className="font-bold text-slate-700">Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ({selectedProgram.obligations?.length || 0})</h4>
                  <button onClick={() => { setShowDetailModal(false); openAddObligation(selectedProgram); }} className="text-sm text-emerald-600 hover:underline flex items-center gap-1">
                    <Plus className="w-4 h-4" />Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ²Ø§Ù…
                  </button>
                </div>
                <div className="space-y-2 max-h-60 overflow-y-auto">
                  {selectedProgram.obligations?.map((obl, idx) => (
                    <div key={idx} className="flex items-start justify-between p-3 bg-slate-50 rounded-xl group hover:bg-slate-100">
                      <div className="flex items-start gap-3 flex-1">
                        <span className="font-mono text-xs bg-white px-2 py-1 rounded border shrink-0">{obl.code}</span>
                        <div className="flex-1">
                          <p className="text-slate-800 font-medium">{obl.title}</p>
                          {obl.description && <p className="text-xs text-slate-500 mt-1">{obl.description}</p>}
                        </div>
                        <span className={`px-2 py-1 rounded text-xs font-bold shrink-0 ${obl.severity === 'Critical' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}`}>{obl.severity}</span>
                      </div>
                      <div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all mr-2">
                        <button onClick={() => { setShowDetailModal(false); openEditObligation(selectedProgram, obl); }} className="p-1.5 text-amber-600 hover:bg-amber-50 rounded-lg"><Edit className="w-4 h-4" /></button>
                        <button onClick={() => { setShowDetailModal(false); openDeleteObligation(obl); }} className="p-1.5 text-red-600 hover:bg-red-50 rounded-lg"><Trash2 className="w-4 h-4" /></button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Standards */}
              {selectedProgram.standards?.length > 0 && (
                <div>
                  <h4 className="font-bold text-slate-700 mb-3">Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± ÙˆØ§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³ ({selectedProgram.standards.length})</h4>
                  <div className="grid grid-cols-2 gap-2">
                    {selectedProgram.standards.map((std, idx) => (
                      <div key={idx} className="flex items-center justify-between p-3 bg-blue-50 rounded-xl">
                        <div>
                          <p className="font-mono text-xs text-blue-600">{std.code}</p>
                          <p className="text-sm text-slate-700">{std.title}</p>
                        </div>
                        <span className="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-bold">{std.metric}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between shrink-0">
              <button onClick={() => { setShowDetailModal(false); setSelectedProgram(null); }} className="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥ØºÙ„Ø§Ù‚</button>
              <div className="flex items-center gap-2">
                <button onClick={() => { setShowDetailModal(false); openEditProgram(selectedProgram); }} className="flex items-center gap-2 px-4 py-2.5 bg-amber-500 text-white rounded-xl font-bold hover:bg-amber-600">
                  <Edit className="w-5 h-5" />ØªØ¹Ø¯ÙŠÙ„
                </button>
                {!activatedPrograms.includes(selectedProgram.id) && (
                  <button onClick={() => { setShowDetailModal(false); setShowAdvancedWizard(true); }} className="flex items-center gap-2 px-4 py-2.5 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                    <Zap className="w-5 h-5" />ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      )}

      {/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ACTIVATION WIZARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */}
      {showAdvancedWizard && selectedProgram && (
        <div className="fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4">
          <div className="bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden">
            <div className="bg-gradient-to-r from-emerald-500 to-teal-600 px-6 py-5 text-white">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-xl bg-white/20 flex items-center justify-center text-3xl">{selectedProgram.icon}</div>
                  <div>
                    <h2 className="text-xl font-bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ</h2>
                    <p className="text-emerald-200 text-sm">{selectedProgram.name}</p>
                  </div>
                </div>
                <button onClick={() => { setShowAdvancedWizard(false); setSelectedProgram(null); }} className="w-10 h-10 rounded-xl bg-white/20 hover:bg-white/30 flex items-center justify-center">
                  <X className="w-5 h-5" />
                </button>
              </div>
            </div>
            <div className="p-6 space-y-4">
              <div className="bg-emerald-50 rounded-xl p-4 border border-emerald-200">
                <p className="text-emerald-700 font-bold mb-2">âœ… Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ§Ù„ÙŠ:</p>
                <p className="text-slate-700">{selectedProgram.name} ({selectedProgram.nameEn})</p>
                <p className="text-sm text-slate-500 mt-1">Ø§Ù„Ø¬Ù‡Ø©: {selectedProgram.authorityName}</p>
              </div>
              <div className="bg-amber-50 rounded-xl p-4 border border-amber-200">
                <p className="text-amber-700 font-bold mb-2">âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù‡Ø§Ù…Ø©:</p>
                <ul className="text-sm text-amber-600 space-y-1">
                  <li>â€¢ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© {selectedProgram.obligations?.length || 0} Ø§Ù„ØªØ²Ø§Ù… Ø¥Ù„Ù‰ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</li>
                  <li>â€¢ ØªØ£ÙƒØ¯ Ù…Ù† Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ÙØ±ÙŠÙ‚ Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø¨Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª</li>
                  <li>â€¢ ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù…Ù† Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù…ÙØ¹Ù‘Ù„Ø©</li>
                </ul>
              </div>
            </div>
            <div className="border-t border-slate-200 px-6 py-4 bg-slate-50 flex items-center justify-between">
              <button onClick={() => { setShowAdvancedWizard(false); setSelectedProgram(null); }} className="px-6 py-2.5 border-2 border-slate-300 text-slate-700 rounded-xl font-bold hover:bg-white">Ø¥Ù„ØºØ§Ø¡</button>
              <button onClick={() => { handleActivateProgram(selectedProgram.id); setShowAdvancedWizard(false); setSelectedProgram(null); }}
                className="flex items-center gap-2 px-6 py-2.5 bg-emerald-500 text-white rounded-xl font-bold hover:bg-emerald-600">
                <Zap className="w-5 h-5" />ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const InstitutionalCompliance = () => <PlaceholderScreen title="Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ" subtitle="Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±" />;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Main Application)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CompliancePlatform = () => {
  const [activeScreen, setActiveScreen] = useState('obligations');
  const [sidebarOpen, setSidebarOpen] = useState(true);

  const menuItems = [
    { id: 'dashboard', label: 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', icon: Home },
    { id: 'obligations', label: 'Ø³Ø¬Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', icon: FileText },
    { id: 'policies', label: 'Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª ÙˆÙ…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', icon: BookOpen },
    { id: 'mapping', label: 'Ø±Ø¨Ø· Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø§Ù„Ø¶ÙˆØ§Ø¨Ø· ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±', icon: Link2 },
    { id: 'calendar', label: 'ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ©', icon: Calendar },
    { id: 'evidence', label: 'Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚', icon: FolderOpen },
    { id: 'tests', label: 'Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„', icon: ClipboardCheck },
    { id: 'violations', label: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©', icon: AlertTriangle },
    { id: 'changes', label: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠØ©', icon: RefreshCw },
    { id: 'contact', label: 'Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ù‚Ø§Ø¨ÙŠØ©', icon: MessageSquare },
    { id: 'maturity', label: 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„Ù†Ø¶Ø¬', icon: TrendingUp },
    { id: 'saudipack', label: 'Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ', icon: Globe },
    { id: 'institutional', label: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ', icon: Building2 },
  ];

  const renderScreen = () => {
    switch (activeScreen) {
      case 'dashboard': return <Dashboard />;
      case 'obligations': return <ObligationsRegistry />;
      case 'policies': return <PoliciesStandards />;
      case 'mapping': return <ObligationsMapping />;
      case 'calendar': return <ComplianceCalendar />;
      case 'evidence': return <EvidenceRepository />;
      case 'tests': return <ComplianceTests />;
      case 'violations': return <ViolationsManagement />;
      case 'changes': return <RegulatoryChanges />;
      case 'contact': return <RegulatoryContact />;
      case 'maturity': return <MaturityAssessment />;
      case 'saudipack': return <SaudiRegulatoryPack />;
      case 'institutional': return <InstitutionalCompliance />;
      default: return <Dashboard />;
    }
  };

  return (
    <div dir="rtl" className="min-h-screen bg-slate-100">
      {/* Header */}
      <header className="fixed top-0 left-0 right-0 h-14 bg-white border-b border-slate-200 z-50 flex items-center justify-between px-4">
        <div className="flex items-center gap-3">
          <div className="w-9 h-9 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg shadow-emerald-500/25">
            <Shield className="w-5 h-5 text-white" />
          </div>
          <div className="hidden sm:block">
            <span className="font-bold text-slate-800">Ù…Ù†ØµØ© Ø§Ù„Ø¨ØµÙŠØ±ÙŠ</span>
            <span className="text-slate-400 text-xs mr-2">Ù„Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„Ø­ÙˆÙƒÙ…Ø©</span>
          </div>
        </div>
        <div className="flex items-center gap-2">
          <button className="p-2 hover:bg-slate-100 rounded-lg relative">
            <Bell className="w-5 h-5 text-slate-600" />
            <span className="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
          </button>
          <button className="p-2 hover:bg-slate-100 rounded-lg">
            <Settings className="w-5 h-5 text-slate-600" />
          </button>
          <div className="w-9 h-9 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center">
            <User className="w-5 h-5 text-white" />
          </div>
        </div>
      </header>

      <div className="flex pt-14">
        {/* Sidebar */}
        <aside className={`fixed top-14 right-0 bottom-0 bg-slate-900 z-40 transition-all duration-300 ${sidebarOpen ? 'w-64' : 'w-0 overflow-hidden'}`}>
          <button
            onClick={() => setSidebarOpen(!sidebarOpen)}
            className={`absolute top-4 bg-slate-800 text-white p-2 rounded-xl hover:bg-slate-700 transition-all z-50 ${sidebarOpen ? '-left-3' : '-left-12'}`}
          >
            <ChevronRight className={`w-5 h-5 transition-transform ${sidebarOpen ? '' : 'rotate-180'}`} />
          </button>

          <div className="h-full overflow-y-auto p-3" style={{ scrollbarWidth: 'thin', scrollbarColor: 'rgba(255,255,255,0.2) transparent' }}>
            <div className="flex items-center gap-2 px-3 py-3 mb-4">
              <div className="w-8 h-8 rounded-lg bg-emerald-500 flex items-center justify-center">
                <span className="text-white font-bold text-sm">4</span>
              </div>
              <span className="text-white font-semibold">Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ…</span>
            </div>

            <nav className="space-y-1">
              {menuItems.map((item, index) => (
                <button
                  key={item.id}
                  onClick={() => setActiveScreen(item.id)}
                  className={`w-full flex items-center gap-2 px-3 py-2.5 rounded-xl transition-all text-sm ${activeScreen === item.id
                      ? 'bg-emerald-500 text-white'
                      : 'text-slate-400 hover:text-white hover:bg-slate-800'
                    }`}
                >
                  <item.icon className="w-4 h-4 flex-shrink-0" />
                  <span className="flex-1 text-right truncate">{item.label}</span>
                  {index > 0 && <span className="text-xs opacity-50">4.{index}</span>}
                </button>
              ))}
            </nav>

            <div className="mt-6 pt-4 border-t border-slate-800">
              <button className="w-full flex items-center gap-2 px-3 py-2.5 rounded-xl text-slate-400 hover:text-white hover:bg-slate-800 text-sm">
                <LogOut className="w-4 h-4" />
                <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
              </button>
            </div>
          </div>
        </aside>

        {/* Main Content */}
        <main className={`flex-1 min-h-screen transition-all duration-300 ${sidebarOpen ? 'mr-64' : 'mr-0'}`}>
          {!sidebarOpen && (
            <button onClick={() => setSidebarOpen(true)} className="fixed top-20 right-4 bg-slate-900 text-white p-3 rounded-xl shadow-lg z-30 hover:bg-slate-800 transition-colors">
              <Menu className="w-5 h-5" />
            </button>
          )}
          <div className="p-6">{renderScreen()}</div>
        </main>
      </div>
    </div>
  );
};

export default CompliancePlatform;
